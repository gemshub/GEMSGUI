<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
            
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
            
  <meta name="GENERATOR"
 content="Mozilla/4.72 [en] (Win98; I) [Netscape]">
  <title>GEMS Thermo Database Manual (3)</title>
             
  <meta name="description" content="Version 2.0.0-PSI">
</head>
  <body>
     
<h1><img src="gems1.png" height="48" width="48">
  <b><font color="#000099"><font size="+2"> </font></font></b><font
 color="#000066">GEM-Selektor version 2-PSI</font></h1>
     
<p><a href="gemstar2.html#END_GEMSTAR2">PREVIOUS file (gemstar2.html)</a> 
</p>
   
<p><a href="gemstart.html">Table of Contents</a> <br>
</p>
<p>Under Construction<br>
</p>
<p>To be completed in Version 2.1&nbsp; </p>
   
<h2> Getting Started Manual (Continued)</h2>
 
<hr width="100%" size="2">                              
<p><br>
                </p>
                               
<h2><a name="GSM_EXTEND_PROJECT"></a>4. Extending Modelling Project Database</h2>
                               
<p><br>
                </p>
                               
<h3><a name="GSM_DATA_OVERRIDE"></a>4.1. Overriding Database Records for
Species and Phases</h3>
                               
<p><br>
                </p>
                               
<h3><a name="GSM_ADD_SPECIES"></a>4.2. Adding New Dependent Components (Species)</h3>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_ADD_DCOMP"></a>4.2.1. Adding DComp Records</h4>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_SET_BIBLIOREF"></a>4.2.2. Setting Up a Bibliography Reference</h4>
                               
<p>     <br>
                </p>
                               
<h4><a name="GSM_ADD_REACDC"></a>4.2.3. Adding ReacDC Records&nbsp;</h4>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_RUN_RTPARM"></a>4.2.4. Tabulating T,P Corrections for Thermodynamic
        Data (RTParm Records)&nbsp;</h4>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_RTPARM_MATH_SCRIPT"></a>4.2.5. Modifying a RTParm Print
Script</h4>
                                  
<p>  </p>
                                    
<p>  </p>
                                  
<p><br>
                </p>
                               
<h3><a name="GSM_ADD_PHASE"></a>4.3. Adding New Phase Definitions</h3>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_ADD_SINGLE"></a>4.3.1. Creating a Single-Component Phase
        Record</h4>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_ADD_IDEAL"></a>4.3.2. Creating an Ideal Solution Phase Record</h4>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_ADD_NONIDEAL"></a>4.3.3. Creating a Non-Ideal Solution Phase
        Record</h4>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_PHASE_MATH_SCRIPT"></a>4.3.4. Writing Math Script for a
Non-Ideal Mixing Model</h4>
                               
<p><br>
                </p>
                               
<h4><a name="GSM_ADD_SORPTION"></a>4.3.5. Creating a Sorption Phase Record 
            </h4>
                               
<p><br>
                </p>
                               
<h3><a name="GSM_ADD_COMPOS"></a>4.4. Adding New PCO (Compos) Records</h3>
                               
<p><br>
                </p>
                               
<h3><a name="GSM_GEMS_DB_MORE"></a>4.5. More About Management of GEMS Databases</h3>
                               
<p>   <br>
                </p>
                               
<h2><a name="GSM_PROJECT_EXTEND"></a>5. &nbsp;Extending the Modelling Project</h2>
                               
<p><br>
                </p>
                               
<h3><a name="GSM_ELEMENTS_DIALOG"></a>5.1. ElementsDialog Options</h3>
                               
<p><br>
                </p>
                               
<h3><a name="GSM_PROJECT_COPY"></a>5.2. Copying Records from GEMS Kernel
Database</h3>
                               
<p>     <br>
                </p>
                               
<h3><a name="GSM_EQSTAT_RERUN"></a>5.3. Re-running already calculated equilibria</h3>
                               
<p><br>
                     </p>
                               
<h3><a name="GSM_PROJECTS_MORE"></a>5.4. More About Modelling Projects</h3>
                               
<p><br>
                </p>
                               
<h2><a name="GSM_MOD_SORPTION"></a>6. Modelling Systems with Sorption Phases</h2>
                               
<p><br>
                </p>
                               
<h3>6.1.&nbsp;</h3>
                               
<p><br>
                </p>
                               
<h3>6.2.&nbsp;</h3>
                               
<p><br>
                     </p>
                               
<h2><a name="GSM_HOWTO_PROCEED"></a>7. How to Proceed&nbsp;</h2>
                                  
<p>  </p>
                                    
<p>  </p>
                                  
<p><br>
                </p>
                              <br>
    
<h3> <a name="3_3_extend_tdbase"></a>3.3 Extending Thermodynamic Database</h3>
      
<p><br>
  What to do if you have reached a conclusion that an aqueous complex or
solid  phase are missing in the system profile you worked with? Or you do
not like  some thermodynamic data in the GEM-Selektor kernel database and
want to replace  them? These situations are very typical in geochemical modelling
and may sometimes need a lot of effort to be resolved. <br>
  &nbsp; </p>
   
<p>In GEM-Selektor, it is easy to do thermodynamic database extensions and
 make them available to your system profile, although this requires some
understanding  on how the thermodynamic database is organized and maintained.
You may skip  the following five paragraphs if you are already familiar with
GEMS thermodynamic  data framework. <br>
  &nbsp; </p>
   
<blockquote><a name="TDB_OVERVIEW"></a>The GEM-Selektor thermodynamic database 
 has four levels of data, kept in the IComp, DComp, ReacDC, and Phase record 
 types (chains). The <a href="gm_icomp.html">IComp</a> chain contains records 
 defining Independent Components (IC), or stoichiometry units, which form 
a common stoichiometry basis for expressing&nbsp; composition of chemical 
systems and species. The IComp symbols (mainly chemical elements and charge), 
and only them, can be used in writing&nbsp; <a
 href="g_useref.html#FORMULA">chemical  formulae</a>&nbsp; of&nbsp; thermodynamic&nbsp; 
species, or Dependent Components  (DC), which are stored in&nbsp; <a
 href="gm_dcomp.html">DComp</a>&nbsp; or&nbsp;   <a
 href="gm_reacdc.html">ReacDC</a>&nbsp; database records. DC formulae are 
automatically processed for calculation of the species molar mass, formula
 charge, checking consistency of thermodynamic data, and producing stoichiometry
 matrices for calculation of chemical equilibria. In addition, IComp records
 contain default valence numbers of elements to simplify chemical formulae,
 as well as values of absolute entropy of elements, needed for conversions
 between standard molar Gibbs energy, enthalpy and entropy of chemical species. 
   <br>
  &nbsp;       
  <p>DComp records keep the formulae and standard state thermodynamic properties 
 of solid, gas, liquid and aqueous species (DC) in "thermochemical" format. 
 Namely, it includes the standard molar properties (or standard partial molal
 properties) at reference pressure and temperature: Gibbs energy <i>G<sup>o</sup></i>&nbsp; 
 and enthalpy <i>H<sup>o</sup>&nbsp;</i> of formation from IC (chemical elements)
 at standard states, absolute entropy <i>S<sup>o</sup>&nbsp;</i> and molar
 volume <i>V<sup>o</sup></i> . Optionally, the <a href="gm_dcomp.html">DComp</a> 
 records may contain vectors of empirical <i>Cp<sup>o</sup> </i>= <i>f </i>(<i>T 
   </i>), <i>V<sup>o</sup> </i>= <i>f </i>(<i>T,P</i> ), equation -of - state
 coefficients etc., necessary for <a href="theortdb.html">calculation of
standard  thermodynamic properties at elevated pressures and temperatures</a>.
All the numbers contained in DComp records refer to the stoichiometry of
this particular species, rather than to its reaction with other species.
In other words, data in different DComp records are connected only through
IC stoichiometries  of species and information kept in IComp records. <br>
  &nbsp; </p>
       
  <p><a href="gm_reacdc.html">ReacDC</a> records are used for defining thermodynamic 
 properties of aqueous and surface complexes and minerals for which thermochemical 
 data are not available or too uncertain. For such species, only log<i>K</i>&nbsp; 
 of the dissolution, association or surface complexation reaction is usually 
 known (often predicted at 25 <sup>o</sup>C or other temperatures). Thus, 
a ReacDC record describes the reaction and its properties (and also <i>T,P</i>&nbsp; 
 dependence of&nbsp; log<i>K</i> ). Because GEM algorithms cannot use reactions 
 and stability constants directly for calculation of equilibria, ReacDC record
 also provides a full set of standard (partial molal) thermodynamic properties
 for a "new" species, computed from the properties of the reaction and that
 of all other species involved in the reaction. The "new", reaction-defined 
 compound, actually, gives a name to the reaction and to the ReacDC <a
 href="#P3324">record key</a>. Thermodynamic properties of this compound
are automatically maintained consistent (to that of other species involved
into the reaction) at all temperatures and pressures. The "involved" species
must already exist in the database as either <a href="#P33D3">DComp</a> or
other ReacDC records: a given ReacDC definition can refer to other ReacDC
records (but not to itself), thus forming a "reaction chain" (up to seven
levels of recursion are supported). Any reaction chain always terminates
with a reaction which refers to DComp records only. Several&nbsp; <a
 href="theortdb.html">methods of calculation</a> of thermodynamic properties
 of reaction-defined species at elevated&nbsp; <i>T,P&nbsp; </i>are available
 in GEM-Selektor. ReacDC module is a unique feature of GEMS, to our knowledge,
 not yet available in full elsewhere. Accordingly, the GEM-Selektor database
 is the first in a sense that thermochemical data and reactions are used
together  for any kind of geochemical modelling and data consistency is automatically 
 maintained. <br>
  &nbsp; </p>
       
  <p><a href="gm_phase.html">Phase</a> definition records put together links 
 to input data from both DComp and ReacDC record types. Design of GEM-Selektor 
 requires that each (even a single- component) phase to be taken into calculation 
 of equilibrium states must be&nbsp; described in a separate <a
 href="gm_phase.html">Phase</a> record, with (unique) phase name appearing
 in the <a href="#P3326">Phase record key</a>. <a href="gm_dcomp.html">DComp</a>
 or <a href="gm_reacdc.html">ReacDC</a> definitions do not contain all information
 for defining structure and behavior of the single- or multi-component phases.
 In fact, any data describing the non-ideal mixing behavior of end-members
 is valid for a particular model of phase only, and alternative representations
 are often possible. The flexible Phase data structure permits formulation
 of a large variety of crystalline and dispersed, liquid and gaseous, adsorption
 and ion-exchange ideal or non-ideal phases which may occur in different
(geo)chemical  systems. Please, note that <a href="gm_profil.html">System
Profiles</a> in  GEMS are constructed from Phase definitions, i.e. the profile
cannot "see"  any DComp or ReacDC records which are not referred to by at
least one Phase  record accessible to the profile. <br>
  &nbsp; </p>
       
  <p>What does it mean "accessible"? In GEM-Selektor, every database chain 
 consists of several files, usually located in two places: a "kernel database" 
 and a "user's profile" directories. The write-protected "kernel database" 
 directory contains IComp, DComp, ReacDC and Phase database files with more 
 or less "standard" thermodynamic data for major and many minor chemical elements;
is supplied and installed together with GEMS program and help files. The
user's profile directory is automatically created when the user creates a
new system profile for his/her modelling applications; this is the only place
where all the input data provided by the user and calculation results can
be stored. Any time, the database file can be linked in or out of the current
database configuration of GEM-Selektor. When a file is linked in, all the
records it contains become "visible" for the user and the program in record
key lists. Accordingly, these records become "invisible" and inaccessible
 after the file has been linked out. New database files can be any time created
 by the user in his profile directory and linked in, if necessary.</p>
  </blockquote>
      
<p>Although the GEM-Selektor kernel thermodynamic database can be used for
 solving many various geochemical problems (see <a href="g_tutor.html">Tutorial</a>), 
 almost every study involving thermodynamic modeling, sooner or later, faces 
 a problem of inconsistency or incompleteness of thermodynamic data. It is
 therefore necessary to have convenient tools to handle the data, check and
 match them, and incorporate into equilibria calculations. The tradition, 
however, is such that most of modeling codes contain files with thermodynamic 
data from published databases but still no tools to work with the data (except
 using them for speciation calculations). <br>
  &nbsp; </p>
   
<p>There are some specialized codes such as SUPCRT92 [<a
 href="g_litref.html#%5B1992JOH/OEL%5D">1992JOH/OEL</a>] which handle the
 thermodynamic database, calculate user-specified reactions, plot them on
diagrams, but they cannot calculate equilibria in multi-component systems.
Moreover, most of speciation programs based on the Law of Mass Action (LMA)
algorithm (like PHREEQC2 [<a href="g_litref.html#%5B1999PAR/APP%5D">1999PAR/APP</a>] 
 or MINTEQA2 [1991ALL/BRO] use thermodynamic data exclusively in the form 
of reaction equilibrium constants <i>K</i>&nbsp; for the "product" species 
plus dependences of <i>K</i>&nbsp;&nbsp; on temperature and/or pressure. Thermochemical
data must be recalculated first into log<i>K</i>&nbsp;&nbsp; values (e.g.,
as in EQ3/6&nbsp; [1992WOL]) to be used in such codes. There are, however,
special utility programs PMATCH [1989PEA/AVI] and PM2SEL [1999DMY/KUL] which
can help in checking the internal consistency of&nbsp; thermodynamic data
and convert it into different formats. <br>
  &nbsp; </p>
   
<p>Programs based on GEM algorithms (e.g., ChemGeo, GIBBS, GEM-Selektor), 
 on the contrary, accept only the standard partial molar(molal) values of 
Gibbs energy for all species <i>g<sup>o </sup></i>(<i>T,P&nbsp; </i>), so 
any data represented as log<i>K</i> (<i>T,P&nbsp; </i>) must first be converted 
to <i>g<sup>o </sup></i>(<i>T,P&nbsp; </i>) values before usage in GEM modeling
 calculations. In this case, it is not easy to extend thermodynamic database
 with consistent data for some new components if their thermochemical properties
 are not known. Hence, the structure of GEM-Selektor database has been designed
 to help in overcoming these difficulties. <br>
  &nbsp; <br>
  &nbsp; </p>
   
<blockquote>Example? Diagram?</blockquote>
      
<p>When you press the "<tt>Thermodynamic Database</tt>" button on GEM-Selektor 
 Main dialog, you will see a "Thermodynamic Database" dialog window with six
large buttons for accessing the <a href="gm_icomp.html">IComp</a>, <a
 href="gm_dcomp.html">DComp</a>, <a href="gm_reacdc.html">ReacDC</a>, <a
 href="gm_rtparm.html">RTparm</a>, <a href="gm_compos.html">Phase</a> and
 <a href="gm_compos.html">Compos</a> module windows, described in the corresponding
 manuals. The respective six database chains contain records with all the
input data necessary for building GEM chemical models, linked together into
the System Profile ("Default" in this exercise). Part of database files in
each chain belongs to the kernel database which you can use but not modify;
another part belongs to your own "Default" profile directory; all extensions
and changes you make can be stored there and only there. In other words,
the kernel database will remain unaffected by your personal modifications
of thermodynamic data, and your own work will retain compatibility with system
 profiles created by other GEMS users. <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_3_1_override_data"></a>3.3.1 Overriding data in kernel database</h4>
   &nbsp;   
<p>&nbsp; </p>
   
<p>A typical case (especially for experienced modellers) is when the user 
 refuses&nbsp; thermodynamic data for some species or minerals provided in
 the kernel database, but the corresponding records cannot be changed because
 they are write-protected. Of course, you could create a new DComp or ReacDC
 records with different names for those species and type in your favorite
numbers; after the system profile is open next time, you should not forget
to switch off the "primarily provided" species from the SysEq selection lists.
But GEM- Selektor offers&nbsp; a far more elegant way - <i>an override mechanism
 of record selection, </i>which applies to lists of record keys in ReacDC,
 Phase, and Profile/SysEq data structures only. <br>
  &nbsp; <br>
  &nbsp; </p>
   
<blockquote>In the GEMS database, structurized <a href="gdb_rkey.html">record 
 key formats</a> are supported.&nbsp; For instance, <a
 href="gm_dcomp.html">DComp</a> and <a href="gm_reacdc.html">ReacDC</a> record
 key formats are identical and include four fields - phase state, group,
species  name, and comment (data set code). The primary idea of these formats
was to keep long lists of DC record keys in a well-structurized way as the
database  chain index is alphabetically sorted, so that aqueous species are
first, gases next, and minerals at the end. Within aqueous species list,
the group name (second field) usually refers to metal cation or ligand, so
all complexes  of a given metal are conveniently held together in the lists.
Actually, the  species name is the most important because it may appear in
the (case sensitive)    <a href="gmscript.html">math scripts.</a>&nbsp; The
fourth field serves  to indicate the original data set from where the data
were taken and (optionally)  grade of their uncertainty.</blockquote>
      
<p><a name="OVERRIDE"></a>The <b><i>override mechanism</i></b>&nbsp; consists 
 in that the last field of the record key is actually ignored when the records 
 are loaded during processing of the lists of record keys in&nbsp; ReacDC, 
 Phase and Profile/SysEq data structures. So, when the program finds more 
than one&nbsp; record with the same record key fields except the last one,&nbsp; 
 it simply takes in a record keyed alphabetically the first and ignores others;
 no warnings are issued. <br>
  &nbsp; </p>
   
<p>Let us check how the override mechanism works using a celestite (SrSO<sub>4</sub>) 
 example. From the "Thermodynamic Database" dialog, press the <tt>"Dependent 
 Components (DComp)" </tt>button. In appearing "DComp" window, click on the
 "Show" icon (first from the left) and in the list, select the line  <tt>s:SrSO:celestite:rs:</tt>&nbsp;
 and press <tt>"Ok"</tt>. You will see the DComp record for celestite from
 GEMS kernel database which contains data from the USGS dataset [<a
 href="g_litref.html#%5B1995ROB/HEM%5D">1995ROB/HEM</a>]&nbsp; (indicated
 by&nbsp; <tt>rs</tt>&nbsp; in the last record key field). The drawback of
 this data is absence of <i>Cp<sup>o</sup></i> = <i>f </i>(<i>T </i>) coefficients
 and heat capacity value at 25 <sup>o</sup>C (check on <tt>Page 2</tt> of
"DComp" window), thus making temperature extrapolation impossible. Fortunately,
data for celestite is also available from the SUPCRT92 database [<a
 href="g_litref.html#%5B1992JOH/OEL%5D">1992JOH/OEL</a>] with Majer-Kelly 
 coefficients valid up to 1500 K (both data are compared below in J/mol): 
<br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp;   
<table border="1" cols="3" width="73%">
   <tbody>
      <tr>
   <td>Property of celestite</td>
    <td>&nbsp;[<a href="g_litref.html#%5B1995ROB/HEM%5D">1995ROB/HEM</a>]&nbsp;</td>
    <td>[<a href="g_litref.html#%5B1992JOH/OEL%5D">1992JOH/OEL</a>]</td>
   </tr>
    <tr>
   <td><i>G<sup>o</sup><sub>298&nbsp;&nbsp; </sub></i>J/mol</td>
    <td>-1339600</td>
    <td>-1340700</td>
   </tr>
    <tr>
   <td><i>H<sup>o</sup><sub>298&nbsp;&nbsp; </sub></i>J/mol</td>
    <td>-1453200</td>
    <td>-1453100</td>
   </tr>
    <tr>
   <td><i>S<sup>o</sup><sub>298&nbsp;&nbsp;&nbsp; </sub></i>J/K/mol</td>
    <td>117.0</td>
    <td>117.152</td>
   </tr>
    <tr>
   <td><i>V<sup>o</sup><sub>298</sub></i> , J/bar</td>
    <td>4.625</td>
    <td>4.625</td>
   </tr>
    <tr>
   <td><i>Cp<sup>o</sup><sub>298&nbsp; </sub></i>J/K/mol</td>
    <td>0</td>
    <td>107.8</td>
   </tr>
    <tr>
   <td><i>a<sub>0</sub></i></td>
    <td>0</td>
    <td>91.2112</td>
   </tr>
    <tr>
   <td><i>a<sub>1</sub></i></td>
    <td>0</td>
    <td>0.05565</td>
   </tr>
    <tr>
   <td><i>a<sub>2</sub></i></td>
    <td>0</td>
    <td>0</td>
   </tr>
         
  </tbody>  
</table>
    <br>
  &nbsp; </p>
   
<p>The SUPCRT92 data for celestite originate from a compilation by H.Helgeson 
 and others [1978HEL/DEL]; it allows for temperature extrapolation and provides 
 ca. 0.2 p<i>K</i> unit lower solubility of celestite at 25 <sup>o</sup>C, 
 compared to the data from [<a href="g_litref.html#%5B1995ROB/HEM%5D">1995ROB/HEM</a>], 
 as seen from the difference in values of&nbsp; <i>G<sup>o</sup><sub>298</sub></i> 
 . <br>
  &nbsp; </p>
   
<p>To use SUPCRT92 data for celestite in equilibria calculations, select <tt>"Record"
 "Save As"</tt> menu commands in order to create a new <a
 href="gm_dcomp.html">DComp</a> record with identical first three key fields
 and an alphabetically higher fourth field. A small dialog entitled "DComp:
 Insert new record keyed" appears, with the&nbsp; <tt>s:SrSO:celestite:rs3:
 </tt>record key disassembled into four editor lines. Change only the last
 (fourth) line from&nbsp; <tt>"rs3"</tt> to <tt>"h78"</tt> (or any other
alphabetically  preceding value) and press <tt>"Ok"</tt>.&nbsp; You will
see a selection list entitled "Choose database file to put a record..." with
DComp database file names, currently linked to GEMS. Select a&nbsp; <tt>dcomp.Default
</tt>file  (other files belong to the kernel database and are write-protected)
and press  <tt>"Ok"</tt>. <br>
  &nbsp; </p>
   
<p>Now, the DComp window appears again with previous contents, but under different
record key. Enter data from the above table (right column) into <tt>Page
1</tt> there (heat capacity coefficients and their validity temperature interval
into <tt>Page 2</tt>). Change reference in dSDref field on <tt>Page 1</tt>
to <tt>"Helgeson_ea:1978:pap:".</tt> Press <tt>"Calculate"</tt> icon (or
<tt>F9</tt>). A small dialog with a question "Calculate standard values ..."
appears; press<tt> "Yes"</tt> - this will check consistency of standard properties
and calculate <i>Cp<sup>o</sup><sub>298</sub></i> value for celestite from
the Majer-Kelly coefficients that you entered on <tt>Page 2</tt>. If this
value is not 107.83 then the <i>Cp<sup>o</sup></i> = <i>f </i>(<i>T </i>)
coefficients were not entered correctly; if so then check numbers entered
 on <tt>Page 2</tt> and&nbsp; repeat calculation. Press <tt>"Save"</tt> icon
 when finished. You can also perform data restoration and consistency checks;
 for instance, put "Empty" value (`) into the <tt>H0d[0]</tt> cell and press
 <tt>"Calculate"</tt> button. <br>
  &nbsp; <br>
  &nbsp; </p>
   
<p>Upon the next calculation, any reference to celestite in ReacDC, Phase 
 records and Profile/SysEq structures will operate with your new data for 
celestite, without any furtner reconfiguration. <br>
  &nbsp; </p>
   
<p>A little bit more complicated change is needed when you wish to replace 
 <a href="gm_dcomp.html">DComp</a> data for a mineral but you have only reaction
 logK and can create <a href="gm_reacdc.html">ReacDC</a> record only. This
 requires to override <a href="gm_phase.html">Phase</a> definition which
refers  to this species: just copy it (using a "Record" "Save as" menu command)
with  alphabetically higher last record key field into your <tt>phase.&lt;profilename&gt;.pdb</tt>
 file (). Then remake new phase definition so that it would point to your
own ReacDC record. Done! <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_3_2_insert_new"></a>3.3.2 Inserting new species and phases</h4>
      
<p><br>
  Second typical (and not so rare) case is that, after some modeling sessions,
 you have reached a conclusion that a mineral and/or an aqueous complex,&nbsp;
 which in reality most probably define measured metal concentrations, are
missing from your modeling system. There is nothing unusual - no thermodynamic
 database is complete, not even the GEM-Selektor kernel database. It is more
important to have effiicient tools for extending your database and system
formulations. Such tools are at your disposal! <br>
  &nbsp; </p>
   
<p>The simplest case is adding aqueous or gaseous species if your <a
 href="gm_profil.html">system profile</a> uses default (automatically assembled
 during opening of the profile) aqueous and gas phases. All you have to do
 is to collect thermodynamic data and create missing <a
 href="gm_dcomp.html">DComp</a> and/or <a href="gm_reacdc.html">ReacDC</a> 
 records in database extension files in your profile directory. We recommend 
 keeping up with the style of record keys used in the kernel database. These 
 new species will be taken into all your SysEq definitions when you select 
 the "Computation of Equilibria" mode and open your profile next time (press 
 "Ok" on warnings about detection of your newly inserted species). <br>
  &nbsp; </p>
   
<p>Please, do not forget to re-calculate all equilibria already stored in
 SysEq records in your profile! The program automatically updates indexation 
 in <a href="gm_syseq.html">SysEq</a> records after some species were excluded 
 or added from/to the system profile, but it cannot decide in which cases 
these species can affect modelling results, so this is left to your discretion. 
 <br>
  &nbsp; </p>
   
<p>If you wish to add mineral phases to your system, first check whether the
respective DComp records are available in the kernel database - Phase definitions
are provided there only for the most commonly used minerals. If this is the
case, simply create missing <a href="gm_phase.html">Phase definition</a>
records. If not - then create <a href="gm_dcomp.html">DComp</a> or <a
 href="gm_reacdc.html">ReacDC</a> record, enter thermodynamic data, and save
the record in one of the database extension files in your profile directory
(best is to load some of the existing records and use them as templates by
applying "Record" "Save As" menu command). Then&nbsp; create a new Phase
 record (single- or multi-component phases) and remake it to point to the
new DC record. New phases and components will be automatically inserted into
System Profile lists upon the next opening of the profile. Do not forget
to recalculate those <a href="gm_syseq.html">SysEq</a> records (system definitions)
in which you deem the new phases to be stable! <br>
  &nbsp; </p>
   
<p>One important remark about non-aqueous and non-gaseous phases and their 
 components: the system profile is assembled by picking up all records available 
 in the current Phase database chain (with due regard to the override mechanism). 
 Only those <a href="gm_dcomp.html">DComp</a> and <a
 href="gm_reacdc.html">ReacDC</a> records will be selected that are referred
 to in <a href="gm_phase.html">Phase</a> records. This means that some species
 or minerals in your database extension may not be used in equilibria calculations
 if you (on purpose or by chance) did not include them into Phase record
lists.  <br>
  &nbsp; </p>
   
<p>Creating definitions of single component condensed phases is by far the
 simplest task because such a definition does not include any math script 
equations and refers only to one species (the system profile <a
 href="#OVERRIDE">override  mechanism</a> applies for loading DComp/ReacDC 
data referred to in <a href="gm_phase.html">Phase definitions</a>). In a Remake
configuration window which comes after you have specified the new <a
 href="gdb_rkey.html#dbm_Phase">Phase record key</a>, check that <tt>"NNNNNN"</tt>
 is entered into<tt> p_solt</tt>&nbsp; fields with <a
 href="g_useref.html#NONIDTYPES">codes for non-ideality phase types;</a>&nbsp; 
 either of <tt>"l", "s"</tt> or <tt>"d"</tt> code stays in the <tt>Ph_Ps[0,0]</tt><a
 href="g_useref.html#PHASETYPES">phase class field</a>, and press "Ok". Then
 select one species from DComp or ReacDC record lists that appear later.
Type  in the phase name and check that <tt>"O"</tt> (single component) code
is present in the <tt>PhDCC</tt> (species class) field. Finally, save the
new phase definition record into one of your profile extension database files.
 <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_3_3_check_trends"></a>3.3.3 Checking T,P trends for new species</h4>
      
<p><br>
  When thermodynamic data are entered into <a href="gm_dcomp.html">Dcomp</a> 
 records, or new <a href="gm_reacdc.html">ReacDC</a> definitions are constructed, 
 misprints and errors can be introduced. Some of them are automatically detected
 by Dcomp and ReacDC modules, i.e. such errors incomplete or inconsistent 
standard state data, wrong formula stoichiometry, incorrect charge; the corresponding
 diagnostic messages are then issued. Some other errors can be detected only
 when a series of thermodynamic data for varying <i>T,P</i>&nbsp;&nbsp; is
 computed and plotted on graphs. Thus, the RTparm module and window screen 
 forms are provided for facilitating the process of "debugging"&nbsp; thermodynamic 
 data and their <i>T,P</i>&nbsp;&nbsp; dependencies for individual species. 
 <a href="gm_rtparm.html">RTparm</a> module takes input data from Dcomp or
 ReacDC record with the four first fields same as in the <a
 href="gdb_rkey.html#dbm_RTParm">RTparm record key</a>. The <a
 href="#OVERRIDE">override mechanism</a> does not apply to RTparm lists in
 order to make it possible to compare different representation of temperature-pressure
 trends for one species. <br>
  &nbsp; </p>
   
<p>Several RTPARM records can be created for one DCOMP or REACDC record, and
up to four such records can be plotted together on graphs, e.g., for comparison
of different temperature extrapolations. The RTPARM function, taken together
with flexibility of DCOMP and REACDC definitions implemented in GEMS, provides
a new level of matching and user's extension of thermodynamic database, and
can save a lot of time and effort in putting together various data needed
for modeling systems of environmental geochemical interest. Since the same
DCthermo() and RCthermo() routines are used in both RTPARM and <a
 href="#P3250">System Profile</a> calculations, the tests done by RTPARM
will make you confident that nothing unexpected can happen with thermodynamic
data during calculation of equilibria at non-ambient temperatures and pressures. 
 <br>
  &nbsp; </p>
   
<p>As usual, new RTPARM calculations are performed in GEMS by creating new
 records. In a Remake configuration window (invoked by <a href="#P333R2">Remake</a> 
 or <a href="#P333R3">Create</a> commands), the user can specify how many 
points for temperature and pressure will be calculated, which thermodynamic 
data collected and how they will be displayed on four plots. This is done 
using flags and switches (equipped with help messages popping up at mouse 
pointer, as usual). After pressing OK, the RTPARM screen form appears again, 
there minimum, maximum temperature-pressure and their increments can be specified
 if different from default (0 to 375 <sup>o</sup>C in 15 <sup>o</sup>C increments
 at P<sub>SAT</sub>). <br>
  &nbsp; </p>
   
<p>Calculations are performed&nbsp; with <a href="#P333R4">Calculate</a> command;
when finished, up to four graphs are displayed on <tt>"Record" "<a
 href="#P333R8">Plot</a>"</tt> menu command and can be <a href="#P3290">customized</a> 
 as in <a href="#P3280">GTDEMO</a> record. The calculated data can also be
 printed into a text file using a <tt>"Record" "<a href="#P333R9">Print</a>" 
 </tt>command. <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_3_4_create_PCO"></a>3.3.4 Creating Predefined Composition
 Object (PCO) definitions</h4>
      
<p><br>
  A useful extension of your modeling tollbox is creating GCO definitions 
(<a href="#P33D2">Compos</a> records) and storing them in your <tt>/compos.&lt;pname&gt;.pdb</tt> 
 file. It helps much in setting bulk compositions of systems in a neat and 
 transparent way, especially for simulation of such processes as mixing ,
 evaporation, weathering etc. As usual in GEMS, the easiest way is to "clone"
 existing Compos records with <a href="#P333R3">Create</a> or <a
 href="#P333R6">Save As</a> menu commands, remaking and re-calculating them
 whenever appropriate. The new Compos record keys will be automatically added
 to the <a href="#P3400">System Profile</a> when you open it next time. </p>
   
<p>Let us consider an example of creating a new Compos record for the kaolinite 
 stoichiometry. First, press "Show" button to get the record&nbsp; "<tt>Kaolinite:MIN:Al2Si2O5(OH)4:</tt>". 
 You will see&nbsp; a very simple screen where composition of kaolinite is
 expressed in moles of chemical elements in the "CI" vector. The MasVol[0] 
 cell shows kaolinite molar mass in kg, and MasVol[6] displays the total number
of moles of elements per mole of kaolinite. </p>
   
<p>Try to express the same composition in mole percents of petrogenic oxides 
 Al<sub>2</sub>O<sub>3</sub>, SiO<sub>2</sub> and H<sub>2</sub>O. First, execute&nbsp;
"Record" "<a href="#P333R3">Create</a>" command, modify the previous record
key as follows: "<tt>Kaolinite1:MIN:Moles_oxides:</tt>" and press OK. In
appearing "Reorganization of data fields" dialog, press "<tt>Remake</tt>"
 button. In the next "Compos: Remake parameters" dialog, turn first switch
 off and third switch on. In counters to the right, put zero into fist one
 and 3 (number of required formulae for petrogenic oxides) into third counter,
 and press <tt>OK</tt>. In c_icbc selection list which appears next, check
 "Clear All" and then "Proceed" buttons. </p>
   
<p>Now, the "Compos::" screen form appears, with empty&nbsp; list of formulae 
 "formU". Type SiO2 into its first line; Al2O3 into second and H2O into third
 line. Now,&nbsp; specify composition of kaolinite in "CA" vector (to the
right) by entering 2 against SiO2 formula, 1 against Al2O3 and 2 against
H2O. These numbers will be interpreted depending on <a
 href="GEMS-Linux-USREF.html#P6104">units of measurement</a> coded in the&nbsp;
 "AUcl" vector (in between), and then will be converted to numbers of moles
 and added to bulk GCO composition. By default, 'M' letters (numbers of moles)
 appear in AUcl. Be careful with MasVol[0] and MasVol[6] cells because they
 are used for normalizing the composition you have specified to certain mass
 or total number of IC moles, respectively. MasVol[0] contains total mass
of geochemical object Ms in kg.&nbsp; If 0 or EMPTY value ` were specified
by the user then mass fractions can not be used and Ms will be automatically
 calculated from moles or molar (molal) concentrations. A positive value
should  be entered in MasVol[0] cell if at least one value in CI, CD or CA
vectors  is specified as mass percent&nbsp; '%'&nbsp; in classifiers CIcl,
CDcl or  CAcl. In our kaolinite example, type zero into MasVol[6] and 0.1
into MasVol[0]  cells.&nbsp; Now, press "Calculate"&nbsp; to calculate 100
g of kaolinite  stoichiometry (you will see new&nbsp; numbers in the leftmost
"Cm" vector),  and "Save" to save the new record to database (do not forget
to delete this  exercise before you open the System Profile next time). </p>
   
<p>&nbsp;It is important that each element of CI, CD or CA vectors (and their
 equivalents in SysEq dialog) can be set up in different <a
 href="GEMS-Linux-USREF.html#P6104">units of measurement</a>. This is very
 convenient and gives the user an unprecedented freedom in working with bulk
 compositions or modifying them. When specifying different units, one should
 take care of their base quantities. For example, when setting molality units,
 a mass of water-solvent should always be set. Read carefully all the help
 lines to MasVol cells for instructions how to set base quantities and units
 of measurement correctly. Examination of available Compos records and some
 experimentation will give you the right feeling how&nbsp; to work with GCO
 records. Negative numbers can be used in CI, CD and CA vectors as long as
 they do not produce negative numbers of moles in the total GCO composition
 "Cm" vector. <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_3_5_update_profile"></a>3.3.5 Updating the System Profile</h4>
      
<p><br>
  This is done automatically when the user enters "Computation of Equilibria"
 mode of GEM-Selektor and selects a system profile from the appearing list.
 If some records in thermodynamic database have been created or deleted,
a  warning appears in each case. Press "Ok" to confirm changes or "Cancel"
if  the record was inserted or deleted by mistake (in the latter case, you
will  need to fix the problem before attempting to open your system profile
again).  After insertion of some phases and species into the profile, it
is usually  necessary to re-calculate at least part of <a
 href="gm_syseq.html">SysEq</a>  records produced before (and maybe, also
some <a href="gm_proces.html">Process</a>&nbsp;  and <a
 href="gm_gtdemo.html">GtDemo</a> definitions). <br>
  &nbsp; </p>
   
<p>The usual case for removing some phases from the profile (i.e. respective 
 Phase records from thermodynamic database) is that, after all the necessary 
 models have been calculated, it happens that these phases never appeared 
in equilibria. Cleaning such phases out helps in keeping your profile lists 
smaller and easier to look through. In this situation, it is not necessary 
to re-calculate all the SysEq records because nothing is going to change. 
<br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_3_6_rerun_syseq"></a>3.3.6 Re-running already calculated
equilibria</h4>
      
<p><br>
  There are two ways for re-calculating <a href="gm_syseq.html">SysEq</a> 
records: (i) one-by-one (from the "Single Thermodynamic System" dialog) and 
(ii) batch calculations (re-calculation of <a href="gm_proces.html">Process</a> 
definitions, preferable). <br>
  &nbsp; <br>
  &nbsp; </p>
   
<p>The one-by-one method is the only possible for the SysEq records which 
 are "standalone" or used as "parent" systems for Process definitions. It 
consists of two steps: (1) Press "Load..." button and select the record; (2)
Press "BCC" and then "IPM" buttons to re-run GEM IPM module. "Accept" on
the IPM Progress dialog will also save updated SysEq record to database. <br>
  &nbsp; </p>
   
<p>The batch calculation requires first to open the "Process" window, then 
 load the necessary Process record, and press "Calculate" icon or menu item 
 to recalculate all SysEq records created by this Process definition. Re-calculating 
 all GtDemo definitions related to this process is also advisable for re-plotting 
 results and looking what changed. <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h3> <a name="3_4_create_profile"></a>3.4 Creating a new System Profile</h3>
   &nbsp;   
<p>&nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_4_1_select_files"></a>3.4.1 Selecting files from the kernel 
 database</h4>
   &nbsp;   
<p>&nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_4_2_configure_profile"></a>3.4.2 Configuring the new profile</h4>
   &nbsp;   
<p>&nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h4> <a name="3_4_3_create_first_system"></a>3.4.3 Creating the first chemical 
 system definition</h4>
   &nbsp;   
<p>&nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<h2> <a name="4_howto_proceed"></a>4.&nbsp;&nbsp;&nbsp; How to proceed</h2>
   &nbsp;   
<p>&nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<p>We believe that at this point, you already feel how easy it is to "clone" 
 and change definitions of chemical systems in the GEM-Selektor profile and
 immediately see what happens to the equilibrium states. Later on, you can
 work through the Tutorial to gain a lot more experience. It is really easy
 to check various (geo)chemical ideas using GEM-Selektor! <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; <br>
  &nbsp; </p>
   
<p><a href="gemstart.html">Table of Contents</a> </p>
   
<p><tt>end of file</tt> <br>
  &nbsp; </p>
  <br>
  <br>
 <br>
</body>
</html>
