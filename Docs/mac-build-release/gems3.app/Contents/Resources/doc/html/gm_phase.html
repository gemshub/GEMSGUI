<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Arimo">
    <meta name="GENERATOR" content="Mozilla/4.72 [en] (Win98; I) [Netscape]">
    <title>GEMS3 Phase Module</title>
    <meta name="description" content="Version 2.0.0-PSI">
  </head>
  <body>
    <h1><img src="gems1.png" width="48" align="left" height="48"> <span style="color: rgb(0, 0, 102);">
        GEM-Selektor version 3<br>
      </span></h1>
    <h2>Phase Definitions (Phase) Module<br>
    </h2>
    <hr style="width: 100%; height: 2px;">
    <h3>Contents </h3>
    <blockquote> </blockquote>
    <p><a href="#PHASE_INTRO">1. Introduction to Phase module</a></p>
    <blockquote>
      <p><a href="#PHASE_FORMAT">1.1. Phase Definition data format</a> </p>
      <p><a href="#PHASE_BUILTIN">1.2. Built-in models of (non)ideal mixing</a></p>
      <p><a href="#PHASE_SCRIPTED">1.3. Scripted customary models of non-ideal
          mixing</a></p>
      <p><a href="#PHASE_CALC">1.4. Phase module calculations</a> </p>
      <p><a href="#PHASE_INTPAR">1.5. TSolMod rules for interaction parameters</a></p>
      <p><a href="#PHASE_KINMET">1.6. Metastability and kinetics (TKinMet
          implementation)<br>
        </a></p>
    </blockquote>
    <p><a href="#PHASE_MWIZARD">2. Phase Create/Remake Wizard</a> </p>
    <blockquote> </blockquote>
    <blockquote>
      <p><a href="#WZSTEP_1">2.1. Phase Wizard Step 1 - Defining the phase and
          the mode of mixing</a> </p>
      <p><a href="#WZSTEP_2">2.2. Phase Wizard Step 2 - Selection of phase
          components (endmembers)</a> </p>
      <p><a href="#WZSTEP_3">2.3. Phase Wizard Step 3 - Phase model-of-mixing
          specific dimensions</a> </p>
      <p><a href="#WZSTEP_4">2.4. Phase Wizard Step 4 - Sorption models and
          settings</a></p>
      <p><a href="#WZSTEP_5">2.5. Phase Wizard Step 5 - Kinetics - Optional
          selection of species for activity product term</a> </p>
      <p><a href="#WZSTEP_6">2.6. Phase Wizard Step 6 - Metastability and
          kinetics model settings</a></p>
      <p><a href="#WZSTEP_7">2.7. Phase Wizard Step 7 - Optional - selection of
          phase(s) for metastability link(s) with this phase</a> </p>
      <p><a href="#WZSTEP_8">2.8. Phase Wizard step 8 - Phase links, other
          settings and comments <br>
        </a></p>
    </blockquote>
    <blockquote>
      <p><a href="#WZSTEP_3"> </a></p>
    </blockquote>
    <p> </p>
    <p><a href="#PHASE_MWINDOW">3. Phase Module Window</a> </p>
    <blockquote>
      <p><a href="#MWPAGE_1">3.1. Phase Window Page 1</a></p>
      <p><a href="#MWPAGE_2">3.2. Phase Window Page 2</a></p>
      <p> <a href="#MWPAGE_3">3.3. Phase Window Page 3</a></p>
      <p><a href="#MWPAGE_4">3.4. Phase Window Page 4</a></p>
      <p><a href="#MWPAGE_5">3.5. Phase Window Page 5</a></p>
      <p><a href="#MWPAGE_6">3.6. Phase Window Page 6<br>
        </a></p>
    </blockquote>
    <p><a href="#PHASE_TYPES">4. Types of Multicomponent Phases</a></p>
    <blockquote>
      <p><a href="#PHASE_AQUEOUS">4.1. Aqueous electrolyte</a> </p>
      <p><a href="#PHASE_GASFLUID">4.2. Gas mixture and non-ideal mixed fluids</a>
      </p>
      <p><a href="#PHASE_SOLSOL">4.3. Solid and liquid non-electrolyte solutions</a></p>
      <p><a href="#PHASE_SORPTION">4.4. Sorption and surface complexation</a></p>
      <a href="#PHASE_EXAMPLES">4.5. Examples and special cases</a></blockquote>
    <p> </p>
    <p><a href="#PHASE_DATA_ENTRIES"> 5. Data Entries on Phase Window Pages</a>
    </p>
    <blockquote>
      <p><a href="#PHASE_DOD_REMAKE">5.1. Data objects that can be modified in
          Phase wizard upon create/clone/remake only</a> </p>
      <p><a href="#PHASE_DOD_SORPMOD">5.2. Data objects for isolated
          (ad)sorption and ion exchange models (TSorpMod parameters)</a></p>
      <p><a href="#PHASE_DOD_KINMET">5.3. Data objects for metastability and
          kinetics (TKinMet parameters)</a> </p>
      <p><a href="#PHASE_DOD_HIDDEN">5.4. Hidden data objects for use in Phase
          math scripts</a></p>
    </blockquote>
    <p><a href="#PHASE_ERRORS">6. Warnings and error messages</a></p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h2><a name="PHASE_INTRO"></a>1. Introduction to Phase module<br>
    </h2>
    <p>Data for dependent components (chemical species) kept in <a href="gm_dcomp.html">DComp</a>
      or <a href="gm_reacdc.html">ReacDC</a> records do not contain all
      information that is needed to calculate equilibrium states involving
      multi-component phases. A separate data structure is needed just to tell
      the program what Dependent Components mix even in a simple ideal solution
      phase. In some phases, the solvent (e.g. water) and solutes (e.g. aqueous
      ions and complexes) need to be distinguished. In most cases, a
      phase-solution also has a model of non-ideal mixing with interaction
      parameters acting between components (end members) and/or with certain
      properties of components that, in fact, make no sense for a pure component
      compound. The same Dependent Component dataset can be involved in several
      models of phases-solutions, used alternatively or simultaneously in
      calculation of equilibrium states. Even a single-component (pure) may have
      additional properties such as specific surface area, specific surface free
      energy, etc. For all these reasons, Phase definition records are main
      'building blocks', out of which the <a href="gems_bcc.html">chemical
        system definition</a> (CSD) is constructed inside of the <a href="gm_project.html">modeling
        project</a>. </p>
    <p>A flexible Phase data structure allows the user to describe a large
      variety of crystalline and dispersed, liquid and gaseous, adsorption and
      ion-exchange, ideal or non-ideal phases which may exist in (geo)chemical
      systems. Note that condensed compounds or surface species present as DComp
      or ReacDC records in project database will not be taken into chemical
      systems, if no Phase definitions point to those Dependent Components. In
      contrast, DComp records representing gases will be&nbsp; linked to the
      ideal gas mixture phase, as well as aqueous species and water will be
      linked to the ion-association aqueous electrolyte phase, both (as a
      default) <a href="gems_aphsetup.html">automatically created</a> by
      opening a modeling project.&nbsp;</p>
    <p><span style="color: #cc0000;"><span style="font-weight: bold;">Attention!
        </span>In GEM-Selektor v.3.3.x (and respective v.3.3.x of the GEMS3K
        code) introduced in April 2015, the Phase record and data definition
        structure, as well as the Phase remake wizard, were substantially
        extended in order to accommodate more flexible mixing models (TSolMod),
        built-in mineral-water reaction kinetics (TKinMet), and a new
        implementation of sorption and surface complexation models (TSorpMod;
        work in progress).&nbsp;</span></p>
    <p><span style="color: #cc0000;">For backward compatibility, all Phase
        records created in GEM-Selektor v.3.2.x or earlier , will open and work
        normally in GEM-Selektor v.3.3.x. However, new functionality (e.g.
        multi-site mixing models, kinetics) can only be used if the existing
        Phase record is remade or newly created. If this is to be in an "old"
        project folder (i.e. created in GEM-Selektor v.3.2.x or earlier), it is
        highly recommended to remake </span><span style="color: #cc0000;"><span
          style="color: #cc0000;">one-by-one
          </span>all Phase records available in the project (saving each record
        back after remake). All the Phase records in the default database
        (DB.default) supplied with GEM-Selektor v.3.3.x have already been
        converted into the extended record format.<br>
      </span></p>
    <p><span style="color: #cc0000;">Note that if some Phase records remain in
        the "old" format then this will lead to errors or crashes during
        calculations of equilibria in systems from this project. So, it is
        essential that ALL Phase records go once through the Phase remake
        wizard! Any Phase record made or remade in GEM-Selektor v.3.2.x will not
        be readable in earlier versions of GEM-Selektor (3.2.x or less).</span></p>
    <p> </p>
    <p>In GEM-Selektor, two kinds of multi-component phases are considered:
      "symmetric" and "asymmetric". In symmetric phases (gas mixture, liquid
      non-electrolyte solutions, solid solutions), concentrations, activities
      and activity coefficients of all components are treated in the same
      "rational" mole fraction scale. Asymmetric phases (e.g. aqueous solution)
      differ in that there is always a "solvent" made of end-member(s) taken in
      the mole-fraction scale, but other species ("solutes") are considered in
      the "practical" (e.g. molality) scales, with concentrations being
      normalized by quantity of the "solvent" rather than by the amount of the
      whole phase. More about that can be found in the&nbsp; <b><tt>Activity-coeffs.pdf</tt></b>
      document available in GEM-Selektor installation folder. </p>
    <br>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><a name="PHASE_FORMAT"></a>1.1. Phase Definition data format</h3>
    <p> </p>
    <p>A Phase record must have unique (within a modelling project) phase name
      that appears in the third field of the <a href="gems_rekey.html#dbm_Phase">Phase
        record key</a>. <br>
    </p>
    <p>The simplest case is definition of a single-component condensed (pure)
      solid or liquid phase. Such Phase record at least contains a DComp or
      ReacDC record key that links the phase definition to the related
      stoichiometry formula and standard thermodynamic properties. Optionally,
      pure-phase definition may contain specific surface area, specific free
      energy of mineral-water and/or mineral-gas interface, and other properties
      specific for the project application.&nbsp; In these parameters are both
      given non-zero values, the program will automatically correct the
      stability of a condensed phase according to the&nbsp;Freundlich-Ostwald
      equation.</p>
    <p>Note that, if several DComp (or several ReacDC) records are available and
      their <a href="gems_rekey.html#dbm_DComp">record keys</a> are identical
      except the last field, the program will automatically take only the
      alphanumerically first record into the phase, even though the actual key
      in the <a href="#pDC_v_"><tt>pDC_v_</tt></a> field points to the one with
      different last record key field. For experienced users, this "override
      mechanism" is a very efficient tool to substitute alternative
      thermodynamic data into otherwise identical project- and phase
      definitions. <br>
    </p>
    <p>The next level of Phase definitions is represented by a simple ideal
      (Raoultian) solution. The only difference from the single-component phases
      is that now the phase is composed of two, three or more end-members
      (species, Dependent Components selected during remake of the Phase
      record), so the&nbsp; <a href="#PhDCS"><tt>PhDCS</tt></a> and <a href="#pDC_v_"><tt>pDC_v_</tt></a>
      fields will appear as lists&nbsp;on the first page of the Phase window. In
      addition, the <a href="#PhDCC"><tt>PhDCC</tt></a> column should show the
      type codes of the involved components (<tt>"M"</tt>, <tt>"J"</tt> or <tt>"I"</tt>).
      The simple ideal mixing set by the <tt>'I'</tt> code in the <a href="#p_solt_0"><tt>p_solt[0]</tt></a>
      field. No other parameters are necessary to describe the mixing in simple
      ideal solution.&nbsp; <br>
    </p>
    <p>Various more sophisticated ideal and non-ideal mixing models can be
      configured using <a href="#PHASE_MWIZARD">Phase Wizard</a> and saved as
      Phase records. Selection of models of mixing, along with the list of
      Dependent Components, temperature and pressure ranges of their
      thermodynamic data, defines the area of applicability of the geochemical
      modeling package.&nbsp;</p>
    <p>Non-ideal solutions, in addition to two, three, ... end-members, require
      some parameters describing the essentially non-thermodynamic non-ideal
      mixing effects. Such parameters can either refer to each component (end
      member) separately or one parameter can describe the interaction between
      two or more components (end members). Because model parameter values, in
      general, depend on temperature and pressure, several coefficients of such
      a dependence for each species- or interaction parameter need to be entered
      and stored in the Phase record. <br>
    </p>
    <p>Species property coefficients can be entered into the <a href="#dc_cf"><tt>dc_cf</tt></a>
      table having one row of coefficients per species (end member). Likewise,
      several coefficients of an interaction parameter can be entered into the <a
        href="#ph_cf"><tt>ph_cf</tt></a>
      table (one row per parameter). However, for specific interaction model of
      mixing, each interaction parameter must be identified by indexes of all
      phase components that are involved in the interaction. These indexes are
      stored in a supplementary table called <a href="#ipxT"><tt>ipxT</tt></a>
      (one row per parameter). Allocation of all these tables depends on the
      chosen model type and the number of components; it occurs upon remake of
      the Phase definition in Phase Wizard. Contents of <tt>dc_cf</tt>, <tt>ipxT</tt>,
      and <tt>ph_cf</tt> tables are automatically passed to the GEM IPM work
      structure before calculation of equilibria, and also can be exported into
      the GEMS3K IPM input file. This uniform data structure and data transfer
      mechanism are used in all <a href="#PHASE_BUILTIN">built-in phase
        non-ideality models</a> that are subclasses of the TSolMod class (more
      in the <font color="#cc0000">SolMod paper</font>). The built-in
      calculations are automatically selected in the program by analyzing codes
      set in the <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/gm_phase.html#p_solt_0"><tt>p_solt[0]</tt></a>
      field when the <tt>'S'</tt> code is set in the <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/gm_phase.html#p_solt_3"><tt>p_solt[3]</tt></a>
      field.</p>
    <p>Even though TSolMod class contains over 20 hard-coded phase non-ideality
      models, they by far do not cover all the variety of models of mixing
      available in literature, nor the models that the users can potentially
      invent.&nbsp; For those reasons, GEM-Selektor allows the user to write
      almost any imaginable non-ideality model as two <a href="g_mscript.html">Math
        Script</a> texts stored in the Phase definition record. One script,
      called <a href="#DcEq"><tt>DcEq</tt></a>, should contain equations for
      calculation of each end member activity coefficient (relative to the
      simple ideal mixing) that depend on phase composition (i.e. mole fractions
      of end members). This script will usually be executed at every iteration
      of the GEM IPM algorithm. Another script, <a href="#PhEq"><tt>PhEq</tt></a>,
      contains calculation of parts of the non-ideal model that do not depend on
      composition but depend on temperature and/or pressure. Typically, this
      script will be executed only once before the GEM IPM calculations start
      for a given system. Exact modes of script execution can actually be
      selected in Phase wizard upon remake. Data exchange between scripts is
      done through two optional data arrays <a href="#Qp"><tt>Qp</tt></a> and <a
        href="#Qd"><tt>Qd</tt></a>.
      Technical details can be found in the help pages for DcEq and PhEq
      scripts.&nbsp; <br>
    </p>
    <p>To simplify writing of math scripts in Phase definitions, a <a href="#PHASE_DOD_HIDDEN">special
        set of data object labels</a> is available; the dimensions and pointers
      of them will be reset separately for each phase at every IPM iteration.
      Such calculations are controlled by <a href="#p_solt_0">special codes</a>
      that can be set up and changed during create/remake of a Phase record. The
      main limitation of using Phase scripts is that they cannot be calculated
      in the standalone GEMS3K program, where only built-in non-ideality models
      from TSolMod class can be calculated. <br>
    </p>
    <p>Phase records for sorption phases, in principle, are organized similarly
      to those for multicomponent solid solutions, but, by necessity, more
      surface-related default information (total and maximum site densities,
      capacitance parameters, difference between inner- and outer-sphere surface
      complexes) must be provided in the case of a sorption phase. Some of these
      parameters can be modified later on in the System definition, e.g. for
      model fitting purposes. Details on GEM SCM calculations are given in the <b><tt>SCM-corrections.pdf</tt></b>
      document. On-going work is devoted to conversion of sorption models into a
      TSorpMod class library using the same principles that are used in the
      TSolMod class. <br>
    </p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="PHASE_BUILTIN"></a></font>1.2.
Built-in
      models of (non)ideal mixing</h3>
    <p>In GEM-Selektor (GEMS3K), all models of mixing in symmetric solutions
      (gas/fluid mixture, solid and liquid non-electrolyte solutions) refer to a
      simple ideal Raoultian solution, in which the activity of each end-member
      <i>a<sub>j</sub></i> equals its mole fraction <i>x<sub>j</sub></i>. In an
      asymmetric solution (e.g. aqueous electrolyte), the ideal mixing is
      understood as the activity equals molality for each solute ( <i>a<sub>j</sub></i>
      = <i>m<sub>j</sub></i> ), whereas the activity equals mole fraction for
      the solvent (water, <i>a<sub>w</sub></i> = <i>x<sub>w</sub></i> ). Any
      deviation from the respective reference model of mixing is accounted for
      by the 'lump' activity coefficient <i>y<sub>j</sub></i> of end member - a
      ratio of its activity to mole fraction <i>y<sub>j</sub></i> = <i>a<sub>j</sub></i>
      / <i>x<sub>j</sub></i> (respectively, for aqueous solute species, a ratio
      of the activity to molality <i>y<sub>j</sub></i> = <i>a<sub>j</sub></i>
      / <i>m<sub>j</sub></i> ).</p>
    <p>For the gas mixture, the default is the ideal mixture of ideal gases, in
      which the fugacity of any gas is equal to its partial pressure divided by
      total pressure, i.e. <i>a<sub>j</sub></i> = <i>p<sub>j</sub></i> <i>/ P
      </i>= <i>x<sub>j</sub></i>. In more complicated cases, an ideal mixture
      of real gases can be considered, in which <i>a<sub>j</sub></i> = <i>p<sub>j</sub></i>
      <i>f<sub>0,j</sub></i> <i>/ P </i>= <i>x<sub>j</sub></i><i> f<sub>0,j</sub></i>.
      where <i>f<sub>0,j</sub></i> is the pure gas fugacity coefficient. In the
      general case, the real (non-ideal) mixture of real gases contains also the
      fugacity coefficient due to non-ideal mixing: <i>a<sub>j</sub></i> = <i>p<sub>j</sub></i>
      <i>f<sub>0,j</sub></i> <i>f<sub>j</sub></i> <i>/ P </i>= <i>x<sub>j </sub></i><i>f<sub>0,j</sub></i>
      <i>f<sub>j</sub></i> .&nbsp; </p>
    <p>In solid solutions, the default simple ideal mixing corresponds to a
      random substitution of A,B,C,... on a single structural site with a common
      "ligand" site occupied by L, when the end members are AL, BL, CL, ...
      (alternatively, with a single species on cation site and substituting
      ligands, the end members are CL, CM, CN, ...).&nbsp; Note that, if the
      stoichiometry of end members is scaled up e.g. to A2L2, B2L2, C2L2, ...
      then, even if no excess energy or excess volume interactions occur and the
      solution remains "energetically ideal", it is not a simple ideal solution
      anymore. It can be shown that the activity of end member like A2L2 in such
      'ideal' solution is <i>a<sub>j</sub></i> = <i>(x<sub>j</sub></i>)<sup>2</sup>.
      To calculate this kind of solid solution in GEMS3K correctly, a formal
      activity coefficient <i>y<sub>j</sub></i> = <i>x<sub>j</sub></i> must be
      applied to each end member. If substitutions occur on two or more
      different structural sites (sublattices) than expressions for ideal end
      member activities as functions of mole fractions become much more
      complicated (e.g. in the above example, the (A,B)(L,M) solution with end
      members AL, BL, AM, BM). <br>
    </p>
    <p>In GEM-Selektor, one way to describe such a complex multi-site ideal
      solution is to write down expressions for activity of each end member <i>a<sub>j</sub></i>
      as function of mole fractions of phase end members, then obtain the
      expression for the formal activity coefficient using <i>y<sub>j</sub></i>
      = <i>a<sub>j</sub></i> / <i>x<sub>j</sub></i>, and type all such
      expressions into the DcEq script&nbsp; as described in the next section.
      However, apart from being prone to typos, this approach is limited because
      scripted Phase models cannot be used in standalone programs based on the
      GEMS3K kernel. <br>
    </p>
    <p>Another method of preference for sublattice solution models is more
      universal and requires no scripting at all. In this method, a chemical
      formula of the end member&nbsp; (in DComp or ReacDC records) must be
      written in a special format indicating the moieties present on different
      structural sites. For example, the usual formulae of feldspar end members
      are&nbsp;&nbsp;&nbsp;&nbsp; <tt>KAlSi3O8</tt>&nbsp;
      (microcline);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <tt>NaAlSi3O8</tt>&nbsp;&nbsp;
(albite);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <tt>CaAl2Si2O8</tt>&nbsp; (anorthite)&nbsp;&nbsp; etc. This format does
      not contain the information about sites and moieties that substitute on
      them, which can be incorporated by typing the end member formulae in the
      following way:&nbsp;&nbsp; <tt>{K}:{Al}{Si}3:O8&nbsp;
        {Na}:{Al}{Si}3:O8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {Ca}:{Al}2{Si}2:O8.</tt><br>
    </p>
    <p>Essential feature in this format is that each structural moiety (cation,
      anion, neutral IC, or a vacancy&nbsp; <tt>Va</tt> ) is taken in the {}
      braces. The colon ':' separates sublattice sites which must follow the
      same order in all end members. The moiety occupancy&nbsp; numbers&nbsp;
      appear just as stoichiometry coefficients after moieties. Upon parsing the
      formula, sublattices are counted by encountered colons ':' (two in this
      example), and the moieties are collected in a list along with their
      site-moiety multiplicity numbers and the site index. All this information
      is then passed to GEMS3K kernel (in memory or through the exported IPM
      file for standalone codes) where it is then forwarded to the instance of
      TIdeal subclass of TSolMod library and used in automatic calculation of
      the ideal configurational entropic part of the end member activity,
      finally converted to the respective part of the lump activity coefficient
      <i>y<sub>j</sub></i>.&nbsp; <br>
    </p>
    <p>Note that, unlike in the Calphad software, partial occupancies of a
      sublattice site with two or more moieties&nbsp; in end members are allowed
      in the ideal and Berman mixing models. In any other use of Dependent
      Component formulae except when the chemical system definition (CSD) is
      assembled, the braces and colons in the formula are simply ignored (see <a
        href="g_useref.html#FORMULA">here
        more about DC formula syntax</a>). <br>
    </p>
    <p>A single- or multiple site mixing is called non-ideal when its excess
      Gibbs energy is not zero. In GEM-Selektor and GEMS3K, all such built-in
      models of non-ideal mixing are collected in the TSolMod class library.
      Details on setup and data for particular TSolMod built-in models are
      provided in the description of <a href="#PHASE_MWIZARD">Phase wizard</a>
      and <a href="#PHASE_MWINDOW">Phase window</a> pages. Currently, there are
      four groups of built-in non-ideality models. <br>
    </p>
    <p>(1) For the ion-association model of aqueous electrolyte, there are
      several variants of the Debye-Hückel calculation of activity coefficients
      that account for the excess Gibbs energy of the long-range electrostatic
      interactions between charged aqueous species as function of the effective
      molal ionic strength. Since no specific interaction parameters are
      involved, and only ion-size parameters (properties of Dependent
      Components) are used in some cases, the Phase definition for any such
      model can be automatically created in GEM-Selektor upon opening the
      modeling project (and deleted when closing the modeling project). There is
      no need for the user to create Phase definition for this kind of aqueous
      electrolyte phase. <br>
    </p>
    <p>(2) In specific ion-interaction models of aqueous electrolyte (currently
      SIT, Pitzer, and Extended UNIQUAC), in addition to the Debye-Hückel term,
      also excess energies due to specific ion-ion interactions are accounted
      for. Therefore, such Phase definitions cannot be assembled automatically
      and must be created in the (project) database before creating the modeling
      project chemical system definition. All such models utilized in
      GEM-Selektor use the common TSolMod data transfer mechanism based on <tt>dc_cf</tt>,
      <tt>ipxT</tt> and <tt>ph_cf</tt> data objects, thus can be exported into
      the IPM input files to be used in standalone programs based on GEMS3K
      code.&nbsp; <br>
    </p>
    <p>(3) Models of non-ideal gases and fluids include non-specific and
      specific interaction models. Phase definitions for non-specific
      multicomponent fluid models (such as Churakov-Gottschalk, Peng-Robinson,
      Peng-Robinson-Stryjek-Vera, Soave-Redlich-Kwong) can be assembled by
      GEM-Selektor automatically, provided that DComp records for all components
      are available with correct format and properties in the project database.
      Other models with specific interaction parameters require that Phase
      definition record is created prior to calculation of equilibria, and all
      necessary interaction parameter coefficients entered into common TSolMod
      parameter <tt>ipxT</tt> and <tt>ph_cf</tt> arrays. <br>
    </p>
    <p>(4) Models of non-ideal solid and liquid non-electrolyte solutions are
      all based on specific-interaction framework of 'regular' or 'subregular
      Margules' model for excess Gibbs energy of mixing. They require that the
      Phase definition record is created prior to calculation of equilibria, and
      all necessary interaction parameter coefficients are entered into common
      TSolMod <tt>dc_cf</tt> (optionally), <tt>ipxT</tt> and <tt>ph_cf</tt>
      arrays. In a few 'classic' binary and ternary Margules and Guggenheim
      models, the <tt>ipxT</tt> index array is not used. All models from this
      group can be exported into the IPM file and used in standalone reactive
      transport or parameter fitting calculations.&nbsp;</p>
    <p>The aqueous (non-ideal) solution phase must always be present in any
      aquatic system. In GEM-Selektor, many Phase records defining aqueous
      solutions may be stored in the project database, but only one such
      definition can be included into the <a href="gm_project.html">modelling
        project</a> when creating or remaking it as specified in the <a href="gems_aphsetup.html">Auto-Phase
        dialog</a>.&nbsp; By default, the program creates Phase definitions for
      ion-association aqueous electrolyte (<tt>"aq_gen"</tt>) and gas mixture (<tt>"gas_gen"</tt>),
      giving you a choice between the built-in <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/glossary.html#DT_Davies">Davies</a>
      equation or several forms of&nbsp; <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/glossary.html#DT_Debye_Hueckel">Debye-Hueckel</a>
      equations, valid up to about unimolal <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/glossary.html#DT_ionic_strength">ionic
        strength</a>. If specified, Kielland's ion-size parameters in will be
      collected automatically from <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/gm_dcomp.html">DComp</a>
      or <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/gm_reacdc.html">ReacDC</a>
      records. The default gas mixture is considered as an ideal mixture of
      ideal gases. <br>
    </p>
    <p>Every time when the user opens a modelling project, default definitions
      of aqueous and gaseous phases are automatically assembled and stored in
      project database. In this process, all available DComp and ReacDC records
      of suitable phase state (<tt>"a"</tt> and <tt>"g"</tt> or <tt>"p"</tt>,
      respectively) are selected according to the "override mechanism" of
      GEM-Selektor database. Namely, if there are two or more <a href="gm_dcomp.html">DComp</a>
      records for the same species to be included into the phase, and their<a href="gems_rekey.html#dbm_DComp">
        record keys</a> differ only in the last field, then alphanumerically the
      first one will actually be taken into the Phase list, and all other
      records for the same species will be ignored. The same rule holds for <a
        href="gm_reacdc.html">ReacDC</a>
      records, but not for the case when one record belongs to DComp chain and
      another to ReacDC database chain - in this case, both species will be
      taken into the phase definition. This "override mechanism" applies also
      for any user-created Phase records, i.e. if a Phase record refers to a
      DComp (or ReacDC) and this record key is not found but another key with
      the identical first three fields is available, then that available record
      will be taken into the chemical system definition <i>without warning</i>.
      Again, no&nbsp; automatic crossover replacements can be done <i>between</i>
      DComp and ReacDC database chains.&nbsp;When the user closes a modelling
      project, default Phase records for aqueous electrolyte (<tt>"aq_gen"</tt>)
      and gas mixture (<tt>"gas_gen"</tt>) will be automatically deleted and
      created again when the project is opened next time.</p>
    <p> </p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><a name="PHASE_SCRIPTED"></a>1.3. Scripted customary models of non-ideal
      mixing</h3>
    <p>If, upon create/remake of the multicomponent Phase record, the user did
      not choose any built-in or ideal model of mixing, in GEM-Selektor there
      will be an opportunity to enter the equations for a customary model of
      mixing in&nbsp; <a href="gm_phase.html#DcEq"><span style="font-family: monospace;">DcEq</span></a>
      and <a href="gm_phase.html#PhEq"><span style="font-family: monospace;">PhEq</span></a>
      text editor fields on pages of the Phase module window. Note that such
      models cannot be exported to IPM files and hence cannot be used in
      standalone reactive transport or parameter fitting calculations. <br>
    </p>
    <p>In comparison with built-in phase models, this way of defining non-ideal
      solutions requires some more work: firstly, the allocation of optional
      arrays for parameter coefficients and/or work variables, and secondly -
      entering and debugging <a href="g_mscript.html">scripts</a> with
      equations for calculation of the activity coefficients of species included
      into the phase. To facilitate writing of scripts, some frequently used
      ones are provided in the template script library (press <span style="font-family: monospace;">F3</span>
      or execute "Help" "Scripts" menu command to get there). Note that Phase
      scripts cannot be debugged when the Phase record is calculated. The
      scripts will be translated and executed only during the calculation of
      equilibrium state (with some error messages if something goes
      wrong).Usually, there is an immediate possibility to fix errors, save the
      Phase record, and try the GEM IPM calculation again.<br>
    </p>
    <p>In Phase script, it is strongly recommended to use special <a href="gm_phase.html#PHASE_DOD_HIDDEN">hidden
        data objects</a> that exist in the runtime IPM data structure and
      automatically map species and parameters used in this phase only. When
      labels of these hidden data objects are used in the script, there is no
      need to care about location of this phase and its species in the whole
      chemical system definition, which is hard to know in advance, before the
      project system is assembled. <br>
    </p>
    <p>However, other numerical data objects from the runtime IPM data structure
      can be used as well, with some precautions because this would make the
      Phase definition dependent on the project definition.&nbsp; </p>
    <p>For details and some examples on how to write phase model scripts, please
      refer to help sections for&nbsp; <a href="gm_phase.html#DcEq"><span style="font-family: monospace;">DcEq</span></a>
      and <a href="gm_phase.html#PhEq"><span style="font-family: monospace;">PhEq</span></a>&nbsp;
      text editor fields. The scripted models of mixing are helpful in
      implementing rock-forming mineral solid solutions published in literature
      because each model has its own assumptions, simplifications and shortcuts
      that cannot be specified in a uniform way in any built-in model of mixing
      so far.&nbsp; <br>
    </p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <p> <font face="Helvetica, Arial, sans-serif"> </font></p>
    <h3><a name="PHASE_CALC"></a>1.4. Phase module calculations</h3>
    <p>Execution of the "Record" "Calculate" menu command or toolbar icon on the
      "Phase" window results in a "recalculation" of the the currently loaded
      Phase record, which, in fact, consists in reading all DComp or ReacDC
      records referenced in the phase component list and optionally extraction
      of some codes and parameters from them. This kind of diagnostics is useful
      in order to check if the DComp/ReacDC records referenced in the <a href="gm_phase.html#PhDCS"><tt>PhDCS</tt></a>
      and <a href="gm_phase.html#pDC_v_"><tt>pDC_v_</tt></a> &nbsp;lists are
      indeed present in the project database (especially after you &nbsp;have
      added, renamed or deleted some records). In addition, some data like
      Kielland's effective ionic radii will be collected from the DComp/ReacDC
      records for the respectively defined phases. Note that the "default
      override" mechanism (see above) applies also in Phase recalculations. <br>
    </p>
    <p>If you get any error messages during re-calculation then please use the
      Phase Wizard to remake of the Phase definition and fix the problem before
      opening the modelling project, otherwise the latter will not be opened
      properly or get corrupt. <font face="Helvetica, Arial, sans-serif"><br>
      </font></p>
    <font face="Helvetica, Arial, sans-serif"> </font>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="PHASE_INTPAR"></a></font>1.5.
TSolMod
      rules for interaction parameters</h3>
    <p>Versatility and extensibility of the TSolMod class library is supported
      by the design and transfer of data arrays that contain model-specific
      parameters. These are separated into two data structures, one containing
      parameters of individual end-member components (species), and a second one
      containing the interaction parameters between end-member species or
      between moieties on structural sites. This architecture is illustrated
      below using an example of Extended UNIQUAC model for aqueous electrolyte
      (see also Activity-coeffs.pdf document) &nbsp; <br>
    </p>
    <p>The properties of individual components should be provided in the <a href="#dc_cf"><tt>dc_cf</tt></a>
      array (table) that has one row per phase component. In this example, the
      volume parameter <i>r<sub>j</sub>&nbsp;</i> and surface area parameter <i>q<sub>j</sub></i>
      of aqueous species and water are given in <tt>dc_cf[0]</tt> and <tt>dc_cf[1]</tt>
      columns, respectively, as shown in a screenshot below.&nbsp; <br>
    </p>
    <p><img alt="TsolMod-EU-example-dc_cf-page.png" src="TsolMod-EU-example-dc_cf-page.png"
        width="491"
        height="255"></p>
    <p>In the <tt>dc_cf</tt> array, the number of columns, the order of
      coefficients, and their interpretation&nbsp; strictly depend on the model
      type (see <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/gm_phase.html#p_solt_0"><tt>p_solt[0]</tt></a>)
      chosen in the Phase wizard. Some built-in models do not use properties of
      individual components, in which case the <tt>dc_cf</tt> table will not be
      allocated. <br>
    </p>
    <p>Interaction parameter coefficients must be entered in columns of the <a
        href="#ph_cf"><tt>ph_cf</tt></a>
      table, forming a row for each interaction parameter. In the same row, two
      or more indices in the <a href="#ipxT"><tt>ipxT</tt></a> index list
      columns indicate the interacting species. The number of indices and
      coefficients per parameter, the order and interpretation of coefficients
      strictly depend on the model type (see <a href="gm_phase.html#p_solt_0"><tt>p_solt[0]</tt></a>)
      and (e.g. in Pitzer model) on the parameter type. Unused indices must be
      entered with -1 from the right-most <tt>ipxT</tt> column. Unused
      coefficients in <tt>ph_cf</tt> table must be given as zeros. <br>
    </p>
    <p>In this example, each binary interaction parameter <i>u<sub>ij</sub></i>
      is represented by two coefficients <i>u0</i> and <i>u1</i> of the
      equation <i>u<sub>ij</sub></i> = <i>u0</i> + <i>u1</i>(<i>TK</i> -
      298.15) where <i>TK</i> is temperature in Kelvin. The indices of
      interacting aqueous species are given in the same row of <a href="#ipxT"><tt>ipxT</tt></a>
      index table; these indexes correspond to indexes of phase components in
      the lowermost list. For instance, the second row contains coefficients of
      the interaction parameter between Na+ (index 0) and OH- (index 2). Because
      interactions are symmetric, i.e. <i>u<sub>ji</sub> = u<sub>ij</sub></i>,
      the order of indexes in the <tt>ipxT</tt> row ( 0; 2 or 2; 0 ) does not
      matter; each interaction must be given only once. <br>
    </p>
    <p><img alt="TsolMod-EU-example-ph_cf-page.png" src="TsolMod-EU-example-ph_cf-page.png"
        width="490"
        height="561"><br>
    </p>
    <p>In TSolMod class functions, interactions are processed one by one, so the
      given interaction parameters (rows in the ipxT + ph_cf table) may appear
      in any order, for example, first the rows related to index 4 (H2O@).
      Interactions that are possible but not listed in the table are assumed
      zero by default. Explicitly given rows for interactions with all zero
      coefficients ( 0;0; 3;3; 4;4 in the above example) will be processed, but
      will have no effect on calculated activity coefficients and other
      properties of mixing. In principle, such rows can be skipped.&nbsp;</p>
    <p>The rules used for the TSolMod parameter transfer mechanism render it a
      useful property: Phase records that conform to TSolMod specifications can
      be automatically compressed upon reading them into modeling project
      system, and even upon further compression into a particular SysEq record
      where some independent and dependent components were turned off. For
      instance, if the system has Na turned off then all Dependent Components
      containing Na will also be turned off. Upon compression, the row for Na+
      will be automatically skipped from <tt>dc_cf</tt> table and from DC name
      list. Each row in ipxT + ph_cf table that refers to index 0 (old index for
      Na+) will be skipped too, and indexes in the remaining rows will be
      corrected accordingly, e.g. 0 for Cl-, 1 for OH-, 2 for H+ and 3 for H2O@.
      <br>
    </p>
    <p>This functionality is of great practical importance. For instance, if a
      large Pitzer parameter database is provided in a single large Phase record
      then it is possible in GEM-Selektor automatically to pick up the
      appropriate Pitzer parameters for small aqueous one-, two or three-salt
      systems. Further, these small compressed systems will be exported to DCH,
      IPM and DBR files for GEMS3K input; the parameters from (compressed) ipxT,
      dc_cf and ph_cf arrays will be written in the IPM data file.&nbsp; &nbsp;
      <br>
    </p>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><a name="PHASE_KINMET"></a>1.6. Metastability and kinetics (TKinMet
      implementation)<br>
    </h3>
    <p> For more details, please read the "Kinetics-uptake.pdf" file.</p>
    <p>The <i>local equilibrium</i> is assumed to take place in each control
      volume, according to the assigned composition and the thermodynamic
      parameters of state (<i>P,T</i>, surface areas of phases <i>A</i>). The <i>partial
        equilibrium</i> occurs if some components in some phases cannot reach
      their equilibrium amounts because of the <i>additional metastability
        restrictions</i> (AMR). All phases and components without AMR take part
      in the achievement of the partial equilibrium state under the mass balance
      common to the whole system.</p>
    <p> A chemical speciation solver that can handle AMRs, such as the
      GEM-Selektor, can simulate kinetics by setting each AMR as a function of
      the time step duration <i>dt</i>, the time variable <i>t</i>, the
      surface area <i>A<sub>k,t</sub></i> of <i>k</i>-th solid phase, and the
      (absolute) net kinetic rate <i>R<sub>n,k,t</sub></i> . In principle, AMRs
      may also depend on a link of the specific surface or kinetic rates for one
      phase (e.g. an overgrowth, adsorbed layer) to the volume or surface area
      of another, "seed", "substrate" or "adsorbent" phase, which may even be
      inert, or may have its own kinetics. </p>
    <p>The implementation of metastability and kinetics differs from code to
      code; so far, there is no conventional data structure for kinetic
      parameters. Large literature exists on experimental data and kinetic rate
      laws and parameters of mineral-aqueous reactions, with a much higher
      degree of understanding of dissolution compared to that for precipitation
      and nucleation. Because the experimental rate constants are typically
      normalized per unit area, they must be scaled by the current reactive
      surface area of the mineral, which depends on many factors, some of them
      are external to the chemical system, and some related to the particle/pore
      morphology, initial size distributions, and surface roughness. At present,
      this is perhaps the most important knowledge gap in geochemistry of the
      mineral-water interfaces, related in reactive transport modeling to the
      impact of porosity changes on transport parameters and on reactive surface
      areas. Many kinetic rate laws contain the activity product term related to
      a particular reaction mechanism, catalysis, inhibition, etc.
      Near-equilibrium kinetic rates also depend on the <i>affinity term</i>
      based on the <i>phase saturation index</i> SI<i><sub>k</sub></i>;
      particular forms of this term reflect different nucleation, growth or
      dissolution mechanisms.</p>
    <p> In the GEM IPM algorithm, the SI<i><sub>k</sub></i> index is used as the
      <i>criterion of stability</i> for any phase. If, numerically, -0.01 &lt;
      log<sub>10</sub>SI<i><sub>k</sub></i> &lt; 0.01 then the positive or zero
      amount of this phase is in equilibrium with the rest of the system. If log<sub>10</sub>SI<i><sub>k</sub></i>&nbsp;
      &lt; -0.01 then the phase is unstable (under-saturated), but may be kept
      in a positive amount in the mass balance by the lower AMR(s) set on some
      or all of its components. If log<sub>10</sub> SI<i><sub>k</sub></i>&nbsp;
      &gt; 0.01 then the phase is over-stable (oversaturated) because the
      positive or zero upper AMR(s) were set on some of its components from
      above. Taken together, the GEM output phase stability index SI<sub><i>k</i></sub>
      together with the input lower- and upper AMRs make the GEM-Selektor code a
      versatile tool for modelling various kinds of kinetics and metastability,
      represented as sequences of partial (restricted) equilibrium states. Thus,
      lower-AMRs allow stepwise simulation of <i>dissolution</i> of a mineral
      as long as its stability index SI<sub>k</sub> &lt; 1; upper-AMRs allow
      stepwise simulation of mineral <i>precipitation</i> as long as SI<i><sub>k</sub></i>
      &gt; 1. Setting AMRs as a function of time according to the chosen kinetic
      rate law allows the GEM software to simulate the kinetics of
      mineral-aqueous reactions and trace element uptake. The more ample
      information about the mineral-aqueous reaction is available from the
      experiment the more accurate and specific form of the rate equation can be
      applied to the system of interest.</p>
    <p> Some kinetic rate equations for dissolution, precipitation, and trace
      element uptake in solid solutions have been implemented in the TKinMet
      code library used in GEM-Selektor and GEMS3K codes. Eventually, with this
      library, GEMS will become a general and flexible software tool, extending
      and superseding the existing (geo)chemical models and codes capable of
      kinetic simulations. </p>
    <h4>1.6.1. Transitional State Theory rate law for parallel reactions</h4>
    <p>In the TKinMet library, mineral-water interaction kinetic rate laws are
      considered in a general form derived from the TST (transitional states
      theory). The general rate equation of this form is controlled by several
      parameters: </p>
    <ul>
      <li> Reaction rate constant at reference temperature, in mol/m<sup>2</sup>/s
        or other appropriate units;</li>
      <li> Arrhenius term and activation energy for temperature correction of
        kinetic rate constant (optional);</li>
      <li>Activity product term, accounting for catalysis and inhibition
        (optional);</li>
      <li> Affinity term containing the solid phase stability index (optional);</li>
      <li> Linear surface propagation velocity vs mole/unit-area rates
        (optional);</li>
      <li>Correction term for specific surface area upon particles growth or
        dissolution (optional).</li>
    </ul>
    <p>The options and default values for these kinetic rate terms can be set in
      Phase Wizard Step 6 - Metastability and kinetics model settings, as
      described in Section 2.5 and 2.6. </p>
    <h4>1.6.2. Linked metastability of phases</h4>
    TBD<br>
    <br>
    <h4>1.6.8.&nbsp; Trace element uptake kinetics&nbsp; (unified model) <br>
    </h4>
    TBD
    <p><br>
    </p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h2><a name="PHASE_MWIZARD"></a> 2. Phase Create/Remake Wizard</h2>
    <p>To construct a new phase definition record, close your <a href="gm_project.html">modelling
        project</a> and switch to "Thermodynamic Database" mode of GEM-Selektor.
      There, open the Phase module window and execute the "Record" "Create" (or
      "Clone") toolbar or menu command. In the appearing "Phase:: Insert a new
      record key" dialog, make a new <a href="gems_rekey.html#dbm_Phase">Phase
        record key</a> (at best selecting one of existing keys "From List" and
      modifying it), and press "Ok". The Phase Wizard appears; please, proceed
      through its steps while doing all necessary selections and settings. <br>
    </p>
    <p>After the Phase wizard is finished, the record key list dialog appears
      showing the (filtered) list of available ReacDC ('r') and DComp ('d')
      records, asking you to mark those to be included into this Phase
      definition. Use the left mouse button to mark/unmark items. Depending on
      selected kinetic and phase link models, other record key list dialogs may
      appear. <br>
    </p>
    <p>After all necessary selections were done, the <a href="#PHASE_MWINDOW">Phase
        window</a> appears in the GEM-Selektor frame. Enter the full phase name
      into the <a href="gm_phase.html#PhName"><span style="font-family: monospace;">PhName</span></a>
      field and (optionally) a comment into the <a href="gm_phase.html#PhNote"><span
          style="font-family: monospace;">PhNote</span></a>&nbsp;
      line. Depending on the configuration set up in Phase wizard, you may need
      to enter some numbers (e.g. specific surface area in <a href="gm_phase.html#DisPar_0"><span
          style="font-family: monospace;">DisPar[0]</span></a>
      ), Phase model scripts,&nbsp;or parameter coefficients on Phase window
      pages. When done, optionally recalculate and save the Phase record to
      project database. </p>
    <p>The new or changed Phase definition will be effective in calculations of
      equilibria when this modeling project will be opened next time. Some
      parameter coefficients or comments in the Phase window can be edited and
      saved in the "Equilibria Calculation" mode. However, the remake or
      deletion of Phase records can be done only in the "Database maintenance"
      mode of GEM-Selektor. <br>
    </p>
    <p><font face="Helvetica, Arial, sans-serif"> </font></p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="WZSTEP_1"></a></font>2.1.
Phase
      Wizard Step 1 - Defining the phase and the mode of mixing<font face="Helvetica, Arial, sans-serif"><br>
      </font></h3>
    <p>Selection of one of the following codes from drop-down lists on this page
      will configure the Phase record and tell the program what kind of phase
      and which model of (non-ideal) mixing should be used, and how it should be
      calculated.</p>
    <h4>2.1.1. Dropdown list -&gt; <a href="#Ph_Ps_0">Ph_Ps[0]</a>: Select a
      code of the phase aggregate state: <br>
    </h4>
    <blockquote> </blockquote>
    <table width="100%" cellspacing="2" cellpadding="2" border="1">
      <tbody>
        <tr>
          <td valign="top" align="center">
            <p><b>Code </b></p>
          </td>
          <td valign="top">
            <p>Displayed message </p>
          </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>a </b></p>
          </td>
          <td>
            <p> aqueous electrolyte solution </p>
          </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>g</b></p>
          </td>
          <td>
            <p>gaseous or fluid mixture<br>
            </p>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>f</b> </td>
          <td valign="top">fluid mixture (ideal or non-ideal) </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>p</b> </td>
          <td valign="top">plasma (ionized gas mixture) </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>l</b></p>
          </td>
          <td>
            <p> non-electrolyte liquid (melt), also multi-component</p>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>m</b> </td>
          <td valign="top">silicate (magmatic) melt or non-aqueous electrolyte </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>h</b></p>
          </td>
          <td>
            <p> liquid hydrocarbon phase, also multi-component</p>
          </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>s</b></p>
          </td>
          <td>
            <p> condensed solid phase, also multi-component solid solution </p>
          </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>d</b></p>
          </td>
          <td>
            <p> dispersed (particulate or porous) solid phase, also solid
              solution </p>
          </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>i</b></p>
          </td>
          <td>
            <p> permanent-charge (ligand) ion-exchange phase (ClaySor model)</p>
          </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>z</b></p>
          </td>
          <td>
            <p>surface complexation (adsorption) on hydrated amphoteric surface
              (ClaySor model) </p>
          </td>
        </tr>
        <tr>
          <td align="center">
            <p><b>x</b></p>
          </td>
          <td>
            <p> sorption phase in aqueous electrolyte (with sorption species in
              elemental stoichiometry)</p>
          </td>
        </tr>
      </tbody>
    </table>
    <blockquote> </blockquote>
    <p> The same code should also appear in the first field of <a href="gdb_rkey.html#dbm_Phase">Phase
record
        key</a> where it will be used for sorting Phase record keys in the
      database lists. </p>
    <h4>2.1.2. Dropdown list -&gt; <a href="#p_solt_0">p_solt[0]</a>:&nbsp;
      Select a model of mixing for this phase:</h4>
    <table width="100%" cellspacing="2" cellpadding="2" border="1">
      <tbody>
        <tr>
          <td valign="top" align="center">
            <p><b>Code </b></p>
          </td>
          <td valign="top">
            <p>Displayed message</p>
          </td>
          <td valign="top" align="center">
            <p><b>TSM&gt; </b></p>
          </td>
          <td valign="top">
            <p>Comment, links</p>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>I </b></td>
          <td valign="top">Ideal mixture (also multi-site) or pure phase,
            default </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top"> <br>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>M </b></td>
          <td valign="top">Binary subregular Margules solid-solution model (opt.
            DQF)&nbsp; </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>G </b></td>
          <td valign="top">Binary Redlich-Kister solid-solution model </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>T </b></td>
          <td valign="top">Ternary regular Margules solid-solution model </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>R </b></td>
          <td valign="top">Regular multicomponent solid- or liquid solution
            model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>V </b></td>
          <td valign="top">Van Laar multicomponent solid- or liquid solution
            model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>K </b></td>
          <td valign="top">Redlich-Kister multicomponent solid- or liquid
            solution model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>B </b></td>
          <td valign="top">Multi-site&nbsp; a(symmetric) multicomponent
            sublattice solid-solution model (Berman approach) </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.2 </td>
        </tr>
        <tr>
          <td style="text-align: center;"><span style="font-weight: bold;">$</span></td>
          <td>Multi-site regular multicomponent sublattice solid-solution model
            (Compound Energy Formalism CEF)</td>
          <td style="text-align: center;"><b>+</b></td>
          <td>Appendix 4.2</td>
        </tr>
        <tr>
          <td><span style="font-weight: bold;">&nbsp;&nbsp; #<br>
            </span></td>
          <td>ModifiedBragg-Williams (MBW) CEF-based sublattice solid solution
            model emulating both LRO and SRO </td>
          <td>&nbsp;&nbsp; <b>+</b>&nbsp; </td>
          <td>Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>L </b></td>
          <td valign="top">NRTL multicomponent liquid solution model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>W </b></td>
          <td valign="top">Wilson multicomponent liquid solution (or ion
            exchange) model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.2</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>F </b></td>
          <td valign="top">Churakov-Gottschalk (CG) multicomponent fluid EoS
            model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.3 </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>P </b></td>
          <td valign="top">Peng-Robinson-Stryjek-Vera (PRSV) multicomponent
            fluid EoS model </td>
          <td valign="top" align="center"><b>+<br>
            </b></td>
          <td valign="top">Appendix 4.3</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>E<br>
            </b></td>
          <td valign="top">Soave-Redlich-Kwong (SRK) multicomponent fluid EoS
            model<br>
          </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.3</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>6 </b></td>
          <td valign="top">Sterner-Pitzer (STP) high-pressure fluid EoS model
            (reserved) </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">under construction </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>7 </b></td>
          <td valign="top">Peng-Robinson (PR78) multicomponent fluid EoS model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.3</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>8 </b></td>
          <td valign="top">Compensated Redlich-Kwong (CORK) multicomponent fluid
            EoS model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.3</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>D </b></td>
          <td valign="top">Davies equation aqueous model (with factor 0.3) </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.1</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>H </b></td>
          <td valign="top">Extended Debye-Hueckel aqueous model (Helgeson),
            common a<sup>o</sup> </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.1</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>Y </b></td>
          <td valign="top">Extended Debye-Hueckel aqueous model (Shvarov),
            common a<sup>o</sup> </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.1</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>3 </b></td>
          <td valign="top">Extended Debye-Hueckel aqueous model (Karpov),
            individual a<sup>o</sup> </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.1</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>2 </b></td>
          <td valign="top">Debye-Hueckel aqueous model (2-term) individual a<sup>o</sup>
          </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.1</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>1 </b></td>
          <td valign="top">Debye-Hueckel limiting law aqueous model </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Appendix 4.1</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>S </b></td>
          <td valign="top">SIT multicomponent aqueous model (NEA TDB version) </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.1; Appendix 4.6 </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>Z </b></td>
          <td valign="top">Pitzer (HMW) multicomponent aqueous model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.1; Appendix 4.6</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>Q </b></td>
          <td valign="top">Extended UNIQAC multicomponent aqueous model </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">Appendix 4.1; Appendix 4.6</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>J </b></td>
          <td valign="top">rEUNIQAC multicomponent aqueous model (reserved) </td>
          <td valign="top" align="center"><b>+ </b></td>
          <td valign="top">under construction </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>A </b></td>
          <td valign="top">Adsorption, SACT and EDL models </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">under construction </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>O </b></td>
          <td valign="top">Other non-ideal model selected by phase name
            (reserved) </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">under construction </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>U </b></td>
          <td valign="top">Other non-ideal mixing model (user-defined scripts) </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">see help for&nbsp; <a href="#DcEq"><tt>DcEq</tt></a>,&nbsp;
            <a href="gm_phase.html#PhEq"><tt>PhEq</tt></a>; cannot be used in
            standalone GEMS3K calculations </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>N </b></td>
          <td valign="top">No mixing (pure or single-component phase) </td>
          <td valign="top" align="center"><b>- </b></td>
          <td valign="top">Default option for single-component phases </td>
        </tr>
      </tbody>
    </table>
    <p>Notes: The code is kept in the <a href="#p_solt_0">p_solt[0]</a> field.
      TSM = TSolMod parameter convention: + used; - not used. Appendix 4.1, 4.2,
      4.3 refers to the "Activity-Coeffs.pdf" document where model equations,
      required parameters, and literature references are available. See also <a
        href="g_useref.html#NONIDTYPES">GEMS
        Users Reference Section 4.4</a>. </p>
    <h4>2.1.3. Dropdown list -&gt; <a href="#p_solt_3">p_solt[3]</a>: Select a
      mode of calculation of activity coefficients of end members:<br>
    </h4>
    <table width="100%" cellspacing="2" cellpadding="2" border="1">
      <tbody>
        <tr>
          <td valign="top" align="center">
            <p><b>Code </b></p>
          </td>
          <td valign="top">
            <p>Displayed message</p>
          </td>
          <td valign="top">
            <p>Comment</p>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>I </b></td>
          <td valign="top">Activity coefficients will be set to 1 (pure phase,
            simple ideal mixing), default </td>
          <td valign="top">Also pure phase </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>S </b></td>
          <td valign="top">Activity coefficients will be calculated using a
            built-in mixing model selected above </td>
          <td valign="top">Also multi-site ideal mixing (I) </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>N </b></td>
          <td valign="top">Activity coefficients will be calculated as given in
            user-defined script(s) </td>
          <td valign="top">Mixing model of 'U' type only </td>
        </tr>
      </tbody>
    </table>
    <p>Note: The 'N' mode cannot be used in standalone code calculations with
      GEMS3K kernel.&nbsp; <br>
    </p>
    <h4><a name="EXEC_MODE_DCEQ"></a>2.1.4. Dropdown list-&gt; <a href="#p_solt_1">p_solt[1]</a>:
      Select a mode of execution of <a href="#DcEq"><tt>DcEq</tt></a>
      user-defined script for end-members:<br>
    </h4>
    <table width="100%" cellspacing="2" cellpadding="2" border="1">
      <tbody>
        <tr>
          <td valign="top"><b>Code</b></td>
          <td valign="top">Displayed message</td>
          <td valign="top">Comment</td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>N</b></td>
          <td valign="top">No DcEq script will be provided in this Phase
            definition (default)</td>
          <td valign="top">Select this, if any built-in mixing model or simple
            ideal mixing will be used, or there is no mixing at all (pure
            phase). </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>T</b></td>
          <td valign="top">DcEq script will be executed once before GEM IPM
            iterations</td>
          <td valign="top">Expressions depend on <i>T, P</i> &nbsp;and <i>b</i>
            &nbsp;(bulk composition of the system) only, but not on this phase
            speciation/composition </td>
        </tr>
        <tr>
          <td valign="top" align="center"><b>X</b></td>
          <td valign="top">DcEq script will be executed after each GEM IPM
            iteration</td>
          <td valign="top">Expressions depend on the current phase speciation
            (vector <font color="#cc0000"><tt>x</tt></font>) or any function of
            it such as component concentrations, ionic strength, etc. <br>
          </td>
        </tr>
      </tbody>
    </table>
    Note: These modes are not applicable to standalone GEMS3K calculations.<br>
    <br>
    <h4><a name="EXEC_MODE_PHEQ"></a>2.1.5. Dropdown list -&gt; <a href="#p_solt_2">p_solt[2]</a>:
      Select a mode of execution of <a href="#PhEq"><tt>PhEq</tt></a>
      user-defined script for the whole phase:<br>
    </h4>
    <table width="100%" cellspacing="2" cellpadding="2" border="1">
      <tbody>
        <tr>
          <td valign="top" align="center">
            <p><b>Code </b></p>
          </td>
          <td valign="top">
            <p>Displayed message</p>
          </td>
          <td valign="top">
            <p>Comment</p>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>N<br>
            </b></td>
          <td valign="top">No PhEq script will be provided in this Phase
            definition (default) </td>
          <td valign="top">Select this, if any built-in mixing model or simple
            ideal mixing will be used, or there is no mixing at all (pure
            phase). </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>T<br>
            </b></td>
          <td valign="top">PhEq script will be executed once before GEM IPM
            iterations </td>
          <td valign="top">Expressions depend on <i>T, P</i> &nbsp;and <i>b</i>
            &nbsp;(bulk composition of the system) only, but not on this phase
            speciation/composition. </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>X </b></td>
          <td valign="top">PhEq script will be executed after each GEM IPM
            iteration </td>
          <td valign="top">Expressions depend on the current phase speciation
            (vector <font color="#cc0000"><tt>x</tt></font>) or any function of
            it such as component concentrations, ionic strength, etc. </td>
        </tr>
      </tbody>
    </table>
    <p>Note: These modes are not applicable to standalone GEMS3K calculations.</p>
    <h4><a name="LINK_MODE_DCEQ"></a>2.1.6. Dropdown list -&gt; <a href="#p_solt_4">p_solt[4]</a>:
      Select a mode of linking user-defined <a href="#DcEq"><tt>DcEq</tt></a>
      script to phase end members:<br>
    </h4>
    <table width="100%" cellspacing="2" cellpadding="2" border="1">
      <tbody>
        <tr>
          <td valign="top" align="center">
            <p><b>Code </b></p>
          </td>
          <td valign="top">
            <p>Displayed message</p>
          </td>
          <td valign="top">
            <p>Comment</p>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>N </b></td>
          <td valign="top">No DcEq script will be provided (pure phase, built-in
            or ideal model), default </td>
          <td valign="top">Select this, if any built-in mixing model or simple
            ideal mixing will be used, or there is no mixing at all (pure
            phase). </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>U </b></td>
          <td valign="top">A universal DcEq script will be applied to each end
            member in a loop </td>
          <td valign="top">One "universal" group of equations for all components
            (e.g., Davies equation). The script must contain at list one operand
            using the <tt>js</tt> &nbsp;index (of species in the phase). The
            script will be executed for each of <tt>La</tt> of end-members
            (species) in this phase in GEM IPM work data structure, by
            automatically incrementing the <tt>js</tt> index&nbsp; by 1 from 0
            to <tt>La</tt> - 1. </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>P </b></td>
          <td valign="top">A private group of expressions will be executed for
            each end member separately </td>
          <td valign="top">One "private" group of equations per end-member. The
            script must contain <tt>La</tt> groups of expressions, each group
            closed by <tt>"\@"</tt> character string (<tt>La</tt> stands for
            the number of species in this phase). Groups must follow in the same
            order as the species in the <a href="gm_phase.html#pDC_v_"><tt>pDC_v_</tt></a>
            list in the Phase window page. If a species is turned off in the
            system definition, the respective "private" group will be skipped
            from the math script execution. No other limitations exist for the
            number or structure of expressions within each group (i.e. there can
            be several operators per end-member, if-else blocks etc.). Every
            "private" group will be calculated only once at the time of the
            whole script execution. </td>
        </tr>
      </tbody>
    </table>
    <p>Note: These modes are not applicable to standalone GEMS3K calculations.</p>
    <p><br>
    </p>
    <h4>2.1.7. Dropdown list -&gt; <a href="#p_solt_5">p_solt[5]</a>: Select
      specific mixing rules (or form of temperature correction) for EoS and
      activity models: </h4>
    <table width="100%" cellspacing="2" cellpadding="2" border="1">
      <tbody>
        <tr>
          <td valign="top" align="center">
            <p><b>Code </b></p>
          </td>
          <td valign="top">
            <p>Displayed message</p>
          </td>
          <td valign="top">
            <p>Comment</p>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>N</b> </td>
          <td valign="top"> Default mixing rule or form of interaction parameter
            coefficients </td>
          <td valign="top"> The appropriate mixing rule or form of interaction
            parameter coefficients will be selected depending on the chosen
            fluid- or aqueous model </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>W </b></td>
          <td valign="top">Basic Van der Waals mixing rules in cubic EoS models
            (default) </td>
          <td valign="top">Selecting this code enables the automatically
            assembled gas/fluid phase (chosen in the <a href="gems_aphsetup.html">AutoPhase
              dialog</a>) because all (default) interaction parameters are zeros
          </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>C </b></td>
          <td valign="top">Constant one-term binary interaction parameter <i>k<sub>ij</sub></i>
          </td>
          <td valign="top">One coefficient per non-zero interaction parameter to
            be entered into <a href="#ph_cf"><tt>ph_cf</tt></a> array </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>T </b></td>
          <td valign="top">Temperature-dependent one-term binary interaction
            parameter <i>k</i><sub><i>ij</i></sub> </td>
          <td valign="top">Two coefficients per non-zero interaction parameter <font
              color="#cc0000">(</font><i>A<sub>ij</sub></i>
            and <i>B<sub>ij</sub></i><font color="#cc0000">)</font> to be
            entered into <a href="#ph_cf"><tt>ph_cf</tt></a> array </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>5</b> </td>
          <td valign="top"> 5-term Pitzer model parameter temperature dependence
          </td>
          <td valign="top"> Five coefficients <i>a,b,c,d,e</i> of the
            temperature dependence&nbsp; <i>a</i> + <i>b</i>(1/<i>T</i>?1/298.15)
            +<i> c</i> ln(<i>T</i>/298.15) + <i>d</i>(<i>T</i>?298.15) <font color="#cc0000">+
              <i>e</i>(<i>T</i>?298.15)<sup>2</sup></font>. Used also in
            TOUGHREACT software. </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>6</b> </td>
          <td valign="top"> 6-term Pitzer model parameter temperature dependence
          </td>
          <td valign="top"> FREZCHEM variant (under construction) </td>
        </tr>
        <tr>
          <td valign="top" align="center"> <b>8</b> </td>
          <td valign="top"> 8-term Pitzer model parameter temperature dependence
          </td>
          <td valign="top"> under construction </td>
        </tr>
        <tr>
          <td style="text-align: center;"><span style="font-weight: bold;">R</span></td>
          <td>Calculate reciprocal terms (CEF) with 'B','$' and '#' sublattice
            solution models</td>
          <td>Requirements: all possible end members must be present in the
            phase definition; no partial site substitution allowed in end
            members. No additional parameters needed. Can be used as an option
            with Berman 'B', CEF '$' and MBW '#' &nbsp; sublattice solution
            models.</td>
        </tr>
      </tbody>
    </table>
    <p>Note: Applicable only to non-ideal fluid models 'P', 'E', '7', as well as
      sublattice solid solution models, also in standalone GEMS3K calculations.
      Codes 'C' and 'T' require entering non-zero parameter coefficients into <a
        href="#ipxT"><tt>ipxT</tt></a>
      and <tt><a href="#ph_cf">ph_cf</a></tt> arrays in TSolMod convention,
      therefore, a Phase record must be created before GEM calculations.&nbsp; </p>
    <p><font face="Helvetica, Arial, sans-serif"><br>
      </font></p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="WZSTEP_2"></a></font>2.2.
Phase
      Wizard Step 2 - Selection of phase components (endmembers) <font face="Helvetica, Arial, sans-serif"><br>
      </font></h3>
    <p>This wizard page allows the user to select ReacDC and/or DComp records as
      endmembers (components) that constitute the phase. Minimum one substance
      must be selected for a pure condensed phase; two or more - for a solution
      phase.</p>
    <p>If GEM-Selektor was just launched and a new Phase definition is created,
      the selection of substances starts with a full list of all ReacDC and
      DComp records in the scope. However, in case of (cloning and/or) remaking
      an existing Phase record, the previous selection will be shown. &nbsp; </p>
    <p>To (re)select chemical species (end members) to be involved into this
      phase, activate the 'Full-list selection' checkbox; toggle it back to see
      only the selected records again. In the full list, first the ReacDC 'r'
      and then the DComp 'd' record keys appear; use the filtering settings in
      order to show only relevant records.</p>
    <p><br>
    </p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="WZSTEP_3"></a></font>2.3.
Phase
      Wizard Step 3 - Phase model-of-mixing specific dimensions<font face="Helvetica, Arial, sans-serif"><br>
      </font></h3>
    <p>Optional dimensions to set when built-in functions or scripts for the
      mixing model shall be used. Any parameter coefficients table will be
      allocated only if all its dimensions are non-zero positive integer
      numbers.<br>
    </p>
    <p>Attention! For TSolMod built-in mixing models that use <span style="font-family: monospace;">dc_cf</span>
      and/or <span style="font-family: monospace;">ipxT, pc_cf</span> data
      objects, the numbers of columns will usually be allocated automatically,
      depending on the model of choice. Explicit corrections in these fields may
      be done upon remake of the Phase record.</p>
    <h4>2.3.1. Group box: Parameters and coefficients related to a phase
      component (end member)</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">Number of parameter coefficients per
            solution phase component (columns in the <a href="#dc_cf">dc_cf</a>
            table)
          </td>
          <td style="vertical-align: top;">In certain models of mixing where
            properties of individual components are used</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of Darken (DQF) parameter
            coefficients per solid solution end member
          </td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of reciprocal parameter
            coefficients per solid solution end member
          </td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.3.2. Group box: Interaction parameters, coefficients, and indexes
      related to the model of mixing in this phase</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">Number of interaction parameters
            (i.e. number of rows in <a href="#ph_cf">ph_cf</a> and <a href="#ipxT">ipxT</a>
            tables)
          </td>
          <td style="vertical-align: top;">Must always be given by the user
            (typically 1 for a binary solution; 3 or less for a ternary
            solution, etc.)</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Maximum order of interaction
            parameters (i.e. number of columns in <a href="#ipxT">ipxT</a>
            index table)
          </td>
          <td style="vertical-align: top;">e.g. 2 for binary parameters only; 3
            if binary and ternary parameters will be used (then the last index
            for a binary interaction parameter must be set to -1)</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of coefficients per
            interaction parameter (i.e. number of columns in <a href="#ph_cf">ph_cf</a>
            table)
          </td>
          <td style="vertical-align: top;">Depends on the model of mixing,
            usually set automatically</td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.3.3. Group box: Parameters and coefficients related to multi-solvent
      aqueous electrolyte models (under construction)<br>
    </h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">Number of solvent parameter
            coefficients (columns in solvc array)
          </td>
          <td style="vertical-align: top;">To be implemented
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of solvent interaction
            parameters (rows in solvc array)
          </td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of dielectric constant
            coefficients (colums in dielc array)
          </td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of dielectric constant
            parameters (rows in dielc array)
          </td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of generic DH coefficients
            (rows in dhc array)
          </td>
          <td style="vertical-align: top;">
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="WZSTEP_4"></a></font>2.4.
Phase
      Wizard Step 4 - Sorption models and settings<font face="Helvetica, Arial, sans-serif"><br>
      </font></h3>
    <p>Settings for TSorpMod built-in library models &lt;under construction&gt;.</p>
    <h4>2.4.1. Dropdown list: type of (new) adsorption/ ion exchange/
      polyelectrolyte isotherm model, or leave 'N' and go to the next wizard
      step<br>
    </h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">N
          </td>
          <td style="vertical-align: top;">Not defined, no account for </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
          </td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
          </td>
          <td style="vertical-align: top;">
          </td>
        </tr>
      </tbody>
    </table>
    <p><br>
    </p>
    <h4>2.4.2. Dropdown list: Select a type of (new) EIL (Electrified Interface
      Layer) model for this sorption phase </h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">N
          </td>
          <td style="vertical-align: top;">Not defined, no account for </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
          </td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">
          </td>
          <td style="vertical-align: top;">
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.4.3. Group box: Dimensions related to (new) sorption phase models<br>
    </h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">Number of EIL model layers
          </td>
          <td style="vertical-align: top;">Possible values: { 0 1 2 3 },
            default: 0 for NEM, 1 for CCM, DLM; 2 for TLM, BSM; 3 for 3LM, CD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of EIL model parameters
          </td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of charge distribution
            coefficients
          </td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of (ad)sorption site types
          </td>
          <td style="vertical-align: top;">Possible values: { 0 1 2 ... 10 },
            default: 1</td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of (ad)sorption isotherm
            parameter coefficients per component ( sorbed- or surface species)
          </td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of (ad)sorption isotherm
            parameter coefficients per surface site
          </td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Maximum denticity number for surface
            species { 0 1 2 3 4 5 6 }
          </td>
          <td style="vertical-align: top;">Possible values: { 0 1 2 3 4 5 6 },
            default: 1
          </td>
        </tr>
      </tbody>
    </table>
    <p><br>
    </p>
    <h4>2.4.4.&nbsp; Old-style sorption models </h4>
    The group box below is used only if this is an old-style sorption phase
    (with both sorbent and surface species included). If this is the case:&nbsp;
    <blockquote>
      <p>Check if surface complexation will be considered in this (sorption)
        phase</p>
      <p>Set the number of surface types/patches (minimum 1, maximum 6) to
        allocate surface complexes </p>
      <p>Enter here the specific surface area A of the sorbent (in m<sup>2</sup>
        per gram), A&gt;0</p>
      <p>&lt;under re-construction, will be replaced by a new wizard step for
        TSorpMod settings&gt;
      </p>
    </blockquote>
    <p><br>
    </p>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="WZSTEP_5"></a></font>2.5.
Phase
      Wizard Step 5 - Kinetics: optionally, mark ReacDC/DComp keys for the
      activity product term<font face="Helvetica, Arial, sans-serif"><br>
      </font></h3>
    <p>Rates of mineral-water interface reactions leading to dissolution or
      growth are known to depend on activities of some aqueous ions or gases.
      For instance, rates of reactions involving CaCO<sub>3</sub> may depend on
      activities of Ca<sup>+2</sup> and CO<sub>3</sub><sup>-2</sup> ions (or
      f(CO<sub>2</sub>)), raised to the respective empirical power coefficients.
      This is accounted for in the "activity product term" (in which the power
      coefficients can be set in the Wizard Step 6 page). In this page, you can
      select the ions or gases that should participate in the activity product
      term(s) of the kinetic rate law(s). Upon this selection, the respective
      arrays will be created, where you will be able to enter the power
      coefficients for each reaction mechanism. </p>
    <p>Leave this page unchanged if there is no need to consider activity
      product terms for all reaction mechanisms. </p>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="WZSTEP_6"></a></font>2.6.
Phase
      Wizard Step 6 - Metastability and kinetics model settings<font face="Helvetica, Arial, sans-serif"><br>
      </font></h3>
    <p>Select here the codes defining the KinMet model, or leave 'N' in all
      places and go to the next wizard step<br>
      <br>
    </p>
    <h4>2.6.1. Dropdown list -&gt; kin_t[2]: Type code of the process kinetics</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">N
          </td>
          <td style="vertical-align: top;">Not defined, no account for</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">M
          </td>
          <td style="vertical-align: top;">Kinetics of generic
            dissolution/precipitation (no uptake, no ion exchange, no
            adsorption)</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">U
          </td>
          <td style="vertical-align: top;">Kinetics of uptake/entrapment (of
            minor/trace element) into solid solution</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X
          </td>
          <td style="vertical-align: top;">Kinetics of ion exchange (clays,
            C-S-H, zeolites, ...)</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">A
          </td>
          <td style="vertical-align: top;">Kinetics of adsorption (on MWI),
            redox transformation</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">P
          </td>
          <td style="vertical-align: top;">Kinetics of solid phase nucleation
            and precipitation</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.6.2.&nbsp; Dropdown list -&gt; kin_t[3]: Type code of the
      kinetics/metastability model</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">N<br>
          </td>
          <td style="vertical-align: top;">Not defined, no account for</td>
          <td style="vertical-align: top;"><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">T<br>
          </td>
          <td style="vertical-align: top;">Generic TST dissolution/precipitation
            model following Shott ea 2012</td>
          <td style="vertical-align: top;"><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">P<br>
          </td>
          <td style="vertical-align: top;">Dissolution/precipitation model of
            the form (Palandri 2004)</td>
          <td style="vertical-align: top;">TBD<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">W<br>
          </td>
          <td style="vertical-align: top;">Carbonate growth model following
            (Wolthers 2012)</td>
          <td style="vertical-align: top;">TBD<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">U<br>
          </td>
          <td style="vertical-align: top;">Mineral nucleation and growth model
            with nuclei/particle size distribution<br>
          </td>
          <td style="vertical-align: top;">TBD<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.6.3. Dropdown list -&gt; kin_t[4]: Type code of the sorption kinetics
      model</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">N
          </td>
          <td style="vertical-align: top;">Not defined, no account for</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">E
          </td>
          <td style="vertical-align: top;">Unified entrapment model
            (Thien,Kulik,Curti 2013)</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">M
          </td>
          <td style="vertical-align: top;">DePaolo (2011) uptake kinetics model</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">G
          </td>
          <td style="vertical-align: top;">Growth (surface) entrapment model
            (Watson 2004)</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">F
          </td>
          <td style="vertical-align: top;">Fast ion exchange kinetics (e.g.
            montmorillonite, CSH)</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">L
          </td>
          <td style="vertical-align: top;">Slow ion exchange kinetics (e.g.
            illite, zeolites)</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">I
          </td>
          <td style="vertical-align: top;">Adsorption inhibition</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">P
          </td>
          <td style="vertical-align: top;">Solid solution nucleation model
            (Prieto 2013)</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.6.4. Dropdown list -&gt; kin_t[5]: Type code of metastability links of
      this phase to other phases</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">N<br>
          </td>
          <td style="vertical-align: top;">Not defined, no account for</td>
          <td style="vertical-align: top;"><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">S<br>
          </td>
          <td style="vertical-align: top;">Link to (fraction of) solid substrate
            surface</td>
          <td style="vertical-align: top;"><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">P<br>
          </td>
          <td style="vertical-align: top;">Link to (fraction of) solid substrate
            (pore) volume</td>
          <td style="vertical-align: top;">TBD<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">M<br>
          </td>
          <td style="vertical-align: top;">Link to (fraction of) solid substrate
            mass</td>
          <td style="vertical-align: top;">TBD<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.6.5. Dropdown list -&gt; kin_t[6]: Type of particle/pore size
      distribution and specific surface area correction</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">N
          </td>
          <td style="vertical-align: top;">Not defined, no account for</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">U
          </td>
          <td style="vertical-align: top;">Uniform particle/pore size
            distribution</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">B
          </td>
          <td style="vertical-align: top;">Binodal particle/pore size
            distribution</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">F
          </td>
          <td style="vertical-align: top;">Empirical distribution function</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.6.6. Dropdown list -&gt; kin_t[7]: Code of the rate scaling model
      (reserved)</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">N
          </td>
          <td style="vertical-align: top;">Not defined, no account for</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">A
          </td>
          <td style="vertical-align: top;">Surface-scaled rate model (k in
            mol/m2/s)</td>
          <td style="vertical-align: top;">
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">V
          </td>
          <td style="vertical-align: top;">Pore-volume-scaled model (k in
            mol/m3/s)</td>
          <td style="vertical-align: top;">TBD
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h4>2.6.7. Groupbox: dimensions of KinMet model parameter coefficient tables</h4>
    <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2"
      border="1">
      <tbody>
        <tr>
          <td style="vertical-align: top;">Number of parallel reactions that
            affect amount constraints for this phase 
          </td>
          <td style="vertical-align: top;">Values: { 0 1 2 3 ... }, default: 2
            or 3
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of species from other phases
            involved in parallel reaction activity product terms 
          </td>
          <td style="vertical-align: top;">Positive integer, default: 0
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of parameter coefficients to
            be used in parallel reaction terms 
          </td>
          <td style="vertical-align: top;">Default: 14
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of parameters/coefficients per
            species involved in activity product terms
          </td>
          <td style="vertical-align: top;">Default: 1
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of minor/trace element uptake
            kinetics model parameters/coefficients (per SS end member)
          </td>
          <td style="vertical-align: top;">Default: 6
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Number of parameter coefficients for
            the specific surface area correction equation
          </td>
          <td style="vertical-align: top;">Default: 1
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <p>For built-in TKinMet models, set the first two dimensionalities; others
      will usually be allocated automatically, as appropriate.</p>
    <p> Any parameter coefficients table will be allocated only if all its
      dimensions are positive and not zeros.</p>
    <p> <font face="Helvetica, Arial, sans-serif"><br>
      </font></p>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="WZSTEP_7"></a></font>2.7.
Phase
      Wizard Step 7 - Optionally, mark record key(s) of phase(s) for
      metastability link(s) with this phase<font face="Helvetica, Arial, sans-serif"><br>
      </font></h3>
    <p>This is work in progress. In certain cases, the metastability of a given
      phase or some its components (species, endmembers), understood as a
      deviation from equilibrium chemical potential or an AMR restriction on the
      amount, depends on the amount of another phase present in the system
      (either stable or metastable). One example is a surface precipitation,
      i.e. formation (condensation) of a secondary phase on the surface of a
      sorbent when the concentration of a sorbate exceeds the solubility of a
      surface precipitate phase. Another example is adsorption from aqueous or
      gas phase on a solid sorbent surface if no surface site ligands are
      considered. In this case, the amounts of adsorbed species may need to be
      re-scaled using the site density parameter and the surface area of the
      sorbent.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
    <p>This wizard page allows the user to select phase(s) for such
      metastability linkages, to be fully configured in the next Wizard page.
      Leave this page unchanged if there is no need to create metastability
      linkages.</p>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="WZSTEP_8"></a></font>2.8.
Phase
      Wizard Step 8 - Phase links, other settings and comments<font face="Helvetica, Arial, sans-serif"><br>
      </font></h3>
    <p>Group: Dimensions related to metastability linkages between this and
      other phases (leave zeros if no links)<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
      &nbsp;&nbsp;&nbsp; Counter: set here the number of phases linked to this
      phase ( 0 if no links )<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
      &nbsp;&nbsp;&nbsp; Counter: set here the number of parameters per link to
      another phase ( 0 by default )<br>
      <br>
    </p>
    <h4>Optional settings:<br>
    </h4>
    <p>Counter:&nbsp; Set here the number of links to SDref bibliography records
      (default 0)</p>
    <p style="margin-left: 40px;">Here, you can optionally set the number of
      references to sources of data such as interaction parameter coefficients.
      The respective fields will appear on Page 1 of Phase window. In a SDref
      field, enter a new reference in the format
      &lt;Author&gt;:&lt;Year&gt;:&lt;Type&gt;: (e.g. <span style="font-family: monospace;">"Einstein:1922:pap:"</span>);
if
      this reference does not exist yet in the modeling project then press F2 to
      create a new SDref record with that key; otherwise press F1 to view the
      reference record. In the respective SDval field, enter a short comment on
      e.g. what data were taken from this reference. <br>
    </p>
    <p>Checkbox:&nbsp; Extract parameters from DComp/ReacDC records and refresh
      DC class codes upon 'Calculate'?</p>
    <blockquote>
      <p>This checkbox allows to re-sample codes and numbers as phase component
        properties, e.g. to collect data to the <a href="#dc_cf"><tt>dc_cf</tt></a>
        array. <br>
      </p>
    </blockquote>
    <p>What will happen after you click "Finish":<br>
    </p>
    <blockquote>
      <p>(1) In Phase window, do not forget to fill out <tt>PhName</tt> and <tt>PhNote</tt>
        comments. Depending on setup, enter numbers in <tt>DisPar</tt> array,
        text in <tt>DcEq</tt> and/or <tt>PhEq</tt> script fields, and
        parameter coefficients in <tt>ipxT</tt>, <tt>ph_cf</tt>, <tt>dc_cf</tt>
        arrays on Phase window pages.</p>
      <p>(2) Click on 'Calculate' toolbar button to refresh DC properties
        collected in the Phase definition (works only if the above checkbox is
        set on). Attention! Previous properties and codes will be lost! After
        this operation, look at the <a href="#PhDCC"><tt>PhDCC</tt></a> column,
        and correct DC codes there, if needed ('T' for H+; 'W' for H<sub>2</sub>O-solvent;
'M','J',or
        'I' for solid-solution end members). <br>
      </p>
    </blockquote>
    <p>Last but not least, save the Phase record to the modeling project
      database.</p>
    <blockquote> </blockquote>
    <br>
    <font face="Helvetica, Arial, sans-serif"> </font>
    <hr style="width: 100%; height: 2px;">
    <h2><font face="Helvetica, Arial, sans-serif"><a name="PHASE_MWINDOW"></a></font>3.
Phase
      Module Window</h2>
    <p>This window provides access to relevant data, codes, lists and scripts in
      the Phase definition (kept in Phase record). In current version of
      GEM-Selektor, the Phase window has three pages, shown by clicking on the
      respective buttons in the upper left part. Some data can and should be
      entered/edited directly in data object fields visible in pages, whereas
      configuration data can only be changed through Phase Wizard and&nbsp;
      selection lists upon Create/Remake of the Phase record. <br>
    </p>
    <p>In this version of GEM-Selektor, both Phase Wizard and Phase Window have
      been extended in order to accommodate a range of new adsorption (TSorpMod)
      and metastability/kinetics (TKinMet) built-in models. <br>
    </p>
    <br>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="MWPAGE_1"></a></font>3.1.
Phase
      Window Page 1</h3>
    <p>This window shows <tt>PhName</tt> and <tt>PhNote</tt> comment lines;
      optional fields for source of data (<tt>SDref</tt>) references. Main
      information on this page is the list <tt>pDC_v_</tt> of Dependent
      Components that mix in this Phase. Together with DC class codes and data
      sources ('r' - ReacDC, 'd' - DComp records),&nbsp; this list appears as a
      (scrollable) table. In the same order as seen in this list, DCs and their
      codes will be added to Chemical System Definition created within the
      modelling project to which the Phase record belongs.&nbsp;&nbsp;</p>
    <p>For a sorption phase, a table (starting with the <a href="#SCM_C"><tt>SCM_C</tt></a>
      code of surface complexation model) appears below the DC list. This table
      has one or several rows, each corresponding to a surface patch (type). In
      each row, relevant parameters for the surface patch and electrostatic
      model assigned to it can be entered. <br>
    </p>
    <br>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="MWPAGE_2"></a></font>3.2.
Phase
      Window Page 2</h3>
    <p>This page gives access mainly to properties of Dependent Components. At
      the top, it shows phase model codes in the <a href="#p_solt_0"><tt>p_solt</tt></a>
      field, then relevant dimensions in <tt>Ph_Nc</tt> and <tt>Ph_nsc</tt>
      fields (all cannot be edited directly). Use help (F1) to learn more about
      various modes selected into <tt>p_solt</tt> field. <br>
    </p>
    <p>For a scripted Phase model of mixing (not usable for export into GEMS3K
      files), the <tt>DcEq</tt> multi-line text editor field appears,
      containing a script for calculation of end-member activity coefficients.
      See help pages (F1) on <a href="#DcEq"><tt>DcEq</tt></a> for more
      information.<br>
    </p>
    <p>Appearing next, the list of Phase Dependent Components (species, end
      members) <a href="#pDC_v_"><tt>pDC_v_</tt></a> is accompanied by various
      data fields depending on the chosen Phase model.&nbsp;</p>
    <p>For pure (single-component) phase, simple ideal condensed solution,&nbsp;
      and a number of aqueous and solid solution models, there is no additional
      (DC-specific) data fields on this page. <br>
    </p>
    <p>For other multicomponent phases (non-ideal fluids, some solid solutions,
      some aqueous electrolyte models), the array of phase component properties
      <tt>dc_cf</tt> will be visible directly to the right of DC key list. In
      some cases, the data in this list can be collected automatically from
      DComp/ReacDC records upon calculation of the Phase definition. Otherwise
      (or if different properties are needed), they can be entered or
      copy-pasted directly. Note that the entered data may be lost if the Phase
      record is reclaculated. The coefficients for DCs will be passed to GEM
      kernel and used in TSolMod library functions upon calculation of
      equilibria. <br>
    </p>
    <p>Use help (F1) to learn more about which properties or coefficients, in
      which units etc. must be entered into <tt><a href="#dc_cf">dc_cf</a> </tt>array
      for the mixing model of choice (given by code in <a href="#p_solt_0"><tt>p_solt[0]</tt></a>).&nbsp;
      Optionally, the DQFc and rcpc columns can be appended to this table, where
      the Darken parameters and reciprocal energy parameters for advanced models
      of mixing can be entered, respectively. Below this table, in the lowermost
      row (the dcpl list), the comments to columns of the coefficient table can
      be entered (these comments remain in the Phase record, will not be passed
      to calculations of equilibria).<br>
    </p>
    <p>For a sorption model, the DC list is enhanced with <a href="#SAT_C_0"><tt>SAT_C</tt></a>
      and <a href="#MaSDj_0"><tt>MaSDj</tt></a> tables, where the surface
      species can be assigned to surface patches, electrostatic model planes,
      and site types, as well as the maximum site densities and charge
      distribution (CD) parameters can be specified.</p>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="MWPAGE_3"></a></font>3.3.
Phase
      Window Page 3</h3>
    <p>This page displays mainly data regarding the non-ideal interactions
      between phase end members (species) or even between site moieties in
      multi-site solid solution models. All these parameters will be sent to the
      GEM kernel and used in TSolMod library functions upon equilibria
      calculations. <br>
    </p>
    <p>In the upper part, relevant dimensions are shown (can only be set upon
      remake in Phase Wizard). <br>
    </p>
    <p>For a scripted Phase model of mixing (not usable for export into GEMS3K
      files), the <tt>PhEq</tt> multi-line text editor field appears,
      containing a script for calculation of properties of the phase that
      normally depend on <i>P,T</i> but not on composition. See help pages (F1)
      on <a href="gm_phase.html#PhEq"><tt>PhEq</tt></a> for more information.</p>
    <p>For most built-in models of mixing that conform to TSolMod class library
      specifications, this page shows a table composed of two arrays: <tt>ipxT</tt>
      and <tt>ph_cf.</tt> Each row in this table corresponds to a non-ideal
      interaction between end members or moieties whose indices (in this Phase
      DC record list <a href="gm_phase.html#pDC_v_"><tt>pDC_v_</tt></a>) are
      given in <a href="#ipxT"><tt>ipxT</tt></a>, and interaction parameter
      coefficients are entered in <a href="#ph_cf"><tt>ph_cf</tt></a> part. The
      number of indexes and coefficients per row depends on the model of choice.
      The number of rows must be set in Phase Wizard upon remake. Rows for
      default (zero) interaction parameters are not needed; parameters can
      follow in any order. In the ipicl list, the comment for each interaction
      parameter (row) can be entered; into the ipccl list (lowermost row), the
      comment for each coefficient (column) can be entered. These comments
      remain in the Phase record, and will not be passed to calculations of
      equilibria. </p>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="MWPAGE_4"></a></font>3.4.
Phase
      Window Page 4<br>
    </h3>
    <p>This page displays mainly parameters used in the TSorpMod library of
      "new" sorption models linked to other "sorbent" phases.</p>
    <p>&lt;under construction&gt;<br>
    </p>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="MWPAGE_5"></a></font>3.5.
Phase
      Window Page 5<br>
    </h3>
    <p>This page displays model codes and parameters used in built-in kinetic
      rate models from the TKinMet library. </p>
    <p>In the upper row, the model codes and relevant dimensions are shown (can
      only be changed upon remake in Phase Wizard). </p>
    <p>Below, the table appears, composed of the ocPRk columns for the operation
      codes for 'parallel reaction' and affinity terms to be entered; then feSAr
      column&nbsp; for entering fractions of the surface area for parallel
      reactions;&nbsp; the rpCon columns with kinetic rate constants for
      parallel reactions. In the comment list rprcl, short comment for each
      parallel reaction can be entered;&nbsp; in the lowemost row (rpkcl),
      comments for kinetic rate constants and coefficients can be entered. These
      comments remain in the Phase record, and will not be passed to
      calculations of equilibria. </p>
    <p>In another table below, the optional lDCr list contains DC record keys of
      all species used in activity product terms in all parallel reactions, with
      record sources indicated in lDCd column, and the power coefficients to be
      entered into the apCon column(s). </p>
    <p>&lt;still under construction&gt;</p>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="MWPAGE_6"></a></font>3.6.
Phase
      Window Page 6<br>
    </h3>
    <p>This page displays the parameters for metastability link(s) of this phase
      to other phases, as well as the specific surface area and other bulk
      prolerties of this phase. Optionally, a table for parameter coefficients
      for the uptake kinetics model will appear in the case of kinetics
      specified for a solid solution phase.</p>
    <p>Below the phase title, the <a href="gm_phase.html#DisPar_0"><tt>DisPar</tt></a>
      array appears to enter the specific surface area and other optional bulk
      properties of a particulate/porous phase. <br>
    </p>
    <p>Next down, the nlPh row sows the number of links to other phases and
      other relevant dimensions (can only be changed in Phase Wizard upon
      remake). The Ascp cells accept parameter coefficients of the equation for
      corrections of specific surface area upon precipitation or dissolution
      &lt;TBD&gt;. <br>
    </p>
    <p>Below that, the lPh table shows a list of record keys of linked phases,
      followed by the lPhC column (phase linkage type codes &lt;TBD&gt;), and
      the lPhc (the table of phase link parameters). <br>
    </p>
    <p>The next table below (optional) contains the list of end members of this
      phase, followed (to the right) by the lICu column with names of
      characteristic elements for uptake by this end member, then be the umpCon
      table of the uptake model parameters. In the lowermost row (umpcl),
      comments to umpCon table umpcl&nbsp; can be entered. These comments remain
      in the Phase record, and will not be passed to calculations of equilibria.
    </p>
    <br>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h2><font face="Helvetica, Arial, sans-serif"><a name="PHASE_TYPES"></a></font>4.
Types
      of Multicomponent Phases<br>
    </h2>
    <p>This section covers specific issues and limitations for certain types of
      multicomponent phases. It also contains suggestions concerning the
      preferable workflow with regard to creating and modifying such phase
      definitions. <br>
    </p>
    <br>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="PHASE_AQUEOUS"></a></font>4.1.
Aqueous
      electrolyte</h3>
    <p>Most aqueous activity coefficient models that are currently supported by
      the GEMS3 code belong to extended Debye-Hückel (EDH) models (see document
      "/Resources/doc/pdf/Activity-Coeffs.pdf" for details and references). As
      there is no specific interaction parameters in EDH-based aqueous
      ion-association models, such phases are automatically assembled from
      available DComp and/or ReacDC records upon opening or creating a GEMS3
      modelling project, as defined in the <a href="gems_aphsetup.html">Autophase
        Setup wizard</a>. <br>
    </p>
    <p>Contrary to ion-association models, any "specific interaction" non-ideal
      model of aqueous electrolyte contains interaction parameters between
      aqueous species. Hence, such phase definitions cannot be composed in the
      automatic mode; they must be already present in the project database as
      specific <a href="gm_phase.html">Phase definition records</a>. Such a
      definition typically contains a list of included chemical species, and an
      array of interaction parameter coefficients entered into the <a style="font-family: monospace;"
        href="gm_phase.html#ph_cf">ph_cf</a>
      table, with indices of aqueous species provided in the <a href="gm_phase.html#ipxT"><span
          style="font-family: monospace;">ipxT</span></a>
      list. The appropriate specific-interaction Phase definition must be
      specified in the Autophase Setup wizard, which disables the automatic
      assembling of the EDH-based aqueous phase. <br>
    </p>
    <p>In this GEM-Selektor version, the specific ion interaction aqueous phase
      definitions can be automatically compressed in two steps. Firstly, if an
      extensive Phase for SIT, Pitzer or EUNIQUAC model is provided in the
      default database (DB.default) then it will be compressed during creation
      of a new modeling project. Namely, if in this phase definition, a
      dependent component is found that contains an independent component not
      included into the project IComp file, then this dependent component will
      be skipped along with all interaction parameters (rows in <span style="font-family: monospace;">ph_cf</span>
      table) that refer to this dependent component by index in the <span style="font-family: monospace;">ipxT</span>
      list. Secondly, such aqueous phase definition will be compressed in a
      similar way if some aqueous species are turned off in the chemical system
      definition. This provides an unmatched flexibility also in handling
      specific interaction phase models in GEMS3 code and database.<br>
    </p>
    <p><font face="Helvetica, Arial, sans-serif"><br>
      </font></p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="PHASE_GASFLUID"></a></font>4.2.
Gas
      mixture and non-ideal mixed fluids</h3>
    <p>There is a typical workflow for such phases. Initially, in a new modeling
      project, a non-ideal gas/fluid phase is created via the <a href="gems_aphsetup.html">Autophase
        Wizard</a>, because it may not be known in beforehand what non-ideal
      gase species (DComps) would be available according to the selected list of
      Independent Components in the new project system.<br>
      <br>
      Because the interaction parameters of mixing (if needed) cannot be entered
      into the autophase-created fluid/gas phase, the right way to enhance the
      fluid phase definition with specific interaction parameters would be to
      save it first under a modified name. To do so: <br>
    </p>
    <ul>
      <li>In Equilibria calculation mode, open any system (SysEq) in the
        modeling project. <br>
      </li>
      <li>In "Modules" drop-down menu, select "Phase". <br>
      </li>
      <li>In the list of Phase record keys, select a phase named "<span style="font-family: monospace;">fluid_gen</span>"
        in third record key field to see contents in the Phase window.<br>
      </li>
      <li>Alternatively, open the System window (Phase page), click on the "<span
          style="font-family: monospace;">fluid_gen</span>"
        phase key, and press F7 to see the Phase window. <br>
      </li>
      <li>In the "Record" drop-down menu, select "Save as" command, then modify
        the name in 3rd record key field to e.g. "<span style="font-family: monospace;">my_fluid</span>".</li>
    </ul>
    <p>Now, switch to Database mode of GEM-Selektor, open the Phase window, find
      the just-saved Phase record, and modify it by adding the interaction
      parameters into the <a href="m_phase.html#ph_cf"><span style="font-family: monospace;">ph_cf</span></a>
      table, and indexes of interacting fluid/gas components into the <a href="m_phase.html#ipxT"><span
          style="font-family: monospace;">ipxT</span></a>
      list. If necessary, remake the Phase record and set more interaction
      parameters (rows in <span style="font-family: monospace;">ipxT</span> and
      <span style="font-family: monospace;">ph_cf</span> tables), and enter more
      values into these tables. Save the Phase record. <br>
    </p>
    <p>When opening the modeling project next time, uncheck the "Retain setup of
      aqueous (and gas/fluid) phases" checkbox, then select the second tab in
      the Autophase Dialog, and disable the automatic setup of fluid/gas phase
      by selecting a "... user-defined Phase record from database, U". The
      user-prepared phase that was enhanced with interaction parameters will be
      selected (automatically, or from the appearing list, if there are two or
      more of such phases; in the latter case, one or two pre-defined fluid
      phases can be selected). Click "Do it for all" if the message about
      deletion/insertion of phases appears. When the project opens, the selected
      phase(s) will be visible in the system. Sometimes is good that two
      fluid/gas phases in the system, if for example you want to calculate a
      solvus in CO <sub>2</sub>-H<sub>2</sub>O system. Such phases will be
      automatically compressed for GEM calculations if some components are
      turned off in the system definition.&nbsp; </p>
    <p>If you switch the project back to create the autophase for gas/fluid, the
      modified Phase definition(s) will not be taken into the system, but will
      remain available in this project in Database mode. <br>
    </p>
    <p>The Autophase wizard can only create one ideal or non-ideal automatic
      fluid/gas phase without interaction parameters per project by collecting
      parameters from all available 'f' DComp records. As long as specific
      interactions are not needed, it is the fast and efficient way to keep the
      fluid phase consistent with currently available DComp records for fluid
      components. Whatever new DComp fuid/gas species are added to the project,
      they will be included to the automatic phase, with their nonideality
      coefficients automatically collected from DComp records. <br>
    </p>
    <p>Note that, if the user-modified Phase record for gas/fluid mixture has
      the same key as the automatically created Phase, and the project is reset
      from using the user-prepared phase back into the autophase mode, this
      automatic phase is created correctly, but writes over the user-provided
      fluid phase record. In this way, the interaction parameters will be
      lost.&nbsp;</p>
    <p><br>
    </p>
    <font face="Helvetica, Arial, sans-serif"> </font>
    <hr style="width: 100%; height: 2px;">
    <h3><font face="Helvetica, Arial, sans-serif"><a name="PHASE_SOLSOL"></a></font>4.3.
Solid
      and liquid non-electrolyte solutions</h3>
    <p>&lt;TBD&gt;<br>
    </p>
    <p><font face="Helvetica, Arial, sans-serif"><br>
      </font></p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><a name="PHASE_SORPTION"></a>4.4. Sorption and surface complexation<br>
    </h3>
    <p>Phase definition for a sorption phase, in principle, is organized similar
      to aqueous electrolyte or solid solution, with a difference that some more
      information about surface species and surface types has to be provided
      (see details in the<a href="gems_scm.html"><tt> gems_scm.html </tt></a>and
      <a href="theorscm.html"><tt>theorscm.html</tt></a>&nbsp; manuals). Upon
      create/remake of a sorption phase, first of all, the number of surface
      types must be set in the "Phase: Remake Dialog ..." window (1 to 6, zero
      by default). Several optional arrays for keeping input adsorption
      parameters (area fractions of surface types, maximum site density,
      capacitance parameters, SAT model codes) must also be allocated. After
      selecting the suface species from the ReacDC list and the sorbent
      end-member(s) from DComp or ReacDC lists, make sure that proper codes are
      given&nbsp; in the <a href="g_useref.html#DCCLASSCODES">"Species Class"</a>
      list for inner- and outer-sphere surface complexes and sorbent
      end-members. Check also that the <a href="g_useref.html#SCM_CODES">EDL
        model codes</a> are properly specified and the non-zero number for
      specific surface area is provided (it can be changed later on in project
      System definition, if necessary).&nbsp; Theoretical aspects of GEM
      sorption modeling are given in publications (Kulik, 2000, 2002a,b) or, in
      a condensed form, in the <b><tt>SCM-corrections.pdf</tt></b>&nbsp;
      manual. </p>
    <p>This part is currently under construction due to the on-going
      re-implementation of sorption models into TSorpMod class library. <br>
    </p>
    <br>
    <p> </p>
    <blockquote> </blockquote>
    <hr style="width: 100%; height: 2px;">
    <h3><a name="PHASE_EXAMPLES"></a> 4.5. Examples and special cases</h3>
    <p>&lt;to be added later&gt;<br>
    </p>
    <p> <br>
      &nbsp; </p>
    <h2> </h2>
    <hr style="width: 100%; height: 2px;">
    <h2><a name="PHASE_DATA_ENTRIES"></a><font face="Helvetica, Arial, sans-serif">
      </font>5. Data Entries on Phase Window Pages</h2>
    <br>
    <dl>
      <dt><a name="PhName"></a><big><b><big><tt>PhName</tt></big></b></big> -
        Input full name of this phase definition </dt>
      <dd>
        <p> This comment field may contain a string up to 70 characters long. It
          is highly recommended to enter this string for identifying the Phase
          definition on the Phase window pages or in printouts. Not used in any
          calculations.&nbsp; &nbsp; </p>
      </dd>
      <dt> <a name="PhNote"></a><big><big><b><tt>PhNote</tt></b></big></big> -
        Input comment to <b><tt>PhName </tt></b>(optional) </dt>
    </dl>
    <dl>
      <dd>
        <p>This string up to 70 characters long may be entered by the user for
          identification purposes. <br>
        </p>
      </dd>
      <dd>
        <p>In forthcoming versions, this field will be optionally used for
          providing links to other phases (within the modeling project system).</p>
      </dd>
    </dl>
    <dl>
      <dt> <a name="DisPar_0"></a><big><big><b><tt>DisPar[0]</tt></b></big></big>
        - <i>A</i> &nbsp;(input specific surface area, m<sup>2</sup>/g)<br>
      </dt>
      <dd>
        <p>The positive value of specific surface area <i>A</i> (in m<sup>2</sup>/g)
must
          be entered by the user for dispersed or sortion phases (in the latter
          case, <i>A</i> applies to the sorbent part only). This value is
          automatically copied into the <a href="gems_bcc.html">project system
            definition</a> and can be edited there, if necessary. Default value
          is 0.&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="DisPar_1"></a><big><big><b><tt>DisPar[1]</tt></b></big></big>
        - <i>Sig</i> &nbsp;(input specific surface free energy of solid-aqueous
        interface, J/m<sup>2</sup>) <br>
      </dt>
      <dd>
        <p>The specific free energy of surface in water at Pr = 1 bar, Tr = 25 C
          can be entered by the user for dispersed or sortion phases. If
          unknown, 0 (default value) can be entered.&nbsp; This value is
          automatically copied into <a href="gems_bcc.html">project system
            definition</a> and can be edited there, if necessary. Together with
          <i>A</i>,<i> Sig</i> is used there for correction of stability of the
          solid in water according to the Freundlich-Ostwald equation.&nbsp;</p>
      </dd>
      <dd>
        <p>Positive values of <i>Sig</i> &nbsp;correspond to a positive
          curvature (particulate solid, less stable than the bulk solid);
          negative values of &nbsp;<i>Sig</i> denote a porous solid phase (more
          stable than the bulk solid).</p>
      </dd>
      <dt> <a name="DisPar_2"></a><big><big><b><tt>DisPar[2]</tt></b></big></big>
        - <i>Sigg</i> (input specific surface free energy of gas-aqueous
        interface, J/m<sup>2</sup>)</dt>
      <dd>
        <p>&nbsp; Reserved for future extension to model sorption of gases on
          aqueous phase surface.&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="DisPar_3"></a><b><tt>DisPar[3]</tt></b> - Mean radius r0
        for (spherical or cylindrical) particles, nm (reserved) </dt>
      <dd>
        <p>&nbsp;Reserved for future extensions&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="DisPar_4"></a><b><tt>DisPar[4]</tt></b> - Mean thickness h0
        for cylindrical or 0 for spherical particles, nm (reserved) </dt>
      <dd>
        <p>&nbsp; Reserved for future extensions.</p>
      </dd>
      <dt> <a name="DisPar_5"></a><b><tt>DisPar[5]</tt></b> - Dielectric
        constant for solid carrier at Tr (reserved)</dt>
      <dd>
        <p>&nbsp; Reserved for future extensions.</p>
      </dd>
      <dt> <a name="DisPar_6"></a><b><tt>DisPar[6]</tt></b> - Specific
        conductivity at Tr, Sm/m/cm<sup>2</sup> (reserved) </dt>
      <dd>
        <p>Reserved for future extensions.&nbsp; &nbsp;&nbsp; &nbsp; <br>
        </p>
      </dd>
      <dt> <a name="DisPar_7"></a><big><b><tt>DisPar[7]</tt></b></big> -
        Default reference density for surface species, 1/nm<sup>2</sup> <br>
      </dt>
      <dd>
        <p>Default reference surface density (in sites/nm<sup>2</sup>) can be
          entered by the user for (ad)sortion phases (ignored for all
          non-sorption phases). This value is automatically copied into the
          project system definition and can be edited there, if necessary. If
          unknown, enter the default (reference) site density 12.05 sites/nm<sup>2</sup>.</p>
      </dd>
      <dd>&nbsp;&nbsp;</dd>
      <dt> <a name="pSDref"></a><big><big><b><tt>pSDref</tt></b></big></big>
        &nbsp;- List of SDef keys to data sources or comments to this Phase
        definition. <br>
      </dt>
      <dd>
        <p> The following format is recommended: [name]:[year]:[type]:
          &nbsp;Example: <tt>"Smith&amp;Martell:1976:ref:"</tt></p>
      </dd>
      <dd>
        <p> Click on any entry in this list and then press&nbsp; <tt>F2</tt>&nbsp;
to
          get the <a href="gm_sdref.html">SDref</a> window with full
          information from the respective bibliographic data record. If the
          record does not exist then you can immediately create it, enter the
          information and save to database.&nbsp;</p>
      </dd>
      <dd>&nbsp; <br>
      </dd>
      <dt> <a name="pSDval"></a><big><big><b><tt>pSDval</tt></b></big></big> -
        Comments to SDref keys to data sources <br>
      </dt>
      <dd>
        <p>Contains the same number of entries as the <tt><a href="#pSDref">pSDref</a>
          </tt>list.&nbsp; <br>
        </p>
      </dd>
      <dd>
        <p> Into each entry of the <tt>pSDval</tt> list, you may put very short
          comments indicating which data were taken from the data source
          referenced in the respective <tt>pSDref</tt> list entry.</p>
      </dd>
      <dd>&nbsp; </dd>
      <dt> <a name="PhDCC"></a><big><big><b><tt>PhDCC</tt></b></big></big> - DC
        classes of species included into this phase &nbsp;{ S T W O I M J 0 1 2
        3 4 ... } &nbsp; <br>
      </dt>
      <dd>
        <p>This list is automatically compiled from <a href="g_useref.html#DCCLASSCODES">DC
            Class codes</a> specified in source <a href="gm_dcomp.html">DComp</a>
          (<a href="gm_dcomp.html#DC_set_0"><tt>DC_set[0]</tt></a> &nbsp;field)
          or <a href="gm_reacdc.html">ReacDC</a> (<a href="gm_reacdc.html#RE_set_0"><tt>RE_set[0]</tt></a>
          &nbsp; &nbsp;field) records, when the Phase definition is created or
          cloned. The codes may be changed here in <tt>PhDCC</tt> column, from
          where they will be taken into the modelling project system definition
          (can be also edited in the project system, but only kept for the
          duration of the project session).</p>
      </dd>
      <dd>
        <p><b>Attention!</b> Special care is needed when applying 'remake' for
          an existing Phase record. Upon remake, DC class codes in this field
          will not be replaced automatically, so the user has to check the codes
          and edit them if necessary before saving the Phase record to database.
        </p>
      </dd>
      <dd>&nbsp; &nbsp; &nbsp; </dd>
      <dt> <a name="PhDCS"></a><big><big><b><tt>PhDCS</tt></b></big></big> -
        Location of source records for Dependent Components (species) { r d }
        &nbsp; <br>
      </dt>
      <dd>
        <p>This one-character code defines where the program will look for the
          source input data for the involved species, identified by
          corresponding record keys in the <a href="#pDC_v_"><tt>pDC_v_</tt></a>
          list. Possible codes:&nbsp;</p>
      </dd>
      <dd>&nbsp; &nbsp; &nbsp; <big><b><tt>d</tt></b></big> &nbsp; &nbsp; DComp
        source record <br>
        &nbsp; &nbsp; &nbsp; <big><b><tt>r</tt></b></big> &nbsp; &nbsp;
        &nbsp;ReacDC source record<br>
      </dd>
      <dd>
        <p> The codes will be set automatically upon create/remake of the Phase
          record. </p>
      </dd>
      <dd> &nbsp; &nbsp; </dd>
      <dt> <a name="pDC_v_"></a><big><big><b><tt>pDC_v_</tt></b></big></big>
        &nbsp;- List of source DComp or ReacDC record keys for &nbsp;species
        included into this phase <br>
      </dt>
      <dd>
        <p>This list contains records keys of the species involved into this
          phase. The keys are interpreted according to codes in the <a href="#PhDCS"><tt>PhDCS</tt></a>
          column. This list is created or updated automatically during
          remake/create of the Phase record, when the user selects species from
          ReacDC and/or DCcomp record key lists.&nbsp;</p>
      </dd>
      <dd>
        <p><b>Note</b> that the fourth field of DC record keys is not analyzed
          when records are sampled from database into the modelling project
          ("override mechanism"). This means that the (alphanumerically) first
          record with matching first three fields will be taken, and others (if
          available in the same database chain) will be ignored. However, this
          is done separately within DComp or ReacDC chains, i.e. no
          cross-overriding between DComp and ReacDC records is possible even if
          they have identical first three fields of their <a href="gems_rekey.html#dbm_DComp">record
            keys</a>.&nbsp; </p>
      </dd>
      <dd> &nbsp; &nbsp; </dd>
      <dt> <a name="SAT_C_0"></a><big><big><b><tt>SAT_C[0]</tt></b></big></big>
        - Classifier of methods of SACT&nbsp; calculation { L Q 1 2 3 4 F R N I
        } and obsolete SAT calculation { C S }<br>
      </dt>
      <dd>
        <p> This input column contains <a href="g_useref.html#SACT_CODES">SACT
            codes for surface species</a>, used in calculation of&nbsp; the
          surface activity coefficient terms (SACT). All values must be entered
          by the user here because they cannot be collected from DComp or ReacDC
          records. For the sorbent (end members), the <tt>"I"</tt> code must be
          used.&nbsp; <br>
        </p>
      </dd>
      <dd>
        <p>The SACT codes will be automatically copied into the modelling
          project. Some of new method codes require other parameters to be set
          appropriately in the <small><a style="font-family: monospace;" href="#MaSDj_0"><big>MaSDj</big></a></small><span
            style="font-family: monospace;">
          </span>table, first of all, the site density parameter.&nbsp;
          Recommended&nbsp; value in this column is "L" (competitive Langmuir
          SACT) which produces effects similar to the site balance in LMA SCMs.
          Competition takes place when more than one surface species is assigned
          with the same site density parameter to the same site type on the same
          surface type.</p>
      </dd>
      <dd>
        <p>Use of the obsolete SAT codes and equations ( C, S ) is not
          recommended.<span style="font-style: italic;"></span></p>
      </dd>
      <dd>&nbsp;&nbsp;</dd>
      <dt> <a name="SAT_C_1"></a><big><big><b><tt>SAT_C[1]</tt></b></big></big>
        -&nbsp; Allocation of surface species to sorbent (end-members) { V } <br>
      </dt>
      <dd>
        <p> This input column contains the <a href="g_useref.html#SURFDC_ALLOC_CODES">allocation
            codes</a> assigning a surface species to the whole solid carrier (<tt>"V"</tt>
          code; default) or one of its end-members (<tt>&lt;digit&gt;</tt>). The
          codes must be entered here by the user. Allocation codes will be
          automatically copied into the modelling<a href="gems_scm.html">
            project system </a>and can be edited there, if necessary. </p>
      </dd>
      <dt> <a name="SAT_C_2"></a><big><big><b><tt>SAT_C[2]</tt></b></big></big>
        -&nbsp; Allocation of surface species to surface type on the
        sorbent&nbsp; { 0 1 2 3 4 5 } <br>
      </dt>
      <dd>
        <p> This input column contains the codes for assigning surface&nbsp;
          species, sites, and electrical interface layer (EIL) models to a
          certain surface type (or surface patch) on the solid sorbent. There
          can be up to six surface patches (types) in a sorption phase, indexed
          from 0 (default) to 5. The number of active surface types can be set
          upon remake of the Phase record (see <a style="font-family: monospace;"
            href="#Ph_nsi_0">Ph_nsi[0]</a>
          field). Some common parameters for surface types can be set on Page 3
          of the Phase window.&nbsp; </p>
      </dd>
      <dd>
        <p>These indexes (allocation codes) must be entered here by the user.
          They will be automatically copied into the modelling<a href="gems_scm.html">
            project system </a>and can be edited there later on, if necessary.
        </p>
        &nbsp;&nbsp; </dd>
      <dt> <a name="SAT_C_3"></a><big><big><b><tt>SAT_C[3]</tt></b></big></big>
        -&nbsp; Allocation of the surface complex outer charge to EIL model
        plane&nbsp; { 0&nbsp; 1 b&nbsp; 2 d&nbsp; 3 c } <br>
      </dt>
      <dd>
        <p> This input column contains the <a href="g_useref.html#SURFDC_ALLOC_CODES">allocation
            codes</a> assigning an outer portion of the formula charge of a
          surface species to a certain EIL model plane. The respective charge
          should be given in the <a style="font-family: monospace;" href="#MaSDj_2">MaSDj[][2]</a><small>
          </small>column. The charge given in <small><a href="#MaSDj_1"><big><span
                  style="font-family: monospace;">MaSDj[][1]</span></big></a></small>
          column ("inner charge") will be always assigned to the 0 EIL plane.
          The associated EIL model (for this surface type) is encoded in the <small><a
              href="#SCM_C"><big><span
                  style="font-family: monospace;">SCM_C</span></big></a></small>
          field on Page 3 of the Phase window.</p>
      </dd>
      <dd>
        <p>Default allocation code is 0 (zero plane), which means that the whole
          charge of surface species is located on the sorbent surface directly
          (as in NEM, DLM, CCM, inner-sphere species in TLM, BSM and 3LM). Any
          non-zero charge given in the <a style="font-family: monospace;" href="gm_phase.html#MaSDj_2">MaSDj[][2]</a>
          column will be ignored in this case. </p>
      </dd>
      <dd>
        <p>Charge of outer-sphere electrolyte complexes is usually allocated to
          the beta (b) or 1 plane (in "classic" TLM or BSM) or the 2 (d)
          plane&nbsp; (in three-layer CD model by Hiemstra &amp; Van Riemsdijk
          (1996). The outer charge of inner-sphere adsorbed metal complexes or
          anions considered in 3LM CD should be located on the 1 (b) plane. The
          inner charge is assigned to 0 plane in all cases. Codes '3' or 'c' are
          reserved for future implementations of EIL models.</p>
      </dd>
      <dd>
        <p>The allocation codes must be entered here by the user. they will be
          automatically copied into the modelling<a href="gems_scm.html">
            project system </a>and can be edited there, if necessary. </p>
        &nbsp;&nbsp; </dd>
      <dt> <a name="SAT_C_4"></a><big><big><b><tt>SAT_C[4]</tt></b></big></big>
        -&nbsp; Allocation of surface species to site type within a surface type
        { 0 1 2 3 4 5 } <br>
      </dt>
      <dd>
        <p> This input column contains the codes for assigning surface&nbsp;
          species to a certain site type (within a surface type or patch) on the
          sorbent surface. There can be up to six site types on one surface
          type, indexed from 0 (default) to 5. </p>
      </dd>
      <dd>
        <p>All species assigned to the same site type on the same surface patch
          will potentially compete for these sites if a competitive SACT is used
          (e.g. 'L'). All such competing species must be given the same value of
          site density parameter (complete coverage site density) in the <small><a
              href="#MaSDj_0"><big><span
                  style="font-family: monospace;">MaSDj[][0]</span></big></a>
          </small>column. </p>
      </dd>
      <dd>
        <p>These indexes (allocation codes) must be entered here by the user.
          They will be automatically copied into the modelling<a href="gems_scm.html">
            project system </a>and can be edited there later on, if necessary.
          <br>
        </p>
      </dd>
      <dt> <a name="SAT_C_5"></a><big><big><b><tt>SAT_C[5]</tt></b></big></big>
        -&nbsp; Units in which surface site density is given in MaSDj[][0]
        column { n } ( { m M g } reserved } <br>
      </dt>
      <dd>
        <p> This input column contains the code 'n' which tells that site
          densities are given in nm<sup>-2</sup> units (one site per one square
          nanometer). Other codes are reserved for future versions. </p>
      </dd>
      <dd> <br>
      </dd>
      <dt> <a name="MaSDj_0"></a><big><big><b><tt>MaSDj[0]</tt></b></big></big>
        - Surface site (type) density parameter, in nm<sup>-2</sup>, to be used
        in SACT calculations&nbsp;<br>
      </dt>
      <dd>
        <p>This input column contains surface site (or complete site coverage)
          densities for&nbsp; surface species, expressed in 1/nm2 units. If
          unknown, put here the standard-state reference density (12.05 nm<sup>-2</sup>).&nbsp;</p>
      </dd>
      <dd>
        <p><b style="text-decoration: underline;">Attention: </b>All surface
          species allocated to the same site type&nbsp; (<a style="font-family: monospace;"
            href="#SAT_C_4">SAT_C[][4]</a>
          column) on the same surface type (<a style="font-family: monospace;" href="#SAT_C_2">SAT_C[][,2]</a>
          column)&nbsp; must have the same density parameter value if they are
          assigned with a competitive SACT code in <a style="font-family: monospace;"
            href="#SAT_C_0">SAT_C[][0]</a>
          column). <br>
        </p>
      </dd>
      <dd>
        <p>Surface site densities will be automatically copied into the
          modelling <a href="gems_scm.html">project system</a> and can be
          edited there, if necessary. &nbsp;&nbsp;&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="MaSDj_1"></a><big><big><b><tt>MaSDj[1]</tt></b></big></big>
        - Effective part of the formula unit charge of surface species allocated
        to 0 plane (sorbent surface)&nbsp; <br>
      </dt>
      <dd>
        <p>These numbers will be used only in calculations of charge densities
          and electrostatic potentials in CD EIL model Coulombic term, which
          does not&nbsp; affect the overall charge balance in the chemical
          system stoichiometry. Hence, the effective charges entered here must
          not necessarily co-inside with formula charges of surface species. The
          charges in this column will be applied regardless of the allocation
          code set in <a style="font-family: monospace;" href="#SAT_C_3">SAT_C[][3]</a>
          column.</p>
      </dd>
      <dd>
        <p>Upon recalculation of Phase record, the numbers can be collected
          initially from ReacDC records referred to in this Phase definition and
          then edited by the user.</p>
      </dd>
      <dd>
        <p>Later on, the data will be automatically copied into the modelling <a
            href="gems_scm.html">project
            system</a> and can be edited there, if necessary. </p>
      </dd>
    </dl>
    <dl>
      <dt> <a name="MaSDj_2"></a><big><big><b><tt>MaSDj[2]</tt></b></big></big>
        - Effective part of the formula unit charge of surface species allocated
        to 1 or 2 plane (CD 3LM;&nbsp; BSM, TLM) <br>
      </dt>
      <dd>
        <p>This input column contains unit charges of surface species to be
          allocated to one of outer EIL planes&nbsp; according to the allocation
          code in <a style="font-family: monospace;" href="#SAT_C_3">SAT_C[][3]</a>
          column. If the corresponding allocation code is '0', the charge value
          in this column will be ignored.</p>
      </dd>
      <dd>
        <p>These numbers will be used only in calculations of charge densities
          and electrostatic potentials in CD EIL model Coulombic terms, which
          does not&nbsp; affect the overall charge balance in the chemical
          system stoichiometry. Hence, the effective charges entered here must
          not necessarily co-inside with formula charges of surface species.</p>
      </dd>
      <dd>
        <p>Upon recalculation of Phase record, the numbers can be collected
          initially from ReacDC records referred to in this Phase definition and
          then edited by the user.</p>
      </dd>
      <dd>
        <p>Later on, the data will be automatically copied into the modelling <a
            href="gems_scm.html">project
            system</a> and can be edited there, if necessary.</p>
      </dd>
    </dl>
    <dl>
      <dt> <a name="MaSDj_3"></a><big><big><b><tt>MaSDj[3]</tt></b></big></big>
        - SACT isotherm parameter 1 (e.g. interaction parameter <i>a<sub>F</sub></i>&nbsp;
in
        Frumkin SACT)<br>
      </dt>
      <dd>
        <p>This input column contains an optional additional parameter value to
          be used in some SACT equations.&nbsp; </p>
      </dd>
      <dd>
        <p>&nbsp;In Frumkin SACT, this column should provide the value of
          interaction parameter <i>a<sub>F</sub></i> (negative means lateral
          repulsion, positive means lateral attraction).</p>
      </dd>
      <dd>
        <p>Later on, the data will be automatically copied into the modelling <a
            href="gems_scm.html">project
            system</a> and can be edited there, if necessary. </p>
      </dd>
      <dt> <a name="MaSDj_4"></a><big><big><b><tt>MaSDj[4]</tt></b></big></big>
        -&nbsp; SACT isotherm parameter 2 (e.g. denticity n in QCA SACTs) <br>
      </dt>
      <dd>
        <p>This input column contains an optional additional parameter value to
          be used in some SACT equations.&nbsp; </p>
      </dd>
      <dd>
        <p>In Frumkin SACT, this column should provide the value of coordination
          number (default value 2 gives the standard Frumkin term).</p>
      </dd>
      <dd>
        <p>In QCA SACT, this column provides the denticity d (1, 2, 3 or 4).</p>
      </dd>
      <dd>
        <p>Later on, the data will be automatically copied into the modelling <a
            href="gems_scm.html">project
            system</a> and can be edited there, if necessary.</p>
      </dd>
    </dl>
    <dl>
      <dt> <a name="MaSDj_5"></a><big><big><b><tt>MaSDj[5]</tt></b></big></big>
        - SACT isotherm parameter 3 (reserved for future development of SACT
        equations) &nbsp; <br>
      </dt>
      <dd>
        <p>This input column contains an optional additional parameter value to
          be used in&nbsp; SACT equations added in future.&nbsp;</p>
      </dd>
      <dd>
        <p>&nbsp;Later on, the data will be automatically copied into the
          modelling <a href="gems_scm.html">project system</a> and can be
          edited there, if necessary. </p>
      </dd>
    </dl>
    <dl>
      <dd>&nbsp; </dd>
    </dl>
    <dl>
      <dt> <a name="DcEq"></a><b><big><big><tt>DcEq</tt></big></big></b> - Math
        script to compute activity coefficients of phase components (for
        user-defined non-ideal mixing models) <br>
      </dt>
      <dd>
        <p>Use this multi-line text editor field to create a <a href="g_mscript.html">math
            script</a> for calculation of species' activity coefficients in the
          non-ideal multi-component phase.&nbsp; Normally, this math script will
          be executed after each GEM IPM iteration because activity coefficients
          are functions of the phase composition, which is part of the GEM
          primal solution approximation.This behavior, coded in the <a href="gm_phase.html#p_solt_1"><tt>p_solt[1]</tt></a>
          field, can be changed in the Phase wizard upon remake of the Phase
          record. <br>
        </p>
      </dd>
      <dd>
        <p>To facilitate writing of math scripts for calculation of activity
          coefficients, a template script library is provided, accessible by
          pressing <span style="font-family: monospace;">F3</span> or executing
          the "Help" "Scripts" menu command. Select one of "mscripts" from the
          appearing list; this opens the SDref window, where the script (with
          comments) can be found on the second page. Copy-paste the script into
          DcEq field and modify, as needed.&nbsp;</p>
      </dd>
      <dd>
        <p>A typical script from the library ("<tt>mscript-2-Margules:0001:phase</tt>")
looks
          like this:</p>
      </dd>
    </dl>
    <blockquote>
      <dl>
        <dd><tt>$ Calculation of the activity coefficients (Margules subregular)<br>
            &nbsp; ln_gam[0] =: (Qd[0]+2*Wx[0]*(Qd[1]-Qd[0]))*Wx[1]^2; \@<br>
            &nbsp; ln_gam[1] =: (Qd[1]+2*Wx[1]*(Qd[0]-Qd[1]))*Wx[0]^2; \@<br>
            $ end<br>
          </tt></dd>
      </dl>
    </blockquote>
    <dl>
      <dd>
        <p>This script applies to a single-site binary condensed solution
          consisting of two end members (indexed with 0 and 1), in the same
          order as they appear in the <a href="#pDC_v_"><tt>pDC_v_</tt></a>
          list on Page 1 of the "Phase" window. <tt><a href="#Wx">Wx</a>[0]</tt>
          and <tt>Wx[1]</tt> designate the current end-member mole fractions;
          the<tt> \@</tt> symbols mark the end of group of equations for a given
          end member (several operators per end member can be written in one
          group of equations). The Margules interaction parameters are taken
          from an optional vector of work variables <a href="#Qd"><tt>Qd</tt></a>
          (where, in turn, they are placed after execution of another script in
          the <a href="#PhEq"><tt>PhEq</tt></a> field, see example below). The
          <tt>Qd</tt> vector, with at least two elements, must be allocated in
          Phase Wizard upon remake.</p>
      </dd>
    </dl>
    <blockquote>
      <p>Data object labels normally used in DcEq and PhEq scripts belong to a
        special set of <a href="#PHASE_DOD_HIDDEN">"hidden" data objects</a>,
        automatically adjusted for each phase such that the indexation in them
        is limited to within this phase. For example, <a href="#Wx"><tt>Wx</tt></a>
        (mole fraction of end member) is a hidden data object that covers part
        of the (visible) <a href="gems_sys.html#Wxx"><tt>Wxx</tt></a> vector
        corresponding to this phase in the GEM IPM work structure. Likewise, <a
          href="#ln_gam"><tt>ln_gam</tt></a>
        is a hidden data object that covers part of the visible <a href="gems_sys.html#lnGam"><tt>lnGam</tt></a>
        vector corresponding to this phase only. Using such hidden object has an
        obvious&nbsp; advantage that their indexes are limited only to this
        phase, thus independent of the actual indexes of end members in the
        whole list of DCs in the chemical system. Available hidden data objects
        are <a href="#PHASE_DOD_HIDDEN">listed here</a>.&nbsp; </p>
    </blockquote>
    <dl>
      <dd>
        <p>Math script expressions in the DcEq field will be collected for all
          phases involved in the modelling project, and translated immediately
          before the beginning of GEM IPM calculation of an equilibrium state.
          The scripts will be executed at each iteration of the IPM minimization
          algorithm according to the flag 'X' in the <a href="#p_solt_1"><tt>p_solt[1]</tt></a>
          field. </p>
      </dd>
      <dd>
        <p>There are two different relations between equations in the DcEq
          script and the components of the non-ideal solution phase, defined by
          the linking code in the <a href="#p_solt_4"><tt>p_solt[4]</tt></a>
          field. The above example corresponds to the "private" linking, where
          each species has its own group of equations in the math script
          (separated by the<tt> \@</tt> symbols).&nbsp; There are also
          non-ideality models, in which the same group of math script equations
          must be executed for each phase species (e.g. as in the Debye-Hueckel
          aqueous activity model).&nbsp; <br>
        </p>
      </dd>
      <dd>
        <p>In some cases (SIT aqueous models, multicomponent solid solutions),
          the DcEq math script can be greatly simplified using hidden
          aliases&nbsp; <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/gm_phase.html#dCm"><tt>dCm</tt></a>
          for the optional <a href="#dc_cf"><tt>dc_cf</tt></a> array, and <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/gm_phase.html#pCv"><tt>pCv</tt></a>
          for the optional <a href="#ph_cf"><tt>ph_cf</tt></a> array, both
          allocated upon create/remake of the Phase record. This is the easiest
          way to provide component properties and interaction parameter
          coefficients for the scripted model of mixing in the phase, similar to
          that in most of the <a href="g_useref#P_SOLT0">built-in phase models</a>.&nbsp;
          </p> </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="dc_cf"></a><big><b><tt><big>dc_cf</big> </tt></b></big>-
        Array of coefficients of end-member (species) properties for the
        non-ideal mixing model <br>
      </dt>
      <dd>
        <p>This array of component-related coefficients of the non-ideality
          model can be allocated in Phase wizard upon create/remake of the Phase
          record. The <tt>dc_cf</tt> array has the same number of rows as the
          number of Dependent components in the phase, and the user-defined
          number of columns (i.e. number of coefficients per species). This
          array has also a hidden runtime data object alias <a href="#dCm"><tt>dCm</tt></a>.&nbsp;
          </p> </dd>
      <dd>
        <p>The <tt>dc_cf</tt> array is automatically created, filled-out and
          used in some <a href="g_useref.html#P_SOLT0">built-in modes</a> for
          calculation of activity coefficients. For some built-in models, the
          user must fill the coefficients out and save them in the Phase record.
          &nbsp; </p>
      </dd>
      <dd>
        <p>Coefficients stored in this array can be used in <a href="g_mscript.html">math
            script</a> equations for calculation of activity coefficients typed
          in the <a href="#DcEq"><tt>DcEq</tt></a> field, where they are
          accessible at the GEM IPM runtime using the <a href="#dCm"><tt>dCm</tt></a>
          hidden data object. To access a coefficient, two indexes must be
          provided after <big><span style="font-family: monospace;">the <small>dCm</small></span></big>&nbsp;
          identifier, for instance, as <span style="font-family: monospace;">dCm[1][2]</span>&nbsp;
or
          <span style="font-family: monospace;">dCm[js][1]</span>&nbsp; or <span
            style="font-family: monospace;">dCm[js][is]</span>.
          <br>
        </p>
      </dd>
      <dd>
        <p>Except for the built-in mixing models, the user is fully responsible
          for setting up the correct information in the <tt>dc_cf </tt>array
          and for the correct usage of this data in calculation of activity
          coefficients.&nbsp; </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="dcpcl"></a><big><b><tt><big>dcpcl</big> </tt></b></big>-
        Comments to end-member (species) properties for the non-ideal mixing
        model <br>
      </dt>
      <dd>
        <p>This row appears below the <tt>dc_cf</tt> table. Enter here short
          stings - comments explaining the meaning of each column in the dc_cf
          table. <br>
        </p>
      </dd>
      <dd>
        <p>These comments for better clarity remain in the phase record and will
          not be passed to GEM kernel for calculation of equilibria. </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="DQFc"></a><big><b><tt><big>DqFc</big> </tt></b></big>-
        Array of coefficients of DQF parameters for end-members of the binary
        (sub)regular mixing model <br>
      </dt>
      <dd>
        <p>This array will be created if 4 DQF parameters per end member is set
          in Phase remake wizard. So far, works only within the binary
          subregular Margules ('M') built-in solid solution model. </p>
      </dd>
      <dd>
        <p>Enter in this array four numbers per end member according to the
          following format:</p>
      </dd>
      <dd>
        <table style="width: 706px; height: 29px;" border="1">
          <tbody>
            <tr>
              <td><span style="font-style: italic;">&nbsp; X_b,j&nbsp;&nbsp; <br>
                </span></td>
              <td><span style="font-style: italic;">&nbsp; a</span>
                (J/mol)&nbsp;&nbsp; </td>
              <td><span style="font-style: italic;">&nbsp; b</span>&nbsp;
                (J/mol/K)&nbsp;&nbsp; </td>
              <td><span style="font-style: italic;">&nbsp; c</span>&nbsp;
                (J/mol/bar)&nbsp;&nbsp; </td>
            </tr>
          </tbody>
        </table>
        <p>&nbsp;Here, <span style="font-style: italic;">X_b,j</span> is the
          mole fraction of this end member, below which it takes the structure
          of another end member; <span style="font-style: italic;">a, b,</span>
          and <span style="font-style: italic;">c</span> are coefficients of
          the equation <span style="font-style: italic;">G</span>(DQF)<span style="font-style: italic;">,j</span>
          = <span style="font-style: italic;">a</span> - <span style="font-style: italic;">b</span>*<span
            style="font-style: italic;">T</span>
          + <span style="font-style: italic;">c</span>*<span style="font-style: italic;">P</span>.
          Physical sense of the parameter <span style="font-style: italic;">G</span>(DQF)<span
            style="font-style: italic;">,j</span>
          is the difference of its standard Gibbs energy (per mole) between that
          for the less stable and more stable structure. For instance, for the
          solid solution system (Ca,Sr)CO<sub>3</sub>, <span style="font-style: italic;">G</span>(DQF)<span
            style="font-style: italic;">,</span>CaCO<sub>3</sub>
          = g<sup>o</sup>(Aragonite) - g<sup>o</sup>(Calcite) at <span style="font-style: italic;">T,P</span>
          of interest; <span style="font-style: italic;">G</span>(DQF)<span style="font-style: italic;">,</span>SrCO<sub>3</sub>
          = g<sup>o</sup>(SrCO<sub>3</sub>,cal) - g<sup>o</sup>(Strontianite),
          where SrCO3,cal is the (hypothetical) compound having calcite
          structure. For this system, it can be assumed that&nbsp; <span style="font-style: italic;">X_b,</span><span
            style="font-style: italic;"></span>Calcite
          = 0.45 and&nbsp;<span style="font-style: italic;">X_b,</span><span style="font-style: italic;"></span>Strontianite
          = 0.55. &nbsp; &nbsp; </p>
      </dd>
      <dd>
        <p>Note that, if this table is set in the Phase definition for the 'M'
          model of mixing, the interaction parameters in the <a href="#ph_cf">ph_cf</a>
          table will be used as regular mixing parameters <span style="font-style: italic;">W</span><sub>12</sub>
          and <span style="font-style: italic;">W</span><sub>21</sub> for the
          structures of the second and the first end members, respectively, to
          calculate activity coefficients according to DQF model (see
          description and example in paper Kulik et al., P<span style="font-style: italic;">hys.Chem.Earth</span>
          35 (2010) 217-232, eqs 18-20).&nbsp; </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="rcpc"></a><big><b><tt><big>rcpc</big> </tt></b></big>-
        Array of reciprocal term coefficients for end-members of the multi-site
        (sublattice) non-ideal mixing model <br>
      </dt>
      <dd>
        <p>&lt;under construction&gt; </p>
      </dd>
      <dd>&nbsp; &nbsp;&nbsp; </dd>
      <dt> <a name="PhEq"></a><big><big><b><tt>PhEq</tt></b></big></big>
        -&nbsp;Math script to calculate <i>T,P</i>-corrected parameters and
        properties (for user-defined non-ideal mixing models)&nbsp; <br>
      </dt>
      <dd>
        <p>This multi-line editor field can be used to create an auxiliary <a href="g_mscript.html">math
            script</a> for preparing some temperature-, pressure- corrected
          interaction parameters and phase properties to be used in calculation
          of activity coefficients of components in the non-ideal solution phase
          as defined in the <a href="#DcEq"><tt>DcEq</tt></a> math script.
          Normally, this script does not depend on phase composition, hence it
          is calculated only once before entering the GEM IPM algorithm
          iterations. However, if some parts of the script depend on phase
          composition or any other function of the primal GEM solution (e.g.
          ionic strength), it has to be executed at every IPM iteration. This
          behavior, coded in the <a href="gm_phase.html#p_solt_2">p_solt[2]</a>
          field, can be changed in the Phase wizard upon remake of Phase record.<br>
        </p>
      </dd>
      <dd>
        <p>In writing PhEq scripts, we strongly recommend usage of special <a href="#PHASE_DOD_HIDDEN">hidden
data
            objects</a> that exist in the runtime IPM data structure and
          automatically map indexes of components and parameters of this phase
          only (see also the description of the <a href="#DcEq"><tt>DcEq</tt></a>
          field).</p>
      </dd>
      <dd>
        <p>Examples of PhEq scripts can be found in the template script library,
          accessible by pressing <span style="font-family: monospace;">F3</span>
          or executing the "Help" "Scripts" menu command. For example, the
          library entry "<tt>mscript-2-Margules:0001:phase</tt>" contains the
          following script to be copy-pasted into the <tt>PhEq</tt> field in
          order to complement the example script given in help page for the <a
            href="#DcEq"><tt>DcEq</tt></a>
          field:</p>
      </dd>
    </dl>
    <blockquote>
      <dl>
        <dd><tt>&nbsp;$ Margules parameters W/(RT):<br>
            &nbsp; Qd[0] =: ( 6327 </tt><tt>- 4.632*T_K </tt><tt>+ 0.093*P_
            )/RT_;&nbsp; <br>
            &nbsp; Qd[1] =: ( 7672 </tt><tt>- 3.857*T_K </tt><tt>+ 0.112*P_
            )/RT_;<br>
            &nbsp;$ end</tt><tt> </tt></dd>
      </dl>
    </blockquote>
    <dl>
      <dd>
        <p>This script should be calculated only once per equilibrium state,
          because the Margules interaction parameters depend on <i>T, P</i> but
          not on the phase composition. The calculated Margules parameters are
          assigned to&nbsp; an optional vector <a href="gm_phase.html#Qd"><tt>Qd</tt></a>
          &nbsp;from where, in turn, they will be taken into equations for
          calculation of activity coefficients as specified in the <a href="#DcEq"><tt>DcEq</tt></a>
          field (see above). &nbsp;Note that the same binary Margules model is
          implemented as a built-in option (<tt>'M'</tt> code set in the <a href="gm_phase.html#p_solt_0"><tt>p_solt[0]</tt></a>
          cell and <tt>'S'</tt> code in <a href="#p_solt_3"><tt>p_solt[3]</tt></a>
          cell), in which case no scripts are needed, but&nbsp; the Margules
          parameter coefficients given in the above script should be entered
          into <a href="#ph_cf"><tt>ph_cf</tt></a> cells instead.</p>
      </dd>
      <dd>
        <p>Of course, it is possible to modify the above script to access
          parameter values previously entered into the <tt>ph_cf</tt> table
          (allocated in Phase wizard with two rows and three columns).&nbsp; In
          the script below, <a href="#pCv"><tt>pCv</tt></a> is a hidden data
          object alias for <a href="#ph_cf"><tt>ph_cf</tt></a> table in this
          Phase definition:<br>
        </p>
      </dd>
    </dl>
    <blockquote>
      <dl>
        <dd><tt>&nbsp;$ Margules parameters W/(RT):<br>
            &nbsp; Qd[0] =: ( pCv[0][0] </tt><tt>- pCv[0][1] </tt><tt>+
            pCv[0][2] ) / RT_; <br>
            &nbsp; Qd[1] =: </tt><tt>( pCv[1][0] </tt><tt>- pCv[1][1] </tt><tt>+
            pCv[1][2] ) / RT_;</tt><tt> <br>
            &nbsp;$ end</tt><tt> </tt></dd>
      </dl>
    </blockquote>
    <blockquote>
      <p>For this particular Margules model, the contents of <tt>ph_cf</tt>
        table must be:&nbsp;</p>
      <table width="60%" cellspacing="2" cellpadding="2" border="1">
        <tbody>
          <tr>
            <td valign="top" align="center">
              <p><tt>6327</tt></p>
            </td>
            <td valign="top" align="center">
              <p><tt>4.632</tt></p>
            </td>
            <td valign="top" align="center">
              <p><tt>0.093</tt></p>
            </td>
          </tr>
          <tr>
            <td valign="top" align="center">
              <p><tt>7672</tt></p>
            </td>
            <td valign="top" align="center">
              <p><tt>3.857</tt></p>
            </td>
            <td valign="top" align="center">
              <p><tt>0.112</tt></p>
            </td>
          </tr>
        </tbody>
      </table>
      <p>Math script expressions in the <tt>PhEq</tt> field will be copied into
        the modelling project, and translated immediately before the beginning
        of GEM IPM calculation of an equilibrium state. The script will be
        computed once before starting the GEM IPM run, or also at every IPM
        iteration, according to the mode flag in the <a href="#p_solt_2"><tt>p_solt[2]</tt></a>
        field. <br>
      </p>
    </blockquote>
    <dl>
      <dd> &nbsp;</dd>
      <dt> <a name="ipccl"></a><big><b><tt><big>ipccl</big> </tt></b></big>-
        Comments to interaction parameter coefficients in the ph_cf table <br>
      </dt>
      <dd>
        <p>Enter here short strings&nbsp; - comments explaining the meaning of
          each column of the <tt>ph_cf</tt> table with interaction parameter
          coefficients.&nbsp; </p>
      </dd>
      <dd>&nbsp; &nbsp; </dd>
      <dt> <a name="ph_cf"></a><big><big><b><tt>ph_cf</tt></b></big></big> -
        Array of interaction parameter coefficients for the phase-solution
        non-ideal mixing model<br>
      </dt>
      <dd>
        <p>This array of interaction parameter coefficients of the non-ideality
          model can be allocated in Phase wizard upon create/remake of the Phase
          record. The <tt>ph_cf</tt> array has the number of rows equal to the
          number of interaction parameters; the number of columns equals the
          number of&nbsp; coefficients per parameter, as defined by the user or
          set up automatically by the chosen <a href="g_useref.html#P_SOLT0">built-in
            mixing model</a>.&nbsp;</p>
      </dd>
      <dd>
        <p>In many built-in models that belong to TSolMod class library, the <tt>ph_cf</tt>
          array is used together with the <a href="#ipxT"><tt>ipxT</tt></a>
          index list; each row in the latter contains indices of phase
          components (starting from 0) between which the non-ideal interaction
          exists, as given by coefficients in the respective row of the <tt>ph_cf</tt>
          table. The number, units and order of those coefficients is determined
          by the selected model of mixing (<a href="g_useref.html#P_SOLT0">see
            details here</a>).&nbsp; </p>
      </dd>
      <dd>
        <p>The <tt>ph_cf</tt> array will be automatically created, if
          necessary, for certain types of built-in models as specified in the
          Phase wizard. You will only have to enter the indexes into <tt>ipxT</tt>
          list if apropriate, and the respective coefficient values in <tt>ph_cf</tt>
          rows, and save the Phase record to project database.&nbsp; </p>
      </dd>
      <dd>
        <p>There are three "old-style" built-in solid solution models that do
          not use the ipxT index list and, therefore, do not conform with the
          TSolMod specifications. These models were retained for upward
          compatibility. </p>
      </dd>
      <dd>
        <p>Specifically, the built-in binary Margules model (the 'M' code) uses
          three coefficients <i>W<sub>U</sub></i><sub>,1</sub>, <i>W<sub>S</sub></i><sub>,1</sub>&nbsp;
and
          <i>W<sub>V</sub></i><sub>,1</sub><i> </i>from the first ph_cf row,
          and three from the second row&nbsp; (in J/mol, J/K/mol and J/bar), as
          represented below&nbsp; (see also the second example of <a href="#PhEq"><tt>PhEq</tt></a>
          script above):&nbsp;</p>
      </dd>
    </dl>
    <blockquote>
      <dl>
        <dd><i>W</i><sub>12</sub> = <i>W<sub>U</sub></i><sub>,1</sub> - <i>W<sub>S</sub></i><sub>,1</sub>*<i>T</i>
          + <i>W<sub>V</sub></i><sub>,1</sub>*<i>P</i> &nbsp;&nbsp; <br>
        </dd>
        <dd><i>W</i><sub>21</sub> = <i>W<sub>U</sub></i><sub>,2</sub> - <i>W<sub>S</sub></i><sub>,2</sub>*<i>T</i>
          + <i>W<sub>V</sub></i><sub>,2</sub>*<i>P</i> &nbsp;&nbsp; <br>
        </dd>
      </dl>
    </blockquote>
    <dl>
      <dd>
        <p>Unknown coefficients in <tt>ph_cf</tt> array must be set to zero.
          For example, if you wish to have activity coefficients to be
          independent of temperature, set non-zero values only in <tt>ph_cf[0,1]</tt>
          and&nbsp;<tt>ph_cf[1,1]</tt>cells. If you set different values of of <i>W</i><sub>1</sub>
          and <i>W</i><sub>2</sub>, you will run a subregular mixing model;
          equal values of <i>W</i><sub>1</sub> and <i>W</i><sub>2</sub> result
          in a regular mixing model, and all zero values reduce it to the ideal
          mixture. </p>
      </dd>
      <dd>
        <p>A ternary regular Margules model 'T' requires four rows each of three
          coefficients according to the following equations:</p>
      </dd>
    </dl>
    <blockquote>
      <blockquote><i>W</i><sub>12</sub> = <i>W<sub>U</sub></i><sub>,12</sub> -
        <i>W<sub>S</sub></i><sub>,12</sub>*<i>T</i> + <i>W<sub>V</sub></i><sub>,12</sub>*<i>P</i>
        <br>
        <i>W</i><sub>13</sub> = <i>W<sub>U</sub></i><sub>,13</sub> - <i>W<sub>S</sub></i><sub>,13</sub>*<i>T</i>
        + <i>W<sub>V</sub></i><sub>,13</sub>*<i>P</i> <br>
        <i>W</i><sub>23</sub> = <i>W<sub>U</sub></i><sub>,23</sub> - <i>W<sub>S</sub></i><sub>,23</sub>*<i>T</i>
        + <i>W<sub>V</sub></i><sub>,23</sub>*<i>P</i> <br>
        <i>W</i><sub>123</sub> = <i>W<sub>U</sub></i><sub>,123</sub> - <i>W<sub>S</sub></i><sub>,123</sub>*<i>T</i>
        + <i>W<sub>V</sub></i><sub>,123</sub>*<i>P</i> <br>
      </blockquote>
    </blockquote>
    <dl>
      <dd>
        <p>The binary Guggenheim (Redlich - Kister) mixing model 'G' needs only
          three coefficients that (in the present implementation) should be
          entered in dimensionless form: <i>a</i>0, <i>a</i>1 and <i>a</i>2
          into <tt>ph_cf[0,0]</tt>, <tt>ph_cf[0,1]</tt> and <tt>ph_cf[0,2]</tt>cells,
          respectively. These T,P independent coefficients will be directly used
          in computing end-member activity coefficients. </p>
      </dd>
      <dd>
        <p>Mathematical details about built-in calculations can be found in the
          <b><tt>Activity-coeffs.pdf</tt></b> and&nbsp; <b><tt>Multisite-mod.pdf</tt></b>
          manuals.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
          &nbsp;&nbsp;&nbsp;</p>
      </dd>
      <dd>
        <p>Coefficients stored in the <tt>ph_cf</tt> array can be used in <a href="g_mscript.html">math
            script</a> equations for calculation of activity coefficients at the
          GEM IPM runtime by executing scripts typed in the <a href="gm_phase.html#DcEq"><tt>DcEq</tt></a>
          or <a href="gm_phase.html#PhEq"><tt>PhEq</tt></a> fields, where the <tt>ph_cf</tt>
          coefficients are accessible via the <a href="gm_phase.html#pCv"><tt>pCv</tt></a>
          hidden data object.&nbsp;</p>
      </dd>
      <dd><br>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="ipicl"></a><big><b><tt><big>ipicl</big> </tt></b></big>-
        Comments for interaction parameters entered in ipxT and ph_cf table <br>
      </dt>
      <dd>
        <p>Enter in this list short strings - comments for each interaction
          (parameter), for instance "W_12", "W_13", etc.</p>
      </dd>
      <dd><br>
      </dd>
      <dt><a name="ipxT"></a><big><big><b><tt>ipxT </tt></b></big></big>- List
        of indexation for interaction parameters of mixing models given in the <span
          style="font-family: monospace;">ph_cf</span>
        array </dt>
      <dd>
        <p>This data object was introduced in GEM-Selektor version 2.2.0 for the
          implementation of TSolMod class library of <a href="g_useref.html#P_SOLT0">built-in
            non-ideal mixing models</a>.</p>
      </dd>
      <dd>
        <p>The <big><tt>ipxT</tt></big> array has the number of rows equal to
          the number of (non-default) interaction parameters (set in <small><a
              href="#Ph_ncp_0"><big><span
                  style="font-family: monospace;">Ph_ncp[0]</span></big></a></small>
          upon remake) and columns equal to the maximum order of interaction
          parameter (set in <small><a href="#Ph_npx"><big><span style="font-family: monospace;">Ph_npx</span></big></a></small>
          upon remake), as defined by the user or set up automatically by the
          built-in mixing model.&nbsp;</p>
      </dd>
      <dd>
        <p>The index in each row of&nbsp; <span style="font-family: monospace;">ipxT</span>
          table should correspond to the interaction parameter&nbsp; in the
          respective&nbsp; row of the <span style="font-family: monospace;">ph_cf</span>
          array. For example, the ternary Margules model shown above (see
          description of&nbsp; <small><a href="#ph_cf"><big><span style="font-family: monospace;">ph_cf</span></big></a></small>
          array) would require the following <span style="font-family: monospace;">ipxT</span>
          table:</p>
      </dd>
    </dl>
    <blockquote>
      <table width="50%" cellspacing="2" cellpadding="2" border="1">
        <tbody>
          <tr>
            <td valign="top" align="center">
              <p>0</p>
            </td>
            <td valign="top" align="center">
              <p>1</p>
            </td>
            <td valign="top" align="center">
              <p>-1</p>
            </td>
          </tr>
          <tr>
            <td valign="top" align="center">
              <p>0</p>
            </td>
            <td valign="top" align="center">
              <p>2</p>
            </td>
            <td valign="top" align="center">
              <p>-1</p>
            </td>
          </tr>
          <tr>
            <td valign="top" align="center">
              <p>1</p>
            </td>
            <td valign="top" align="center">
              <p>2</p>
            </td>
            <td valign="top" align="center">
              <p>-1</p>
            </td>
          </tr>
          <tr>
            <td valign="top" align="center">
              <p>0</p>
            </td>
            <td valign="top" align="center">
              <p>1</p>
            </td>
            <td valign="top" align="center">
              <p>2</p>
            </td>
          </tr>
        </tbody>
      </table>
    </blockquote>
    <dl>
      <dd>
        <p>As the interaction parameters are symmetric (<span style="font-style: italic;">W</span><sub>12</sub>
          = <span style="font-style: italic;">W</span><sub>21</sub>; <span style="font-style: italic;">W</span><sub>123</sub>
          = <span style="font-style: italic;">W</span><sub>231</sub> = <span style="font-style: italic;">W</span><sub>312</sub>
          etc.) in such mixing models, it is sufficient to index only one of
          them, as done above. The index -1 in the last column means that there
          is no last index for this interaction parameter (i.e. binary in a
          ternary system). For multi-component mixing models such as Van Laar,
          Peng-Robinson, SIT, or Extended UNIQAC, which have only binary
          interaction parameters, it is sufficient to have only two columns in
          the <span style="font-family: monospace;">ipxT</span> table. </p>
      </dd>
      <dd>
        <p>Note that the TSolMod class library built-in functions assume that if
          some index combinations are missing from the&nbsp; <span style="font-family: monospace;">ipxT</span>&nbsp;
          (and respective coefficients from&nbsp; <span style="font-family: monospace;">ph_cf</span>)
          arrays, the respective interactions are assumed ideal and take default
          values of interaction coefficients (usually 0). This makes the setup
          of multicomponent mixing models easier. For instance, if in the above
          example, coefficients W<sub>123</sub> and W<sub>13</sub> are not known
          or assumed to be zero then the respective lines (the last and the
          second one) could be omitted from <span style="font-family: monospace;">ipxT</span>
          and <span style="font-family: monospace;">ph_cf</span> arrays, which
          would have then only two rows each.&nbsp; <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="lsMoi"></a><big><b><tt><big>lsMoi</big> </tt></b></big>-
        Names of moieties extracted from formulae of end members in the
        sublattice solid solution model <br>
      </dt>
      <dd>
        <p>This list shows the names of moieties used in this sublattice solid
          solution model. The names are collected by parsing the end-member
          formulae from the lsForm list. Note that the same moiety name found in
          a different sublattice (sites) is considered as a different moiety.
          The moiety names are shown here for better readability of the OcpN
          table. <br>
        </p>
      </dd>
      <dd>
        <p>Although this data object is not saved in Phase record, being created
          by "Calculate" of the Phase record in Database Mode, whenever
          necessary, this table shows the information which will be
          automatically passed to GEM kernel for this phase and then used in
          TSolMod calculations of mixing in GEM iterations.</p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="OcpN"></a><big><b><tt><big>OcpN</big> </tt></b></big>-
        Table of moiety - end-member occupance numbers in sublattice solid
        solution model <br>
      </dt>
      <dd>
        <p>This table is automatically created by by parsing the end-member
          formulae from the lsForm list upon "Calculate" of the Phase record. <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="lsForm"></a><big><b><tt><big>lsForm</big> </tt></b></big>-
        List of extended chemical formulae of end members in the sublattice
        solid solution model </dt>
      <dd>
        <p>This shows the extended chemical formulae of end members in the
          sublattice solid solution model, with sublattices and moieties
          indicated. The formulae are collected from the respective DComp or
          ReacDC records upon "Calculate", and can be used for cross-checking of
          the contents of OcpN table. <br>
        </p>
      </dd>
      <dd>
        <p>This data object is not saved in Phase record, it is created by
          "Calculate" of the Phase record in Database Mode, whenever necessary.
        </p>
      </dd>
      <dd> &nbsp;&nbsp; </dd>
      <dt> <a name="SCM_C"></a><big><big><b><tt>SCM_C</tt></b></big></big> -
        Classifier of SCM applied to surface patches/types {&nbsp; D C S T 3 M I
        N&nbsp; }<br>
      </dt>
      <dd>
        <p> This input data object object contains the <a href="g_useref.html#SCM_CODES">SCM
            codes</a> for each surface patch (type) on a sorption phase, e.g.
          for each crystal face. The codes must be entered by user directly
          here. Each surface patch can have an own surface complexation model,
          as given by this code. On each patch, one or more surface site types
          can be considered (via setting respective codes and site densities in
          the <a href="#MaSDj_0"><tt>MaSDj</tt></a> table). </p>
      </dd>
      <dd>
        <p>SCM codes will be automatically copied into the modelling <a href="gems_scm.html">project
            system</a> and can be edited there, if necessary.&nbsp; <br>
        </p>
      </dd>
      <dd>&nbsp; &nbsp; </dd>
      <dt> <a name="FSI_t"></a><big><big><b><tt>FSI_t</tt></b></big></big> -
        Fraction of surface patch (type) relative to &nbsp;the whole surface of
        the sorbent<br>
      </dt>
      <dd>
        <p> This input data object contains fractions of the total surface of
          the sorbent assigned to each surface type. The numbers must be entered
          by user; the total fraction may be greater or smaller than 1. The
          total &lt; 1 indicates that the remaining part of the sorbent surface
          is considered non-reactive. </p>
      </dd>
      <dd>
        <p>Surface patch fractions will be automatically copied into the
          modelling <a href="gems_scm.html">project system</a> and can be
          edited there, if necessary.</p>
      </dd>
      <dd>&nbsp;<br>
      </dd>
      <dt> <a name="MsDt_0"></a><big><big><b><tt>MsDt[0]</tt></b></big></big> -
        Common maximum density of competitive surface complexes, nm<sup>-2</sup>
        (obsolete)<br>
      </dt>
      <dd>
        <p>This input data object used in old SAT setup contains maximum density
          of surface complexes (marked as "C" in the <a href="#SAT_C_0"><tt>SAT_C[0]</tt></a>
          column) that compete for sites of the same type on the same surface
          patch (type).&nbsp;</p>
      </dd>
      <dd>
        <p>Common maximum densities will be automatically copied into the
          modelling <a href="gems_scm.html">project system</a> and can be
          edited there, if necessary.</p>
      </dd>
      <dd>&nbsp;&nbsp;&nbsp;</dd>
      <dt> <a name="MsDt_1"></a><big><b><tt>MsDt[1]</tt></b></big> - SAT FFG
        parameters (reserved) </dt>
      <dd>
        <p>This data object is reserved for future implementation of new SCMs
          and SAT equations. The cells must contain zeros in this version of
          GEMS.&nbsp;</p>
      </dd>
      <dd>&nbsp; <br>
      </dd>
      <dt> <a name="Cap_t_0"></a><big><big><b><tt>Cap_t[0]</tt></b></big></big>
        - C1 - inner EDL capacitance density parameter, F/m<sup>2</sup> (TLM,
        BSM, CCM)<br>
      </dt>
      <dd>
        <p>This input data object contains values of inner capacitance density
          C1 in F/m<sup>2</sup> for TLM, BSM and CCM for each surface type. The
          numbers must be entered by user; default is 1.0 F/m<sup>2</sup>.&nbsp;</p>
      </dd>
      <dd>
        <p>Values of C1 will be automatically copied into the modelling <a href="gems_scm.html">project
            system</a> and can be edited there, if necessary.&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="Cap_t_1"></a><big><big><b><tt>Cap_t[1]</tt></b></big></big>
        - C2 - outer EDL capacitance density parameter, F/m<sup>2</sup> (TLM);
        anion C for BSM<br>
      </dt>
      <dd>
        <p> This input data object contains values of outer capacitance density
          C2 in F/m<sup>2</sup> for TLM for each surface type. The numbers must
          be entered by user; default is 0.2 F/m<sup>2</sup> for TLM and 0 for
          other SCMs. &nbsp;</p>
      </dd>
      <dd>
        <p>Values of C2 will be automatically copied into the modelling <a href="gems_scm.html">project
            system</a> and can be edited there, if necessary.&nbsp; &nbsp; <br>
        </p>
      </dd>
      <dd>&nbsp;&nbsp; </dd>
      <dt> <a name="XfIEC"></a><big><big><b><tt>XfIEC</tt></b></big></big> -
        Density of permanent surface charge, mkeq/m<sup>2</sup> (for
        electrostatic SCMs)</dt>
      <dd>
        <p> This input data object contains values of permanent surface charge
          in mkeq/m<sup>2</sup> for for each surface type. The numbers must be
          entered by user; default is 0. Non-zero numbers must be entered for
          surface types on which the ion exchange has to be considered using the
          electrostatic SCM.&nbsp; <br>
        </p>
      </dd>
      <dd>
        <p>Values of permanent charge density will be automatically copied into
          the modelling <a href="gems_scm.html">project system</a> and can be
          edited there, if necessary. <br>
        </p>
      </dd>
      <dd>&nbsp;<br>
      </dd>
    </dl>
    <h3><a name="PHASE_DOD_REMAKE"></a>5.1. Data objects that can be modified in
      Phase wizard upon create/clone/remake only</h3>
    <p><font face="Helvetica, Arial, sans-serif"> </font></p>
    <dl>
      <dt> <a name="p_solt_0"></a><b><tt><font size="+2">p_solt[0]</font></tt></b>
        Code of phase-solution type and model of (non)ideal mixing { I M G T R V
        ... A O U N }<br>
      </dt>
      <dd>
        <p>This code defines the type of mixing and the (built-in or scripted)
          method of calculation of mixing properties and activity coefficients
          at GEM IPM iterations. It can be set in Phase wizard upon
          create/clone/remake of the Phase record.</p>
      </dd>
      <dd>
        <p>Possible codes: see <a href="g_useref.html#P_SOLT0">User's Reference</a>.
          Default code: <tt>"I"</tt>.&nbsp;</p>
      </dd>
      <dd>
        <p> In the Phase record, two dynamic text fields with math scripts ( <tt><a
              href="gm_phase.html#PhEq">PhEq</a></tt>
          and <tt><a href="gm_phase.html#DcEq">DcEq</a></tt> ) will be
          allocated, if this code is set to <tt>"R"</tt> or <tt>"U" </tt>or<tt>
            "O"</tt> values. No math scripts are necessary for other options
          (i.e. simple ideal or built-in non-ideal mixing models). &nbsp;
          &nbsp;&nbsp; &nbsp; <br>
        </p>
      </dd>
      <dt><b> <a name="p_solt_1"></a></b><tt style="font-weight: bold;"><font size="+2">p_solt[1]</font></tt>
        - Mode of calculation of the <tt>DcEq</tt> math script for end members
        { N T X } </dt>
      <dd>
        <p> This code defines how the math script expressions written by the
          user in the <tt><a href="#DcEq">DcEq</a></tt> field (Page 2 of Phase
          window) depend on <i>T,P</i> and/or current speciation (vector <tt><a
              href="gems_ipm.html#x">x</a></tt>)
          along the <a href="gems_ipm.html">GEM IPM</a> iterations, and when
          the program should calculate the script while solving for the chemical
          equilibrium state. Possible code values: {N T X} (<a href="#EXEC_MODE_DCEQ">see
            details here</a>). <br>
        </p>
      </dd>
      <dd>
        <p>The code can be set in Phase wizard upon create/clone/remake of the
          Phase record.&nbsp; </p>
      </dd>
      <dd>
        <p>If the math script is not neeced and the <tt>DcEq</tt> field must
          not be allocated, the code here must be set to <tt>"N"</tt> (default,
          "not execute") value. This is the case e.g. if a built-in mixing model
          was specified in the <tt>p_solt[0]</tt> code.&nbsp; &nbsp; </p>
      </dd>
      <dt> <a name="p_solt_2"></a><tt><b><big><big>p_solt[2]</big></big></b></tt>
        - Mode of calculation of the <tt>PhEq</tt> math script for the whole
        phase { N T X } </dt>
      <dd>
        <p>This code defines how the math script expressions written by the user
          in the <tt><a href="#PhEq">PhEq</a></tt> field (Page 3 of Phase
          window) depend on <i>T,P</i> and/or current speciation (vector <tt><a
              href="gems_ipm.html#x">x</a></tt>)
          along the <a href="glossary.html#DT_IPM">GEM IPM</a> iterations, and
          when the program should calculate the script while solving for the
          chemical equilibrium state. Possible code values: {N T X} (<a href="#EXEC_MODE_PHEQ">see
            details here</a>).&nbsp;</p>
      </dd>
      <dd>
        <p>The code can be set in Phase wizard upon create/clone/remake of the
          Phase record.</p>
      </dd>
      <dd>
        <p>If the math script is not needed and the<tt> PhEq</tt> &nbsp;field is
          not allocated, this code must be set to <tt>"N"</tt> (default, "not
          execute") value.&nbsp;This is the case e.g. if a built-in mixing model
          was specified in the <tt>p_solt[0]</tt> code. &nbsp; &nbsp; </p>
      </dd>
      <dt><a name="p_solt_3"></a><b><tt><big><big>p_solt[3]</big></big></tt></b>
        - Mode of calculation of species activity coefficients { N S I }<br>
      </dt>
      <dd>
        <p>This code defines how the activity coefficients of species in this
          phase will be calculated. Any built-in mixing model for calculation of
          activity coefficients (see <a href="#p_solt_0"><tt>p_solt[0]</tt></a>
          code field) will operate only if this code will be set to <b><tt>'S'</tt></b>
          value.&nbsp;&nbsp;</p>
      </dd>
      <dd>
        <p>The code can be set in Phase wizard upon create/clone/remake of the
          Phase record. Possible values: <a href="g_useref.html#P_SOLT3">see
            User's Reference</a>.&nbsp; </p>
      </dd>
      <dd>
        <p><u>Attention</u>: If <a href="#p_solt_0"><tt>p_solt[0]</tt></a> is
          set to <tt>"I"</tt> then this code must be also set to <tt>"I"</tt>
          value. Only systems where all solution phases have the 'S' or 'I' code
          in this field can be exported into GEMS3K input files for standalone
          coupled-code calculations. <br>
        </p>
      </dd>
      <dt> <a name="p_solt_4"></a><b><tt><big><big>p_solt[4]</big></big></tt></b>
        - Mode of linking DcEq math script equations to phase end members { N U
        P }<br>
      </dt>
      <dd>
        <p>This code defines how the math script expressions specified by the
          user in the <a href="#DcEq"><tt>DcEq</tt></a> text field (Page 2 of
          the "Phase" window) will be linked to the end-members and their
          non-ideality parameters. Please, consult the <tt><a href="gm_sdref.html">SDref</a></tt>
          library of template math scripts for Phase records to learn about the
          typical examples. Possible values: { N U P } (<a href="#LINK_MODE_DCEQ">see
details
            here</a>). Default value: 'N' (no link).&nbsp;</p>
      </dd>
      <dd>
        <p>The code can be set in Phase wizard upon create/clone/remake of the
          Phase record. </p>
      </dd>
      <dd>
        <p><u>Attention</u>: If <a href="gm_phase.html#p_solt_0"><tt>p_solt[0]</tt></a>
          is set to <tt>"I"</tt> and <a href="#p_solt_1"><tt>p_solt[1]</tt></a>
          set to <tt>"N"</tt> then this code must be also set to <tt>"N"</tt>
          value.&nbsp; </p>
      </dd>
      <dt> <a name="p_solt_5"></a><b><tt><big><big>p_solt[5]</big></big></tt></b>
        - Specific mixing rule (or form of temperature correction) for EoS and
        activity models { N W C T 5 6 8 }&nbsp; </dt>
      <dd>
        <p>This code provides additional options to some phase-solution and
          model of mixing modes selected in <a href="#p_solt_0"><tt>p_solt[0]</tt></a>,
          either defining specific mixing rule and interaction parameter format
          for non-ideal fluid models, or defining a specific form of temperature
          dependence for Pitzer aqueous model. Possible values: <a href="g_useref.html#P_SOLT5">see
            User's Reference</a>.&nbsp;</p>
      </dd>
      <dd>
        <p>The code can be set in Phase wizard upon create/clone/remake of the
          Phase record.</p>
      </dd>
      <dd>
        <p><u>Attention</u>: For phase models where these additional options are
          irrelevant, the <tt>"N"</tt> (default) code must be specified. </p>
      </dd>
      <dd>&nbsp;&nbsp; &nbsp;&nbsp; </dd>
      <dt> <a name="Ph_Ps_0"></a><big><big><b><tt>Ph_Ps[0]</tt></b></big></big>
        - Code of this phase aggregate state in the system { a g l h s d x }
        &nbsp; <br>
      </dt>
      <dd>
        <p>This code defines the standard state and the reference scale of
          concentrations for dependent components in a phase.&nbsp; It is used
          by many <a href="gems_ipm.html">IPM module subroutines</a> during
          calculation of equilibrium states. Possible values: <a href="g_useref.html#PHASESTATECODES">see
            User's Reference.</a></p>
      </dd>
      <dt> <a name="Ph_Ps_1"></a><big><big><b><tt>Ph_Ps[1]</tt></b></big></big>
        - Allocation flag for the <a href="#ph_cf"><tt>ph_cf</tt></a> array and
        <a href="#ipxT"><span style="font-family: monospace;">ipxT</span></a>
        table for interaction parameters { + * - } <br>
      </dt>
      <dd>
        <p>This flag controls allocation an optional dynamic array <a href="#ph_cf"><tt>ph_cf</tt></a>
          &nbsp;for keeping the interaction parameter coefficients, and of the <a
            href="#ipxT"><tt>ipxT</tt></a>
          list of component or moiety indices that identify the interaction in
          the TSolMod library convention.&nbsp;Default flag is off <tt>'-'.</tt></p>
      </dd>
      <dd>
        <p>Dimensions of the <tt>ph_cf</tt> array must be set in the <a href="#Ph_ncp"><tt>Ph_ncp</tt></a>
          cells, and the maximum order of interaction (number of columns) for
          the <tt>ipxT</tt> list must be set in <small><a href="gm_phase.html#Ph_npx"><big><span
                  style="font-family: monospace;">Ph_npx</span></big></a></small>
          upon remake. The user must enter the data in <tt>ph_cf</tt> array and
          into the <tt>ipxT</tt> list. <br>
        </p>
      </dd>
      <dt> <a name="Ph_Ps_2"></a><big><big><b><tt>Ph_Ps[2]</tt></b></big></big>
        - Allocation flag for the <a href="#dc_cf"><tt>dc_cf</tt></a> array for
        phase component properties { + * - } </dt>
      <dd>
        <p>This flag controls allocation of an optional dynamic array <a href="#dc_cf"><tt>dc_cf</tt></a>
          &nbsp;for keeping properties of individual phase components to be used
          in built-in mixing models or in the math scripts provided in <a href="#DcEq"><tt>DcEq</tt></a>
          or <a href="#PhEq"><tt>PhEq</tt></a> fields.&nbsp;</p>
      </dd>
      <dd>
        <p>Dimensions of the <a href="#dc_cf"><tt>dc_cf</tt></a> array (only
          number of coefficients per species M)&nbsp; <a href="#Ph_nsc"><tt>Ph_nsc</tt></a>
          field must be set up in the Phase wizard upon create/clone/remake. The
          user must enter the data into dc_cf array. Default flag is off <tt>'-'</tt>.</p>
      </dd>
      <dd>
        <p><b>Note:</b> In certain cases, the program will sample the component
          properties from DComp or ReacDC records upon re-calculation of the
          Phase record. </p>
      </dd>
      <dt> <a name="Ph_Ps_3"></a><big><big><b><tt>Ph_Ps[3]</tt></b></big></big>
        - Allocation flag for the math script <a href="#PhEq"><tt>PhEq</tt></a>
        field { + * - } <br>
      </dt>
      <dd>
        <p>If this flag is set (in Phase wizard) to&nbsp; '<tt>+</tt>'&nbsp; or
          '<tt>*</tt>'&nbsp; then the <a href="#PhEq"><tt>PhEq</tt></a> text
          field will be allocated, where the user can specify a <a href="gmscript.html">math
            script</a> with equations for the whole phase. Default flag is off <tt>'-'</tt>.</p>
      </dd>
      <dt> <a name="Ph_Ps_4"></a><tt><big><big><b>Ph_Ps[4]</b></big></big></tt>
        - Allocation flag for the&nbsp; math script <a href="#DcEq"><tt>DcEq</tt></a>
        field { + * - } </dt>
      <dd>
        <p>If this flag is set (in Phase wizard) to '<tt>+</tt>' or '<tt>*</tt>'
          then the <a href="#DcEq"><tt>DcEq</tt></a> text field will be
          allocated, where the user can enter a <a href="gmscript.html">math
            script</a> with equations for calculation of species activity
          coefficients. Default flag is off <tt>'-'</tt>.</p>
      </dd>
      <dt> <a name="Ph_Ps_5"></a><big><big><b><tt>Ph_Ps[5]</tt></b></big></big>
        - Allocation flag for surface type - related data objects { + * - } <br>
      </dt>
      <dd>
        <p>This flag must be set on ( '+' or '*' ) using Phase wizard in order
          to define a sorption phase with surface species. If the flag is on
          then <tt><a href="#SCM_C">SCM_C</a>,<a href="#FSI_t">FSI_t</a>, <a href="#MsDt_0">MsDT</a>,
            <a href="#Cap_t_0">Cap_t</a> </tt>and <a href="#XfIEC"><tt>XfIEC</tt></a>
          data objects (visible in the "Phase" window) will be allocated. Each
          of these objects will have the number of rows specified in the <a href="#Ph_nsi_0"><tt>Ph_nsi</tt></a>
          &nbsp;field. In addition, the data objects <a href="#SAT_C_0"><tt>SAT_C</tt></a>
          and <a href="#MaSDj"><tt>MaSDj</tt></a> will be allocated. Default
          flag is off <tt>'-'</tt>.&nbsp; </p>
        &nbsp; </dd>
      <dt> <a name="Ph_Nc_0"></a><big><big><b><tt>Ph_Nc[0]</tt></b></big></big>
        - Number of Dependent Components (species) in this phase definition <br>
      </dt>
      <dd>
        <p>This number will be automatically calculated after the user has
          selected ReacDC/DComp records to be linked into this Phase definition.
          This selection occurs after finishing the Phase wizard.&nbsp; Upon
          clone/remake, previously selected phase components will be
          automatically marked in the ReacDC/DComp record list.</p>
        &nbsp; </dd>
      <dt> <a name="Ph_Nc_1"></a><big><big><b><tt>Ph_Nc[1]</tt></b></big></big>
        - Number of references to Data Sources <br>
      </dt>
      <dd>
        <p>Shows the number of references to data sources visible in optional
          lists <a href="#pSDref"><tt>pDSref</tt></a> and <a href="#pSDval"><tt>pSDval</tt></a>.
          This number can be changed in Phase Wizard upon remake. Default value
          is 0 (the SDref key lists not available). </p>
        &nbsp;&nbsp; </dd>
      <dt> <a name="Ph_ncp"></a><big><b><big><tt>Ph_ncp</tt></big></b></big> -
        Number of rows in <a href="#ph_cf"><tt>ph_cf</tt></a> data array and
        in&nbsp;<a href="#ipxT"><span style="font-family: monospace;">ipxT</span></a>&nbsp;
index
        list; number of columns in <tt>ph_cf</tt> data array. <br>
      </dt>
      <dd>
        <p>Shows the number of rows (first cell) and columns (second cell) of
          the optional <a href="#ph_cf"><tt>ph_cf</tt></a> array (to appear on
          Page 3 of the Phase window); if both non-zero then the <a href="#Ph_Ps_1"><tt>Ph_Ps[1]</tt></a>
          flag is also set on. The number of rows in <tt>ph_cf</tt> is also the
          number of rows in <tt>ipxT</tt> index list. <br>
        </p>
      </dd>
      <dd>
        <p>These dimensions can be reset in Phase wizard upon
          create/clone/remake of the Phase record. For some built - in
          calculation modes (see code in <a href="file:///Users/kulik/DevGEMS/trunk/gems-gui/Resources/doc/html/gm_phase.html#p_solt_0"><tt>&nbsp;p_solt[0]</tt></a>
          field) conforming to TSolMod class specifications, the number of
          columns will be set automatically. The number of rows&nbsp; in <span
            style="font-family: monospace;">ph_cf</span>&nbsp;
          array is also the number of&nbsp; rows in the <a href="#ipxT"><span style="font-family: monospace;">ipxT</span></a>
          array. </p>
      </dd>
      <dd>
        <p>Default values are 0 (the <a href="#ph_cf"><tt>ph_cf</tt></a> array
          and ipxT list not available).</p>
      </dd>
      <dd>&nbsp; </dd>
      <dt> <a name="Ph_npx"></a><big><big><b><tt>Ph_npx</tt></b></big>&nbsp; </big>-&nbsp;
        Number of columns (max. order of interaction parameter) in <a href="#ipxT"><span
            style="font-family: monospace;">ipxT</span></a>
        index lis </dt>
      <dd>
        <p> Shows the number of columns in the <a href="#ipxT"><span style="font-family: monospace;">ipxT</span></a>
          parameter indexation list, which corresponds to the maximum order of
          used parameters. For instance, set 2 if only binary parameters are
          used in the multi-component mixing model. Some built-in mixing models
          (see code in <a href="gm_phase.html#p_solt_0"><tt>p_solt[0]</tt></a>
          field) conforming to <a href="#PHASE_INTPAR">TSolMod specifications</a>
          set this dimension automatically. The number of rows in the <a href="#ipxT"><span
              style="font-family: monospace;">ipxT</span></a>
          table is the same as in the <a href="#ph_cf"><span style="font-family: monospace;">ph_cf</span></a>
          array. Dimensions can be reset in the Phase wizard upon clone/remake
          of Phase record. </p>
      </dd>
      <dd> Default value is 0 (the <span style="font-family: monospace;">ipxT</span>
        list not available).<br>
        &nbsp; &nbsp;</dd>
      <dd>&nbsp;&nbsp; </dd>
      <dt> <a name="Ph_nsc"></a><big><big><b><tt>Ph_nsc</tt></b></big></big> -
        Number of columns (properties and coefficients per end member) in the <a
          href="#dc_cf"><tt>dc_cf</tt></a>
        array<br>
      </dt>
      <dd><br>
      </dd>
      <dd>Shows the number of columns of the optional <a href="#dc_cf"><tt>dc_cf</tt></a>
        array (the <a href="#Ph_Ps_2"><tt>Ph_Ps[2]</tt></a> flag must be also
        set on). The number of rows in <tt>dc_cf</tt> is given in the <a href="#Ph_Nc_0"><tt>Ph_Nc[0]</tt></a>
        cell. Dimensions can be changed in Phase wizard upon remake. In some
        built - in calculation modes, these dimensions will be set
        automatically, depending on the code in &nbsp;<a href="#p_solt_0"><tt>p_solt[0]</tt></a>
        field.&nbsp;&nbsp;</dd>
      <dd>&nbsp; <br>
      </dd>
      <dd>Default value is 0 (the <a href="#dc_cf"><tt>dc_cf</tt></a> array
        will not be available). </dd>
      <dd>&nbsp;&nbsp; <br>
        &nbsp;&nbsp; </dd>
      <dt> <a name="Ph_nsi_0"></a><big><big><b><tt>Ph_nsi[0]</tt></b></big></big>
        - Number of active surface patches/types (1 to 6, sorption phases only)
        <br>
      </dt>
      <dd>
        <p>Shows number of surface types (minimum 1, maximum 6) defining how
          many surface patches (types) will be considered (and how many rows
          will be allocated in <tt><a href="#SCM_C">SCM_C</a>, <a href="#FSI_t">FSI_t</a>,
            <a href="#MsDt_0">MsDT</a>, <a href="#Cap_t_0">Cap_t</a> </tt>and
          <a href="#XfIEC"><tt>XfIEC</tt></a> data objects). The <a href="#Ph_Ps_5"><tt>Ph_Ps[5]</tt></a>
          flag must also be set on in the case of sorption phase with surface
          complexation. Number of surface types can be changed in Phase wizard
          upon remake.<br>
        </p>
      </dd>
      <dd>
        <p>&nbsp;This cell must contain 0 (default) for all phase types except
          sorption phase (code 'A' in <a href="#p_solt_0">p_solt[0]</a>).&nbsp;
        </p>
        &nbsp; </dd>
      <dt> <a name="Ph_nsi_1"></a><big><big><b><tt>Ph_nsi[1]</tt></b></big></big>
        - Number of different substituting moieties in the multi-site mixing
        model (0: simple mixing)</dt>
      <dd>
        <p>Contains the number of different moieties (ions, atoms, etc.) that
          can substitute each other on structural sites of the sublattice
          (multisite) model of mixing.&nbsp; Note that the same stoichiometry
          (e.g. {Fe} substituting in two different sites is considered as two
          different moieties. This dimension is automatically computed by
          analyzing DC formulae when the Phase record is re-calculated.</p>
      </dd>
      <dd>
        <p>Default value (for models other than the multi-site mixing) is
          0.&nbsp;</p>
      </dd>
    </dl>
    <br>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h3><a name="PHASE_DOD_SORPMOD"></a>5.2. Data objects for isolated
      (ad)sorption and ion exchange models (TSorpMod parameters)</h3>
    This section is under construction (will appear later).<br>
    <br>
    <dl>
      <dt> <a name="kin_t_0"></a><b><tt><font size="+2">kin_t[0]</font></tt></b>
        - Type code of adsorption/ ion exchange/ polyelectrolyte isotherm model
        { N&nbsp; }<br>
      </dt>
      <dd>
        <p>This code defines the .</p>
      </dd>
      <dd>
        <p>Possible codes: see <a href="g_useref.html#P_SOLT0">User's Reference</a>.
          Default code: <tt>"I"</tt>.&nbsp;</p>
      </dd>
      <dd>
        <p> In the Phase record,&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; <br>
        </p>
      </dd>
      <dt><b> <a name="kin_t_1"></a></b><tt style="font-weight: bold;"><font size="+2">kin_t[1]</font></tt>
        - Type code of the sorption Electric Iinterface Layer (EIL,
        electrostatic) model { N&nbsp;&nbsp; }_ </dt>
      <dd>
        <p> This code defines how the <br>
        </p>
      </dd>
      <dd>
        <p>The code can be set in Phase wizard upon create/clone/remake of the
          Phase record.&nbsp; </p>
      </dd>
      <dd>
        <p>If the .&nbsp; &nbsp; </p>
      </dd>
    </dl>
    <br>
    TBD<br>
    <br>
    <br>
    <hr width="100%" size="2">
    <h3><a name="PHASE_DOD_KINMET"></a>5.3. Data objects for metastability and
      kinetics (TKinMet parameters)</h3>
    <br>
    <dl>
      <dt> <a name="kin_t_2"></a><b><tt><font size="+2">kin_t[2]</font></tt></b>
        - Type code of mineral-aqueous/gas reaction kinetic rate model&nbsp; { N
        M U X A P }<br>
      </dt>
      <dd>
        <p>This code configures the mineral-aqueous or mineral-gas reaction
          kinetics model. The code can be set in Phase wizard upon create/
          clone/ remake of the Phase record.</p>
      </dd>
      <dd>
        <p>Possible codes: see <a href="g_useref.html#P_KINUPTT1">User's
            Reference</a>. Default code: <tt>"N"</tt>, kinetics disabled.
          &nbsp;</p>
      </dd>
      <dd>
        <p> ...&nbsp; &nbsp; &nbsp;&nbsp; <br>
        </p>
      </dd>
      <dt><b> <a name="kin_t_3"></a></b><tt style="font-weight: bold;"><font size="+2">kin_t[3]</font></tt>
        - Type code of the particular form of kinetic model { N T P W U } </dt>
      <dd>
        <p>This code defines a particular form of the kinetic model.&nbsp; If
          the previous code (kin_t[2] ) is set to 'N', this code will be
          ignored. <br>
        </p>
      </dd>
      <dd>
        <p>Possible codes: see <a href="g_useref.html#P_KINUPTT2">User's
            Reference</a>. The code can be set in Phase wizard upon create/
          clone/ remake of the Phase record.&nbsp; </p>
      </dd>
      <dd>
        <p>Default code: 'N' (disabled).</p>
      </dd>
      <dd>
        <p>...&nbsp; &nbsp; </p>
      </dd>
      <dt> <a name="kin_t_4"></a><tt><b><big><big>kin_t[4]</big></big></b></tt>
        - Type code of the uptake/sorption kinetics model (solution/sorption
        phases only) { N E M G F L I P } </dt>
      <dd>
        <p>This code defines a particular form of the uptake kinetics
          model.&nbsp;</p>
      </dd>
      <dd>
        <p>Possible codes: see <a href="g_useref.html#P_KINUPTT3">User's
            Reference</a>. The code can be set in Phase wizard upon
          create/clone/remake of the Phase record.</p>
      </dd>
      <dd>
        <p>If the previous code (kin_t[2] ) is set to 'N', this code will be
          ignored.</p>
      </dd>
      <dd>
        <p>Default code: 'N' (disabled).</p>
      </dd>
      <dd>
        <p>...<br>
        </p>
      </dd>
      <dt><a name="kin_t_5"></a><b><tt><big><big>kin_t[5]</big></big></tt></b> -
        Type code of metastability links of this phase to other phases { N S P M
        }<br>
      </dt>
      <dd>
        <p>This code defines whether and how this phase is linked to another
          (carrier, seed, or sorbent) phase. <br>
        </p>
      </dd>
      <dd>
        <p>The code can be set in Phase wizard upon create/clone/remake of the
          Phase record. Possible values: <a href="g_useref.html#P_KINUPTT4">see
            User's Reference</a>.&nbsp; </p>
      </dd>
      <dd>
        <p>Default code: 'N', no links.</p>
      </dd>
      <dd>
        <p>... <br>
        </p>
      </dd>
      <dt> <a name="kin_t_6"></a><b><tt><big><big>kin_t[6]</big></big></tt></b>
        - Type code of particle/pore size distribution and specific surface area
        correction { N U B F }<br>
      </dt>
      <dd>
        <p>This code defines how the specific surface area is corrected for
          particle growth or dissolution. <br>
        </p>
      </dd>
      <dd>
        <p>Possible codes: see <a href="g_useref.html#P_KINUPTT5">User's
            Reference</a>. The code can be set in Phase wizard upon
          create/clone/remake of the Phase record. </p>
      </dd>
      <dd>
        <p>Default code 'N', no corrections.</p>
      </dd>
      <dd>
        <p>... &nbsp; <br>
        </p>
      </dd>
      <dt> <a name="kin_t_7"></a><b><tt><big><big>kin_t[7]</big></big></tt></b>
        - Codes of the rate scaling model (reserved)&nbsp;<br>
      </dt>
      <dd>
        <p>This code selects the basis to which the rate constants are scaled
          for this phase. Possible values: <a href="g_useref.html#P_KINUPTT6">see
            User's Reference</a>.&nbsp;</p>
      </dd>
      <dd>
        <p>The code can be set in Phase wizard upon create/clone/remake of the
          Phase record.</p>
      </dd>
      <dd>
        <p>Default value: 'N'.</p>
      </dd>
      <dd>
        <p>... </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="lPh"></a><big><b><tt><big>lPh</big> </tt></b></big>- List
        of record keys of linked phases <br>
      </dt>
      <dd>
        <p>This list contains one or more record keys of linked phases that has
          been selected in Phase Wizard upon remake.&nbsp; When the modeling
          project is opened, these record keys will be converted into phase
          indexes in the chemical thermodynamic system. <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="lPhC"></a><big><b><tt><big>lPhC</big> </tt></b></big>-
        Phase linkage type codes<br>
      </dt>
      <dd>
        <p>The Phase linkage type code shows how the current phase is linked to
          another phase (with key visible in lPh row to the left). <br>
        </p>
      </dd>
      <dd>
        <p>Possible values:&nbsp; 0 - the link is deactivated</p>
      </dd>
      <dd>
        <p>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
          1 - metastability constraints for this phase are linked to the surface
          area of the phase where this links points to (default);</p>
      </dd>
      <dd>
        <p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp; 2 - TBD</p>
      </dd>
      <dd>
        <p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp; 3 - TBD.</p>
      </dd>
      <dd>
        <p>The respective property of the phase to which this phase is linked to
          must have non-zero value during calculation of equilibrium state.</p>
      </dd>
      <dd>
        <p><br>
        </p>
      </dd>
      <dt> <a name="lPhc"></a><big><b><tt><big>lPhc</big> </tt></b></big>-
        Array of phase linkage parameters<br>
      </dt>
      <dd>
        <p>In this table, phase linkage parameters must be entered (one row per
          phase link).</p>
      </dd>
      <dd>
        <p>At present, only one parameter is used for phase linkage type code 1
          (see lPhC): a fraction of surface area of the "seed" or "carrier"
          solid phase to define the kinetic rates for this "overgrowth"phase
          (default value: 1).</p>
      </dd>
      <dd>
        <p>Other coefficients: TBD.<br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="ocPRk"></a><big><b><tt><big>ocPRk</big> </tt></b></big>-
        Operation codes for kinetic 'parallel reaction' affinity terms <br>
      </dt>
      <dd>
        <p>This array contains two input codes for each parallel reaction (row).
          <br>
        </p>
      </dd>
      <dd>
        <p>The first code (integer number) allows the user to select a
          particular form of the affinity term to be used in the rate law for
          this parallel reaction (see <span style="font-family: monospace;">Kinetics</span><tt>-uptake.pdf</tt>
          file for detailed equations). The main part of the affinity term is
          the phase stability index <span style="font-style: italic;">O</span>,
          automatically computed by GEM algorithm (see Falp). <br>
        </p>
      </dd>
      <dd>
        <p>Each term has one or more parameters <span style="font-style: italic;">q</span>,
          <span style="font-style: italic;">m</span> and <span style="font-style: italic;">u</span>,
          which can be set in the respective positions in the <a href="#rpCon">rpCon</a>
          table. Power coefficients <span style="font-style: italic;">q</span>,
          <span style="font-style: italic;">m</span>, and <span style="font-style: italic;">u</span>,
          if set to 0 (default), disable the respective parts of the affinity
          term by setting it to 1. <br>
        </p>
      </dd>
      <dd>
        <p>Possible codes:&nbsp; <br>
        </p>
      </dd>
      <dd>
        <table style="text-align: left; width: 90%;" cellspacing="2" cellpadding="2"
          border="1">
          <tbody>
            <tr>
              <td style="vertical-align: top;">Code<br>
              </td>
              <td style="vertical-align: top;">Form<br>
              </td>
              <td style="vertical-align: top;">Explanation<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">0<br>
              </td>
              <td style="vertical-align: top;">(<span style="font-style: italic;">u</span>+1-<span
                  style="font-style: italic;">O</span>^<span
                  style="font-style: italic;">q</span>)^<span
                  style="font-style: italic;">m</span><br>
              </td>
              <td style="vertical-align: top;">Classic TST affinity term
                (default);</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">1<br>
              </td>
              <td style="vertical-align: top;">(<span style="font-style: italic;">O</span>^<span
                  style="font-style: italic;">q</span>-1-<span
                  style="font-style: italic;">u</span>)^<span
                  style="font-style: italic;">m</span><br>
              </td>
              <td style="vertical-align: top;">Classic TST affinity term,
                reversed</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">2<br>
              </td>
              <td style="vertical-align: top;">exp(-<span style="font-style: italic;">m</span>/<span
                  style="font-style: italic;">O</span>)<br>
              </td>
              <td style="vertical-align: top;">Affinity term from Schott et al.
                (2012), Fig. 1e</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">3<br>
              </td>
              <td style="vertical-align: top;">1-exp(-(<span style="font-style: italic;">q</span>
                ln<span style="font-style: italic;">O</span>)^<span style="font-style: italic;">m</span>)<br>
              </td>
              <td style="vertical-align: top;">Affinity term from Hellmann &amp;
                Tisserand (2006), eq 9</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">4<br>
              </td>
              <td style="vertical-align: top;"><span style="font-style: italic;">m
                </span>(<span style="font-style: italic;">O</span>-1) ln<span style="font-style: italic;">O</span><br>
              </td>
              <td style="vertical-align: top;">Affinity term from Teng et al.
                (2000), eq.13</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">5<br>
              </td>
              <td style="vertical-align: top;"><span style="font-style: italic;">O</span>^<span
                  style="font-style: italic;">m</span><br>
              </td>
              <td style="vertical-align: top;">Affinity term from Teng et al.
                (2000), Fig.6</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">6<br>
              </td>
              <td style="vertical-align: top;">(<span style="font-style: italic;">O</span>
                - <span style="font-style: italic;">O_n</span>)^<span style="font-style: italic;">m</span><br>
              </td>
              <td style="vertical-align: top;">Nucleation affinity term from
                Fritz et al. (2009), eq 6 (TBD)</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">7<br>
              </td>
              <td style="vertical-align: top;"><br>
              </td>
              <td style="vertical-align: top;">TBD</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">8<br>
              </td>
              <td style="vertical-align: top;"><br>
              </td>
              <td style="vertical-align: top;">TBD<br>
              </td>
            </tr>
          </tbody>
        </table>
      </dd>
      <dd><br>
      </dd>
      <dd>
        <p>The code in the second column of this array should be set to 0
          (reserved for future development). <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="feSAr"></a><big><b><tt><big>feSAr</big> </tt></b></big>-
        Fractions of surface area of the solid related to different parallel
        reactions <br>
      </dt>
      <dd>
        <p>Here, the (initial) fraction of surface area related to this parallel
          reaction can be changed. Default value is 1.0; allowed values are
          greater than 0 and less than or equal to 1. If this parameter is set
          to 0, the parallel reaction is disabled. <br>
        </p>
      </dd>
      <dd>
        <p>This parameter can be changed later on by the process simulator or
          the transport code as function of time and other parameters of the
          system. <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="rpCon"></a><big><b><tt><big>rpCon</big> </tt></b></big>-
        Array of kinetic rate constants for particle faces or for parallel
        reactions <br>
      </dt>
      <dd>
        <p>This table contains as many rows as there should be parallel
          reactions in the overall kinetic rate model for this phase, and 14
          columns, where the rate model parameters should be entered for each
          parallel reaction (row) in the following order:</p>
      </dd>
      <dd>
        <table style="text-align: left; width: 90%;" cellspacing="2" cellpadding="2"
          border="1">
          <tbody>
            <tr>
              <td style="vertical-align: top;">Index<br>
              </td>
              <td style="vertical-align: top;">Symbol<br>
              </td>
              <td style="vertical-align: top;">Desription<br>
              </td>
              <td style="vertical-align: top;">Default<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">0<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">k<sup>o</sup><br>
              </td>
              <td style="vertical-align: top;">Standard-temperature net rate
                constant (in mol/m2/s)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">1<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">K<sup>o</sup><br>
              </td>
              <td style="vertical-align: top;">Standard-temperature gross rate
                constant (in mol/m2/s)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">2<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">A<br>
              </td>
              <td style="vertical-align: top;">Arrhenius factor <br>
              </td>
              <td style="vertical-align: top;">1<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">3<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">E<br>
              </td>
              <td style="vertical-align: top;">Activation energy (J/mol)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">4<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">b_I<br>
              </td>
              <td style="vertical-align: top;">Empirical power parameter related
                to ionic strength <span style="font-style: italic;">I</span>&nbsp;
                (term <span style="font-style: italic;">I</span>^<span style="font-style: italic;">b_I</span>)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">5<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">b_pH<br>
              </td>
              <td style="vertical-align: top;">Empirical power parameter related
                to pH (term pH^b_pH)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">6<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">b_pe<br>
              </td>
              <td style="vertical-align: top;">Empirical power parameter related
                to pe (term pe^b_pe)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">7<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">b_Eh<br>
              </td>
              <td style="vertical-align: top;">Empirical power parameter related
                to Eh (term Eh^b_Eh)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">8<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">p<br>
              </td>
              <td style="vertical-align: top;">«Reaction order» power parameter
                for the whole activity product term (in far-from-equilibrium
                case), see the <a href="#apCon">apCon</a> table for other
                activity parameters <br>
              </td>
              <td style="vertical-align: top;">1<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">9<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">q<br>
              </td>
              <td style="vertical-align: top;">Power parameter at the stability
                index in the affinity term <br>
              </td>
              <td style="vertical-align: top;">1<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">10<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">m<br>
              </td>
              <td style="vertical-align: top;">Empirical power parameter in the
                affinity term<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">11<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">u<br>
              </td>
              <td style="vertical-align: top;">Power parameter or constant in
                the affinity term <br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">12<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">O_n<br>
              </td>
              <td style="vertical-align: top;">«Effective» saturation index for
                nucleation affinity term <br>
              </td>
              <td style="vertical-align: top;">1<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">13<br>
              </td>
              <td style="vertical-align: top; font-style: italic;">q_n<br>
              </td>
              <td style="vertical-align: top;">Reserved parameter for nucleation
                (TBD)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
          </tbody>
        </table>
        <p>These parameters apply to general TST rate equation (1.1) as desribed
          in the <span style="font-family: monospace;">Kinetics</span><tt>-uptake.pdf</tt>
          file. Typically, most parameters can be left at their default values,
          which disable the respective terms in eq (1.1).</p>
      </dd>
      <dd>I<span style="font-weight: bold;">mportant: </span>Sign convention
        for the net <span style="font-style: italic;">k</span><sup style="font-style: italic;">o</sup>
        und gross K<sup>o</sup> rate constants:</dd>
      <dd><br>
      </dd>
      <dd>
        <table style="text-align: left; width: 693px; height: 52px;" cellspacing="2"
          cellpadding="2"
          border="1">
          <tbody>
            <tr>
              <td style="vertical-align: top;">&gt; 0 (positive)<br>
              </td>
              <td style="vertical-align: top;">Dissolution, decrease<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">&lt; 0 (negative)<br>
              </td>
              <td style="vertical-align: top;">Precipitation, nucleation, growth
                (increase)<br>
              </td>
            </tr>
          </tbody>
        </table>
        <p>If two or more parallel reactions are provided (e.g. one for
          dissolution, another for growth), the program will choose the
          appropriate one depending on the value of the phase stability index
          lgOm: the former if lgOm &lt; 0.001 and the latter if lgOm &gt; 0.001.
          This makes it possible to use the same phase definition in all
          possible cases, depending on the changing conditions in the system.
          More specific rules:</p>
      </dd>
      <dd>
        <p>If the net rate constant is 0 and gross rate constant is not 0 then
          the gross rate constant will be used, and vice versa. If both are not
          0 then the net rate constant will be used. If the net rate constant is
          positive and phase stability index lgOm&nbsp; &lt; -0.001
          (dissolution) then this net rate constant will be used, but if
          lgOm&nbsp; &gt; 0.001 (precipitation) then this parallel reaction
          term will be skipped. If the net rate constant is negative and phase
          stability index lgOm&nbsp; &gt; 0.001 (precipitation) then the
          absolute value of this rate constant will be used, but if lgOm&nbsp;
          &lt; -0.001 (dissolution) then this parallel reaction term will be
          skipped.</p>
      </dd>
      <dd>
        <p>Priority: if both rate constants are given as non-zero values, only
          the net rate constant <span style="font-style: italic;">k</span><sup
            style="font-style: italic;">o</sup>
          will be used. </p>
      </dd>
      <dd>.</dd>
      <dd> &nbsp;</dd>
      <dt> <a name="rprcl"></a><big><b><tt><big>rprcl</big> </tt></b></big>-
        Kinetic parallel reactions comment list <br>
      </dt>
      <dd>
        <p>It is desirable to put here a short comment for each parallel
          reaction, for instance: <br>
        </p>
      </dd>
      <dd>
        <table style="text-align: left; width: 202px; height: 76px;" cellspacing="2"
          cellpadding="2"
          border="1">
          <tbody>
            <tr>
              <td style="vertical-align: top;">Dissol.low.pH</td>
            </tr>
            <tr>
              <td style="vertical-align: top;">Precip.low.pH</td>
            </tr>
            <tr>
              <td style="vertical-align: top;"><br>
              </td>
            </tr>
          </tbody>
        </table>
      </dd>
      <dd>
        <p>and so on. This greatly improves the readability of the phase
          definition. <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="rpkcl"></a><big><b><tt><big>rpkcl</big> </tt></b></big>-
        Kinetic rate parameters comment list <br>
      </dt>
      <dd>
        <p>It is desirable to put here a short comment for each rate parameter,
          for instance:</p>
      </dd>
      <dd>
        <table style="text-align: left; width: 745px; height: 28px;" cellspacing="2"
          cellpadding="2"
          border="1">
          <tbody>
            <tr>
              <td style="vertical-align: top;">ko<br>
              </td>
              <td style="vertical-align: top;">Ko<br>
              </td>
              <td style="vertical-align: top;">Af<br>
              </td>
              <td style="vertical-align: top;">Ea<br>
              </td>
              <td style="vertical-align: top;">bI<br>
              </td>
              <td style="vertical-align: top;">bpH<br>
              </td>
              <td style="vertical-align: top;">bpE<br>
              </td>
              <td style="vertical-align: top;">bEh<br>
              </td>
              <td style="vertical-align: top;">p<br>
              </td>
              <td style="vertical-align: top;">q<br>
              </td>
              <td style="vertical-align: top;">m<br>
              </td>
              <td style="vertical-align: top;">u<br>
              </td>
              <td style="vertical-align: top;">Onucl<br>
              </td>
              <td style="vertical-align: top;">qn<br>
              </td>
            </tr>
          </tbody>
        </table>
        <br>
      </dd>
      <dd>This greatly improves the readability of the phase definition.</dd>
      <dd>
        <p>.&nbsp;&nbsp;</p>
      </dd>
      <dt> <a name="lDCr"></a><big><b><tt><big>lDCr</big> </tt></b></big>-
        List of record keys of species involved in activity product terms for
        parallel reactions <br>
      </dt>
      <dd>
        <p>In this implementation of kinetic rate calculations, a common list of
          species is used in activity product terms for all parallel reactions.
          Unused species are simply disabled by setting the respective power
          (stoichiometry) coefficient to 0 (default). <br>
        </p>
      </dd>
      <dd>
        <p>Aqueous or gaseous species can be selected for this list after the
          Phase Wizard is finished. If nothing was selected, the activity
          product terms will be disabled in all parallel reactions (generic
          terms such as pH^bpH still remain active). Upon opening of the
          modeling project, the record keys from this list will be automatically
          converted into the indexes of respective species in the system
          definition. <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="lDCd"></a><big><b><tt><big>lDCd</big> </tt></b></big>-
        Location of source records for species involved in activity product
        terms <br>
      </dt>
      <dd>
        <p>This column is created automatically to point where the source
          records for each species is located: 'r' (ReacDC) or 'd' (DComp)
          record.</p>
      </dd>
      <dd>
        <p>There is no need to edit this information. <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="apCon"></a><big><b><tt><big>apCon</big> </tt></b></big>-
        Array of parameters per species involved in activity product terms <br>
      </dt>
      <dd>
        <p>This array presently has a row per each parallel reaction and as many
          columns as there were species selected in the lDCr list. <br>
        </p>
      </dd>
      <dd>
        <p>Enter in each cell in the row the power coefficient b_j (0 is the
          default) for the respective j-th species whose activity appears in the
          activity product (see eq (1.2) in the <span style="font-family: monospace;">Kinetics</span><tt>-uptake.pdf</tt>
          file). <br>
        </p>
      </dd>
      <dd>
        <p>b_j is usually a species stoichiometry coefficient in the parallel
          reaction (can also be treated as empirical parameter having
          non-integer value). Setting b_j = 0 disables the contribution of the
          respective species activity to eq (1.2) for a given parallel reaction.
          These activities are taken from GEM output.&nbsp; <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="Ascp"></a><big><b><tt><big>Ascp</big> </tt></b></big>-
        Parameter coefficients for corrections of specific surface area for
        growth or dissolution <br>
      </dt>
      <dd>
        <p>This array contains at least one parameter which is the shape factor
          in equation&nbsp; (1.4) for correcting the specific surface area of a
          particulate phase for growth or dissolution, assuming uniform particle
          size.</p>
      </dd>
      <dd>
        <p>Default value of the shape factor is 1 (spherical particles).&nbsp; <br>
        </p>
      </dd>
      <dd>
        <p>More corrections to be implemented. <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="lICu"></a><big><b><tt><big>lICu</big> </tt></b></big>-
        List of names of Independent Components characteristic for end members <br>
      </dt>
      <dd>
        <p>In the uptake kinetic models, each end member of the phase must be
          associated with its "characteristic" chemical element. This is
          straightforward for simple cases such as Cd uptake in calcite: Cd is
          associated with the CdCO3 end member, and Ca with the (host) CaCO3 end
          member. However, this becomes non-trivial if the end members have
          complex stoichiometry. For that reason, the user must type in a symbol
          of "characteristic" Independent Component against each end member.</p>
      </dd>
      <dd>
        <p>Default value is "Elem", but, if not changed, will result in
          errors.&nbsp; <br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="umpCon"></a><big><b><tt><big>umpCon</big> </tt></b></big>-
        Array of uptake kinetics model parameters <br>
      </dt>
      <dd>
        <p>This table contains a row per each end member, which currently holds
          6 parameters of the "unified uptake kinetics" model (Thien et al.,
          2013) as described by eq (2.7) inthe <span style="font-family: monospace;">Kinetics</span><tt>-uptake.pdf</tt>
          file. These parameters go in the following order:</p>
      </dd>
      <dd>
        <table style="text-align: left; width: 90%;" cellspacing="2" cellpadding="2"
          border="1">
          <tbody>
            <tr>
              <td style="vertical-align: top;">Index<br>
              </td>
              <td style="vertical-align: top;">Symbol<br>
              </td>
              <td style="vertical-align: top;">Description<br>
              </td>
              <td style="vertical-align: top;">Default<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">0<br>
              </td>
              <td style="vertical-align: top;"><span style="font-style: italic;">F</span><br>
              </td>
              <td style="vertical-align: top;">Surface enrichment (&gt;1) or
                depletion (&lt;1) factor of the characteristic element relative
                to the host element<br>
              </td>
              <td style="vertical-align: top;">1<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">1<br>
              </td>
              <td style="vertical-align: top;"><span style="font-style: italic;">Del</span>0<br>
              </td>
              <td style="vertical-align: top;">Equilibrium fractionation
                (distribution) coefficient of the characteristic element
                relative to the host element<br>
              </td>
              <td style="vertical-align: top;">1<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">2<br>
              </td>
              <td style="vertical-align: top;"><span style="font-style: italic;">D<sub>S</sub></span><br>
              </td>
              <td style="vertical-align: top;">Empirical effective sub-surface
                layer diffusivity parameter ( m<sup>2</sup>/s)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">3<br>
              </td>
              <td style="vertical-align: top;"><span style="font-style: italic;">D<sub>L</sub></span><br>
              </td>
              <td style="vertical-align: top;">Solid-state diffusion coefficient
                of the characteristic element in the bulk host mineral phase (m<sup>2</sup>/s)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">4<br>
              </td>
              <td style="vertical-align: top;"><span style="font-style: italic;">l</span><br>
              </td>
              <td style="vertical-align: top;">Half-thickness of the sub-surface
                layer (nm)<br>
              </td>
              <td style="vertical-align: top;">0<br>
              </td>
            </tr>
            <tr>
              <td style="vertical-align: top;">5<br>
              </td>
              <td style="vertical-align: top;"><span style="font-style: italic;">m</span><br>
              </td>
              <td style="vertical-align: top;">Multiplier that links <span style="font-style: italic;">l</span>
                to the maximum thickness of the elevated-diffusivity sub-surface
                region <br>
              </td>
              <td style="vertical-align: top;">1<br>
              </td>
            </tr>
          </tbody>
        </table>
        <br>
      </dd>
      <dd>
        <p>The uptake kinetics model depends on the overall kinetic rate law for
          the (host) mineral phase. At every time step, the change in amount of
          the whole phase will be computed, then the effective fractionation
          coefficient for Tr (trace) element, then the amount change of Tr end
          member will be found from that and the total dissolved molalities of
          Tr and Hc (host) elements. <br>
        </p>
      </dd>
      <dd>
        <p>More models and parameter sets are in development.<br>
        </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt> <a name="umpcl"></a><big><b><tt><big>umpcl</big> </tt></b></big>-
        Uptake kinetic model parameters comment list <br>
      </dt>
      <dd>
        <dl>
          <dd>
            <p>It is desirable to put here a short comment for each parameter of
              the uptake kinetics model, for instance:</p>
          </dd>
          <dd>
            <table style="text-align: left; width: 469px; height: 28px;" cellspacing="2"
              cellpadding="2"
              border="1">
              <tbody>
                <tr>
                  <td style="vertical-align: top;">F<br>
                  </td>
                  <td style="vertical-align: top;">Del0<br>
                  </td>
                  <td style="vertical-align: top;">DS<br>
                  </td>
                  <td style="vertical-align: top;">DL<br>
                  </td>
                  <td style="vertical-align: top;">l<br>
                  </td>
                  <td style="vertical-align: top;">m<br>
                  </td>
                </tr>
              </tbody>
            </table>
            <br>
          </dd>
          <dd>This greatly improves the readability of the uptake kinetics model
            definition.</dd>
        </dl>
        <p>&nbsp; </p>
      </dd>
      <dd> &nbsp;</dd>
      <dt><a name="PHtprn"></a><big><b><tt>PHtprn</tt></b></big> </dt>
      <dd> Internal </dd>
      <dd> <br>
      </dd>
    </dl>
    <hr width="100%" size="2">
    <h3><a name="PHASE_DOD_HIDDEN"></a>5.4. Hidden data objects for usage in
      Phase math scripts<br>
    </h3>
    <p> The data objects listed below cannot be seen on Phase window pages
      because these data exist in the runtime GEM IPM work data structure and
      are automatically mapped to components and parameters of this phase
      only.&nbsp;When labels of these hidden data objects are used in the <a href="#DcEq"><tt>DcEq</tt></a>
      or <a href="#PhEq"><tt>PhEq </tt></a>scripts, there is no need to care
      about location of this phase and its species in the whole chemical system
      definition, which is hard to know in advance, before the project system is
      assembled. </p>
    <p><big><b><tt>Attention!</tt></b></big> Most of the data objects listed
      below are marked as "read only". This means that their values are
      automatically set or changed during GEM IPM calculations. Using these
      "read only" objects on the left side of <a href="g_mscript.html">math
        script</a> assign operator "=:" (i.e. assigning values to them) may
      cause incorrect results, unpredictable behaviour or the program crash. </p>
    <dl>
      <dt> <a name="Ps_mod"></a><big><b><tt>Ps_mod</tt></b></big> - Copy of <a
          href="#p_solt_0"><tt>p_solt</tt></a>
        codes for this phase, kept in the IPM work data structure<br>
      </dt>
      <dd>
        <p>Reserved.</p>
      </dd>
      <dd> <br>
      </dd>
      <dt><a name="T_C"></a><big><b><tt>T_C</tt></b></big> - &nbsp;Temperature
        in Centigrade C (scalar, read only) </dt>
      <dd>
        <p>Current system temperature (<sup>o</sup>C).&nbsp;&nbsp; </p>
      </dd>
      <dt> <a name="T_K"></a><big><b><tt>T_K</tt></b></big> - Temperature in
        Kelvins (scalar, read only) </dt>
      <dd>
        <p>Current system temperature (K). </p>
      </dd>
      <dt> <a name="P_"></a><b><big><tt>P_</tt></big></b> - Pressure in bars
        (scalar, read only) </dt>
      <dd>
        <p> &nbsp; Current system pressure (bar, 1 bar = 0.1 MPa).&nbsp; </p>
      </dd>
      <dt> <a name="IS_"></a><big><b><tt>IS_</tt></b></big> - Effective molal
        ionic strength I (scalar, read only) </dt>
      <dd>
        <p>Current (at GEM IPM iteration) molal ionic strength of aqueous
          electrolyte.</p>
      </dd>
      <dt> <a name="is"></a><big><b><tt>is</tt></b></big> - Internal index of a
        column (e.g. in <a href="#dCm"><big><span style="font-family: monospace;">dCm</span></big></a>
        or <a href="#pCv"><big><span style="font-family: monospace;">pCv</span></big></a>
        arrays),&nbsp; scalar&nbsp; </dt>
      <dd>
        <p>This index is not set automatically and can be changed e.g. in a math
          script "do begin ... end" loop.&nbsp;&nbsp; </p>
      </dd>
      <dt> <a name="js"></a><b><big><tt>js</tt></big></b> - internal index of a
        row in <big><tt>dCm</tt></big> array (scalar) </dt>
      <dd>
        <p>This index can be used in DcEq or PhEq scripts to access <a href="#dCm"><big><span
                style="font-family: monospace;">dCm</span></big></a>
          array cells. </p>
      </dd>
      <dd>
        <p>In "public" mode, this index is automatically changed by the program
          from 0 to <tt>Ndc-1</tt>, where <a href="#Ndc"><tt>Ndc</tt></a> is
          number of dependent components (species) in this phase. In "private"
          mode, the user must change this index in a math script
          operator.&nbsp;&nbsp; &nbsp;&nbsp; </p>
      </dd>
      <dt> <a name="nexta"></a><b><big><tt>nexta</tt></big></b> - internal
        indicator of continued loops&nbsp; in do() operator (scalar) </dt>
      <dd>
        <p>This indicator (integer number 0 or 1) is not set automatically and
          can be changed in a math script operator. The control will bail out of
          the loop when nexta = 0. <br>
        </p>
      </dd>
      <dt> <a name="Ncp"></a><big><b><tt>Ncp</tt></b></big> - Number of
        interaction parameters;&nbsp; max. order of interaction; number of
        coefficients per parameter; (vector of length 3, read only) </dt>
      <dd>
        <p>These three counters contain: </p>
      </dd>
      <dd><tt>Ncp[0]</tt> - number of rows in the <a href="#pCv"><tt>pCv</tt></a>&nbsp;
and
        <a href="#ipxt"><tt>ipxt</tt></a> arrays, or zero if <a href="#pCv"><tt>pCv</tt></a>
        is not allocated.</dd>
      <dd><tt>Ncp[1]</tt> - number of columns in the <a href="#ipxt"><tt>ipxt</tt></a>
        index list for interaction parameters (in models of mixing from TSolMod
        class library), or 0 if the <tt>ipxt</tt> index list is not used for
        this phase.</dd>
      <dd><tt>Ncp[2]</tt> - number of columns in <tt>pCv</tt> array, or 0 if <tt>pCv</tt>
        is not used.&nbsp; <br>
      </dd>
      <dd> &nbsp;&nbsp; </dd>
      <dt> <a name="Ncd"></a><big><b><tt>Ncd</tt></b></big>&nbsp;- Number of
        coefficients per DC in <tt>dCm</tt> array; number of sublattices/sites;
        number of substituting moieties (scalar, read only) </dt>
      <dd>
        <p>These three counters contain: </p>
      </dd>
      <dd><tt>Ncd[0]</tt> - number of columns in the <a href="#dCm"><tt>dCm</tt></a>
        array, or zero if <a href="#dCm"><tt>dCm</tt></a> is not allocated
        (number of rows in dCm is given in the <a href="#Ndc"><tt>Ndc</tt></a>
        counter).</dd>
      <dd><tt>Ncd[1]</tt> - number of sublattices/sites in multi-site solution
        model, or zero otherwise.</dd>
      <dd><tt>Ncd[2]</tt> - number of moieties substituting on sublattice sites
        in multi-site solution, or zero otherwise.</dd>
      <dd>&nbsp; <br>
      </dd>
      <dt> <a name="Ndc"></a><big><b><tt>Ndc</tt></b></big> - Number of
        dependent components (end members, species) in this phase (scalar, read
        only) </dt>
      <dd>
        <p>This object is mapped onto <tt>L1[k]</tt> cell, where&nbsp;<tt>k</tt>
          is the index of this phase in the GEM IPM data structure. It must be
          used for limiting any loop that runs with the <a href="#js"><tt>js</tt></a>
          index over phase components.<br>
        </p>
      </dd>
      <dt> <a name="PhVol"></a><big><b><tt>PhVol</tt></b></big> - current
        volume of this phase in cm<sup>3</sup> (scalar, read only) <br>
      </dt>
      <dd>
        <p>Mapped to the <tt>phVol[k]</tt> cell where <tt>k</tt> is the index
          of this phase in the GEM IPM data structure.&nbsp;&nbsp; </p>
      </dd>
      <dt> <a name="RT_"></a><big><b><tt>RT_</tt></b></big> - &nbsp;value of <i>RT
          </i>for current temperature in J/mol (scalar, read only) </dt>
      <dd>
        <p>The value of <i>RT</i> (<i>R</i>=8.31451 J/K/mol&nbsp; is the
          universal gas constant, <i>T</i> is temperature in K) is set
          automatically. </p>
      </dd>
      <dd>
        <p>Added to simplify writing Phase math scritps.&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="FRT_"></a><big><b><tt>FRT_</tt></b></big> - value of <i>F</i>/(<i>RT</i>)&nbsp;
for
        current temperature in C/J (scalar, read only) </dt>
      <dd>
        <p>The value of <i>F</i>/(<i>RT</i>) (<i>F</i> = 96485 C/mol is the
          Faraday constant) is set automatically. </p>
      </dd>
      <dd>
        <p>Added to simplify Phase math scritps involving electrostatic
          correction terms.&nbsp;</p>
      </dd>
      <dt> <a name="Ez"></a><big><b><tt>Ez</tt></b></big> - DC (species)
        formula charges&nbsp; (vector of length&nbsp; <a href="#Ndc"><tt>Ndc</tt></a>,
        read only).</dt>
      <dd>
        <p>Mapped to a block of the&nbsp; <tt>ez</tt> &nbsp;vector in the GEM
          IPM data structure that corresponds to this phase.&nbsp; </p>
      </dd>
      <dd>
        <p>Usage in phase scripts: <tt>Ez[js]</tt> (in "public" mode),&nbsp; or
          <tt>Ez[0]</tt> &nbsp;(<tt>Ez[1]</tt> ...) in "private" mode.&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="pCv"></a><big><b><tt>pCv</tt></b></big> - Array of
        interaction parameter coefficients for the phase-solution non-ideal
        mixing model (read only) </dt>
      <dd>
        <p>This array having Ncp[0] rows and Ncp[2] columns corresponds at GEM
          IPM runtime to the <a href="#ph_cf"><tt>ph_cf</tt></a> array of
          interaction parameter coefficients from this Phase record. More about
          these coefficients in relation to built-in and cripted models can be
          learned <a href="#ph_cf">here</a>.</p>
      </dd>
      <dd>
        <p>Usage in math scripts: <tt>pCv[0][0], pCv[0][1], ...</tt></p>
      </dd>
      <dt> <a name="dCm"></a><big><b><tt>dCm</tt></b></big> - Array of
        coefficients of end-member (species) properties for the non-ideal mixing
        model (read only)<br>
      </dt>
      <dd>
        <p>This array having <a href="#Ndc"><tt>Ndc</tt></a> rows and <a href="#Ncd">Ncd</a>[0]
          columns (coefficients per phase component) corresponds at GEM IPM
          runtime to the <a href="#dc_cf"><tt>dc_cf</tt></a> array of phase
          component properties. More about these coefficients in relation to
          built-in and cripted models can be learned <a href="gm_phase.html#dc_cf">here</a>.
          Before the GEM IPM calculation, the program automatically copies here
          data from the <a href="#dc_cf"><tt>dc_cf</tt></a> array (if present)
          from the respective Phase record (row by row, except that for skipped
          phase components).&nbsp; <br>
        </p>
      </dd>
      <dd>
        <p>Usage in math scripts:<tt> dCm[0][1], ... &nbsp;dCm[js][is]</tt>
          ("public" mode), ...<tt> dCm[js]</tt> (if <a href="#Ncd"><tt>Ncd</tt></a>[0]
          = 1).</p>
      </dd>
      <dt> <a name="mVol"></a><b><big><tt>mVol</tt></big></b> - Species molar
        volume, cm<sup>3</sup>/mol; &nbsp;vector of length&nbsp; <a href="#Ndc"><tt>Ndc</tt></a>
        (read only).</dt>
      <dd>
        <p>Mapped to a block of the <tt>vol</tt> &nbsp;vector belonging to this
          phase in the GEM IPM data structure. </p>
      </dd>
      <dd>
        <p>Usage in math scripts: <tt>mVol[js]</tt> (in "public" mode)&nbsp; or
          <tt>mVol[0]</tt> &nbsp;(<tt>mVol[1]</tt> ...) in "private" mode.&nbsp;</p>
      </dd>
      <dt> <a name="mGo"></a><big><b><tt>mGo</tt></b></big> - molar Gibbs
        energy of pure end-members in the normalized lnK scale at <i>T,P</i> of
        interest (length <a href="#Ndc"><tt>Ndc</tt></a>), read only </dt>
      <dd>
        <p>Mapped to a block of the <tt>g0</tt> &nbsp;vector belonging to this
          phase in the GEM IPM data structure.&nbsp;Read only.&nbsp;</p>
      </dd>
      <dd>
        <p>Usage in math scripts: <tt>mGo[js]</tt> (in "public" mode)&nbsp; or
          <tt>mGo[0]</tt> &nbsp;(<tt>mGo[1]</tt> ...) in "private" mode.&nbsp;</p>
      </dd>
      <dt> <a name="gDQF"></a><big><b><tt>gDQF</tt></b></big> - Constant
        correction to end member <i>g</i>0 from Darken formalism or pure-state
        fugacity (length <a href="#Ndc"><tt>Ndc</tt></a>) </dt>
    </dl>
    <dl>
      <dd>
        <p>Units of measurement: normalized ln<i>K</i>, correspond to <a href="#ln_gam"><span
              style="font-family: monospace;">ln_gam</span></a>
          units. Calculated in non-ideal fluid models (built-in or scripted). <br>
        </p>
      </dd>
      <dd>
        <p>Mapped to a block of the&nbsp; <tt>gEx</tt>&nbsp; vector belonging
          to this phase in the GEM IPM work data structure. </p>
      </dd>
      <dd>
        <p><big><span style="font-family: monospace;">gDQF</span></big>&nbsp;
          elements can be used e.g. for setting up solid solution models that
          use Darken's Quadratic Formalism (DQF).&nbsp;</p>
      </dd>
      <dd>
        <p>Usage in math scripts: <tt>gDQF[js]</tt> (in "public" mode)&nbsp; or
          <tt>gDQF[0]</tt> &nbsp;(<tt>gDQF[1]</tt> ...) in "private" mode.&nbsp;
          <br>
        </p>
      </dd>
      <dt> <a name="gam"></a><big><b><tt>gam</tt></b></big> - calculated
        activity coefficients of phase components (length <a href="#Ndc"><tt>Ndc</tt></a>,
        in molal scale for aqueous species)<br>
      </dt>
      <dd>
        <p>Mapped to a block of the <tt>gamma</tt> &nbsp;vector belonging to
          this phase in the GEM IPM data structure.&nbsp;&nbsp; <br>
        </p>
      </dd>
      <dd>
        <p>Usage in math scripts: <tt>gam[js] =: &lt;expression&gt;</tt>&nbsp;
          (in "public" mode) or <tt>gam[0] =: &lt;expression&gt;;</tt> &nbsp;(<tt>gam[1]
            =:</tt> ...) &nbsp;in "private" mode.&nbsp;</p>
      </dd>
      <dd>
        <p>&nbsp;If, for a phase species, <tt>gam[js]</tt> not equal to 1 is
          calculated and <tt>ln_gam[js]</tt> is set to 0 then <tt>ln_gam[js]</tt>
          will be automatically assigned<tt> ln(gam[js])</tt> value.</p>
      </dd>
      <dt> <a name="ln_gam"></a><big><b><tt>ln_gam</tt></b></big> - calculated
        natural logarithms of rational (mole fraction scale) activity
        coefficients of phase components (length <a href="#Ndc"><tt>Ndc</tt></a>)
      </dt>
      <dd>
        <p>Mapped to a block of the <tt>lnGam</tt> &nbsp;vector belonging to
          this phase in the GEM IPM data structure. Calculated in all built-in
          models of mixing. <br>
        </p>
      </dd>
      <dd>
        <p>Usage in math scripts: <tt>ln_gam[js] =: &lt;expression&gt;</tt>&nbsp;
(in
          "public" mode) or <tt>ln_gam[0] =: &lt;expression&gt;;</tt> &nbsp;(<tt>ln_gam[1]
            =:</tt> ...) &nbsp;in "private" mode.&nbsp;</p>
      </dd>
      <dd>
        <p>Math scripts in <a href="#DcEq"><tt>DcEq</tt></a> field (as well as
          built-in functions) usually calculate <tt>ln_gam</tt> values for
          phase species involved into calculation of equilibrium states. If, for
          a phase species, <tt>ln_gam[js]</tt> not equal to 0 is calculated and
          <tt>gam[js]</tt> is set to 1 then <tt>gam[js]</tt> will be
          automatically assigned<tt> exp(ln_gam[js])</tt> value.&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="ipxt"></a><big><b><tt>ipxt</tt></b></big> - table of
        indexation of components or moieties for interaction parameters,&nbsp;
        read only<br>
      </dt>
      <dd>
        <p>Mapped to the part of the <big><span style="font-family: monospace;">IPx</span></big>
          array in the GEM IPM data structure that belongs to this phase.&nbsp;
          This table (list) has one row per interaction parameter and the number
          of columns equal to the maximum order of interactions (usually number
          of end members, or less).&nbsp; The number of interaction parameters
          is model-specific and also depends on the number of end members. See
          also <a href="#ipxT">ipxT help page</a>.<br>
        </p>
      </dd>
      <dd>
        <p>Values in this table are indexes of the end members in the phase
          (ranging from 0 to <a href="#Ndc"><tt>Ndc</tt></a>-1), or -1 if this
          parameter is less than higher-order. Rules for setting up the
          indexation and interaction parameter coefficients for built-in
          functions are provided in the description of&nbsp; <a href="#ph_cf"><big><span
                style="font-family: monospace;">ph_cf</span></big></a>&nbsp;
          table and in the <a href="g_useref#P_SOLT0">User's Reference</a>. </p>
      </dd>
      <dd>
        <p>For example, in a binary solution phase, the <big><span style="font-family: monospace;">ipxt</span></big>
          table will have two columns and two rows for a subregular mixing
          model. A multicomponent Van Laar model will require two columns
          because it only considers binary interaction parameters; the number of
          rows depends on how many non-zero interaction parameters are known.
          Any binary interaction parameter which is not listed in the <big><span
              style="font-family: monospace;">ipxt
              </span></big>table will receive its default (usually zero) value
          in built-in subroutines for calculation of activity coefficients.</p>
      </dd>
      <dd>
        <p>Used in all built-in models of non-ideal mixing that conform with
          TSolMod specifications. Can be used in both Phase math scripts.</p>
      </dd>
      <dt> <a name="As"></a><big><b><tt>As</tt></b></big> - block of the
        stoichiometry matrix A belonging to this phase in the GEM IPM data
        structure (read only) </dt>
      <dd>
        <p>Mapped to a block of the <tt>A</tt> matrix in GEM IPM data
          structure, one row per phase component, one column per independent
          component. &nbsp; </p>
      </dd>
      <dd>Can be used in Phase math scripts e.g. for extracting stoichiometry of
        a species. <br>
      </dd>
      <dd> &nbsp; </dd>
      <dt> <a name="Xalp"></a><big><b><tt>Xalp</tt></b></big> - current total
        mole amount of this phase (scalar, read only) </dt>
      <dd>
        <p>Mapped to an element of vector <tt>Xa[k]</tt> in the GEM IPM data
          structure, where k is the index of this phase. Can be used in both
          Phase math scripts e.g. for explicit calculation of mole fractions.</p>
      </dd>
      <dt> <a name="XalpV"></a><big><b><tt>XalpV</tt></b></big> - current total
        mole amount in solvent or sorbent of this phase (scalar, read only) </dt>
      <dd>
        <p>Mapped to an element of vector <tt>Xav[k]</tt> in the GEM IPM data
          structure, where k is the index of this phase. Can be used in both
          Phase math scripts e.g. for explicit calculation of mole fractions. <br>
        </p>
      </dd>
      <dt> <a name="XalpS"></a><big><b><tt>XalpS</tt></b></big> -&nbsp; total
        number of moles of solutes in this (aqueous or sorption) phase (scalar,
        read only) </dt>
      <dd>
        <p>Mapped to an element of vector <tt>Xas[k]</tt> in the GEM IPM data
          structure, where k is the index of this phase. Can be used in both
          Phase math scripts e.g. for explicit calculation of mole fractions
          etc.</p>
      </dd>
      <dt> <a name="XecR"></a><big><b><tt>XecR</tt></b></big> &nbsp;- reserved
        for future versions </dt>
      <dd> &nbsp; </dd>
      <dd> &nbsp; </dd>
      <dt> <a name="Xx"></a><big><b><tt>Xx</tt></b></big> - vector of current
        mole amounts of dependent components (end members, species) in this
        phase&nbsp;(length <a href="#Ndc"><tt>Ndc</tt></a>, read only) </dt>
      <dd>
        <p>Mapped to a block of the <tt>x</tt> &nbsp;vector belonging to this
          phase in the GEM IPM data structure.&nbsp;&nbsp;</p>
      </dd>
      <dd>
        <p>Usage in math scripts: <tt>Xx[js]</tt> (in "public" mode)&nbsp; or <tt>Xx[0]</tt>
          &nbsp;(<tt>Xx[1]</tt> ...) in "private" mode.&nbsp;</p>
      </dd>
      <dt> <a name="Wx"></a><big><b><tt>Wx</tt></b></big>&nbsp;- vector of
        current mole fractions of dependent components (end members, species) in
        this phase&nbsp;(length <a href="#Ndc"><tt>Ndc</tt></a>, read only) </dt>
      <dd>
        <p>Mapped to a block of the <tt>Wxx</tt> &nbsp;vector belonging to this
          phase in the GEM IPM data structure.&nbsp;&nbsp;</p>
      </dd>
      <dd>
        <p>Usage in math scripts: <tt>Wx[js]</tt> (in "public" mode)&nbsp; or <tt>Wx[0]</tt>
          &nbsp;(<tt>Wx[1]</tt> ...) in "private" mode.&nbsp;</p>
      </dd>
      <dd>
        <p>This object is most frequently used in writing equations for activity
          coefficients of end-members in non-ideal solid solutions.&nbsp;&nbsp;
          <br>
        </p>
      </dd>
      <dt> <a name="fMu"></a><big><b><tt>fMu</tt></b></big> - vector of current
        normalized chemical potentials of dependent components involved in this
        phase (length <a href="#Ndc"><tt>Ndc</tt></a>, read only) </dt>
      <dd>
        <p> &nbsp;Mapped to a block of the v &nbsp;vector belonging to this
          phase in the GEM IPM data structure.&nbsp; <br>
        </p>
      </dd>
      <dt> <a name="Qp"></a><b><big><tt>Qp</tt></big></b> - array of&nbsp; 180
        work cells for phase model for use in math scripts for this phase &nbsp;
      </dt>
      <dd>
        <p>These work cells are initialized to zeros before the <a href="#PhEq"><tt>PhEq</tt></a>
          math script is executed.&nbsp;&nbsp; </p>
      </dd>
      <dt> <a name="Qd"></a><big><b><tt>Qd</tt></b></big> - array of 60 work
        cells for DCs use in math scripts for this phase </dt>
      <dd>
        <p>Attention: In "public" mode, contents of these work cells will be
          zeroed off before the next (js) species is processed.</p>
      </dd>
      <dt> <a name="wEqTxt"></a><big><b><tt>wEqTxt</tt></b></big> &nbsp;-
        reserved for future versions<b><b><b> </b> </b></b></dt>
      <dd> <br>
      </dd>
      <dt> <a name="gE"></a><big><b><tt>gE</tt></b></big> &nbsp;- gE: excess
        molar Gibbs energy of phase </dt>
      <dd>
        <p>(reserved) </p>
      </dd>
      <dt> <a name="hE"></a><big><b><tt>hE</tt></b></big> &nbsp;- hE: excess
        molar enthalpy of phase </dt>
      <dd>
        <p>(reserved) </p>
      </dd>
      <dt> <a name="sE"></a><big><b><tt>sE</tt></b></big> &nbsp;- sE: excess
        molar entropy of phase </dt>
      <dd>
        <p>(reserved) </p>
      </dd>
      <dt> <a name="vE"></a><big><b><tt>vE</tt></b></big> &nbsp;- vE: excess
        molar volume of phase </dt>
      <dd>
        <p>(reserved) </p>
      </dd>
      <dt> <a name="cpE"></a><big><b><tt>cpE</tt></b></big> &nbsp;- cpE: excess
        molar heat capacity of phase </dt>
      <dd>
        <p>(reserved) </p>
      </dd>
      <dt> <a name="aE"></a><big><b><tt>aE</tt></b></big> &nbsp;- aE: excess
        molar Helmholtz energy of phase </dt>
      <dd>
        <p>(reserved) </p>
      </dd>
      <dt> <a name="uE"></a><big><b><tt>uE</tt></b></big> &nbsp;- uE: excess
        molar internal energy of phase </dt>
      <dd>
        <p>(reserved) </p>
      </dd>
    </dl>
    <br>
    <hr style="width: 100%; height: 2px;">
    <h2><a name="PHASE_ERRORS"></a>6. Warnings and error messages</h2>
    <dl>
      <dt><big><b><tt>E00PHrem</tt></b></big>: Illegal link q&gt;nQ</dt>
      <dd><br>
      </dd>
      <dt><big><b><tt>E01PHrem:</tt></b></big> Illegal access to ph in dyn_set()</dt>
      <dd><br>
      </dd>
      <dt><big><b><tt>E02PHrem:</tt></b></big> Illegal access to ph in
        dyn_kill()</dt>
      <dd><br>
      </dd>
      <dt><big><b><tt>E03PHrem:</tt></b></big> Illegal access to ph in dyn_new()</dt>
      <dd><br>
      </dd>
      <dt><big><b><tt>E04PHrem:</tt></b></big> Number of DC in the phase
        definition &lt;= 0</dt>
      <dd><br>
      </dd>
      <dt><big><b><tt>E05PHrem:</tt></b></big> Illegal access to ph in set_def()</dt>
      <dd>
        <p>Internal errors that most probably indicate the corruption of dynamic
          memory.&nbsp;</p>
      </dd>
      <dd>
        <p>Action: Restart GEM-Selektor and try again. If it does not help,
          please, submit a bug report describing a situation when it happens.
          &nbsp; <br>
        </p>
      </dd>
      <dd>&nbsp;<br>
      </dd>
      <dt><big><b><tt>W06PHrem:</tt></b></big> Invalid number of coeffs in the
        non-ideal solution model! Proceed?</dt>
      <dd>
        <p>During remake, some dimensionalities have been assigned negative or
          too large values.&nbsp;</p>
      </dd>
      <dd>
        <p>Action: Press "Yes" and remake the record again and change the
          counters.</p>
      </dd>
      <dd>&nbsp;&nbsp;<br>
      </dd>
      <dt><b><big><tt>E07PHrem:</tt></big></b> Invalid mode of calculation!</dt>
      <dd>
        <p>&nbsp;Some codes in the <a href="#p_solt_0"><tt>p_solt</tt></a>
          field are wrong or in mismatch with the allocation flags.&nbsp; <br>
        </p>
      </dd>
      <dd>
        <p>Action: Remake the record again and change the codes or allocation
          flags.</p>
      </dd>
      <dd>&nbsp; <br>
      </dd>
      <dt><big><b><tt>W08PHrem:</tt></b></big> Number of selected ReacDC/DComp
        keys &lt; 1.</dt>
      <dt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Mark
        again, proceed without ReacDC/DComp or Cancel?,</dt>
      <dd>
        <p>No species from the database have been selected into the phase
          definition.&nbsp;</p>
      </dd>
      <dd>
        <p>Actions: &nbsp; Press "Repeat" and mark the species again; &nbsp;
          press "Cancel" to abandon the create/remake action. </p>
      </dd>
      <dd>&nbsp;<br>
      </dd>
      <dt><big><b><tt>E09PHrem:</tt></b></big> No ReacDC/DComp records selected
        into Phase.</dt>
      <dd>
        <p>Confirmation that the user has pressed "Cancel" on the <big><tt>W08PHrem</tt></big>
          warning.</p>
      </dd>
      <dd>&nbsp;&nbsp;<br>
      </dd>
      <dt><big><b><tt>W10PHrem:</tt></b></big> Shall I set default values
        automatically:&nbsp; from (Kielland 1936), from (Helgeson ea 1981) or</dt>
      <dt>&nbsp;Not collect and not set automatically?&nbsp;</dt>
      <dd>&nbsp; <br>
      </dd>
      <dd>This function is under construction.&nbsp; <br>
      </dd>
      <dd>&nbsp;<br>
      </dd>
    </dl>
    <hr style="width: 100%; height: 2px;"><b><b><b><br>
        </b></b></b>Copyright (c) 2003-2021 GEMS Develoment Team<br>
    <br>
    Last update: 3.06.2021 DK<b><b><b><tt><br>
          </tt><br>
          &nbsp; <br>
        </b> </b></b> <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
  </body>
</html>
