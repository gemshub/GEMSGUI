<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
  <title>GEMIPM2K User Reference</title>
</head>
<body>
<h1><img alt="GEMS icon"
 src="file:///c:/Developer/work/gems2/mods/gemipm/doc/html/gems1.png"
 style="width: 48px; height: 48px;" align="left"> <font color="#000066">
GEMIPM2K version 3</font> </h1>
<h1>Function calls needed for using
GEMIPM2K<span style=""></span><span style=""> </span>in a coupled
modeling code
(on TNode level)</h1>
<p><span style="font-family: Helvetica,Arial,sans-serif;">The input
files to start calculations with GEMIPM2K can be obtained
from running the GEM-Selektor package as described in Section 2.4 of
the </span><a style="font-family: Helvetica,Arial,sans-serif;"
 href="gemipm2k-man.html">gemipm2k-man.html</a><span
 style="font-family: Helvetica,Arial,sans-serif;"> file (or in
Technical Report), and
can also be modified using any ASCII text editor. The file formats are
described in detail in </span><a
 style="font-family: Helvetica,Arial,sans-serif;"
 href="gemipm2k-inp.html">gemipm2k-inp.html</a><span
 style="font-family: Helvetica,Arial,sans-serif;">
file.&nbsp;
The names of IPM, DCH and one or several DBR files should be collected
in
a list (txt file) with the file name/path given as a string in the
first parameter of GEM_init() function call. Contents of this list
usually look like this: </span><br>
</p>
<p><span style="font-family: monospace;">-t "Test-dch.dat"
"Test-ipm.dat" "Test-dbr-0.dat"<br>
</span><br>
<span style="font-family: Helvetica,Arial,sans-serif;">These files
should be
located in the same directory where&nbsp; the list file is located.</span><br>
</p>
<h2>1. The simplest case: data exchange using disk files only</h2>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Programming
example fragment (see full example in
</span><big><span style="font-family: monospace;">/GEMIPM2K/main.cpp</span></big><span
 style="font-family: Helvetica,Arial,sans-serif;">): </span><br>
<span style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span></p>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">#include "node.h"<br>
      <br style="font-family: monospace;">
      </span><span style="font-family: monospace;">&nbsp;&nbsp; //
Creates
TNode structure instance accessible trough the "node" pointer</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; TNode*
node&nbsp; =
new TNode();</span><br style="font-family: monospace;">
      <p style="font-family: monospace;">&nbsp;&nbsp; // (1)
Initialization
of GEMIPM2K internal data by reading&nbsp; files <br>
&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp; whose names are given in the
input_system_file_list_name <br>
&nbsp;<span style="color: rgb(0, 153, 0);">&nbsp; </span>if(
node-&gt;GEM_init( input_system_file_list_name ) )<br>
&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// error occured during reading the files<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
return 1;<br>
&nbsp;&nbsp; }<br style="color: rgb(0, 153, 0);">
      <span style="color: rgb(0, 153, 0);">&nbsp;&nbsp; </span><br>
&nbsp;&nbsp; // Getting direct
access to work node DATABR structure which exchanges the <br>
&nbsp;&nbsp; // data with GEM IPM2 (already filled out by reading the
DBR input file)<br>
&nbsp;&nbsp; DATABR* dBR = node-&gt;pCNode();&nbsp;<br>
      </p>
      <p style="font-family: monospace;">&nbsp;&nbsp; // Asking GEM to
run
with automatic initial approximation&nbsp; <br>
&nbsp;&nbsp; dBR-&gt;NodeStatusCH = NEED_GEM_AIA; <br>
      </p>
      <p style="font-family: monospace;">&nbsp;&nbsp; // (2)
re-calculating
equilibrium by calling GEMIPM2K, getting the status back<br>
&nbsp;&nbsp; int NodeStatusCH = node-&gt;GEM_run( 3., false );<br>
      </p>
      <p style="font-family: monospace;">&nbsp;&nbsp; if( NodeStatusCH
==
OK_GEM_AIA || NodeStatusCH == OK_GEM_SIA&nbsp; )<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (3) Writing results in default
DBR file <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node-&gt;GEM_write_dbr( NULL,
false, true );<br>
&nbsp;&nbsp; else { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (4) possible return status analysis,
error message <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node-&gt;GEM_print_ipm( NULL
);&nbsp;&nbsp; // possible debugging printout<br>
&nbsp;&nbsp; }<br>
      </p>
      <p style="font-family: monospace;">&nbsp;&nbsp; // Here a
possible loop
on input recipes begins<br>
&nbsp;&nbsp; // (5) Reading the next DBR file with different input
composition or temperature <br>
&nbsp;&nbsp; node-&gt;GEM_read_dbr( NextRecipeFileName ); </p>
      <p style="font-family: monospace;">&nbsp;&nbsp; // Asking GEM
IPM2 to
run (faster) with smart initial approximation&nbsp; <br>
&nbsp;&nbsp; dBR-&gt;NodeStatusCH = NEED_GEM_SIA;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
      </p>
      <p style="font-family: monospace;">&nbsp;&nbsp; NodeStatusCH =
node-&gt;GEM_run( 3., false );</p>
      <p style="font-family: monospace;">&nbsp;&nbsp; if( NodeStatusCH
==
OK_GEM_AIA || NodeStatusCH == OK_GEM_SIA&nbsp; )<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node-&gt;GEM_write_dbr(
NextRecipeFileName_out, false, true );<br>
&nbsp;&nbsp; else { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // error message, debugging
printout <br>
&nbsp;&nbsp; }</p>
      <p style="font-family: monospace;">&nbsp;&nbsp; // end of
possible loop
on input recipes <br>
      </p>
      <span style="font-family: monospace;">&nbsp;&nbsp; delete node;</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">// End of example</span></td>
    </tr>
  </tbody>
</table>
<span style="font-family: monospace;"><br>
</span>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Description
of function calls (see also "node.h" file) </span><br>
</p>
<h3>(1)&nbsp; GEM_init()<br>
</h3>
<p><span style="font-family: monospace;">long int GEM_init( const char
*ipmfiles_lst_name,&nbsp; long int *nodeTypes = 0, bool getNodT1 =
false );</span><br>
</p>
<p style="font-family: Helvetica,Arial,sans-serif;">Purpose:
Initialization of GEM IPM2 data structures in coupled
FMT-GEM programs that use GEMIPM2K module. Also reads in the IPM, DCH
and DBR text input files. <br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Parameters:&nbsp;
</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">ipmfiles_lst_name&nbsp;&nbsp;&nbsp;
</span>pointer to a null-terminated C string with a path to a text file
containing the list of names of<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; GEMIPM2K input files.<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Example: file <span
 style="font-family: monospace;">"test.lst"</span> with a
content:&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">-t
"dch.dat" "ipm.dat" "dbr-0.dat"</span>&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; (<span
 style="font-family: monospace;">-t</span>&nbsp; tells that input files
are in text format) </p>
<p><span style="font-family: monospace;">&nbsp; nodeTypes</span>&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp; optional parameter used only on the TNodeClass
level to create nodeArray <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; (not used in
this example)<br>
</p>
<p><span style="font-family: monospace;">&nbsp; getNodT1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
optional parameter used only when reading multiple DBR files after
modeling task interruption <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; in
GEM-Selektor (not used in this example)<br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Return
values: </span>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
0&nbsp; if successful; 1 if input file(s) were not found or corrupt; -1
if internal memory allocation error occurred. <br>
&nbsp;&nbsp;&nbsp; <br>
</p>
<h3>(2) GEM_run()<br>
</h3>
<p><span style="font-family: monospace;"> long int&nbsp; GEM_run( bool
uPrimalSol );&nbsp; </span><br style="font-family: monospace;">
<span style="font-family: monospace;"> long int&nbsp; GEM_run( double
InternalMass = 1., bool uPrimalSol = false&nbsp; );&nbsp;&nbsp; </span><br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Purpose:</span>&nbsp;&nbsp;
Main call for GEM IPM calculations using the
input bulk composition, temperature, pressure and metastability
constraints <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; provided in the work instance of
DATABR structure.&nbsp; Actual
calculation will be performed only when <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dBR-&gt;NodeStatusCH ==
<span style="font-family: monospace;">NEED_GEM_SIA
(5)</span> or dBR-&gt;NodeStatusCH = <span
 style="font-family: monospace;">NEED_GEM_AIA (1)</span>. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; By other
values of NodeStatusCH, no calculation will be performed and the status
will remain unchanged. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; In "smart initial approximation" (SIA) mode,
the
program can automatically switch into the "automatic initial<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; approximation" (AIA) mode and
return&nbsp;
OK_GEM_AIA instead of OK_GEM_SIA. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
The variant with one function parameter performs no internal scaling of
the mass of the system. <br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Parameters:</span><br>
&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">uPrimalSol&nbsp;&nbsp;</span>&nbsp;&nbsp;
flag to define the mode of GEM smart initial approximation <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; (only if
dBR-&gt;NodeStatusCH = NEED_GEM_SIA has been set before GEM_run() call).<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span
 style="font-family: monospace;">false</span>&nbsp; (0) -&nbsp; use
speciation and activity coefficients from previous GEM_run() calculation<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span
 style="font-family: monospace;"> true&nbsp;</span> (1)&nbsp; -&nbsp;
use speciation provided in the DATABR memory structure (e.g. after
reading the DBR file) &nbsp; <br>
&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;<span style="font-family: monospace;">
InternalMass&nbsp;</span> Mass (kg) to which the input bulk composition
(provided in DATABR memory structure) will be scaled&nbsp; <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; internally during the GEM IPM
calculation (results will be scaled back to the original mass). <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Default
value - 1 kg, reasonable range from 0.01 to 100 kg.
This scaling is used for achieving <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; better
convergence and balance
accuracy of GEM IPM2 algorithm. <br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Return values:</span>&nbsp;&nbsp;&nbsp;
<span style="font-family: monospace;">NodeStatusCH</span>&nbsp; (the
same as
set in dBR-&gt;NodeStatusCH). Possible values (see "databr.h" file for
the full list): <span style="font-family: monospace;"><br>
&nbsp;<br>
&nbsp;OK_GEM_AIA&nbsp;&nbsp; ( 2 ) &nbsp; </span>OK after GEM
calculation with
simplex (automatic) initial approximation (IA)<span
 style="font-family: monospace;"><br>
&nbsp;BAD_GEM_AIA&nbsp; ( 3 ) &nbsp; </span>Bad (not fully trustful)
result after GEM
calculation with simplex (automatic) IA<span
 style="font-family: monospace;"><br>
&nbsp;ERR_GEM_AIA&nbsp; ( 4 ) &nbsp; </span>Failure (no result) in GEM
calculation with simplex (automatic) IA<span
 style="font-family: monospace;"><br>
&nbsp;OK_GEM_SIA&nbsp;&nbsp; ( 6 ) &nbsp; </span>OK after GEM
calculation with
no-simplex (smart) IA<span style="font-family: monospace;"><br>
&nbsp;BAD_GEM_SIA&nbsp; ( 7 ) &nbsp; </span>Bad (not fully trustful)
result after GEM
calculation with no-simplex (smart) IA<span
 style="font-family: monospace;"><br>
&nbsp;ERR_GEM_SIA&nbsp; ( 8 ) &nbsp; </span>Failure (no result) in GEM
calculation with no-simplex (smart) IA<span
 style="font-family: monospace;"><br>
&nbsp;T_ERROR_GEM&nbsp; ( 9 ) &nbsp; </span>Terminal error has
occurred in
GEMIPM2K (e.g. memory corruption). Restart is required.&nbsp; </p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">We recommend
checking the NodeStatusCH immediately after the
</span><big><span style="font-family: monospace;">GEM_run()</span></big><span
 style="font-family: Helvetica,Arial,sans-serif;"> call, as shown in
the above code example.</span><br
 style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">&nbsp;</span><br>
</p>
<h3>(3) GEM_write_dbr()
</h3>
<span style="font-family: monospace;">void&nbsp; GEM_write_dbr( const
char* fname,&nbsp; bool binary_f=false, bool with_comments = true, bool
brief_mode = false )<span style="color: rgb(0, 153, 0);">;</span></span><br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Purpose:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Writes the contents
of the work instance of DATABR structure into a disk file with path
name&nbsp; <span style="font-family: monospace;">fname</span>.<br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Parameters:</span>&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp; <span style="font-family: monospace;">fname </span>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
null-terminated (C) string containing a full path to the DBR disk file
to be written. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;
NULL&nbsp; - the disk file name path stored in the&nbsp; <span
 style="font-family: monospace;">dbr_file_name</span>&nbsp; field of
the TNode class instance <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; will be used, extended with ".out".&nbsp; Usually the<span
 style="font-family: monospace;"> dbr_file_name </span>field contains
the path <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; to the last input DBR file. <br>
&nbsp;&nbsp; <span style="font-family: monospace;">binary_f&nbsp;</span>&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; defines if the file is to be
written in binary format (true or 1, good for interruption of coupled
modeling task<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; if called in the loop for each node), or in text
format (false or 0, default). <br>
&nbsp;&nbsp; <span style="font-family: monospace;">with_comments</span>&nbsp;&nbsp;&nbsp;
(text format only): defines the mode of output of comments written
before each data tag and <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; content in the DBR file. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp; If set to true (1), the
comments will be written for all data entries (default).&nbsp;
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; If&nbsp;&nbsp; false (0), comments will not be
written. <br>
<span style="color: rgb(0, 153, 0);">&nbsp; </span><span
 style="font-family: monospace;">brief_mode</span><span
 style="font-family: monospace;">&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if true, tells that the data objects/items which contain only
default values will be skipped from the text format file<br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Any DBR file
written using </span><big><span style="font-family: monospace;">GEM_write_dbr()</span></big><span
 style="font-family: Helvetica,Arial,sans-serif;"> can be read as input
file
using </span><big><span style="font-family: monospace;">GEM_init()</span></big><span
 style="font-family: Helvetica,Arial,sans-serif;"> or </span><big><span
 style="font-family: monospace;">GEM_read_dbr()</span></big><span
 style="font-family: Helvetica,Arial,sans-serif;"> as long as it is
consistent with the
same set of IPM and DCH files that contain parameters of solution
models and chemical system definition, respectively. </span><br>
<br>
<h3>(4) GEM_print_ipm()</h3>
<p><span style="font-family: monospace;">void&nbsp; GEM_print_ipm(
const char* fname )</span><br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Purpose:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Produces a formatted text
file with detailed contents (scalars and arrays) of the GEM IPM work
structure.&nbsp; <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; This call is useful when GEM_run() returns with a
NodeStatusCH value indicating a GEM calculation error <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; (see&nbsp;
above).&nbsp; Another use is for a detailed comparison of a test system
calculation after the<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version upgrade of GEMIPM2K.<br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Parameters:</span>
<br>
</p>
<p>&nbsp;&nbsp; <span style="font-family: monospace;">fname </span>&nbsp;&nbsp;
&nbsp; null-terminated (C) string containing a full path to the disk
file to be written. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; NULL&nbsp; - the disk file name path stored in
the&nbsp; <span style="font-family: monospace;">dbr_file_name</span>&nbsp;
field of the TNode class instance will be used, <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; extended with
".dump.out".&nbsp; Usually the<span style="font-family: monospace;">
dbr_file_name </span>field contains the path to the last input DBR
file. <br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Attention:&nbsp;</span>&nbsp;&nbsp;
the text file produced by this function
call cannot be read back with <span style="font-family: monospace;">GEM_init()</span>
because it has a format
different<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; from that of
IPM, DCH and DBR input file formats.<br>
<br>
</p>
<h3>(5) GEM_read_dbr()</h3>
<p style="font-family: monospace;"> long int GEM_read_dbr( const char*
fname, bool binary_f=false );</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Purpose: </span>&nbsp;&nbsp;&nbsp;
Reads another DBR file (with input
system composition, T,P etc.) with a path name <span
 style="font-family: monospace;">fname. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span>The
DBR file must be
compatible with the currently
loaded IPM and DCH files (see description <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; of GEM_init()
function call).
<br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Parameters:</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">fname&nbsp;&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Null-terminated (C) string containing a
full path to the input DBR disk file. <br>
&nbsp;&nbsp;&nbsp;<span style="font-family: monospace;"> binary_f </span>&nbsp;&nbsp;
Flag defining whether the file specified in fname is in text fromat
(false or 0, default) or in binary format (true or 1)<br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Return
values: </span>&nbsp;&nbsp;&nbsp; 0&nbsp; if successful; 1 if input
file(s) has not found been or is corrupt; -1
if internal memory allocation error occurred. </p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">The input DBR
file may have been produced earlier from GEM-Selektor
or via the </span><big><span style="font-family: monospace;">GEM_write_dbr()</span></big><span
 style="font-family: Helvetica,Arial,sans-serif;">call and then
modified </span><br style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">using a text
editor so that the format (data object tags,
number of elements in arrays, etc.) remains intact. </span><br
 style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">&nbsp;</span><br>
</p>
<h3>Optional: GEM_CalcTime() and GEM_Iterations()
&nbsp;</h3>
<p style="font-family: monospace;">double GEM_CalcTime();</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Purpose:&nbsp;</span>&nbsp;&nbsp;&nbsp;
Returns GEMIPM2 calculation time in
seconds elapsed during the last call of <span
 style="font-family: monospace;">GEM_run() </span>- can be used for
monitoring <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the performance of calculations.<br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Return
value:&nbsp;</span> double number, may contain 0.0 if the
calculation time is less than the internal time resolution of C/C++
function <br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">clock() </span>defined
in the value of system variable <span style="font-family: monospace;">CLOCKS_PER_SEC</span>
for a particular processor and operation system. <br>
</p>
<p><br>
<span style="font-family: monospace;">long int GEM_Iterations( long
int&amp; PrecLoops, long int&amp; NumIterFIA, long int&amp; NumIterIPM
);</span> </p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Purpose:</span>
&nbsp;&nbsp;&nbsp;&nbsp; To obtain the number of GEM IPM2
iterations performed during the last call of <span
 style="font-family: monospace;">GEM_run()</span> e.g. for monitoring
the <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp; performance of GEMIPM2K in AIA or SIA modes, or for
problem diagnostics.&nbsp; &nbsp; </p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Parameters:</span>&nbsp;
long int variables per reference (must be
allocated before calling GEM_Iterations(), previous values will be
lost. See Return values.</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Return
values: </span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">Function&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; </span>Total number of EFD + IPM iterations
from the last call to GEM_run()<br>
<span style="font-family: monospace;">&nbsp; PrecLoops&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp; </span>Number of performed IPM-2 precision
refinement loops<br>
<span style="font-family: monospace;">&nbsp; NumIterFIA&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; </span>Total number of performed
EnterFeasibleDomain() (EFD) iterations to obtain a <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; feasible initial
approximation for the IPM algorithm.<br>
<span style="font-family: monospace;">&nbsp; NumIterIPM&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; </span>Total number of performed IPM main descent
algorithm iterations. <br>
<br>
</p>
<h2>2. The case of data exchange in computer memory </h2>
<span style="font-family: Helvetica,Arial,sans-serif;">This case is
typical for coupling GEMIPM2K with an existing reactive
mass transport code that has its own data structure for keeping
chemical information (e.g. speciation, bulk composition of the system)
for each node. As in the previous example, it uses one work instance of
DATABR
structure for the exchange with internal GEM IPM data structures.
&nbsp; </span><br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Simplified
programming example (see full example in</span>
<big><span style="font-family: monospace;">/node_gem/main.cpp</span></big><span
 style="font-family: Helvetica,Arial,sans-serif;">): </span><br>
<span style="font-family: monospace;"><br>
</span>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">#include "node.h"</span><br>
      <span style="font-family: monospace;">&nbsp;&nbsp; <br>
&nbsp;&nbsp; // Creates TNode
structure instance accessible trough the "node" pointer</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; TNode*
node&nbsp; =
new TNode();</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;<span
 style="color: rgb(0, 153, 0);">&nbsp; </span>// (1) Initialization of
GEMIPM2K internal data by reading&nbsp; files<br>
&nbsp;&nbsp;
//&nbsp;&nbsp;&nbsp;&nbsp; whose names are given in the
input_system_file_list_name<br>
&nbsp;</span><span style="font-family: monospace;">&nbsp; if(
node-&gt;GEM_init( ipm_input_file_list_name ) )</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; {</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp; </span><span style="font-family: monospace;">// Error
message here</span><span
 style="font-family: monospace; color: rgb(0, 153, 0);"> </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;
return 1; </span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; }</span><br
 style="font-family: monospace;">
      <br>
      <span style="font-family: monospace;">&nbsp;<span
 style="color: rgb(153, 153, 255);">&nbsp;<span
 style="color: rgb(0, 153, 0);"> </span></span>// Getting direct
access to work node
DATABR structure which exchanges the<br>
&nbsp;&nbsp; // data with
GEM IPM2 (already filled out by reading the DBR input file)<br>
      </span><span style="font-family: monospace;"></span><span
 style="font-family: monospace;">&nbsp;&nbsp; DATABR* dBR =
node-&gt;pCNode();</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; // Getting
direct
access to DataCH structure in GEMIPM2K
instance memory</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; DATACH* dCH =
node-&gt;pCSD();</span><br style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">&nbsp;&nbsp; // Extracting data bridge
array sizes</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; long int nIC =
dCH-&gt;nICb;</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; long int nDC =
dCH-&gt;nDCb;</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; long int nPH =
dCH-&gt;nPHb;</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; long int nPS =
dCH-&gt;nPSb;</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; long int
nNodes =
11; // Number of nodes in the transport part <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// (can be much greater in a real transport code)<br>
      </span></td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">// Allocating memory for keeping node
data (real transport codes may do
it differently) &nbsp;&nbsp; </span><br>
      <div style="margin-left: 40px;"><span
 style="font-family: monospace;"> </span><span
 style="font-family: monospace;">long int
*m_NodeHandle,
*m_NodeStatusCH,
*m_IterDone;</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">m_NodeHandle = new long int
[nNodes];</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">m_NodeStatusCH</span><span
 style="font-family: monospace;"> = new long int [nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_IterDone </span><span
 style="font-family: monospace;">= new long int [nNodes];</span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;">double *m_T, *m_P, *m_Vs,
*m_Ms,</span><span style="font-family: monospace;"> *m_Gs, *m_Hs,
*m_IC, *m_pH, *m_pe,</span><span style="font-family: monospace;"> *m_Eh;</span><br>
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">m_T = new double [nNodes];</span><br>
      <span style="font-family: monospace;">m_P</span><span
 style="font-family: monospace;"> = new double [nNodes];</span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;">m_Vs </span><span
 style="font-family: monospace;">= new double
[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_Ms </span><span
 style="font-family: monospace;">= new double [nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">m_Gs </span><span
 style="font-family: monospace;">= new double [nNodes];</span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;">m_Hs </span><span
 style="font-family: monospace;">= new double
[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_IC = </span><span
 style="font-family: monospace;">new double [nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_pH </span><span
 style="font-family: monospace;">= new double [nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_pe </span><span
 style="font-family: monospace;">= new double [nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">m_Eh </span><span
 style="font-family: monospace;">= new double [nNodes];</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;">double **m_xDC, **m_gam,
**m_xPH, **m_aPH, **m_vPS,
**m_mPS,**m_bPS,</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
**m_xPA, **m_dul,
**m_dll, **m_bIC, **m_rMB, **m_uIC;</span><br>
      <span style="font-family: monospace;">m_xDC = new double
*[nNodes];</span><br>
      <span style="font-family: monospace;">m_gam </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_xPH </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_aPH </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_vPS </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_mPS </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_bPS </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_xPA </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_dul </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">m_dll </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">m_bIC </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">m_rMB </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">m_uIC </span><span
 style="font-family: monospace;">= new double *[nNodes];</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;">for (long int in=0;
in&lt;nNodes; in++)</span><br>
      <span style="font-family: monospace;">{</span><br>
      <span style="font-family: monospace;">&nbsp;&nbsp; m_bIC[in] =
new
double [nIC]; </span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_rMB</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nIC]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_uIC</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nIC]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_xDC</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nDC]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_gam</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nDC]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_dul</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nDC]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_dll</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nDC]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_aPH</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nPH]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_xPH</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nPH]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_vPS</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nPS]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; m_mPS</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nPS]; </span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">&nbsp;&nbsp; m_xPA</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nPS]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">&nbsp;&nbsp; m_bPS</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;"> = </span><span
 style="font-family: monospace;">new double [nIC*nPS]; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">}</span></div>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;"> // Initialization of
GEMIPM2K and chemical information for nodes kept in the
FMT part</span><br style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">&nbsp;&nbsp; long int in;</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace; color: rgb(0, 153, 0);">&nbsp;&nbsp;
      </span><span style="font-family: monospace;">for(&nbsp;
in=0;
in&lt;nNodes; in++ )</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; {</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
// Asking GEM to run with automatic initial approximation<br>
&nbsp;&nbsp;&nbsp;&nbsp; dBR-&gt;NodeStatusCH = NEED_GEM_AIA; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;<span
 style="color: rgb(0, 153, 0);"> </span>// (2) re-calculating
equilibrium by calling GEMIPM2K, getting the status back</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
m_NodeStatusCH[in] = node-&gt;GEM_run(1.,
false);</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
if( !(
m_NodeStatusCH[in] == OK_GEM_AIA ||
m_NodeStatusCH[in] == OK_GEM_SIA ) )</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; {</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Error message here<br>
&nbsp;&nbsp;&nbsp;&nbsp; }</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; //
(6) Extracting GEMIPM input data to mass-transport program arrays</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
node-&gt;GEM_restore_MT( m_NodeHandle[in],
m_NodeStatusCH[in], m_T[in],</span><span style="font-family: monospace;">
m_P[in], <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_Vs[in], m_Ms[in],</span><span
 style="font-family: monospace;"> m_bIC[in], m_dul[in],
m_dll[in], m_aPH[in] );</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      </span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; //
(7) Extracting GEMIPM output data to mass-transport program arrays</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
node-&gt;GEM_to_MT( m_NodeHandle[in],
m_NodeStatusCH[in], m_IterDone[in],</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_Vs[in], m_Ms[in], m_Gs[in],
m_Hs[in], m_IC[in], m_pH[in], m_pe[in],</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_Eh[in], m_rMB[in],
m_uIC[in], m_xDC[in], m_gam[in],</span><span
 style="font-family: monospace;"> m_xPH[in], <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_vPS[in],
m_mPS[in],</span><span style="font-family: monospace;"> m_bPS[in],
m_xPA[in] );</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; //
Here
the setup of initial differences between node compositions, <br>
&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp; temperatures, etc. can be
implemented<br>
&nbsp;&nbsp;&nbsp;&nbsp; // Here the file output for the initial
conditions can be implemented</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; }</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">// Main loop -
iterations over nTimes time steps <br>
      </span><span style="font-family: monospace;">&nbsp;&nbsp; double
parcel[3];</span><br>
      <span style="font-family: monospace;">&nbsp;&nbsp; int ICndx[3];<br>
// Finding indexes of some Independent Components<br>
&nbsp;&nbsp; ICndx[0] =
node-&gt;IC_name_to_xDB("Ca");<br>
&nbsp;&nbsp; ICndx[1] =
node-&gt;IC_name_to_xDB("C");<br>
&nbsp;&nbsp; ICndx[2] =
node-&gt;IC_name_to_xDB("O");<br>
      <br>
&nbsp;&nbsp; long int it, nTimes = 99; <br>
&nbsp;&nbsp; for( it=0; it&lt;nTimes; it++ )&nbsp; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; {</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; //
Mass
transport loop over nodes (here not a real transport model) </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;"><span style="color: rgb(0, 153, 0);">&nbsp;</span></span><span
 style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
for(&nbsp; in=1; in&lt;nNodes; in++ )</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; {</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span> <span
 style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // some
operators that change in some nodes some amounts of some migrating <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // chemical species (m_xDC array) (or
some amounts of migrating
chemical <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // elements in m_bIC array), possibly
using data from other arrays in such <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // a way that the mass
conservation within the whole array of nodes&nbsp; is retained<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
for (int i=0; i&lt;3; i++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
parcel[i] = 0.01*m_bIC[in-1][ICndx[i]];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_bIC[in][ICndx[i]] += parcel[i];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if( in &gt; 1 )&nbsp; m_bIC[in-1][ICndx[i]] -= parcel[i];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// <span style="color: rgb(0, 0, 0);">The above example loop
implements a zero-order flux of CaO and C in
one direction.</span><br>
      </span><span style="font-family: monospace;"><span
 style="color: rgb(0, 153, 0);">&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;
// Real advective/diffusive
transport models are much more complex, but do essentially<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // similar things<br>
      </span><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
} </span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; //
      </span><span style="font-family: monospace;">Chemical
equilibration </span><span style="font-family: monospace;">loop over
nodes </span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
for(
in=0; in&lt;nNodes; in++ )</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; {</span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_NodeHandle[in] = in;</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_NodeStatusCH[in] =
NEED_GEM_SIA; </span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// (8) Setting input data for
GEMIPM to use available node speciation as <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// </span><span style="font-family: monospace;">initial </span><span
 style="font-family: monospace;">approximation<br
 style="font-family: monospace;">
      </span><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
node-&gt;GEM_from_MT(
m_NodeHandle[in], m_NodeStatusCH[in],</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_T[in], m_P[in], m_Vs[in], m_Ms[in],</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_bIC[in], m_dul[in], m_dll[in], m_aPH[in], m_xDC[in],
m_gam[in] );</span><br style="font-family: monospace;">
      <span style="color: rgb(0, 153, 0);">&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; </span><span
 style="font-family: monospace;">// (9) Passing
current FMT iteration information into the work DATABR structure</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
node-&gt;GEM_set_MT(
(double)it, 1. );</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Calling GEMIPM calculation</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_NodeStatusCH[in] =
node-&gt;GEM_run( 1., true );</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if( ( m_NodeStatusCH[in] ==
ERR_GEM_AIA ||</span><span style="font-family: monospace;">
m_NodeStatusCH[in] == ERR_GEM_SIA <br>
      <span style="color: rgb(0, 153, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
|| </span><span style="font-family: monospace;">m_NodeStatusCH[in]
== T_ERROR_GEM&nbsp;</span><span
 style="font-family: monospace; color: rgb(0, 153, 0);"> </span><span
 style="font-family: monospace;">) )</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</span><br style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
//&nbsp; Error message,&nbsp; GEM
calculation results are not retrieved <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
else</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{&nbsp;&nbsp;&nbsp; </span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if(
( m_NodeStatusCH[in] == BAD_GEM_AIA ||</span><span
 style="font-family: monospace;">
m_NodeStatusCH[in] == BAD_GEM_SIA ) )</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</span><br style="font-family: monospace;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span style="font-family: monospace;">// warning about
insufficient
quality of GEM solution, but GEM results are retrieved <br>
      </span><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}&nbsp;&nbsp;&nbsp; </span><span style="font-family: monospace;"></span><span
 style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else //
(7) Extracting GEMIPM output data
to FMT part</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
node-&gt;GEM_to_MT( m_NodeHandle[in], m_NodeStatusCH[in],
m_IterDone[in],</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_Vs[in],
m_Ms[in], m_Gs[in], m_Hs[in], m_IC[in], m_pH[in], m_pe[in],</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
m_Eh[in],m_rMB[in], m_uIC[in], m_xDC[in], m_gam[in],</span><span
 style="font-family: monospace;"> m_xPH[in], <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; m_vPS[in], m_mPS[in],</span><span
 style="font-family: monospace;"> m_bPS[in], m_xPA[in] );<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br
 style="font-family: monospace;">
&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp; // Here, the output upon completion of the
time step is usually implemented<br>
&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; to monitor the coupled simulation or
collect results<br style="font-family: monospace;">
      </span><span style="font-family: monospace;">&nbsp; }</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span></td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">// Calculations finished - end
time reached<br>
      <br>
&nbsp; // Final output e.g. of total simulation time or of the final
distribution of<br>
&nbsp; //&nbsp; components and phases in all nodes can be implemented
here<br style="font-family: monospace;">
      </span><br style="font-family: monospace;">
      <div style="margin-left: 40px;"><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">// Deleting chemical data arrays for
nodes </span><br>
      <span style="font-family: monospace;">for (long int in=0;
in&lt;nNodes; in++)</span><br>
      <span style="font-family: monospace;">{</span><br>
      <span style="font-family: monospace;">&nbsp;&nbsp;
delete[]m_bIC[in]; </span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_rMB</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"> </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_uIC</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_xDC</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_gam</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_dul</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_dll</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_aPH</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_xPH</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_vPS</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_mPS</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_xPA</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">&nbsp;&nbsp; </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_bPS</span><span
 style="font-family: monospace;">[in]</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;"></span>}<br>
      <span style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_xDC;</span><br>
      <span style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_gam</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_xPH</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_aPH</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_vPS</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_mPS</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_bPS</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_xPA</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_dul</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_dll</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_bIC</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_rMB</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_uIC</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_NodeHandle;</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_NodeStatusCH</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_IterDone</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_T;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_P</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_Vs</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_Ms</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_Gs</span><span
 style="font-family: monospace;">;</span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">
m_Hs</span><span style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_IC</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_pH</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_pe</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"> </span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">delete[]</span><span
 style="font-family: monospace;">m_Eh</span><span
 style="font-family: monospace;">;</span><br>
      <span style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><br>
      <span style="font-family: monospace;">// deleting GEMIPM and data
exchange memory structures</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">delete node;</span><br>
      <span style="font-family: monospace;"> </span><br>
      <span style="font-family: monospace;"></span></div>
      <span style="font-family: monospace;">// end of example<br
 style="font-family: monospace;">
      </span></td>
    </tr>
  </tbody>
</table>
<span style="font-family: monospace;"></span><span
 style="font-family: monospace;"><br>
</span><span style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
<big style="font-family: Helvetica,Arial,sans-serif;"><span
 style="text-decoration: underline;">Description of function
calls</span></big><span style="font-family: Helvetica,Arial,sans-serif;">
(continued, see also "node.h" file) </span><br
 style="font-family: Helvetica,Arial,sans-serif;">
<br>
<h3>(6) GEM_restore_MT()</h3>
<p>&nbsp;
<span style="font-family: monospace;">void GEM_restore_MT(&nbsp; long
int&nbsp; &amp;p_NodeHandle,&nbsp; long int&nbsp; &amp;p_NodeStatusCH, </span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
double &amp;p_TK,&nbsp; double &amp;p_P, double &amp;p_Vs, double
&amp;p_Ms, </span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
double *p_bIC, double *p_dul, double *p_dll, double *p_aPH );</span></p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Purpose:&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;
Passes (copies) the GEMIPM2K
input data from the work instance of DATABR structure.&nbsp; <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; This call is useful after the GEM_init()&nbsp; and
GEM_run() calls to initialize the arrays which keep the <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; chemical data for all nodes used
in the mass-transport model. The GEM_init() call reads the <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; IPM, DCH and DBR file into the
GEMIPM2K work structures (see details above in Section 1).<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; The GEM_run() call (details in Section
2) calculates the full chemical speciation.&nbsp; <br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Parameters: </span><br>
</p>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Parameter
ID<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Type<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Explanation<br>
      </td>
      <td style="vertical-align: top;">Tag in <br>
DBR file<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_NodeHandle</span></td>
      <td style="vertical-align: top;">long int &amp;<br>
      </td>
      <td style="vertical-align: top;">Node identification handle</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">NodeHandle</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_NodeStatusCH</span></td>
      <td style="vertical-align: top;">long int &amp;<br>
      </td>
      <td style="vertical-align: top;">Node status
code (see Section 2 for possible codes)<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">NodeStatusCH</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_TK</span></td>
      <td style="vertical-align: top;">double &amp;<br>
      </td>
      <td style="vertical-align: top;">Temperature T, Kelvins <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">TK<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_P</span></td>
      <td style="vertical-align: top;">double &amp;<br>
      </td>
      <td style="vertical-align: top;">Pressure P,&nbsp; <span
 style="color: rgb(0, 0, 0);">Pa&nbsp;</span> <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">P<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_Vs</span></td>
      <td style="vertical-align: top;">double &amp;<br>
      </td>
      <td style="vertical-align: top;">Volume
V of reactive subsystem,&nbsp; <span style="color: rgb(0, 0, 0);">m3</span><br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">Vs<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_Ms</span></td>
      <td style="vertical-align: top;">double &amp;<br>
      </td>
      <td style="vertical-align: top;">Mass of
reactive subsystem,
kg&nbsp; <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">Ms<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_bIC</span></td>
      <td style="vertical-align: top;">double *<br>
      </td>
      <td style="vertical-align: top;">Bulk mole
amounts of Independent Components
[<span style="font-family: monospace;">dCH-&gt;nICb</span> elements]</td>
      <td style="vertical-align: top; font-family: monospace;">bIC<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_dul</span></td>
      <td style="vertical-align: top;">double *<br>
      </td>
      <td style="vertical-align: top;">Upper restrictions to amounts of
Dependent Components [<span style="font-family: monospace;">dCH-&gt;nDCb</span>
elements]<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">dul<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_dll</span></td>
      <td style="vertical-align: top;">double *<br>
      </td>
      <td style="vertical-align: top;">Lower restrictions to amounts of
Dependent Components [<span style="font-family: monospace;">dCH-&gt;nDCb</span>
elements] <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">dll<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_aPH</span></td>
      <td style="vertical-align: top;">double *<br>
      </td>
      <td style="vertical-align: top;">Specific
surface areas of phases, <span style="color: rgb(0, 0, 0);">m2/kg</span>
[<span style="font-family: monospace;">dCH-&gt;nPHb</span>
elements]<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">aPH<br>
      </td>
    </tr>
  </tbody>
</table>
<p><span style="font-family: Helvetica,Arial,sans-serif;">In </span><span
 style="font-family: monospace;">GEM_restore_MT()</span><span
 style="font-family: Helvetica,Arial,sans-serif;">, all parameters are
output parameters( i.e.
previous contents of memory given to parameters will be lost).</span><br
 style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">Contents of the
work DATABR structure remain unchanged. This function
is a reverse of&nbsp; </span><span style="font-family: monospace;">GEM_from_MT()</span><span
 style="font-family: Helvetica,Arial,sans-serif;">, see Section 8.</span>
<br>
</p>
<br>
<h3>(7) GEM_to_MT()</h3>
<span style="font-family: monospace;"> void GEM_to_MT( long int
&amp;p_NodeHandle, long int &amp;p_NodeStatusCH, long int
&amp;p_IterDone, </span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; double
&amp;p_Vs, double &amp;p_Ms, double &amp;p_Gs, double &amp;p_Hs, double
&amp;p_IC,&nbsp; </span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; double
&amp;p_pH, double &amp;p_pe, double &amp;p_Eh,&nbsp; </span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; double
*p_rMB,&nbsp; double *p_uIC,&nbsp; double *p_xDC,&nbsp; double *p_gam,
double *p_xPH,&nbsp; </span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; double
*p_vPS,&nbsp; double *p_mPS, double *p_bPS, double *p_xPA&nbsp; );</span><br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Purpose:</span>&nbsp;&nbsp;
Retrieves the GEMIPM2 chemical speciation
calculation results from the work DATABR structure instance <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; into memory provided by the mass
transport part. Dimensions and order of elements in the arrays must
correspond <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; to those in currently existing
DATACH memory structure.<br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Parameters:&nbsp;</span>
<br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Parameter
ID<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Type<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Explanation<br>
      </td>
      <td style="vertical-align: top;">Tag in <br>
DBR file<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_NodeHandle</span></td>
      <td style="vertical-align: top;">long int &amp;<br>
      </td>
      <td style="vertical-align: top;">Node identification handle</td>
      <td style="vertical-align: top; font-family: monospace;">NodeHandle</td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-decoration: underline;"><span
 style="font-family: monospace;">p_NodeStatusCH</span></td>
      <td style="vertical-align: top;">long int &amp;<br>
      </td>
      <td style="vertical-align: top;">Node status
code (see Section 2 for possible codes)<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">NodeStatusCH<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_IterDone</td>
      <td style="vertical-align: top;">long int &amp;</td>
      <td style="vertical-align: top;">Number of iterations performed
in the last GEM IPM calculation<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">IterDone<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_Vs</td>
      <td style="vertical-align: top;">double &amp;<br>
      </td>
      <td style="vertical-align: top;">Total volume
V of reactive subsystem at given P,T,&nbsp; <span
 style="color: rgb(0, 0, 0);">m3</span> <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">Vs<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_Ms</td>
      <td style="vertical-align: top;">double &amp;<br>
      </td>
      <td style="vertical-align: top;">Total mass of
the reactive subsystem,
kg&nbsp; <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">Ms<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_Gs</td>
      <td style="vertical-align: top;">double &amp;</td>
      <td style="vertical-align: top;">Total Gibbs energy
of the reactive subsystem<span style="color: rgb(0, 153, 0);">, J</span><br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">Gs<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_Hs</td>
      <td style="vertical-align: top;">double &amp;</td>
      <td style="vertical-align: top;">Total enthalpy of
reactive subsystem, J (reserved)<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">Hs<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_IC</td>
      <td style="vertical-align: top;">double &amp;</td>
      <td style="vertical-align: top;">Effective aqueous ionic
strength, molal (0 if no aqueous electrolyte phase)<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">IC<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_pH</td>
      <td style="vertical-align: top;">double &amp;</td>
      <td style="vertical-align: top;">pH of aqueous
solution (0 if no aqueous electrolyte phase)</td>
      <td style="vertical-align: top; font-family: monospace;">pH<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_pe</td>
      <td style="vertical-align: top;">double &amp;</td>
      <td style="vertical-align: top;">pe of aqueous
solution (0 if no aqueous electrolyte phase)</td>
      <td style="vertical-align: top; font-family: monospace;">pe<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_Eh</td>
      <td style="vertical-align: top;">double &amp;</td>
      <td style="vertical-align: top;">Eh of aqueous
solution,
V (0 if no aqueous electrolyte phase)</td>
      <td style="vertical-align: top; font-family: monospace;">Eh<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_rMB</td>
      <td style="vertical-align: top;">double *<br>
      </td>
      <td style="vertical-align: top;">Mole balance residuals for
Independent Components [<span style="font-family: monospace;">dCH-&gt;nICb</span>
elements]</td>
      <td style="vertical-align: top; font-family: monospace;">rMB </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_uIC</td>
      <td style="vertical-align: top;">double *<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">Dual
solution</span>: IC chemical
potentials, mol/mol [<span style="font-family: monospace;">dCH-&gt;nICb</span>
elements]<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">uIC </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_xDC</td>
      <td style="vertical-align: top;">double *<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">Primal
solution</span>: DC mole
amounts (equilibrium speciation) [<span style="font-family: monospace;">dCH-&gt;nDCb</span>
elements] <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">xDC </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_gam</td>
      <td style="vertical-align: top;">double *</td>
      <td style="vertical-align: top;">External activity
coefficients of DC [<span style="font-family: monospace;">dCH-&gt;nDCb</span>
elements] </td>
      <td style="vertical-align: top; font-family: monospace;">gam</td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_xPH</td>
      <td style="vertical-align: top;">double *<br>
      </td>
      <td style="vertical-align: top;">Total mole amounts of
all phases [<span style="font-family: monospace;">dCH-&gt;nPHb</span>
elements]<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">xPH </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_vPS</td>
      <td style="vertical-align: top;">double *</td>
      <td style="vertical-align: top;">Total volumes of multicomponent
phases, <span style="color: rgb(0, 0, 0);">m3</span> [<span
 style="font-family: monospace;">dCH-&gt;nPSb</span>
elements]&nbsp;&nbsp; <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">vPS</td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_mPS</td>
      <td style="vertical-align: top;">double *</td>
      <td style="vertical-align: top;">Total mass of multicomponent
phase (carrier),&nbsp; <span style="color: rgb(0, 0, 0);">kg</span>
[<span style="font-family: monospace;">dCH-&gt;nPSb</span>
elements]&nbsp;&nbsp;&nbsp; ????<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">mPS</td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; text-decoration: underline;">p_bPS</td>
      <td style="vertical-align: top;">double *</td>
      <td style="vertical-align: top;">Bulk compositions of
phases [<span style="font-family: monospace;">dCH-&gt;nPSb*dCH-&gt;nICb</span>
elements]</td>
      <td style="vertical-align: top; font-family: monospace;">bPS</td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_xPA</td>
      <td style="vertical-align: top;">double *</td>
      <td style="vertical-align: top;">Amount of carrier in
a multicomponent asymmetric phase&nbsp; [<span
 style="font-family: monospace;">dCH-&gt;nPSb</span> elements] </td>
      <td style="vertical-align: top; font-family: monospace;">xPA</td>
    </tr>
  </tbody>
</table>
<p>I<span style="font-family: Helvetica,Arial,sans-serif;">n </span><span
 style="font-family: monospace;">GEM_to_MT()</span><span
 style="font-family: Helvetica,Arial,sans-serif;">, all parameters are
output parameters ( i.e. previous
contents of memory given to parameters will be lost).</span><br
 style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">Contents of the
work DATABR structure remain
unchanged. </span><br style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">Parameter IDs
for the most important GEMIPM2 output data are
underlined. </span><br>
</p>
<br>
<h3>(8) GEM_from_MT()</h3>
<p>&nbsp;
<span style="font-family: monospace;">void GEM_from_MT(&nbsp; long
int&nbsp; p_NodeHandle,&nbsp; long int&nbsp; p_NodeStatusCH, </span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double p_TK,&nbsp; double p_P,
double p_Vs, double p_Ms, </span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
double *p_bIC, double *p_dul, double *p_dll, double *p_aPH );</span></p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Purpose:&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;
Loads the GEMIPM2K input data
for a given mass-transport node into the work instance of DATABR
structure. &nbsp; <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; This call is usually preceeding the GEM_run() call<br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Parameters: </span><br>
</p>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Parameter
ID<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Type<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Explanation<br>
      </td>
      <td style="vertical-align: top;">Tag in <br>
DBR file<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_NodeHandle</span></td>
      <td style="vertical-align: top;">long int <br>
      </td>
      <td style="vertical-align: top;">Node identification handle<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">NodeHandle
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-decoration: underline;"><span
 style="font-family: monospace;">p_NodeStatusCH</span></td>
      <td style="vertical-align: top;">long int <br>
      </td>
      <td style="vertical-align: top;">Node status
code (NEED_GEM_SIA or NEED_GEM_AIA), will be changed internally after
GEM_run() <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">NodeStatusCH
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-decoration: underline;"><span
 style="font-family: monospace;">p_TK</span></td>
      <td style="vertical-align: top;">double <br>
      </td>
      <td style="vertical-align: top;">Temperature T, Kelvin<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">TC<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-decoration: underline;"><span
 style="font-family: monospace;">p_P</span></td>
      <td style="vertical-align: top;">double <br>
      </td>
      <td style="vertical-align: top;">Pressure P,&nbsp; Pa <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">P<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_Vs</span></td>
      <td style="vertical-align: top;">double <br>
      </td>
      <td style="vertical-align: top;">Volume
V of reactive subsystem, m3, may change in GEM_run() internally<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">Vs<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_Ms</span></td>
      <td style="vertical-align: top;">double <br>
      </td>
      <td style="vertical-align: top;">Mass of
reactive subsystem,
kg; may be updated&nbsp; in GEM_run() internally </td>
      <td style="vertical-align: top; font-family: monospace;">Ms<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-decoration: underline;"><span
 style="font-family: monospace;">p_bIC</span></td>
      <td style="vertical-align: top;">double*<br>
      </td>
      <td style="vertical-align: top;">Bulk mole
amounts of Independent Components
[<span style="font-family: monospace;">dCH-&gt;nICb</span> elements]</td>
      <td style="vertical-align: top; font-family: monospace;">bIC<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_dul</span></td>
      <td style="vertical-align: top;">double*<br>
      </td>
      <td style="vertical-align: top;">Upper restrictions to amounts of
Dependent Components [<span style="font-family: monospace;">dCH-&gt;nDCb</span>
elements]<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">dul<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_dll</span></td>
      <td style="vertical-align: top;">double*<br>
      </td>
      <td style="vertical-align: top;">Lower restrictions to amounts of
Dependent Components [<span style="font-family: monospace;">dCH-&gt;nDCb</span>
elements] <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">dll<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_aPH</span></td>
      <td style="vertical-align: top;">double*<br>
      </td>
      <td style="vertical-align: top;">Specific
surface areas of phases, <span style="color: rgb(0, 0, 0);">m2/kg</span>
[<span style="font-family: monospace;">dCH-&gt;nPHb</span>
elements]<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">aPH<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">p_xDC</td>
      <td style="vertical-align: top;">double*</td>
      <td style="vertical-align: top;">Mole amounts of DCs [<span
 style="font-family: monospace;">dCH-&gt;</span><span
 style="font-family: monospace;">nDCb</span>] -
will be internally convoluted and added to the <span
 style="font-family: monospace;">bIC</span> GEM input vector&nbsp;
(only in the overloaded call, see Section 8a below)<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">xDC</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">p_gam</span> <br>
      </td>
      <td style="vertical-align: top;">double*</td>
      <td style="vertical-align: top;">DC activity coefficients [<span
 style="font-family: monospace;">dCH-&gt;</span><span
 style="font-family: monospace;">nDCb</span>] - used only in the
overloaded call (see Section 8b) together with the <span
 style="font-family: monospace;">p_xDC</span> data as GEM initial
approximation for this node <br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">gam</span><br>
      </td>
    </tr>
  </tbody>
</table>
<p><span style="font-family: Helvetica,Arial,sans-serif;">In </span><span
 style="font-family: monospace;">GEM_from_MT()</span><span
 style="font-family: Helvetica,Arial,sans-serif;">, all parameters are
input ( i.e. contents of memory
given to parameters will remain unchanged). </span><br
 style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">Most frequently
used input parameters are underlined in the above
table. </span><br style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">This function is
a reverse of&nbsp; </span><span style="font-family: monospace;">GEM_restore_MT()</span><span
 style="font-family: Helvetica,Arial,sans-serif;">, see Section
6.&nbsp; </span><br style="font-family: Helvetica,Arial,sans-serif;">
<span style="font-family: Helvetica,Arial,sans-serif;">To retrieve, if
necessary, the internally changed&nbsp; Vs or Ms values after </span><span
 style="font-family: monospace;">GEM_run()</span><span
 style="font-family: Helvetica,Arial,sans-serif;">, use
</span><span style="font-family: monospace;">GEM_restore_MT()</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: Helvetica,Arial,sans-serif;">or </span><span
 style="font-family: monospace;">GEM_to_MT()</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> calls.</span><br>
<br>
</p>
<h3>(8a) GEM_from_MT() overload call </h3>
<span style="font-family: monospace;">void GEM_from_MT(&nbsp; long
int&nbsp; p_NodeHandle,&nbsp; long int&nbsp; p_NodeStatusCH, </span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double p_TK,&nbsp; double p_P,
double p_Vs, double p_Ms, </span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
double *p_bIC, double *p_dul, double *p_dll, double *p_aPH, </span><span
 style="font-family: monospace;">double *p_xDC</span><span
 style="font-family: monospace;"> );</span>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Purpose:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Loads the GEMIPM2K input data
for a given mass-transport node into the work instance of DATABR
structure. &nbsp; <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; In advection/diffusion transport codes (such as
GeoSys),&nbsp; the amounts of aqueous species are usually moved <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; between nodes, but not the total
amounts of elements. Conversely, after the mass transport step, only
the <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; speciation vector <span
 style="font-family: monospace;">xDC</span> is changed in each node,
and an additional step would be needed to compute a <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; corrected <span
 style="font-family: monospace;">bIC</span> vector (i.e. elemental bulk
composition) which is the GEM input to compute the new speciation. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; With the 8a variant of GEM_from_MT()
call, this task is performed in GEMIPM2K, so that there is no need<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; to do it in the mass transport
part. <br>
</p>
<p>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This overloaded variant uses the <span
 style="font-family: monospace;">xDC</span> speciation vector (provided
as the last parameter in the function call list) <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for setting the new bulk chemical
composition to be used in the next GEM_run() calculation. Whatever
total <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; charge value is computed from <span
 style="font-family: monospace;">xDC</span> data, it will be set to
zero in the last element of <span style="font-family: monospace;">bIC</span>
vector. Actually, total <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; amounts of chemical elements are
calculated from stoichiometries of Dependent Components (as provided <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; in the A matrix in DATACH
structure) and their amounts (in the <span
 style="font-family: monospace;">xDC</span> vector), and then added to
the amounts <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; given in the <span
 style="font-family: monospace;">bIC</span> vector (passed through the <span
 style="font-family: monospace;">p_bIC</span> parameter). Hence, two
cases are possible. One case is<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; when the mass trasport step puts
in the p_xDC parameter the <span style="text-decoration: underline;">differences</span>
between the new and the old speciation<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; in the node chemical system. In this
case, the old p_bIC content (e.g. unchanged since the last GEM
calculation<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; for this node) must be provided - then it will be
automatically corrected.&nbsp; Another case is when the mass-transport<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; part delivers in p_xDC the complete new
speciation after the transport time step. In this case, the p_bIC
vector <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; must be filled with zeros because its new content will be
completely retrieved from the x_DC vector.&nbsp; <br>
</p>
<p><span style="font-family: Helvetica,Arial,sans-serif;">Parameters:</span>&nbsp;
see Table in Section (8) - all are input
parameters. <br>
<br>
</p>
<h3>(8b) GEM_from_MT() overload call
</h3>
<span style="font-family: monospace;">void GEM_from_MT(&nbsp; long
int&nbsp; p_NodeHandle,&nbsp; long int&nbsp; p_NodeStatusCH, </span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double p_TK,&nbsp; double p_P,
double p_Vs, double p_Ms, </span><span style="font-family: monospace;">double
*p_bIC, <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; double *p_dul, double *p_dll, double
*p_aPH, </span><span style="font-family: monospace;">double *p_xDC,
double *p_gam</span><span style="font-family: monospace;"> );<br>
<br>
</span><br>
<span style="font-family: Helvetica,Arial,sans-serif;">Purpose:&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;
Loads the GEMIPM2K input data
for a given mass-transport node into the work instance of DATABR
structure. <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; In addition, provides access to speciation vector p_xDC
and DC activity coefficients p_gam that will be used in <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
GEM "smart initial approximation" SIA mode if dBR-&gt;NodeStatusCH ==
<span style="font-family: monospace;">NEED_GEM_SIA
(5)</span> and <span style="font-family: monospace;"><br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; uPrimalSol = true </span>are
set for the GEM_run() call (see Section 2) . This works only when the
DATACH <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; structure contains a full list
of Dependent Components used in GEM IPM2 calculations. <br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Parameters:</span>&nbsp;
see Table in Section (8) - all are input parameters. <br>
<br>
<span style="color: rgb(204, 0, 0);">Open issue: shall p_xDC content
used for updating bIC content in the
same way as in variant (8a)?</span> <br>
<br>
<h3>(9) GEM_set_MT()</h3>
<span style="font-family: monospace;">void GEM_set_MT( double p_Tm,
double p_dt );</span><br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Purpose:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Optional, for passing the
current mass transport iteration information into the work DATABR
structure<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (e.g. for using it in tracing/debugging
or in writing DBR files for nodes).<br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Parameters:&nbsp;
</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">p_Tm</span>&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Actual total
simulation time,
s&nbsp;&nbsp;&nbsp; <br>
&nbsp; &nbsp; <span style="font-family: monospace;">p_dt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Actual
time step,
s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
<br>
<br>
<h2>3. Miscellaneous methods for accessing the GEMIPM2K data from the
mass transport part </h2>
<span style="font-family: Helvetica,Arial,sans-serif;">These public
methods of access to particular elements of TNode class
data require that the "node.h" header is included. Usage of these
public methods is strongly preferred instead of direct access to fields
of the DATABR, DATACH and MULTI memory sturctures. </span><br>
<br>
<h4>3.1. Whole node chemical system</h4>
<span style="font-family: Helvetica,Arial,sans-serif;">Table 3.1.
Access to properties of the whole chemical system assigned
to the node</span><br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Method<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Function<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Example<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">TNode*
TNode();</td>
      <td style="vertical-align: top;">Constructor of the class
instance in memory<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">TNode* node&nbsp; =
new TNode();</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double GEM_CalcTime();</span> <br>
      </td>
      <td style="vertical-align: top;">Returns GEMIPM2 calculation time
in s elapsed during the last call to
GEM_run()</td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">DATACH*
pCSD() </td>
      <td style="vertical-align: top;">Get the pointer to
chemical system definition data structure</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">DATACH* dCH =
node-&gt;pCSD();</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">DATABR*
pCNode() </td>
      <td style="vertical-align: top;">Get pointer to work
node data structure (not recommended on TNodearray level)<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">DATABR* dBR =
node-&gt;pCNode();</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> double
cTK() </td>
      <td style="vertical-align: top;">Get
current node Temperature T, Kelvin<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">double
TK = node-&gt;cTK(); <br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> double
cTC()</td>
      <td style="vertical-align: top;">Get
current node Temperature T, Celsius<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">double
TC = node-&gt;cTC();</td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> double
cP()</td>
      <td style="vertical-align: top;">Get
current node Pressure P,&nbsp; <span style="color: rgb(0, 0, 0);">Pa</span>
      <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">double P
= node-&gt;cP(); </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double cMs()</span><br>
      </td>
      <td style="vertical-align: top;">Get current mass of reactive
part, in kg<br>
      </td>
      <td style="vertical-align: top; font-family: monospace;">double
Mass
= node-&gt;cMs();</td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double cVs()</span><br>
      </td>
      <td style="vertical-align: top;">Get current volume of reactive
part, in m<sup>3</sup><br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double Vol_L = node-&gt;cVs*1000.;</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> void
setNodeHandle( long int jj )</td>
      <td style="vertical-align: top;">Set current node identification
handle to value of parameter jj<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">node-&gt;setNodeHandle( 4L );</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">double
ResizeNode( double Factor );</td>
      <td style="vertical-align: top;">Resizes the node chemical system
size by factor Factor; returns new mass of the chemical system in <span
 style="color: rgb(0, 0, 0);">kg</span><br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double NewMass&nbsp; =
node-&gt;ResizeNode( 3.0 ); </span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">bool&nbsp;
check_TP( double T, double P );</td>
      <td style="vertical-align: top;">Checks if given temperature T
(K) and pressure P (Pa) fit within the
interpolation intervals of the DATACH lookup arrays (returns true) or
not (returns false)<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">if(!node-&gt;checkTP(320.,2e5))</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; return 1;</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> long
int&nbsp; check_grid_TP(&nbsp; double T,
double P );</td>
      <td style="vertical-align: top;">Tests T (K) and P as a grid
point
for
the interpolation
of thermodynamic data using DATACH lookup arrays. Returns -1L if
interpolation is needed, or 1D index of the lookup array element if Tc
and P fit within the respective tolerances. For producing lookup arrays
(in GEMS), we recommend using step for temperature less or equal to 10
degrees in order to assure good accuracy of interpolation especially
for S0 and Cp0 of aqueous species. <br>
      </td>
      <td style="vertical-align: top; font-family: monospace;"> long
int laX = node-&gt;check_grid_TP(&nbsp; 400., 5e5 ); <br>
      </td>
    </tr>
  </tbody>
</table>
<br>
&nbsp;&nbsp;&nbsp; <br>
<h4>3.2. Manipulations with phase- and component indexes</h4>
In GEMIPM2K code, two indexation systems for phases and components are
maintained. One pertains to the complete definition of chemical system
as expressed in the input DCH and IPM files and, accordingly, in DATACH
and MULTI memory structures (the latter is used in GEM IPM2
calculations). Another indexation defines which phases and components
are involved in the data exchange via the <br>
DBR input/output files and the DATABR memory structure in the work
TNode class instance. The two indexation systems are connected through
the index mapping lists <big><span style="font-family: monospace;"><span
 style="font-family: monospace;">xIC, xDC</span></span><span
 style="font-family: Times New Roman,Times,serif;"> <small>and </small></span><span
 style="font-family: monospace;"><span style="font-family: monospace;">xPH
</span></span><small>(and the respective counters </small></big><span
 style="font-family: monospace;">nICb, nIC, </span><span
 style="font-family: monospace;">nDCb,
nDC, </span><span style="font-family: monospace;">nPHb, nPH, </span><big><span
 style="font-family: monospace;"><small>nPSb, nPS</small></span></big><big><small>)
</small></big><big><span style="font-family: monospace;"><span
 style="font-family: monospace;"></span></span><small>that exist in the
DCH file and DATACH structure. </small></big><big><br>
</big>
<p style="font-family: Helvetica,Arial,sans-serif;"><small><big><span
 style="font-family: Times New Roman,Times,serif;">The trivial
(default) case is when</span></big> </small> <span
 style="font-family: monospace;">nICb
= nIC,</span><span style="font-family: monospace;">nDCb =
nDC, </span><span style="font-family: monospace;">nPHb =
nPH, </span><big><span style="font-family: monospace;"><small>nPSb =
nPS.<span style="font-family: Helvetica,Arial,sans-serif;"> </span></small></span><small
 style="font-family: Times New Roman,Times,serif;">In this
case, the data arrays in the DATABR structure <span
 style="text-decoration: underline;">exactly map</span> the
corresponding data arrays in DATACH and MULTI structures. For
instance, the bulk chemical composition of the system - vector</small><span
 style="font-family: monospace;"><small><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">b</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></small></span><small
 style="font-family: Times New Roman,Times,serif;">in the MULTI
structure - is the
same as the vector</small><span style="font-family: monospace;"><small><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">bIC</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></small></span><small
 style="font-family: Times New Roman,Times,serif;">provided in the
DATABR structure or in the DBR file. The index mapping lists</small><span
 style="font-family: monospace;"><small><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">xIC, xDC</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></small></span><small
 style="font-family: Times New Roman,Times,serif;">and</small><span
 style="font-family: monospace;"><small><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">xPH</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></small></span><small
 style="font-family: Times New Roman,Times,serif;">will also be
trivial. For instance, given 7 independent components in the system</small><span
 style="font-family: monospace;"><small><span
 style="font-family: Helvetica,Arial,sans-serif;"> (</span><span
 style="font-family: monospace;">nIC</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> = 7), </span></small></span><small
 style="font-family: Times New Roman,Times,serif;">the</small><span
 style="font-family: monospace;"><small><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">xIC</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></small></span><small
 style="font-family: Times New Roman,Times,serif;">array will simply
contain seven ascending indexes</small><span
 style="font-family: monospace;"><small><span
 style="font-family: Helvetica,Arial,sans-serif;"> (</span><span
 style="font-family: monospace;">0,1,2,3,4,5,6</span></small><span
 style="font-family: Helvetica,Arial,sans-serif;"><small>). </small><br>
</span></span></big></p>
<p style="font-family: Helvetica,Arial,sans-serif;"><span
 style="font-family: Times New Roman,Times,serif;">During the
development of GEMIPM2K, it was foreseen that the usage of
index mapping lists</span><span style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;">&nbsp; </span></span><span
 style="font-family: monospace;"><span style="font-family: monospace;">xIC,xDC</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></span><span
 style="font-family: Times New Roman,Times,serif;">and</span><span
 style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">xPH</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></span><span
 style="font-family: Times New Roman,Times,serif;">may significantly
accelerate data exchange and reduce memory size of the
coupled FMT-GEM problem when some ICs, DCs and phases are not
considered in the data exchange and/or in transport between the nodes.
For example, the
break-through columns
in experiments are often filled with quartz sand, dissolution of which
can be neglected, so the transport of dissolved silica can also be
neglected.&nbsp; For a system involving calcium and magnesium,
carbonate, and chloride, the&nbsp; DATACH lists in this case will look
like:</span><span style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"><br>
</span></span></p>
<p style="font-family: Helvetica,Arial,sans-serif; margin-left: 40px;"><span
 style="font-family: monospace;"><span style="font-family: monospace;">&lt;nIC&gt;
8&nbsp;&nbsp; &lt;nDC&gt; 27&nbsp;&nbsp; &lt;nPH&gt; 8&nbsp;&nbsp;
&lt;nPS&gt; 2<br>
&lt;ICNL&gt;</span><span
 style="font-family: Helvetica,Arial,sans-serif;">&nbsp; </span><span
 style="font-family: monospace;">'C' 'Ca' 'Cl' 'H' 'Mg' 'O' <span
 style="color: rgb(204, 0, 0);">'Si'</span> <span
 style="color: rgb(204, 0, 0);">'Zz'</span></span><span
 style="font-family: Helvetica,Arial,sans-serif;"> &nbsp;&nbsp; ( NB: </span><span
 style="font-family: monospace;">'Zz'</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> stays for electrical
charge). <br>
</span><span style="font-family: monospace;">&lt;DCNL&gt;</span><span
 style="font-family: Helvetica,Arial,sans-serif;">&nbsp; </span><span
 style="font-family: monospace;">'Ca+2' 'CaOH+' <span
 style="color: rgb(204, 0, 0);">'Ca(HSiO3)+'</span> <span
 style="color: rgb(204, 0, 0);">'CaSiO3@'</span> 'Mg+2' 'MgOH+' <span
 style="color: rgb(204, 0, 0);">'HSiO3-' 'SiO2@' 'SiO3-2'</span> 'CO2@'
'CO3-2' 'HCO3-' <span style="color: rgb(153, 51, 153);">'CH4@'</span>
'Cl-' 'H2@' 'O2@' 'OH-' 'H+' 'H2O@' <span
 style="color: rgb(204, 0, 0);">'H2' 'O2'</span> <span
 style="color: rgb(153, 51, 153);">'Gr'</span> 'Cal' 'Dis-Dol' <span
 style="color: rgb(153, 51, 153);">'Portlandite' 'Brc'</span> <span
 style="color: rgb(204, 0, 0);">'Qtz'</span></span><span
 style="font-family: Helvetica,Arial,sans-serif;">. <br>
</span><span style="font-family: monospace;">&lt;PHNL&gt;</span><span
 style="font-family: Helvetica,Arial,sans-serif;">&nbsp;</span><span
 style="font-family: monospace;"> 'aq_gen' <span
 style="color: rgb(204, 0, 0);">'gas_gen'</span> <span
 style="color: rgb(153, 51, 153);">'Graphite'</span> 'Calcite'
'Dolomite-dis' <span style="color: rgb(153, 51, 153);">'Portlandite'
'Brucite'</span><span style="color: rgb(204, 0, 0);"> 'Quartz'</span></span><span
 style="font-family: Helvetica,Arial,sans-serif;"><br>
</span><span style="font-family: monospace;">&lt;nDCinPH&gt;</span><span
 style="font-family: Helvetica,Arial,sans-serif;">&nbsp; </span><span
 style="font-family: monospace;">19 2 1 1 1 1 1 1</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> <br>
</span></span></p>
<p style="font-family: Helvetica,Arial,sans-serif;"><span
 style="font-family: Times New Roman,Times,serif;">Now, suppose that
our
mass transport model does not consider the transport of gas phase,
electric charge, and of dissolved silicium species (non-transported
components and species are marked red in the lists above). Some
aqueous species and solids are very unlikely to appear (marked in pink)
and thus
can also be considered irrelevant for the MT model . Then&nbsp;
the&nbsp; respective arrays of the DATABR structure can be made
smaller, and values in them re-mapped to DATACH or MULTI structure as
follows: </span><span style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"><br>
</span></span></p>
<p style="font-family: Helvetica,Arial,sans-serif; margin-left: 40px;"><span
 style="font-family: monospace;"><span style="font-family: monospace;">&lt;nICb&gt;
6 &nbsp; &lt;nDCb&gt; 15 &nbsp; &lt;nPHb&gt; 3 &nbsp; &lt;nPSb&gt; 1<br>
&lt;xIC&gt;&nbsp; 0 1 2 3 4 5 <br>
&lt;xDC&gt;&nbsp; 0 1&nbsp; 4 5&nbsp; 9 10 11&nbsp; 13 14 15 16 17
18&nbsp; 22 23 <br>
&lt;xPH&gt;&nbsp; 0&nbsp; 3 4 <br>
</span></span></p>
<p style="font-family: Helvetica,Arial,sans-serif;"><span
 style="font-family: Times New Roman,Times,serif;">It is important
to realize that the re-mapping does not affect any dimensions in the
MULTI structure and any DATACH lists and arrays (the latter remain
accessible in full also from the mass transport part of the coupled
code).
Values for components and phases marked red (non-transported) are
skipped only from data arrays in all instances of the DATABR structure,
but
these components and phases are still present in DATACH and MULTI
structures and may take part in the chemical equilibration modeled in
GEM IPM2 runs. In the above example,
the size of a DATABR instance (and DBR file) becomes 30% less
compared with the trivial (complete) index mapping case.&nbsp; This
decrease can be even more dramatic for some transport algorithms where
only a certain tracers move, or where the advection strongly prevails
over the diffusion. In the latter case, only the bulk aqueous solution
is migrated as the whole between the nodes, so all dependent components
of the aqueous phase can be skipped from the DATABR mapping. In the
above example, this would make the DATABR instance ca. 3-4 times
smaller
than in the trivial mapping case. </span><span
 style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"><br>
</span></span></p>
<p style="font-family: Helvetica,Arial,sans-serif;"><span
 style="font-family: Times New Roman,Times,serif;">It can be stated
that
the presence of DATABR index mapping to DATACH structure provides a
great flexibility in defining various coupling schemes between the FMT
and the GEM parts. A natural question is - how the bulk composition of
the node system can be set up when the mapping list</span><span
 style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">xIC</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></span><span
 style="font-family: Times New Roman,Times,serif;">is incomplete?&nbsp;
A straightforward answer is - the full</span><span
 style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">b</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></span><span
 style="font-family: Times New Roman,Times,serif;">vector can always be
provided in the IPM file (from where it is directly loaded into the
MULTI structure).</span><span style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></span><span
 style="font-family: Times New Roman,Times,serif;">The </span><span
 style="font-family: monospace;"><span style="font-family: monospace;">TNode</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></span><span
 style="font-family: Times New Roman,Times,serif;">class also has
methods for the direct access to the</span><span
 style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span><span
 style="font-family: monospace;">b</span><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></span><span
 style="font-family: Times New Roman,Times,serif;">vector using the
DATACH/MULTI indexation, which can be used e.g. for setting in all
nodes the initial amounts of ICs skipped from the DATABR index mapping.
Use of this functionality makes sense in 2-D or 3-D FMT problems with
relatively large chemical system definition, where it may result in
considerably less memory demand and higher performance of data
exchange. However, the use of SIA initial approximation mode of GEM
IPM2 may be restricted in this case. Hence, for 1-D columns, we
still recommend
using the trivial (complete) one-to-one mapping in DATABR and DBR
files.</span><span style="font-family: monospace;"><span
 style="font-family: Helvetica,Arial,sans-serif;"> </span></span></p>
In Table 3.2 below, the description of TNode class fnctionality for
manipulating the&nbsp; indexes of phases and components (also by names)
is provided. Data access methods using either DBR or DCH indexation are
summarized in Tables 3.3, 3.4 and so on.&nbsp; <br>
<br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Table 3.2.
Retrieval of indexes for components and phases</span><br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Method<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Function<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Example<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> long
int IC_name_to_xCH(const char *Name);</td>
      <td
 style="vertical-align: top; font-family: Times New Roman,Times,serif;">Returns
DCH index of IC given the IC Name string
(null-terminated) or -1 if no such name was found in the DATACH IC name
list</td>
      <td
 style="vertical-align: top; font-family: Times New Roman,Times,serif;">l<span
 style="font-family: monospace;">ong int xCa =
node-&gt;IC_name_to_xCH("Ca");</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long int
DC_name_to_xCH(const char *Name);</td>
      <td style="vertical-align: top;"> Returns
DCH index of DC given
the DC Name string
(null-terminated) or -1 if no such name was found in the DATACH DC name
list</td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xCa_ion = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">DC_name_to_xCH("Ca+2");</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> long
int Ph_name_to_xCH(const char *Name);</td>
      <td style="vertical-align: top;"> Returns DCH index of Phase
given the Phase Name string or -1 if no such name was found in the
DATACH Phase
name list</td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xCalcite = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">Ph_name_to_xCH("Calcite");</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long int
IC_name_to_xDB(const char *Name)</td>
      <td style="vertical-align: top;">Returns DBR index of IC given
the IC Name string or -1 if no such name was found in the DATACH IC
name
list</td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xbCa = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">IC_name_to_xDB("Ca");</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long int
DC_name_to_xDB(const char *Name)</td>
      <td style="vertical-align: top;">Returns DBR index of DC given
the DC Name string or -1 if no such name was found in the DATACH DC
name
list</td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xbCa_ion = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">DC_name_to_xDB("Ca+2");</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long int
Ph_name_to_xDB(const char *Name)</td>
      <td style="vertical-align: top;"> Returns DBR index of Phase
given the Phase Name string or -1 if no such name was found in the
DATACH phase
name list</td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xbCalcite = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">Ph_name_to_xDB("Calcite");</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long int
IC_xCH_to_xDB(const long int xCH);<br>
      </td>
      <td style="vertical-align: top;">Converts the IC DCH index xCH
into the IC DBR index (return value) or returns -1 if this IC is not
used in the data bridge</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">xbCa = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">IC_xCH_to_xDB(xCa);</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> long
int DC_xCH_to_xDB(const long int xCH );</td>
      <td style="vertical-align: top;"> Converts the DC DCH index into
the DC DBR index (return value) or returns -1 if this DC is not used in
the data bridge</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">xbCa_ion = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">DC_xCH_to_xDB(xCa_ion);</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> long
int Ph_xCH_to_xDB(const long int xCH );</td>
      <td style="vertical-align: top;"> Converts the Phase DCH index
into the Phase DBR index (return value) or returns -1 if this phase is
not used in the data
bridge</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">xbCalcite = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">Ph_xCH_to_xDB(xCalcite);</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long int
IC_xDB_to_xCH(const long int xBR )</td>
      <td style="vertical-align: top;"> Converts the IC DBR index xBR
into the IC DCH index (return value)</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">xCa = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">IC_xDB_to_xCH(xbCa);</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long int
DC_xDB_to_xCH( const long int xBR )</td>
      <td style="vertical-align: top;">Converts the DC DBR index xBR
into the DC DCH index (return value)</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">xCa_ion = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">DC_xDB_to_xCH(xbCa_ion);</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long int
Ph_xDB_to_xCH( const long int xBR )</td>
      <td style="vertical-align: top;">Converts the Phase DBR index xBR
into the Phase DCH index (return value)</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">xCalcite = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">Ph_xDB_to_xCH(xbCalcite);</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> long
int Phx_to_DCx( const long int Phx );</td>
      <td style="vertical-align: top;">Returns the DCH index of the
first DC belonging to the phase with DCH index Phx <br>
      </td>
      <td style="vertical-align: top;">l<span
 style="font-family: monospace;">ong int xCal = node-&gt;Phx_to_DCx(
xCalcite );</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"> long
int PhtoDC_DCH( const long int Phx, long
int&amp; nDCinPh );</td>
      <td style="vertical-align: top;">Returns the DCH index of the
first DC belonging to the phase with DCH index Phx, plus returns
through the nDCinPh (reference) parameter the number of DCs included
into this
phase <br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">long int nDCGas;<br>
long int xGas = </span><span style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">Ph_name_to_xCH("Gasmix");</span><br>
      <span style="font-family: monospace;">long int xCH4 =
node-&gt;Phx_to_DCx(xGas,nDCGas);</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long
int DCtoPh_DCH( const long int xCH )</td>
      <td style="vertical-align: top; color: rgb(0, 153, 0);"><span
 style="color: rgb(0, 0, 0);">Returns
the DCH index of the Phase to which the Dependent Component with index
xCH belongs</span><br>
      </td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);"><span
 style="font-family: monospace;">xPh = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">DCtoPh_DCH(xCa_ion);</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">long
int PhtoDC_DBR( const long int Phx, long
int&amp; nDCinPh );</td>
      <td style="vertical-align: top;">Returns the DBR index of the
first DC belonging to the phase with DBR index Phx, plus returns
through the nDCinPh (reference) parameter the number of DCs included
into DBR for this
phase&nbsp;</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">long int nbDCGas;<br>
long int xbGas = </span><span style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">Ph_name_to_xDB("Gasmix");</span><br>
      <span style="font-family: monospace;">long int xbCH4 =
node-&gt;Phx_to_DCx(xbGas,nbDCGas);</span></td>
    </tr>
    <tr>
      <td style="vertical-align: top; color: rgb(0, 153, 0);"><span
 style="font-family: monospace; color: rgb(0, 0, 0);">long int
DCtoPh_DBR( const long
int xBR )</span><br>
      </td>
      <td style="vertical-align: top; color: rgb(0, 153, 0);"><span
 style="color: rgb(0, 0, 0);">Returns
the DBR index of the Phase to which the&nbsp; Dependent Component with
index xBR belongs</span><br>
      </td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);"><span
 style="font-family: monospace;">xbPh = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">DCtoPh_DCH(xbCa_ion);</span></td>
    </tr>
  </tbody>
</table>
<br>
<br>
<h4>3.3. Manipulations with phase- and component properties</h4>
In DBR files and DATABR structure, results for volumes, masses and bulk
compositions for phases are only provided for multi-component phases
because for pure phases they can be easily retrieved from other input
data and results. Nevertheless,
functions Ph_Volume(), Ph_Mass(), Ph_BC() and Ph_SatInd() are provided
in TNode class that work both for multi- and single-component phases.
This is done in order to make access to such data from the side of
mass-transport part of the program as simple as possible. All functions
in Table 3.3 actually access only data in the work DATABR structure;
this has to be kept in mind when not all components and phases are
exchanged through DATABR or DBR files.
For the full access to DATACH/MULTI data for phases and components,
even
those not included in DATABR lists, see Table 3.4.<br>
<br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Table 3.3.
Access to equilibrium properties of phases and components
using DATABR indexation</span><br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Method<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Function<br>
      </td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Example<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">double
Ph_Volume( const long int
xph );</td>
      <td style="vertical-align: top;">Retrieves the current phase
volume in <span style="color: rgb(0, 0, 0);">m3</span> ( xph is
DBR
phase index) in the reactive sub-system. Works both for multicomponent
and for single-component phases.
Returns 0.0 if the phase mole amount is zero.<br>
      </td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xbCalcite = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">Ph_name_to_xDB("Calcite");<br>
double CalVol = node-&gt;Ph_Volume(xbCalcite);<br>
      </span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">double
Ph_Mass( const long int xph
);</td>
      <td style="vertical-align: top;">Retrieves the phase mass in kg
( xph is DBR phase
index). Works for multicomponent and for single-component phases.
Returns 0.0 if phase amount is zero.</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double CalM =
node-&gt;Ph_Mass(xbCalcite); </span><span
 style="font-family: monospace;">double CalDen = </span><span
 style="font-family: monospace;">CalM / CalVol;&nbsp;</span> </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
Ph_SatInd( const long int xph);</td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">Retrieves
the phase saturation
index
( xph is DBR phase
index). Works for multicomponent and for single-component phases.
Returns 0.0 if phase amount is zero.</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double CalOmg = Ph_SatInd(xbCalcite);</span>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">double*
Ph_BC( const long int xph,
double *ARout=0 );</td>
      <td style="vertical-align: top;">Retrieval of the phase bulk
composition ( xph is DBR
phase index) into memory indicated by ARout (array of at least [<span
 style="font-family: monospace;">dCH-&gt;nICb</span> elements]).
Returns pointer to ARout which may also be
allocated inside of Ph_BC() in the case if parameter ARout = NULL is
specified; to avoid a memory leak, you will have to free this memory
wherever appropriate. This function works for multicomponent and for
single-component phases</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double* PhB; <br>
PhB = new double [</span><span style="font-family: monospace;">dCH-&gt;nICb</span><span
 style="font-family: monospace;">];<br>
node-&gt;Ph_BC( xbCalcite, PhB );<br>
. . . . . . . . . . . . <br>
delete[]PhB;<br>
      </span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; color: rgb(0, 0, 0);"><span
 style="font-family: monospace;">void
Set_bIC( const
long int xic, const double bIC);</span></td>
      <td style="vertical-align: top;">Sets the amount of Independent
Component (xic is IC DBR index) in the bIC input vector of the work
DATABR structure</td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xbCa =
node-&gt;</span><span style="font-family: monospace;">IC_name_to_xDB("Ca");<br>
node-&gt;Set_bIC(xbCa, 0.1 );<br>
      </span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; color: rgb(0, 0, 0);"><span
 style="font-family: monospace;">double
Get_bIC(const
long int xic);</span></td>
      <td style="vertical-align: top;">Retrieves the current amount of
Independent Component (xic is IC DBR index)</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double bIC =
node-&gt;Get_bIC(xbCa);</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; color: rgb(0, 0, 0);"><span
 style="font-family: monospace;">void
Set_dll( const
long int xdc, const double dll);</span></td>
      <td style="vertical-align: top;">Sets the metastability
constraint from below to the amount of Dependent Component (xdc is DC
DBR index) in the <span style="font-family: monospace;">dll </span>vector
of the work DATABR structure</td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xbCa_ion = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">DC_name_to_xDB("Ca+2");<br>
      </span><span style="font-family: monospace;">node-&gt;Set_dll(</span><span
 style="font-family: monospace;">xbCa_ion</span><span
 style="font-family: monospace;">, 0.001 );</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; color: rgb(0, 0, 0);"><span
 style="font-family: monospace;">void
Set_dul( const
long int xdc, const double dll);</span></td>
      <td style="vertical-align: top;">Sets the metastability
constraint from above to the amount of Dependent Component (xdc is DC
DBR index) in the <span style="font-family: monospace;">dul </span>vector
of the work DATABR structure</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">node-&gt;Set_dul(</span><span
 style="font-family: monospace;">xbCa_ion</span><span
 style="font-family: monospace;">, 1e5 );</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; color: rgb(0, 0, 0);"><span
 style="font-family: monospace;">void
Set_nDC( const
long int xdc, const double nDC);</span></td>
      <td style="vertical-align: top;">Sets the amount of Dependent
Component (xdc is DC DBR index) in the xDC vector of the work DATABR
structure<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">node-&gt;Set_nDC(</span><span
 style="font-family: monospace;">xbCa_ion</span><span
 style="font-family: monospace;">, 1e-5 );</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace; color: rgb(0, 0, 0);">double
Get_nDC(const
long int xdc);</span><br>
      </td>
      <td style="vertical-align: top;">Retrieves the current mole
amount of Dependent Component (xdc is DC DBR index)<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double nDC =
node-&gt;Get_nDC(xbCa_ion);</span> </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
Get_muDC( const long int
xDC, bool norm=true );</td>
      <td style="vertical-align: top;">Retrieval of
(dual-thermodynamic) chemical potential of the Dependent Component (xdc
is the
DC DBR index). Parameter norm defines the scale: <span
 style="color: rgb(0, 0, 0);">if true (1) then in
mol/mol, otherwise in J/mol</span><br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double muDC =
node-&gt;Get_muDC( xbCa_ion);</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"><span
 style="color: rgb(255, 102, 102);"><span style="color: rgb(0, 0, 0);">double
Get_aDC( const long int xdc);</span> </span><br>
      </td>
      <td style="vertical-align: top;">Retrieval of
(dual-thermodynamic)
activity of the Dependent Component (xdc is the
DC DBR index) <br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double aDC =
node-&gt;Get_aDC( xbCa_ion);</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"><span
 style="color: rgb(0, 0, 0);">double Get_cDC( const long int xdc);</span><br>
      </td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">Retrieves
concentration of
Dependent Component (xdc is the
DC DBR index) in its phase in the respective concentration scale. For
aqueous species,
molality is returned; for gas
species, partial pressure; for surface complexes - density in mol/m<sup>2</sup>;
for species in other phases - mole fraction. If DC has zero amount, the
function
returns 0.0. </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double cDC =
node-&gt;Get_cDC( xbCa_ion);</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;"><span
 style="color: rgb(0, 0, 0);">double Get_gDC( const long int xDC);</span>
      <br>
      </td>
      <td style="vertical-align: top;">Retrieves the activity
coefficient of Dependent Component (xdc is the
DC DBR index) in its phase in the respective scale. Returns 1.0 if
amount of this DC is 0.0<br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double gDC =
node-&gt;Get_gDC( xbCa_ion);</span> </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DCmm( const long int xdc );</td>
      <td style="vertical-align: top;">Retrieves the molar mass of
Dependent Component (xdc is DC DBR index) in <span
 style="color: rgb(0, 0, 0);">kg/mol</span><br>
      </td>
      <td style="vertical-align: top;"> <span
 style="font-family: monospace;">double mm =
node-&gt;DCmm( xbCa_ion);</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
ICmm( const long int xic );</td>
      <td style="vertical-align: top;">Retrieves the molar mass of
Independent Component (xic is IC DBR index) in <span
 style="color: rgb(0, 0, 0);">kg/mol</span><br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double mm =
node-&gt;ICmm( xbCa );</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace; color: rgb(0, 0, 0);">double
DCaJI( const long int xdc, const long int xic);</span><br>
      </td>
      <td style="vertical-align: top;">Retrieves the stoichiometry
coefficient <span style="color: rgb(0, 0, 0);">a[j][i]</span> of IC
(xic is IC DBR index) in the formula of DC
(xdc is DC DBR index) </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double aij = node-&gt;</span><span
 style="font-family: monospace;">DCaJI( <br>
      </span><span style="font-family: monospace;">xbCa_ion</span><span
 style="font-family: monospace;">,&nbsp;</span><span
 style="font-family: monospace;"> xbCa );</span> </td>
    </tr>
  </tbody>
</table>
<br>
<br>
<br>
<span style="font-family: Helvetica,Arial,sans-serif;">Table 3.4.
Access to thermodynamic and equilibrium properties of phases
and components
using DATACH indexation</span><br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Method</td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Function</td>
      <td
 style="vertical-align: top; font-family: Helvetica,Arial,sans-serif;">Example</td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">void Set_IC_b( const double b_val,
const long int xCH)</span><br>
      </td>
      <td style="vertical-align: top;">(*) Sets
the amount of
Independent Component (xCH is IC DCH index) when this IC index is not
included into DATABR. Internal re-scaling to mass of the system is
applied, but only to mass of that part which is included in DATABR.</td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xSi = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">IC_name_to_xCH("Si");<br>
double moles_Si = 0.003; Set_IC_b( moles_Si, xSi );</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
IC_b(const long int xCH)</td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">(*)
Retrieves the current amount of
Independent Component (xCH is IC DCH index). Also amount of ICs not
included into DATABR list
can be retrieved. Internal re-scaling to mass of the system is
applied. </td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);"> l<span
 style="font-family: monospace;">ong int xCa = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">IC_name_to_xCH("Ca");<br>
double moles_Ca = IC_b(xCa);</span> </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_n(const long int xCH)</td>
      <td style="vertical-align: top;">(*) Retrieves the current mole
amount of Dependent Component (xCH is DC DCH index) directly from <span
 style="color: rgb(255, 102, 102);"><span style="color: rgb(0, 0, 0);">GEM
IPM</span> </span>work structure. Also amount of DCs not included into
DATABR
list
can be retrieved. Internal re-scaling to mass of the system is
applied.<span style="color: rgb(204, 102, 204);"></span><br>
      </td>
      <td style="vertical-align: top;"> l<span
 style="font-family: monospace;">ong int xCa_ion = </span><span
 style="font-family: monospace;">node-&gt;</span><span
 style="font-family: monospace;">DC_name_to_xCH("Ca+2");<br>
double moles_Ca_ion = node-&gt;DC_n(xCa_ion);</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_a(const long int xCH)</td>
      <td style="vertical-align: top;">(*) Retrieves the current
(dual-thermodynamic) activity of Dependent Component (xCH is DC DCH
index) directly from <span style="color: rgb(0, 0, 0);">GEM IPM</span>
work structure. Also activity of a DC not
included into DATABR list can be retrieved. If DC has zero amount, its
dual-thermodynamic activity is returned anyway. For single condensed
phase component, this value has a meaning of the saturation index, also
in the presence of metastability constraint(s). <br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double a_Ca_ion =
node-&gt;DC_a(xCa_ion);</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_c(const long int xCH)</td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">(*)
Retrieves the current
concentration of Dependent
Component (xCH is DC DCH index) in its phase directly from GEM IPM
work structure.Also activity of a DC not included into DATABR list can
be retrieved. For aqueous species, molality is returned; for gas
species, partial pressure; for surface complexes - density in mol/m2;
for species in other phases - mole fraction. If DC has zero amount, the
function
returns 0.0. <br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double m_Ca_ion = DC_c(xCa_ion);</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_g(const long int xCH)</td>
      <td style="vertical-align: top;">(*) Retrieves the current
activity
coefficient of Dependent
Component (xCH is DC DCH index) in its phase directly from <span
 style="color: rgb(0, 0, 0);">GEM IPM</span>
work structure. Also activity coefficient of a DC not included into
DATABR list can
be retrieved. If DC has zero amount, this function returns 1.0. </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double gamma_Ca_ion =
node-&gt;DC_g(xCa_ion);</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_mu(const long int xCH, bool norm=true)</td>
      <td style="vertical-align: top;">(*) Retrieves the current
(dual-thermodynamic) chemical potential of Dependent Component (xCH is
DC DCH index) directly from <span style="color: rgb(0, 0, 0);">GEM
IPM </span>work structure, also for any DC
not included into DATABR or having zero amount. Parameter<span
 style="font-family: monospace;"> norm </span>defines in wnich units
the chemical potential value is returned: false - in J/mol; true
(default) - in mol/mol. <br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double mu_Ca_ion_J_mol =
node-&gt;DC_mu(xCa_ion, false);</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_mu0(const long int xCH, bool norm=true)</td>
      <td style="vertical-align: top;">(*) Retrieves the standard
chemical
potential of Dependent Component (xCH is DC DCH index) directly from <span
 style="color: rgb(0, 0, 0);">GEM IPM</span> work
structure at current pressure and temperature, also for
any DC not included into DATABR or having zero amount. Parameter<span
 style="font-family: monospace;"> norm </span>defines in which units
the chemical potential value is returned: false - in J/mol; true
(default) - in mol/mol. </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double mu0_Ca_ion_J_mol =
node-&gt;DC_mu0(xCa_ion, false);</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(255, 102, 102);"><span
 style="color: rgb(0, 0, 0);">double
DC_G0(const long int xCH,
const double P, const double TK,&nbsp; bool norm=true)</span><br>
      <span style="color: rgb(0, 0, 0);"></span><br>
      </td>
      <td style="vertical-align: top;">Retrieves (interpolated) molar
Gibbs energy G0(P,TK value for Dependent Component from the
DATACH
structure ( xCH is the DC DCH index) or 7777777., if TK (temperature,
K) or P (pressure, <span style="color: rgb(0, 0, 0);">Pa</span>)
parameters go beyond the valid lookup array
intervals or tolerances. Parameter<span style="font-family: monospace;">
norm </span>defines in wnich units the value is returned: <span
 style="color: rgb(0, 0, 0);">false - in
J/mol; true (default) - in mol/mol.</span> </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double g0_Ca_ion = node-&gt;DC_G0(
xCa_ion, 1e5,
298, false);</span></td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(255, 102, 102);"><span
 style="color: rgb(0, 0, 0);">double
DC_V0(const long int xCH, const double P,
const double TK)</span><br>
      <span style="color: rgb(0, 0, 0);"></span><br>
      </td>
      <td style="vertical-align: top;">Retrieves (interpolated, if
necessary) molar
volume V0(P,TK) value for Dependent Component (in J/Pa or m3/mol) from
the
DATACH
structure ( xCH is the DC DCH index) <span style="color: rgb(0, 0, 0);">or
0., if TK (temperature, K)
or P (pressure, Pa) parameters go beyond the valid lookup array
intervals or tolerances.&nbsp; </span><span
 style="color: rgb(204, 102, 0);"></span><br>
      </td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double v0_Ca_ion = node-&gt;DC_V0(
xCa_ion, 1e5,
298. );</span> </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_H0(const long int xCH,
const double P, const double TK)</td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">Retrieves
(interpolated) molar
enthalpy H0(P,TK) value for Dependent Component (in J/mol) from the
DATACH
structure ( xCH is the DC DCH index) or 7777777., if TK (temperature,
K) or P (pressure, Pa) parameters go
beyond the valid lookup array intervals or tolerances.</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double h0_Ca_ion = node-&gt;DC_H0(
xCa_ion, 1e5,
298. );</span> </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_S0(const long int xCH,
const double P, const double TK)</td>
      <td style="vertical-align: top;">Retrieves (interpolated)
absolute molar enropy S0(P,TK) value for Dependent Component (in
J/K/mol)
from the DATACH
structure ( xCH is the DC DCH index)<span style="color: rgb(0, 153, 0);">
      <span style="color: rgb(0, 0, 0);">or 0.0, if TK
(temperature, K) or P (pressure, Pa) parameters go beyond the valid
lookup array intervals or tolerances.</span></span></td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double s0_Ca_ion = node-&gt;DC_S0(
xCa_ion, 1e5,
298. );</span> </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DC_Cp0(const long int xCH, const double P,
const double TK)</td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">Retrieves
(interpolated)
constant-pressure heat capacity Cp0(P,TK) value for Dependent Component
(in J/K/mol) from the
DATACH
structure ( xCH is the DC DCH index) or 0.0, if TK (temperature, K)
or P (pressure, Pa) parameters go beyond the valid lookup array
intervals or tolerances.</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double cp0_Ca_ion = node-&gt;DC_Cp0(
xCa_ion,
1e5, 298. );</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">double
DC_A0(const long int xCH,
const double P, const double TK)</td>
      <td style="vertical-align: top;">Retrieves
(interpolated) Helmholtz energy&nbsp; of Dependent Component (in J/mol)
from the
DATACH
structure ( xCH is the DC DCH index) or 7777777., if TK (temperature,
K) or P (pressure, Pa) parameters go
beyond the valid lookup array intervals or tolerances.</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double u0_Ca_ion = node-&gt;DC_U0(
xCa_ion, 1e5,
298.15 );</span> </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-family: monospace;">double
DC_U0(const long int xCH,
const double P, const double TK)</td>
      <td style="vertical-align: top;">Retrieves
(interpolated) Internal energy of Dependent Component (in J/K/mol) from
the
DATACH
structure ( xCH is the DC DCH index) or 7777777., if Tc (temperature,
K) or P (pressure, Pa) parameters go
beyond the valid lookup array intervals or tolerances.</td>
      <td style="vertical-align: top;"><span
 style="font-family: monospace;">double a0_Ca_ion = node-&gt;DC_A0(
xCa_ion, 1e6, 350. );</span> </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
EpsH2Ow(const double P, const double TK)</td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">Retrieves
(interpolated)
dielectric constant of liquid water at (P,TK) from the DATACH
structure&nbsp; or 0.0, if TK (temperature, K)
or P (pressure, Pa) parameters go beyond the valid lookup array
intervals or tolerances.</td>
      <td style="vertical-align: top; font-family: monospace;">double
epsW = node-&gt;EpsH2Ow( 1e6, 350.); </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(255, 102, 102);"><span
 style="color: rgb(0, 0, 0);">double
DenH2Ow(const double P, const double TK)</span><br>
      </td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">Retrieves
(interpolated) density
of liquid water (in kg/m3)
at (P,TK) from the DATACH
structure or 0.0, if
TK (temperature, K) or P (pressure, Pa) parameters go beyond the valid
lookup array intervals or tolerances.</td>
      <td style="vertical-align: top; font-family: monospace;">double
denW = node-&gt;DenH2Ow( 1e6, 350.); </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(255, 102, 102);">double
VisH2Ow(const double P, const double TK)</td>
      <td style="vertical-align: top; color: rgb(255, 0, 0);">Retrieves
(interpolated)
viscosity (units???) of liquid water at (P,TK) from the DATACH
structure or 0.0, if TK (temperature, K)
or P (pressure, Pa) parameters go beyond the valid lookup array
intervals or tolerances.</td>
      <td style="vertical-align: top; font-family: monospace;">double
visW = node-&gt;VisH2Ow( 1e6, 350.); </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
EpsH2Og(const double P, const double TK)</td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">Retrieves
(interpolated)
dielectric constant of H<sub>2</sub>O vapor at (P,TK) from the DATACH
structure or 0.0, if TK (temperature, K)
or P (pressure, Pa) parameters go beyond the valid lookup array
intervals or tolerances.</td>
      <td style="vertical-align: top; font-family: monospace;">double
epsWg = node-&gt;EpsH2Og( 1e6, 350.); </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; font-family: monospace; color: rgb(0, 0, 0);">double
DenH2Og(const double P, const double TK)</td>
      <td style="vertical-align: top; color: rgb(0, 0, 0);">Retrieves
(interpolated) density
of H<sub>2</sub>O vapor (in kg/m<sup>3</sup>)
at (P,TK) from the DATACH
structure or 0.0, if TK (temperature, K)
or P (pressure, Pa) parameters go beyond the valid lookup array
intervals or tolerances.</td>
      <td style="vertical-align: top; font-family: monospace;">double
denW g= node-&gt;DenH2Og( 1e6, 350.); </td>
    </tr>
  </tbody>
</table>
<span style="color: rgb(204, 102, 0);"></span><br>
Some functions (marked with *) access the IPM work data structure
directly and can be used only for the current work node.<br>
<br>
<br>
3.4. Access to integral properties of phases-solutions (under
construction)<br>
<br>
Only access via DCH indexation (will be added in next versions)<br>
<br>
<hr style="width: 100%; height: 2px;"><span
 style="font-family: monospace;">End of File</span><br>
<br>
</body>
</html>
