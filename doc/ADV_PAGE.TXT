'
^^4 119 0~~
'
     Задайте в виде текстовой строки информацию о природе
 используемых данных, целях и методе расчета (81-символ).
'
^^3 51 0~~
'
     Строка комментария к процессу (81-символ).
'
^^8 379 0~~
'
    Статус инициализации процесса: 0- неопределен; 1- начало счета;
  2- счет; 4- задача расчитана, определяет текущее состояние
  задачи.
    Если Вы желаете прекратить счет или стартовать процесс с начала 
  (например после ошибочной ситуации) необходимо с помощью режима 
  доступа изменить статус, иначе процесс счета будет запущен с той
  итерации, с которой был прерван.'
^^8 379 0~~
'
    Статус инициализации процесса: 0- неопределен; 1- начало счета;
  2- счет; 4- задача расчитана, определяет текущее состояние
  задачи.
    Если Вы желаете прекратить счет или стартовать процесс с начала 
  (например после ошибочной ситуации) необходимо с помощью режима 
  доступа изменить статус, иначе процесс счета будет запущен с той
  итерации, с которой был прерван.'
^^3 79 0~~
'
      Индикатор указывает, что будем изменять T, P и V
  при расчете задачи.'
^^4 115 0~~
'
     Индикатор указывает, что будут изменения в составе систем и
  необходим пересчет валового состава системы.
'
^^6 233 0~~
'
     Индикатор указывает, что будем изменять ограничения и другие
 физические параметры системы. Следовательно необходим пересчет
 валового состава системы.
     Аналог PePsts[2], достаточно использовать один из этих
 индикаторов.'
^^5 211 0~~
'
     Индикатор указывает, что необходимо сохранить в базе
  измененную и пересчитанную запись SYSTEM.
     Рекомендуем включить режим всегда, когда установлен флаг
  изменения системы PePsts[2] или PePsts[3].'
^^6 263 0~~
'
    Индикатор указавает, что имеем задачу степени протекания
 процесса (последовательный реактор) и текущая запись SYSTEM 
 расчитывается на по предыдущей или стартовой (для 1-й итерации) 
 записи EQSTAT.
    Должны быть включены режимы: PePsts[7] и PePsts[2].'
^^4 92 0~~
'
     Резерв. Необходимость создания новых записей MTPARM
  проверяем при расчете EQSTAT.
'
^^11 567 0~~
'
   В зависимости от состояния данного индикатора модель процесса
 либо сразу сгенерировать набора записей входных данных SYSTEM
 для последующего расчета всей последовательности равновесных
 состояний (записей EQSTAT) (-), либо считать по одному равновесию,
 используя результат для расчета входных данных для следующего
 состояния равновесия (+).
   При включении данного режима программа может потребовать
 пересчитать базовое или текущее равновесие, если
 таковое не было пересчитано ранее, до начала счета.
   Рекомендуем включить режимы: PePsts[2], PePsts[4].'
^^42 1417 0~~
'
        Данный режим предоставляет пользователю самостоятельно
  реализовать (задать) задачу титрования, используя
  IIPN-выражения (PePsts[10]). Необходимо задать процесс
  подбора некоторых параметров системы, для достижения
  требуемых результатов, и алгоритм смещения по итерациям
  процесса, используя индекс I.
        Внимание! I - смещение задается в IIPN-выражениях и
  управляет самим ходом процесса для данного типа задач.  
  Признак прекращения счета:  I >= заданного числа итераций.
        Режим требует подкючения флагов:  PePsts[2], PePsts[4],
  PePsts[7], PePsts[10].
        Режим PePsts[11] не допустим.

    Пример задания такого процесса:

$ Подбор к-ва NaOH для заданного pH 
$ Начальная оценка разности pH
 if( NeIt[1] = 0 )
 begin   ipH =: ipXi; ipH[1] =: ipH-pH; iNu[2] =: 0;
   cNu =: iNu; iNu[1] =: xa_[\K{NaOH}];   
 end
  cpH =: ipH-pH;
$ Пересчет шага по титранту с учетом перемены знака cpH
  cNu =: ( (cpH*ipH[1]) < 0 ? cNu*0.382 : cNu*1 );
  ipH[1] =: cpH;
$ Расчет кол-ва титранта
  iNu[2] =: iNu[2] + cNu*sign(cpH);
  xa_[\K{NaOH}] =: iNu[1]+iNu[2];
$ Проверка сходимости
  Next =: ( ( abs( cpH ) < ipH[2] ) ? 0 : 1);
  if( Next = 0 )  
begin
$  Управляем переходом на седующую итерацию
    vTau[I] =: pH; vNu[I] =: iNu[2];
    I =: I+1; cTm =: cTm+10; Next =: 1;
    ipH =: ipH + ipXi[2]; ipH[1] =: ipXi[2];
    cNu =: iNu; iNu[1] =: xa_[\K{NaOH}]; iNu[2] =: 0;
  end
$ Конец

'
^^2 35 0~~
'
    Резерв. Режим не используем.'
^^18 802 0~~
'
      Уравнения процесса - это IIPN - выражения, которые изменяют
   те или иные входные параметры задачи в соответствии с заране
   заданной закономерностью.
      При отсутствии уравнкний (-) программой будут автоматически
   изменятся значения текущих параметров: cTm, cNV, cP, cV, cT,
   cTau, cpXi, cNu, cpH, cpe на основе соответствующих им векторов:
   iTm, iNv, iP, iV, iTC, iTau, ipXi, iNu, ipH, ipe по закону:
   cTm = cTm + iTm[2];
       Если же уравнения заданы (+), то управление генерацией
   зачений текущих переменных и других значений  полностью полагается
   на пользователя. Исключение составляют лишь cTm, cNV
   (закон описан ранее), J, cnrk - присваиваем номер итерации.
       Ключи SYSTEM и задач EQSTAT формируются по значениям
   текущих значений  cTm, cNV, cP, cV, cT.


'
^^38 1614 0~~
'
        Данный режим аналог PePsts[8], но использует встроенный
  алгоритм сходимости методом "Золотого сечения". 
        Для данного режима наряду с обычными IIPN-выражениями
  процеса необходимо включить следующую последовательность вида:
  
  if( Next = 1 )  begin
    <выражения>   cNu =: <функция>;  <выражения>  end
  if( Next = 2 )  begin
  <выражения> <титрант> =: cEh; <выражение> end
  
  где <функция> - допустимое синтаксисом IIPN-выражение,
 задающее монотонную, достигающую на заданном интервале min 
 по абсолютному значению функцию;
 <титрант> - злемент структуры SYSTEM, MTPARM, EQSTAT.
   
      Кроме IIPN- выражений для даного режима необходимо указать:
  ipXi[0], ipXi[1] - начальны интервал на котором рассматриваем значение
      функции, причем на каждой итерации выбираем интервал [a,b] по
      закону :  x1 = { ipXi[0], 1-я итерация; текущее cEh - остальные},
                x2 =  ipXi[1]
                a = min( x1, x2 )
                b = max( x1, x2 )
  ipXi[2] - требуемая точность по титранту;
  Nui[1] - требуемая точность значения функции (<функция> < Nui[1]).

      На каждой итерации цикла счета процесса в начале создаем
  необходимые записи SYSTEM и EQSTAT, причем инициализация
  текущих значений происходит как в случае отсутствия IIPN-
  выражений; после чего, при повторном входе в цикл, используя 
  метод "Золотого сечения" подбираем требуемое количество
  титранта.
      Количество итераци задает Ntxi[1]. Задайте NeIt[0] > Ntxi[1]*2.
      Режим требует подкючения флагов:  PePsts[2], PePsts[4],
  PePsts[7], PePsts[10].
        Режим PePsts[8] не допустим.

'
^^7 260 0~~
'
    Индикаторы указывают будут ли распределены и использоватьса
 соответствующие массивы для записи в них текущих значений
 управляющих параметров процесса на каждой итерации процесса.
    Требуется задать ненулевые размерности для подключенных
 массивов.
 '
^^6 179 0~~
'
    Индикатор указывает на необходимость задания матрицы
 кинетических параметров vKin. Необходимо задать ненулевые
 размерности для матрицы: PeDim1[2](Nrea), PeDim1[3](Nrp).

'
^^7 252 0~~
'
    Индикатор указывает будем ли использовать массив эмпирических
 параметров modC для задания некоторых входных значений, необходимых
 для задания процесса.
    Требуется задать ненулевые размерности для массива: 
 PeDim2[0](Ntm), PeDim1[1](Nms).
 '
^^5 144 0~~
'
    Индикатор указывает будем ли использовать предыдущее
 решение задач EQSTAT при расчете процесса или использовать
 симплекс приближение.
 '
^^3 14 0~~
'
    Резерв
'
^^7 228 0~~
'
    Данное поле задает максимально возможное число итераций
 цикла расчета процесса. Используем для предотвращения 
 зацикливания при расчете процесса.
   Внимание! Необходимо значение больше, чем ожидаемое
 число итераций.
 '
^^6 186 0~~
'
    Данное поле указывает число пройденных итераций цикла
 расчета процесса (определяет: текущий индекс массивов и в
 списке ключей EQSTAT; значение рабочего индекса J = NeIt[1] ).

 '
^^11 389 0~~
'
    Размерности рабочих массивов задачи:
  1  -- список ключей задач EQSTAT (PeStl);
  2  -- количество коэффициентов модели процесса (столбцов 
        матрицы эмпирических данных modC);
  3,4 - количества явно учитываемых реакций и параметров
        на реакцию ( строк и столбцов матрицы параметров
        кинетики лим.реакций vKin );
  5  -- количество ключей источников данных.

 '
^^5 173 0~~
'
    Требуется задать ненулевые размерности для подключенных
   массивов (в диалоге настройки размерности задачи 
   скорректировать значения предложенные по умолчанию).
 '
^^6 201 0~~
'
    Количество итераций определяет число проходов по
  циклу счета процесса, ключей EQSTAT  ( по этому
  значению устанавливаем признак окончания счета,
  если таковой не задан в IIPN-уравнениях).
 '
^^7 322 0~~
'
       Интервал номеров вариантов системы (начальный, конечный,
  приращение) управляет формированием последовательности номеров
  систем (4-е поле ключа SYSTEM) для каждой итерации цикла
  расчета процесса.
       Формируется автоматически, значение, присвоенное обьекту cTm,
  при расчете выражений процесса теряется.'
^^7 321 0~~
'
       Интервал номеров вариантов MTPARM (начальный, конечный,
  приращение) управляет формированием последовательности номеров
  MTPARM (8-е поле ключа EQSTAT) для каждой итерации цикла
  расчета процесса.
       Формируется автоматически, значение, присвоенное обьекту cNV,
  при расчете выражений процесса теряется.'
^^7 308 0~~
'
       Интервал вариантов давлений (начальный, конечный,
  приращение) управляет формированием последовательности 
  значений давлений, в случае отсутствия IIPN-выражений.
  Иначе разрешается их использовать как константы или
  переменные значения.
      Внимание! При старта счета инициируем: cP = iP[0].'
^^7 312 0~~
'
       Интервал вариантов температур (начальный, конечный,
  приращение) управляет формированием последовательности
  значений температур, в случае отсутствия IIPN-выражений.
  Иначе разрешается их использовать как константы или
  переменные значения.
      Внимание! При старта счета инициируем: cTC = iT[0].'
^^7 305 0~~
'
       Интервал вариантов обьемов (начальный, конечный,
  приращение) управляет формированием последовательности
  значений обьемов, в случае отсутствия IIPN-выражений.
  Иначе разрешается их использовать как константы или
  переменные значения.
      Внимание! При старта счета инициируем: cV = iV[0].'
^^7 307 0~~
'
       Интервал вариантов значений (начальный, конечный,
  приращение) управляет формированием последовательности
  значений cTau, в случае отсутствия IIPN-выражений.
  Иначе разрешается их использовать как константы или
  переменные значения.
      Внимание! При старта счета инициируем: cTau = iTau[0].'
^^11 460 0~~
'
       Интервал вариантов значений (начальный, конечный,
  приращение) управляет формированием последовательности
  значений cpXi, в случае отсутствия IIPN-выражений.
  Иначе разрешается их использовать как константы или
  переменные значения.
   Внимание! При старта счета инициируем: cpXi = ipXi[0].
             
      В случае расчета задачи титрования методом "Золотого
  сечения" (PePsts[11]) данный вектор задает итнтервал и 
  точность для титранта.'
^^10 421 0~~
'
       Интервал вариантов значений (начальный, конечный,
  приращение) управляет формированием последовательности
  значений cNu, в случае отсутствия IIPN-выражений.
  Иначе разрешается их использовать как константы или
  переменные значения.
   Внимание! При старта счета инициируем: cNu = iNu[0].

      В случае расчета задачи титрования методом "Золотого
  сечения" (PePsts[11]) iNu[1] задает точность для функции.'
^^7 301 0~~
'
       Интервал вариантов значений (начальный, конечный,
  приращение) управляет формированием последовательности
  значений cpH, в случае отсутствия IIPN-выражений.
  Иначе разрешается их использовать как константы или
  переменные значения.
   Внимание! При старта счета инициируем: cpH = ipH[0].'
^^7 301 0~~
'
       Интервал вариантов значений (начальный, конечный,
  приращение) управляет формированием последовательности
  значений cpe, в случае отсутствия IIPN-выражений.
  Иначе разрешается их использовать как константы или
  переменные значения.
   Внимание! При старта счета инициируем: cpe = ipe[0].'
^^58 2643 0~~
'
Как составлять уравнения моделей процессов в (гео)химических системах

  Уравнения процесса - это IIPN-выражения, которые изменяют те или иные
входные параметры задачи расчета равновесия в соответствии с заранее 
заданной закономерностью. В зависимости от типа процесса (ключ PsIN, PsPro),  
на синтаксис уравнеий могут быть наложены некоторые ограничения 
(см. справки по ключам).
  Если в IIPN- выражениях устанавливам  Next = 0  (прекратить счет),
то автоматически будут прекращен расчет, иначе счет будет прекращен
при достижении  заданного  числа итераций.

  В качестве переменных разрешатся использовать любые обьекты
структур SYSTEM, EQSTAT, MTPARM.
  Для повышения наглядности текста с уравнениями модели процесса,
можно вместо явного идентификатора обьекта - вектора или массива с
индексом - использовать имена фаз, зависимых и независимых компо-
нентов, включенных в описание базовой мультисистемы (см. окно RMULTS).
  Например, необходимо присвоить рабочей переменной c_Nu величину
нормированного химического потенциала иона Ca+2, который является
шестым зависимым компонентом водного раствора.
Можно записать: cNu =: fMu[5];
  А можно записать это выражение и так: cNu =: fMu{Ca+2};
или  cNu =: fMu[{Ca+2}];
  Нужное значение индекса определяется автоматически, и подстрока
{Ca+2} заменяется программой на подстроку 5 (в первом случае) или
[5] во втором. Каким образом интерпретировать строку, заключенную
в фигурные скобки {}, программа определяет по ключу интерпретации,
который состоит из обратной косой черты, за которой следует буква.
Возможные значения ключей указаны ниже в таблице. Так как во время
расчета равновесий в программе существует два варианта списков
компонентов и фаз (RMULTS и MULTI), очень важно их не путать при
составлении уравнений для математического интерпретатора.
По умолчанию, действует ключ \j (зависимые компоненты задачи рас-
чета равновесия MULTI). Область действия любого ключа - до появле-
ния в тексте следующего подобного ключа.
  Пример - стехиометрический коэффициент магния в форстерите:
  cNu =: A[\i{Mg}\j][{fo}];
  Использование ключей интерпретации позволяет сделать текст урав-
нений модели раствора независимым от конкретного набора зависимых
и независимых компонентов, включенных в данную задачу МВТ.

Таблица.  Возможные ключи интерпретации имен компонентов и фаз.

 Индексы по RMULTS, SYSTEM:

  \I   Независимые компоненты  0:N-1
  \J   Зависимые компоненты    0:L-1
  \A   Фазы                    0:Fi-1
  \K   Составы                 0:La-1

 Индексы по MULTI

  \i   Независимые компоненты  0:N-1
  \j   Зависимые компоненты    0:L-1
  \a   Фазы                    0:FI-1

'
^^5 212 0~~
'
      Матрица эмпирических коэффициентов модели определяет 
  входные параметры при задании протекания процесса.  
  Используем при написании уравнений протекания процесса.
  J - индекс текущей строки матрицы.'
^^8 253 0~~
'
      Массив содержит список номеров вариантов систем. На
 каждой итерации расчета процесса записываем текущее
 значение cTm  в ячейку по номеру итерации.
      Если размер массива меньше, чем количество итераций, то
 оставшиеся значения теряются.

 '
^^5 219 0~~
'
       Начальное значение устанавливаем: cP = iP[0].
   Последующие значения генерируем в IIPN-выражениях или
   cP = cP + iP[2], при отсутствии выражений.
       Используем при формировании ключей SYSTEM или EQSTAT.'
^^5 221 0~~
'
       Начальное значение устанавливаем: cT = iTC[0].
   Последующие значения генерируем в IIPN-выражениях или
   cT = cT + iTC[2], при отсутствии выражений.
       Используем при формировании ключей SYSTEM или EQSTAT.'
^^5 219 0~~
'
       Начальное значение устанавливаем: cV = iV[0].
   Последующие значения генерируем в IIPN-выражениях или
   cV = cV + iV[2], при отсутствии выражений.
       Используем при формировании ключей SYSTEM или EQSTAT.'
^^2 55 0~~
'
       Рабочая ячейка. Используем в IIPN-выражениях.'
^^4 168 0~~
'
       Начальное значение устанавливаем: cTau = iTau[0].
   Последующие значения генерируем в IIPN-выражениях или
   cTau = cTau + iTau[2], при отсутствии выражений.'
^^4 144 0~~
'
      Текущий индекс записываемого варианта MTPARM.
  Используется в процессе расчета и формируется автоматически
  по значениям вектора iNv.'
^^4 145 0~~
'
      Текущий индекс записываемого варианта системы.
  Используется в процессе расчета и формируется автоматически
  по значениям вектора iTm.'
^^7 227 0~~
'
        cnrk = min( количеству итераций (задач EQSTAT),
                    размер буфера ключей EQSTAT )
    Устанавливаем автоматически на каждой итерации счета.
    Рекомендуем использовать как индекс в массиве EQSTAT.

 '
^^6 172 0~~
'
        J = количеству итераций (задач EQSTAT).
    Устанавливаем автоматически на каждой итерации счета.
    Рекомендуем использовать как индекс в массивах значений.

 '
^^7 224 0~~
'
    При расчете задачи титрования (PePsts[8]) данный индекс
 управляет смещением по итерациям (ключам EQSTAT). Его
 изменение должно быть задано в IIPN-выражениях.
    В остальных случаях используем как рабочую ячейку.

 '
^^7 198 0~~
'
    Устанавливаем автоматически 1- в начале счета, 0- при
 превышении заданного числа итераций.
    Возможно модифицировать в IIPN-выражениях, в этом случае
 счет будет прерван, если Next = 0.

 '
