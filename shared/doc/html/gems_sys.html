<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <meta name="GENERATOR"
 content="Mozilla/4.72 [en] (Win98; I) [Netscape]">
  <title>GEMS3 System (EqDemo) Manual</title>
  <meta name="description" content="Version 2.0.0-PSI">
</head>
<body>
<h1><img src="gems1.png" align="left" height="48" width="48"> <font
 color="#000066"> GEM-Selektor version 3<br>
</font></h1>
<h2>Project Equilibrium System (EqDemo)&nbsp;<br>
</h2>
<h3>See also: <a href="gems_bcc.html">Project Chemical System
Definition (CSD)<br>
</a></h3>
<h3> Contents</h3>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#EQDEMO_MULTI">1. The GEM IPM ("Multi") Data Structure</a></p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#HOWTO">2. How to Work with GEM IPM Data for a Chemical System</a><a
 href="#TAB_RESULTS"><br>
</a></p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#EQDEMO_GEMIPM">2.1. The GEM IPM Calculations</a><a
 href="#TAB_RESULTS"><br>
</a></p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#TAB_RESULTS">2.2. 'Results' Tab of the SIngle System Dialog</a><br>
<br>
<a href="#EQDEMO_MWINDOW">3. EqDemo Submodule Window</a></p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#MWPAGE_1">3.1. EqDemo Window EqIC Page</a> <br>
</p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#MWPAGE_2">3.2. EqDemo Window EqPh Page</a> <br>
</p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#MWPAGE_3">3.3. EqDemo Window EqDC Page</a> <br>
</p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#MWPAGE_4">3.4. EqDemo Window EqSurf Page</a> <br>
</p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#MWPAGE_5">3.5. EqDemo Window EqGen Page</a>&nbsp; </p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#EQDEMO_DATA_INPUT">4. Input Data for a GEM
IPM run</a></p>
<p style="margin-left: 40px; font-family: Helvetica,Arial,sans-serif;"><a
 href="#EQDEMO_DATA_RESULTS">5. Output Data - GEM Results<br>
</a></p>
<p style="margin-left: 40px;"><a
 style="font-family: Helvetica,Arial,sans-serif;"
 href="#EQDEMO_DATA_WORK">6. Other (Work) Data Objects</a><br
 style="font-family: Helvetica,Arial,sans-serif;">
<br style="font-family: Helvetica,Arial,sans-serif;">
<a style="font-family: Helvetica,Arial,sans-serif;"
 href="#EQDEMO_ERRORS">7. Warnings and Error Messages</a><span
 style="font-family: helvetica,arial,sans-serif;"></span></p>
<p><span style="font-family: helvetica,arial,sans-serif;"></span></p>
<span style="font-family: helvetica,arial,sans-serif;"></span>&nbsp;&nbsp;
<br>
<p style="font-family: Helvetica,Arial,sans-serif; font-weight: bold;"><a
 href="#HOWTOGEM">8. How To Calculate Equilibria in Geochemical Systems</a></p>
<br>
<hr size="2" width="100%">
<h2>&nbsp;<a name="EQDEMO_MULTI"></a>1. The GEM IPM ("Multi") Data
Structure </h2>
<p>Introduction &nbsp;</p>
<p> &nbsp;Coming soon...</p>
<br>
<br>
<hr style="width: 100%; height: 2px;"><br>
<h2><a name="HOWTO"></a>2. How to Work with GEM IPM Data for a Chemical
System<br>
</h2>
<br>
<br>
<span style="font-weight: bold;">Details: </span><a
 style="font-weight: bold;" href="#HOWTOGEM">see Section 8</a>. <br>
<br>
<br>
<br>
<hr style="width: 100%; height: 2px;">
<h3><a name="EQDEMO_GEMIPM"></a>2.1. The GEM IPM Calculations</h3>
<br>
<span style="font-weight: bold;">Details: See </span><a
 style="font-weight: bold;" href="gems_ipm.html">Description file.</a><br>
<br>
<br>
<br>
<hr style="width: 100%; height: 2px;">
<h3><span style="font-family: Helvetica,Arial,sans-serif;"><a
 name="TAB_RESULTS"></a>2.2. 'Results' Tab of the Single System Dialog</span></h3>
<p><br>
</p>
<br>
<p><br>
</p>
<br>
<hr style="width: 100%; height: 2px;">
<h2><a name="EQDEMO_MWINDOW"></a>3. EqDemo Submodule Window</h2>
<br>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<h3><a name="MWPAGE_1"></a>3.1. EqDemo Window EqIC Page</h3>
<p style="font-family: Helvetica,Arial,sans-serif;"> <br>
</p>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<h3><a name="MWPAGE_2"></a>3.2. EqDemo Window EqPh Page</h3>
<br>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<h3><a name="MWPAGE_3"></a>3.3. EqDemo Window EqDC Page</h3>
<br>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<h3><a name="MWPAGE_4"></a>3.4. EqDemo Window EqSurf Page</h3>
<br>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<p style="font-family: Helvetica,Arial,sans-serif;"><br>
</p>
<h3><a name="MWPAGE_5"></a>3.5. EqDemo Window EqGen Page&nbsp; </h3>
<br>
<p><br>
</p>
<p><br>
</p>
<hr size="2" width="100%">
<h2><a name="EQDEMO_DATA_INPUT"></a>4. Input Data for a GEM
IPM run</h2>
The data objects listed below are automatically filled out with the GEM
IPM input data, as specified in the <a href="glossary.html#DT_CSD">CSD</a>
(see <a href="gems_bcc.html"><tt>gems_bcc.html</tt></a> &nbsp;and
&nbsp;<a href="gems_scm.html"><tt>gems_scm.html</tt></a>&nbsp;
manuals). In
this process, necessary conversions are performed, e.g. values of the
molar Gibbs energy function for DC g(TP) are scaled to mol/mol units
and further on - into a uniform rational concentration scale (see&nbsp;
<a href="theorgem.html"><tt>theorgem.html</tt></a> &nbsp;manual for
details).&nbsp; <br>
<p> </p>
<p> </p>
<p>For the "Multi" data objects used in surface complexation models,
see <a href="gems_scm.html"><tt>gems_scm.html</tt></a> manual.<br>
&nbsp;&nbsp;<br>
</p>
<h3>Scalars</h3>
<dl>
  <dt> <a name="_nnr_0"></a><b><big><tt>_nnr[0]</tt></big></b> -
Number
of Independent Components in the IPM problem n(N)</dt>
  <dd> &nbsp;<br>
  </dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dt> <a name="L_0"></a><big><b><tt>L[0]</tt></b></big> - Number of
Dependent Components in the IPM problem n(L)</dt>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="L_1"></a><b><big><tt>L[1] </tt></big></b>- Number of
Dependent Components included into&nbsp; multicomponent phases
n(Ls)</dt>
  <dd> &nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="L_2"></a><b><big><tt>L[2]</tt></big></b> - Index of
water-solvent LO, equals number of aqueous species n(Laq) </dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This index is kept separately in order to locate quickly the
water-solvent H2O, which must be the last species in the aqueous
phase. If aqueous phase is not included then this index contains
-1.&nbsp;</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="L_3"></a><b><big><tt>L[3]</tt></big></b> - Number of
Dependent Components included in the gas phase PG = n(Lg)</dt>
  <dd> &nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="L_4"></a><b><big><tt>L[4] </tt></big></b>- Number of
Dependent Components in the liquid hydrocarbon phase PSOL
(reserved)</dt>
  <dd>&nbsp; &nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="L_5"></a><tt><b><big>L[5]</big></b> </tt>- Number of
Dependent Components included in sorption phases n(Lads) </dt>
  <dd> &nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="Fi_0"></a><b><big><tt>Fi[0]</tt></big></b> - Number of
Phases included in the IPM problem n(Fi)</dt>
  <dd> &nbsp; <br>
  </dd>
  <dd> &nbsp; &nbsp;</dd>
  <dt> <a name="Fi_1"></a><b><big><tt>Fi[1]</tt></big></b>&nbsp; -
Number of multi-component phases n(Fis)</dt>
  <dd> <br>
  </dd>
  <dd> &nbsp;</dd>
  <dt> <a name="Fi_2"></a><b><big><tt>Fi[2]</tt></big></b>&nbsp; -
Number of sorption multi-component phases n(Fia)</dt>
  <dd> &nbsp;<br>
  </dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dt> <a name="TC"></a><big><b><big><tt>TC</tt></big></b></big> -
Temperature (C) of interest (min-max interval for parametric
problems)&nbsp;</dt>
  <dd> &nbsp;</dd>
  <dd>In a usual GEM IPM run, both cells contain the same value of
temperature of interest.&nbsp;</dd>
  <dd>&nbsp; &nbsp;</dd>
  <dd>&nbsp;&nbsp; &nbsp;</dd>
  <dt> <a name="TK"></a><big><b><big><tt>TK</tt></big></b></big> -
Temperature (K) of interest T (min-max interval for parametric
problems)&nbsp;</dt>
  <dd> &nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="PG"></a><big><b><big><tt>PG</tt></big></b></big> -
General pressure P (bars), min.-max. for parametric problems</dt>
  <dd>&nbsp;</dd>
  <dd>In a usual GEM IPM run, both cells contain the same value of
pressure of interest.&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dt> <a name="Vx"></a><big><b><big><tt>Vx</tt></big></b></big> -
&nbsp;Initial V and calculated V(x) volume of the system (cm3)</dt>
  <dd> &nbsp;<br>
  </dd>
  <dd>&nbsp;&nbsp; <br>
  </dd>
  <dt><a name="Gx"></a><big><b><big><tt>Gx</tt></big></b></big> - Gibbs
potential of the system in J (min.-max. for parametric
problems)&nbsp;</dt>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;Reserved for usage in future versions.</dd>
  <dd><br>
  </dd>
  <dd>&nbsp;&nbsp;&nbsp; &nbsp;</dd>
  <dt> <a name="Mbx"></a><big><b><big><tt>Mbx</tt></big></b></big> -
Total mass of the system, kg</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>Caclulated automatically from the bulk composition (vector b)<br>
  </dd>
  <br>
&nbsp;
</dl>
<h3>Vectors and matrices</h3>
<br>
<dl>
  <dt> <a name="L1"></a><big><b><big><tt>L1</tt></big></b></big> -
Number of Dependent Components included into each phase (l-alpha
vector).</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This input vector of <a href="#Fi_0">n(Fi)</a> length contains
numbers of DC (species) included into each phase.Multicomponent
phases always stay in the beginning of the phase list <a href="#PHnam">PHnam</a>.
Aqueous phase, if present, is always the
first phase. Gas phase is always the next to aqueous phase.</dd>
  <dd>See also comments to the <a href="gems_bcc.html#L1_"><tt>L1_</tt></a>
data object. &nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <p> </p>
  <dt> <a name="Lsmod"></a><b><big><tt>Lsmod</tt></big></b> - Number
of
non-ideality coeffs per multicomponent phase</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This input vector of <a href="#Fi_1">n(Fis)</a> length defines
how many coefficients are assigned to each phase. The coefficients are
provided in the <a href="#pmc"><tt>pmc</tt></a> vector.</dd>
  <dd>&nbsp;&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="Lsmdc"></a><b><big><tt>Lsmdc</tt></big></b> - Number
of
non-ideality coefficients per one DC in multicomponent phases</dt>
  <dd><br>
  </dd>
  <dd>This input vector of <a href="#Fi_1">n(Fis)</a> length defines
how many coefficients are assigned to DC in each phase.<br>
  </dd>
  <dd> The coefficients are provided in the <a href="#dmc"><tt>dmc</tt></a>
vector.</dd>
  <dd>&nbsp; <br>
  </dd>
</dl>
<dl>
  <dt> <a name="pmc"></a><b><big><tt>pmc</tt></big></b> - Vector of
non-ideality coefficients for multi-component phases</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd> This input vector has total length <a href="#Fi_1">n(Fis)</a>*sum(of<a
 href="#Lsmod"><tt>Lsmod</tt></a> elements). The coefficients are
automatically collected from <a href="gm_phase.html">Phase</a> records
and stored in the same order as phases in the <a href="#PHnam"><tt>PHnam</tt></a>
list, Lsmod(k) coefficients per k-th phase. These coefficients are used
in the GammaCalc() function that calculates activity coefficients of
species from math scripts or built-in functions.&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="dmc"></a><b><big><tt>dmc</tt></big></b> - Vector of
non-ideality coefficients for species in multi-component phases</dt>
  <dd>&nbsp;</dd>
  <dd> This input vector has total length <a
 href="file:///C:/GEMS2test/program/doc/html/gems_sys.html#Fi_1">n(Fis)</a>*sum(of<a
 href="#Lsmdc"><tt>Lsmdc</tt></a> * <a href="#L1"><tt>L1</tt></a>
elements). The coefficients are automatically collected from <a
 href="file:///C:/GEMS2test/program/doc/html/gm_phase.html">Phase</a>
records and stored in the same order as phases in the <a
 href="file:///C:/GEMS2test/program/doc/html/gems_sys.html#PHnam"><tt>PHnam</tt></a>
list, Lsmdc(k)*L1(k) coefficients per k-th phase, in the same order as
species in <a href="#DCnam"><tt>DCnam</tt></a> list, Lsmdc(k)
coefficients per species. These coefficients are used in the
GammaCalc() function that calculates activity coefficients of
species from math scripts or built-in functions.</dd>
  <dd>&nbsp; <br>
  </dd>
</dl>
<dl>
  <dt> <a name="dll"></a><big><b><big><tt>dll</tt></big></b></big> -
Lower metastability restrictions for DC mole quantities &nbsp;<a
 href="#x"><tt>x</tt></a>&nbsp; at equilibrium state</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>Input vector (of length n(L)) of lower restrictions (moles)
contains metastability restrictions from below to the sought-for
mole quantities x(j) of Dependent Components at equilibrium state.
The <a href="theorgem.html">GEM IPM algorithm</a> will keep these
quantities greater or equal to the prescribed restrictions.
Default (trivial) value is 0 moles.</dd>
  <dd>See also comments to the <a href="gems_bcc.html#dll_"><tt>dll_</tt></a>
data object.</dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dd>&nbsp; &nbsp; &nbsp;</dd>
  <dt> <a name="dul"></a><b><big><tt><big>dul</big>&nbsp;</tt></big></b>-
Upper metastability restrictions for DC mole quantities &nbsp;<a
 href="#x"><tt>x</tt></a>&nbsp; at equilibrium state</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>Input vector (of length n(L)) of upper restrictions (moles)
contains metastability restrictions from above to the sought-for
mole quantities x(j) of Dependent Components at equilibrium state.
The <a href="theorgem.html">GEM IPM algorithm</a> will keep these
quantities lower or equal to the prescribed restrictions. Default
(trivial) value is 1e6 moles.</dd>
  <dd>See also comments to the <a href="gems_bcc.html#dul_"><tt>dul_</tt></a>
data object.</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;&nbsp;</dd>
  <dt> <a name="gEx"></a><big><b><big><tt>gEx</tt></big></b></big>
&nbsp;- Optional additions to input g(T,P) values for <a
 href="file:///C:/GEMS2test/program/doc/html/glossary.html#DT_dependent_component">Dependent
Components</a></dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> Input increments to Gibbs energies of DC provided in the <a
 href="#g0"><tt>g0</tt></a> vector (in mol/mol or lnK units). These
increments are automatically added to g0 data when the elements of
&nbsp;<a href="#c"><tt>c</tt></a> &nbsp;vector are calculated. Default
value of the gEx elements is 0. Length of this vector is
n(L).&nbsp;</dd>
  <dd>See also comments to the <a href="gems_bcc.html#gEx_"><tt>gEx_</tt></a>
data object.&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="Yof"></a><big><b><big><tt>Yof</tt></big></b></big> -
Optional phase metastability parameters (in J/g)&nbsp;</dt>
  <dd><br>
  </dd>
  <dd>Input values from this vector (of n(Fi) length) of metastability
parameters are added to <a href="#g0"><tt>g0</tt></a> of each
species in this phase after multiplication by the species (phase?)
molar mass upon calculation of the elements of&nbsp; <a href="#c"><tt>c</tt></a>
&nbsp;vector. Default value of Yof elements is 0. <br>
  </dd>
  <dd>See also comments to the <a href="gems_bcc.html#Yof_"><tt>Yof_</tt></a>
data object.<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="vol"></a><big><b><big><tt>vol</tt></big></b></big>
-&nbsp;Molar (molal) volumes of Dependent Components (in cm3/mol)
at&nbsp; T,P of interest </dt>
  <dd>&nbsp; <br>
  </dd>
  <dd> This input vector of n(L) length contains DC molar (partial
molal
for aqueous and surface species) volumes V(TP) corrected to T,P of
interest and converted to cm3/mol. Contents of this vector represent a
(compressed) <a href="gems_bcc.html#VTP"><tt>VTP</tt></a> vector.
Molar volumes are used in calculation of volumes of phases as v(k) =
sum(vol(j)*x(j) (<a href="#phVol"><tt>phVol</tt></a> object) and volume
of the whole system V(x) = sum(v(k)) (<tt><a href="#Vx">Vx</a>[1]</tt>
data object cell) at IPM iterations and equilibrium state. <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="mmDC"></a><big><b><big><tt>mmDC</tt></big></b></big> -
Molar (gram-formula) masses of Dependent Components (g/mol)</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>Input DC molar masses are used in calculation of masses of phases
(<a href="#phM"><tt>phM</tt></a> vector) and mass-unit concentrations (<a
 href="#wy"><tt>wy</tt></a> &nbsp;and&nbsp; <a href="#w_t"><tt>w_t</tt></a>
&nbsp;vectors). Length of this vector is n(L).&nbsp;</dd>
  <dd>&nbsp;&nbsp;&nbsp; &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="lngmf"></a><b><big><tt><big>lngmf</big> </tt></big></b>
- DC activity coefficients for Simplex initial approximation (in
ln scale)&nbsp;</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> This vector (length n(Ls)) contains ln of DC activity
coefficients to be used in Simplex initial approximation only.
These corrections may be inavoidable for the systems containing
solid solution phases with miscibility gaps, or when an initial
approximation can not be obtained otherwise (for some sorption
phases).&nbsp;</dd>
  <dd>Default value is zero.</dd>
  <dd>See also comments to the <a href="gems_bcc.html#lnGmf_"><tt>lnGmf_</tt></a>
data object.<br>
  </dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="ez"></a><big><big><b><tt>ez</tt></b></big></big> -
Formula charges of Dependent Components</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This input vector (length n(L)) contains negative, positive or
zero formula charges of DC, obtained automatically from chemical
formula list together with the <a href="#A"><tt>A</tt></a>
stoichiometry matrix. Used in calculation of activity coefficients
and Coulombic correction factors for aqueous and surface
species.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dt> <a name="g0"></a><big><b><big><tt>g0</tt></big></b></big>&nbsp;
- Molar (molal) standard Gibbs energy functions of Dependent
Components at T,P of interest&nbsp;</dt>
  <dd> <br>
  </dd>
  <dd> This vector contains the main input data for the <a
 href="theorgem.html">GEM IPM problem</a> - the values of molar
(partial
molal for aqueous and surface species) Gibbs energy function g<sup>o</sup>(T,P)
corrected to temperature <a
 href="file:///C:/GEMS2test/program/doc/html/gems_bcc.html#T"><tt>T</tt></a>
and pressure <a
 href="file:///C:/GEMS2test/program/doc/html/gems_bcc.html#P"><tt>P</tt></a>
of interest and normalized into mol/mol (lnK) units.&nbsp;</dd>
  <dd>See also comments to the <a href="gems_bcc.html#gTP"><tt>gTP</tt></a>
data object.</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
</dl>
<dl>
  <dt><a name="icM"></a><big><b><big><tt>icM</tt></big></b></big> -
Input &nbsp;atomic (molar) masses of Independent Components, g/mol</dt>
  <dd>&nbsp;</dd>
  <dd>This vector is used in calculation of mass quantities, such as
the mass of the whole system <a href="#Mbx"><tt>Mbx</tt></a> or masses
of phases <a href="#phM"><tt>phM</tt></a>, as well as total
dissolved mass concentrations <a href="#w_t"><tt>w_t</tt></a>.</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
</dl>
<dl>
  <dt> <a name="b"></a><big><b><big><tt>b</tt></big></b></big>&nbsp;-
Input bulk composition of the system (moles of Independent
Components)</dt>
  <dd><br>
  </dd>
  <dd>This vector defines stoichiometry of the whole system and sets
the mass balance constraint equations Ax = b (see more in <a
 href="theorgem.html"><tt>theorgem.html</tt></a> manual).&nbsp;</dd>
</dl>
<dl>
  <dd>&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="A"></a><big><b><big><tt>A</tt></big></b></big> - Input
stoichiometry matrix of Dependent Components&nbsp;</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> Each row of the stoichiometry matrix A corresponds to one <a
 href="glossary.html#DT_dependent_component">Dependent Component </a>(species).
Columns of this matrix correspond to <a
 href="glossary.html#DT_independent_component">Independent Components</a>.
The matrix element a(ji) is a mole quantity of i-th Independent
Component in one mole of j-th Dependent Component.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>The matrix A is used in numerical GEM IPM algorithms (see
theorgem.html) and in calculation of mass balance residuals <a
 href="#Cb"><tt>Cb</tt></a>. The matrix is automatically created
from the list of chemical formulae of Dependent Components kept in
the <a href="gm_project.html">Project</a> data structure. &nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
</dl>
<dl>
  <dt> <a name="ICnam"></a><big><b><big><tt>ICnam</tt></big></b></big>
-
List of all names of Independent Components included into the
system definition</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This list (of n(N) entries) serves for identification purposes on
EqDemo submodule window pages and printouts, and it is used in <a
 href="gmscript.html#MS_PREPROC">pre-processing the math scripts</a>
that contain names of Independent Components. <br>
  </dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="DCnam"></a><big><b><big><tt>DCnam</tt></big></b></big>
-
List of all names of Dependent Components (species) included into
the system definition</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This list (of n(L) entries)&nbsp;serves for identification
purposes on EqDemo submodule window pages and printouts, and it is
used in <a href="gmscript.html#MS_PREPROC">pre-processing the math
scripts</a> that contain names of Dependent Components. <br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>&nbsp;&nbsp;<br>
  </dd>
  <dt> <a name="PHnam"></a><big><b><big><tt>PHnam</tt></big></b></big>
-
List of all names of Phases included into the system definition</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This list (of n(Fi) entries) serves for identification purposes
on EqDemo submodule window pages and printouts, and it is used in <a
 href="gmscript.html#MS_PREPROC">pre-processing the math scripts</a>
that contain names of Phases. <br>
  </dd>
  <dd>&nbsp;&nbsp;<br>
  </dd>
  <dd>&nbsp;&nbsp; <br>
  </dd>
  <dt> <a name="smod"></a><b><big><tt>smod</tt></big></b> - Codes of
models of multicomponent phases</dt>
  <dd>&nbsp;</dd>
  <dd>This matrix contains six <a href="g_useref.html#NONIDTYPES">type
codes</a> &nbsp;per each multicomponent phase, collected from the
respective Phase records (<a href="gm_phase.html#p_solt_0"><tt>p_solt</tt></a>
field). The codes are used in GammaCalc() and other procedures to
control calculation of activity coefficients or EDL Coulombic
corrections for surface species. <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;<br>
  </dd>
</dl>
<dl>
  <dt> <a name="RLC"></a><big><b><big><tt>RLC</tt></big></b></big> -
Type codes for DC metastability restrictions given in the &nbsp;<a
 href="gems_sys.html#dll"><tt>dll</tt></a> &nbsp;and&nbsp; <a
 href="gems_sys.html#dul"><tt>dul</tt></a> &nbsp;vectors</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This code, for each line of the dll and dul vectors, defines how
the sought-for mole quantity<a href="gems_sys.html#x"><tt> x</tt></a>
of the respective Dependent Component in the <a
 href="glossary.html#DT_prime_solution">prime solution</a> will be
restricted by the IPM algorithm.&nbsp;</dd>
  <dd>Possible codes:&nbsp; see comments to the <a
 href="gems_bcc.html#RLC_"><tt>RLC_</tt></a> data object.</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="RSC"></a><big><b><big><tt>RSC</tt></big></b></big>&nbsp;
- Codes of concentration/quantity for DC metastability restrictions
in&nbsp; <a href="gems_sys.html#dll"><tt>dll</tt></a> &nbsp;and <a
 href="gems_sys.html#dul"><tt>dul</tt></a> &nbsp;vectors</dt>
  <dd>&nbsp;&nbsp; &nbsp;</dd>
  <dd>These codes define <a href="g_useref.html#QUANCONCUNITS">quantity/concentration
units</a> in which the restrictions in dll and dul vectors are
specified.&nbsp;</dd>
  <dd>Possible codes:&nbsp; see comments to the <a
 href="gems_bcc.html#RSC_"><tt>RSC_</tt></a> data object.</dd>
  <dd><br>
  </dd>
  <dd> &nbsp;<br>
  </dd>
  <dt> <a name="ICC"></a><big><b><big><tt>ICC</tt></big></b></big> -
Classifier of Independent Components&nbsp;{ e o h a z v i [int]}</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This vector (of n(N) length, created automatically) contains <a
 href="g_useref.html#ICOMP_TYPES">types of IC</a> included in this GEM
system definition. The codes are used internally to select
computation procedures.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="DCC"></a><big><b><big><tt>DCC</tt></big></b></big> -
Classifier of Dependent Components&nbsp;</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>This vector (of n(L) length, created automatically) contains<a
 href="g_useref.html#DCCLASSCODES"> types of DC</a> included in this
GEM
system definition. The codes are used internally to select computation
procedures,&nbsp; <a
 href="file:///C:/GEMS2test/program/doc/html/gems_sys.html#g0"><tt>g0</tt></a>
to <a href="file:///C:/GEMS2test/program/doc/html/gems_sys.html#c"><tt>c</tt></a>
normalizations, or allocation of surface species to surface types and
EDL planes.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="PHC"></a><big><b><big><tt>PHC</tt></big></b></big> -
Classifier of Phases included in the system&nbsp;</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This vector (of n(Fi) length, created automatically) contains the
    <a href="g_useref.html#PHASESTATECODES">phase state codes</a> used
internally in selection of computation procedures and <a href="#g0"><tt>g0</tt></a>
to <a href="#c"><tt>c</tt></a> normalizations. &nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd><br>
  </dd>
</dl>
<dl>
  <p><br>
  </p>
</dl>
<hr size="2" width="100%">
<h2><a name="EQDEMO_DATA_RESULTS"></a>5. Output Data - GEM Results<br>
</h2>
<h4> Scalars</h4>
<dl>
  <dt> <a name="FI_0"></a><b><big><tt>FI[0]</tt></big></b> - Number of
phases present in non-zero quantities at equilibrium state</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="FI_1"></a><b><big><tt>FI[1]</tt></big></b> - Number of
multi-component phases present in non-zero quantities at
equilibrium state</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="FI_2"></a><b><big><tt>FI[2]</tt></big></b> - Number of
sorption phases present in non-zero quantities at equilibrium state</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="It"></a><b><big><tt><big>It</big> </tt></big></b>-
Number of completed IPM algorithm iterations</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>&nbsp;Current number of completed iterations in EFD, IPM and
IPM-2 &nbsp;blocks (cumulative).&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
</dl>
<dl>
  <dt> <a name="GX"></a><big><b><big><tt>GX</tt></big></b></big> -
Total
equilibrium Gibbs potential of the system, in moles</dt>
  <dd> &nbsp;&nbsp;</dd>
  <dd>This value is updated (as an approximation) on iterations of the
IPM algorithm; after the convergence is achieved, GX contains the
G(x) potential at equilibrium state.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="IS"></a><big><b><big><tt>IS</tt></big></b></big> -
Effective molal ionic strength of aqueous electrolyte</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This value is calculated in &nbsp;GammaCalc() procedure at each
IPM iteration (as an approximation); after the&nbsp; IPM algorithm
has converged, IS is an equilibrium value. If aqueous phase is not
included, this cell contains 0 or EMPTY values.&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp; </dd>
  <dt> <a name="pH"></a><big><b><big><tt>pH</tt></big></b></big> - pH
of
aqueous solution (in molal activity scale)</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd> pH of aqueous solution (-log a(H+) ) is calculated (as an
approximation) from dual chemical potentials of hydrogen u(H) and
charge u(Zz) on each IPM iteration, if the aqueous phase is
included. Otherwise this cell contains 0 or EMPTY value. &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; &nbsp; </dd>
  <dt> <a name="pe"></a><big><b><big><tt>pe</tt></big></b></big> - pe
of
aqueous solution (in molal activity scale)</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd> pe of aqueous solution (-log a(e-) ) is calculated (as an
approximation) from dual chemical potential of charge u(Zz) on each
IPM iteration, if the aqueous phase is included. Otherwise this cell
contains 0 or EMPTY value. &nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="Eh"></a><big><b><big><tt>Eh</tt></big></b></big> - Eh
of
aqueous solution, Volts</dt>
  <dd>&nbsp;</dd>
  <dd>This value is calculated from pe on each IPM iteration, if the
aqueous phase is included. Otherwise, contains 0 or EMPTY value.</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
</dl>
<h4>Vectors </h4>
<dl>
  <dt> <a name="phM"></a><big><b><big><tt>phM</tt></big></b></big> -
Masses of phases (in grams)</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> This vector (of n(Fi) length) contains masses of phases
calculated from their bulk compositions at equilibrium state (<a
 href="#bXa"><tt>bXa</tt></a> matrix). &nbsp;<br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="phVol"></a><big><b><big><tt>phVol</tt></big></b></big>
-
Volumes of phases (in cm3)&nbsp;</dt>
  <dd>&nbsp;</dd>
  <dd> This vector (of n(Fi) length) contains masses of phases
calculated from their speciation at equilibrium state (<a href="#x"><tt>x</tt></a>
vector) and DC molar volumes (<a href="#vol"><tt>vol</tt></a>
&nbsp;vector). &nbsp;<br>
  </dd>
  <dd><b><font color="#660000">Attention!</font></b> Volumes of phases
may contain large errors if molar volumes of some species are
missing in the project thermodynamic database or are incorrectly
extrapolated to P,T of interest.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>&nbsp; &nbsp;<br>
  </dd>
  <dt> <a name="Xa"></a><big><b><big><tt>Xa</tt></big></b></big> -
Output total mole quantities of phases</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This vector (of n(Fi) length) contains the total number of moles
of species in each phase at equilibrium state, calculated from the
"prime solution" vector<tt> <a href="#x">x</a> </tt>using a vector of
number of species in phases &nbsp;<a href="#L1"><tt>L1</tt></a>.
&nbsp;In turn, the Xa vector elements are used for calculation of
mole-fraction-based concentrations and activities within each
multicomponent phase.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="bXa"></a><big><b><big><tt>bXa</tt></big></b></big> -
Output bulk compositions of multicomponent phases (in moles of
Independent Components)</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>Each row of this matrix corresponds to one <a
 href="glossary.html#DT_phase">phase</a>; columns correspond to <a
 href="glossary.html#DT_independent_component">Independent Components</a>.
The matrix element is a mole quantity of i-th Independent Component in
the k-th (multi-component) phase. The size of the matrix is n(Fis) *
n(N).&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="Xwa"></a><big><b><big><tt>Xwa</tt></big></b></big> -
Output mole quantities of the solvent (sorbent) in multi-component
phases</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This vector (of n(Fis) length) contains the mole quantities of
water-solvent (for aqueous phase) or sorbent (sorption phases).
These quantities are computed from the&nbsp;the "prime solution"
vector<tt> <a href="gems_sys.html#x">x</a> </tt>and are also used in
calculation of activities and concentrations in "practical" scales
inside of the IPM algorithm.</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Fa"></a><big><b><big><tt>Fa</tt></big></b></big> -
Values of the phase stability criterion f(alpha)</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This diagnostic vector (of n(Fi) length) contains the values of
Karpov phase stability criteria based on the Kuhn-Tucker necessary
and sufficient conditions of chemical equilibrium (see more in <a
 href="theorgem.html"><tt>theorgem.html</tt></a> manual).&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>A stable phase present in non-zero quantity (in the <a href="#Xa"><tt>Xa</tt></a>
vector) normally has a close-to-zero value of Karpov criterion
(numerically, |f(alpha)| &lt; 0.01). Larger values point to
inconsistent input g(TP) values for some species in the phase or
problems with chemical system definition (insufficient list of
species and phases for a given Independent Component, in which case,
some species are unstable but cannot be dropped because of the mass
balance constraints).&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>Another case when f(alpha) values strongly deviate from zero
occurs when some species in the phase are subject to non-trivial
metastability restrictions (given in dll and dul vectors).&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>Values of f(alpha) criterion for phases whose mole quantities (in
the <a href="file:///C:/GEMS2test/program/doc/html/gems_sys.html#Xa"><tt>Xa</tt></a>
vector) have been zeroed off are meaningless and are also zeroed
off.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>Note that correct f(alpha) values are displayed only immediately
after the IPM calculation, because they are not stored in the SysEq
records.&nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp; &nbsp; &nbsp;</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="x"></a><big><b><big><tt>x</tt></big></b></big> &nbsp;-
Output mole quantities of Dependent Components (species) at
equilibrium state ("primal GEM solution")&nbsp;</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This vector (of n(L) length) contains the "prime solution" output
of the <a href="theorgem.html">GEM IPM algorithm</a> - mole
quantities of all speices at equilibrium state. Quality of this
solution can be characterized by the mass balance residuals (<a
 href="#Cb"><tt>Cb</tt></a> vector) and the phase stability criteria (<a
 href="#Fa">Fa</a> vector). The <tt>x</tt> vector is the basis for
calculation of quantities of phases and concentrations of species in
various scales.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dt> <a name="v"></a><big><b><big><tt>v</tt></big></b></big> -
Primal
chemical potentials of Dependent Components (in mol/mol)</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd> This output vector (of n(L) length) contains chemical potentials
of DC (species), defined in a usual way via the standard molar Gibbs
energy function <a href="#g0"><tt>g0</tt></a>, mole quantity <a
 href="#x"><tt>x</tt></a> (prime IPM solution), phase mole quantity <a
 href="#Xa"><tt>Xa</tt></a> or that of the carrier <a href="#Xwa"><tt>Xwa</tt></a>,&nbsp;
activity coefficient <a href="#lnGam"><tt>lnGam</tt></a>, and
scaling factors. For charged surface species and electrostatic SCM,
the "prime" potential includes the Coulombic term and is therefore an
electrochemical potential. See more in <a href="theorgem.html"><tt>theorgem.html</tt></a>
and <a href="theorscm.html"><tt>theorscm.html</tt></a> manuals. &nbsp;
&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>The chemical potentials in the&nbsp; <tt>v</tt> &nbsp;vector can
be converted into J/mol units multiplying them by <a href="#RT"><tt>RT</tt></a>
. &nbsp; &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt><a name="fx"></a><big><b><big><tt>fx</tt></big></b></big> - Dual
chemical potentials of Dependent Components (in J/mol)</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This output vector (of n(Ls) length) contains values of chemical
potential of DC (species), defined via chemical potentials of
Independent Components <a href="#u"><tt>u</tt></a> (dual IPM
solution) and species stoichiometry (respective j-th line of the
matrix <a href="#A"><tt>A</tt></a>).&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> For all species (with trivial metastability restrictions)
present
in non-zero quantity at equilibrium state, the value from the <tt>fx</tt>
vector should be (almost) equal to that from the <a href="#v"><tt>v</tt></a>
vector (times <a href="#RT"><tt>RT</tt></a>). For species affected by
non-trivial restrictions, the difference v(j)*RT - fx(j) would show a
level of induced metastability.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;<br>
  </dd>
  <dt><a name="lnGam"></a><big><b><big><tt>lnGam</tt></big></b></big> -
Calculated &nbsp;ln of DC activity coefficients in phases </dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> This output vector (of n(L) length) contains natural logarithms
of species activity coefficients, calculated in the GammaCalc()
procedure upon iterations of the GEM IPM algorithm. The <tt>lnGam</tt>
vector is part of the <a href="theorgem.html">GEM IPM primal solution</a>
(together with the <a href="#x"><tt>x</tt></a> vector). The
activity coefficients are computed either using built-in functions
(e.g. Debye-Hueckel or Davies equations for activity coefficients of
aqueous species) or Phase record math scripts. Both can use also input
data from the <tt><a href="#Lsmod">Lsmod</a>, <a href="#Lsmdc">Lsmdc</a>,<a
 href="#pmc">pmc</a></tt> and <a href="#dmc"><tt>dmc</tt></a>
objects.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>The activity coefficients are referenced to the same standard
concentration scale as the respective <a href="#g0"><tt>g0</tt></a>
values (e.g. molal for aqueous and surface species, mole fraction for
solids and gases). For the species in ideal multicomponent phases, as
well as in single-component phases, the <tt>lnGam</tt> values are set
to 0.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp; </dd>
  <dt> <a name="gamma"></a><b><big><tt><big>gamma</big> </tt></big></b>-
Activity coefficients of Dependent Components &nbsp;(species)</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> This output vector (of n(L) length) contains natural logarithms
of species activity coefficients DC activity coefficients, calculated
from the elements of lnGam vector, mainly for demonstration
purposes.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>In future versions of the code, the <tt>gamma</tt> vector is
likely to be replaced by a built-in function gamma() (also usable in
math scripts). &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="vEx"></a><big><b><big><tt>vEx</tt></big></b></big> -
Excess molar Gibbs energy of Dependent Components, mol/mol</dt>
  <dd>&nbsp; &nbsp;</dd>
  <dd>This diagnostic vector (of n(L) length) is calculated at each IPM
iteration from <a href="#lnGam"><tt>lnGam</tt></a> and (for surface
species in electrostatic SCMs) from Coulombic terms. For any ideal
species (also in single-component condensed phases), the <tt>vEx</tt>
vector cells contain 0. <br>
  </dd>
  <dd>&nbsp; &nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt><a name="c"></a><big><b><big><tt>c</tt></big></b></big> -
&nbsp;Normalized energy function of Dependent Components, mol/mol</dt>
  <dd>&nbsp; &nbsp;</dd>
  <dd>This diagnostic vector (of n(L) length) is re-calculated at each
IPM iteration from <a href="#g0"><tt>g0</tt></a> and <a href="#vEx"><tt>vEx</tt></a>
vectors and used in the main linearization process of the IPM algorithm
(see <a href="theorgem.html"><tt>theorgem.html</tt></a>). <br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="lga"></a><big><b><big><tt>lga</tt></big></b></big> -
Decimal logarithms of activity (fugacity) of Dependent Components at
equilibrium state</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd> This output vector (of n(L) length) contains decimal logarithms
of activity of Dependent Components (in the appropriate
standard-state concentration scales). These values are computed from
dual DC chemical potentials as 0.4343*(fx(j)/RT - g0(j)) and include
Coulombic corrections for charged surface species in electrostatic
SCMs.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>For all species present in non-zero quantities at equilibrium,
the <tt>lga</tt> values should be (almost) equal to the logarithms
of activities calculated from the prime DC chemical potentials (<a
 href="#v"><tt>v</tt></a> vector).&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>For species of multi-component phases that are present at too
small concentrations and have been zeroed off by the IPM algorithm,
the <tt>lga</tt> values are still valid even if they are very negative
(i.e. refer to physically meaningless concentration).&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>For single-component condensed phases (e.g. minerals): the <tt>lga</tt>
value is equivalent to decimal logarithm of the saturation index (not
necessarily in aqueous solution). At trivial metastability
constrants, this number is always negative (undersaturation) if the
mineral is present in zero mole quantity, or close to zero (if the
mineral is present in non-zero quantity). At non-trivial restrictions
in the <a href="#dll"><tt>dll</tt></a> and/or <a href="#dul"><tt>dul</tt></a>
vectors, the mineral will be present in non-zero quantity but its <tt>lga</tt>
value will be far from zero (positive in case of oversaturation,
negative at undersaturation) and will show, in fact, the level of
imposed metastability. <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>In future versions of the code, the <tt>lga</tt> vector is
likely
to be replaced by a built-in function lga() (also usable in math
scripts). &nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="wy"></a><big><b><big><tt>wy</tt></big></b></big> -
Mass
concentrations of DC in multi-component phases, % (ppm in aqueous
phase)</dt>
  <dd> &nbsp;<br>
  </dd>
  <dd>This output vector (of n(Ls) length) contains mass concentrations
of Dependent Components related to total mass of the respective
multicomponent phase.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>In future versions of the code, the <tt>wy</tt> vector is likely
to be replaced by a built-in function wy() alias mconc() (also usable
in math scripts). &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Wxx"></a><big><b><big><tt>Wxx</tt></big></b></big> -
Mole fractions of Dependent Components&nbsp; in multi-component
phases&nbsp;</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This output vector (of n(Ls) length) contains mole fractions of
species&nbsp; in multicomponent phases. It is not used directly in
IPM calculations but may be used in Phase, Process or GtDemo math
scripts.&nbsp;&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>In future versions of the code, the <tt>Wxx</tt> vector is
likely
to be replaced by a built-in function Wx() alias molfr() (also usable
in math scripts). &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>&nbsp;&nbsp;<br>
  </dd>
  <dt><a name="my"></a><big><b><big><tt>my</tt></big></b></big> -
Molality concentrations of Dependent Components (in mol per kg H<sub>2</sub>O)</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This output vector (of n(L) length) contains molalities of all
species except water-solvent, calculated if aqueous electrolyte phase
is present at equilibrium state; otherwise, this vector contains
zeros.&nbsp;</dd>
  <dd><br>
  </dd>
  <dd>In future versions of the code, the <tt>my</tt> vector is likely
to be replaced by a built-in function my() alias molal() (also usable
in math scripts). &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dt> <a name="u"></a><big><b><big><tt>u</tt></big></b></big> -
Chemical potentials of Independent Components at equilibrium state
(mol/mol)</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This vector (of n(N) length) contains the "dual solution" output
of the <a href="theorgem.html">GEM IPM algorithm</a> - chemical
potentials of IC (stoichiometry units) at equilibrium state.
&nbsp;These numbers are used for checking the Kuhn-Tucker necessary
and sufficient conditions of equilibrium, calculation of Karpov phase
stability criteria Fa, dual chemical potentials of species fx and other
output parameters.&nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="ue"></a><big><b><big><tt>ue</tt></big></b></big> -
Chemical potentials of Independent Components at equilibrium state
(J/mol)</dt>
  <dd><br>
  </dd>
  <dd>This output vector (of n(N) length) contains the "dual solution"
(IC chemical potentials) converted from the u vector into (J/mole)
units by RT multiplication.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>In future versions of the code, the <tt>ue</tt> vector is likely
to be replaced by a built-in function ue() (also usable in math
scripts). &nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Cb"></a><big><b><big><tt>Cb</tt></big></b></big> -
Mass
balance residuals for Independent Components (at IPM convergence)</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This output vector (of n(N) length) contains mass-balance
deviations (in moles) that characterize quality of the prime IPM
solution (vector <a href="#x"><tt>x</tt></a>) as compared to the input
bulk chemical composition of the system (vector <a href="#b"><tt>b</tt></a>).
The <tt>Cb</tt> vector is calculated using the stoichiometry matrix <a
 href="#A"><tt>A</tt></a>&nbsp; as b - A<tt><sup>T</sup></tt>x
&nbsp;(in vector-matrix form, <tt>T</tt> stands for transpose
operation) and therefore <tt>Cb</tt> it is not stored in <a
 href="gm_syseq.html">SysEq</a> records (i.e. Cb is recalculated every
time when a SysEq record is loaded from the database).&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>The Cb vector is calculated several times on each iteration of
the <a href="theorgem.html">IPM algorithm </a>eiher to enter the
feasible domain or to find the direction of descent and the step size.
The mass-balance precision (i.e. maximum absolute mass balance
residual) of the "standard" IPM algorithm is usually better than 1e-7
moles. The IPM-2 algorithm loop (active by default if some elements of
the b vector are below 1e-5 mol) improves the precision separately to
better than 1/1000 of the respective total mole quantity of such
"trace" element, often yielding residuals of 1e-17 mol or less.</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>If&nbsp; the required precision cannot be achieved in 14 loops of
the IPM-2 algorithm, this indicates serious inconsistencies in the
input thermodynamic data, chemical system definition, or equations
(parameters) for activity coefficients.&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="m_t"></a><big><b><big><tt>m_t</tt></big></b></big> -
Output total dissolved molalities of Independent Components at
equilibrium state</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This output vector (of n(N) length) is calculated from the bulk
composition of aqueous phase and the mole quantity of water-solvent if
aqueous phase is present at the equilibrium state. An m_t(i) value
is a total mole quantity of i-th IC per 1 kg of H<sub>2</sub>O-solvent;
for H and O, the moles of these elements contained in water are
excluded.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>In future versions of the code, the <tt>m_t</tt> vector is
likely
to be replaced by a built-in function m_t() alias tmolal() (also
usable in math scripts). &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="lgm_t"></a><big><b><big><tt>lgm_t</tt></big></b></big>
-
Decimal logarithms of total dissolved molalities of Independent
Components at equilibrium state</dt>
  <dd><br>
  </dd>
  <dd>This output vector (of n(N) length) contains decimal logarithms
of total dissolved molalities, calculated from the m_t vector.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>In future versions of the code, the <tt>lgm_t</tt> vector is
likely to be replaced by a built-in function lgm_t() alias lgtmolal()
(also usable in math scripts). &nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <p> </p>
  <dt> <a name="w_t"></a><big><b><big><tt>w_t</tt></big></b></big>&nbsp;-
Output total dissolved mass concentrations of Independent Components
at equilibrium state</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This output vector (of n(N) length) contains total dissolved mass
concentrations of Independent Components in grams per 1 kg of solution
(salinity in per mil). It is calculated if aqueous phase is present at
the equilibrium state; the mass of the solvent H2O is not included in
calculation of values for H and O.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>In future versions of the code, the <tt>w_t</tt> vector is
likely
to be replaced by a built-in function w_t() alias salinity() (also
usable in math scripts). &nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp; <br>
  </dd>
  <dt> <a name="Gfug"></a><b><big><tt>Gfug</tt></big></b> - Partial
fugacities of gases (in mole fraction scale)</dt>
  <dd>&nbsp;</dd>
  <dd>Calculated partial fugacities of gases&nbsp;(normalized to 1 bar
total pressure). At the state of interest, fugacities can be found
from multiplication by the total pressure <a href="#PG"><tt>PG</tt></a>.&nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; &nbsp;<br>
  </dd>
  <dt> <a name="lgFug"></a><b><big><tt>lgFug</tt></big></b> - Decimal
logarithms of partial fugacities of gases</dt>
  <dd> &nbsp;&nbsp;</dd>
  <dd>Calculated logarithms of partial fugacities of
gases&nbsp;(normalized to 1 bar total pressure). At the state of
interest, log(fugacities) of gases can be found in the respective
cells of the <a href="#lga"><tt>lga</tt></a> &nbsp;vector. The
difference between the two values equals&nbsp; log PG (where <a
 href="#PG"><tt>PG</tt></a> &nbsp;is total pressure in bars).&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="lgPpG"></a><b><big><tt>lgPpG</tt></big></b> - Decimal
logaritms of partial pressures of gases</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>Calculated logarithms of partial pressures of gases. For j-th
gas, they are related to partial fugacity as:</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>&nbsp; &nbsp; &nbsp;<a href="#lgFug"><tt>lgFug</tt></a>(j) + lg(<a
 href="#PG"><tt>PG</tt></a>) = lgPpG(j) + 0.4343*lnGam(j)</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>where <a href="#lnGam"><tt>lnGam</tt></a> contains logarithms of
fugacity (activity) coefficients. <br>
  </dd>
  <dd><br>
  </dd>
  <dd> &nbsp;</dd>
</dl>
<br>
<hr size="2" width="100%">
<h2><a name="EQDEMO_DATA_WORK"></a>6. Other (Work) Data Objects</h2>
<br>
<h3> Codes for units of measurement</h3>
<dl>
  <dt> <a name="_pun_0"></a><big><b><tt>_pun[0]</tt></b></big> - Units
of energy { j; &nbsp;J c C N reserved }</dt>
  <dd>&nbsp;</dd>
  <dd>Only "j" code (Joules) can be used in this version of
GEM-Selektor; other codes are reserved for future use.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="_pun_1"></a><b><big><tt>_pun[1]</tt></big></b> - Units
of volume { j; &nbsp;c L a reserved }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>Only "j" code (J/bar) can be used in this version of
GEM-Selektor; other codes are reserved for future use.</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dt> <a name="_pun_2"></a><b><big><tt>_pun[2]</tt></big></b> - Units
of pressure { b; &nbsp;B p P A reserved }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>Only "b" code (bars) can be used in this version of GEM-Selektor;
other codes are reserved for future use.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp; &nbsp;</dd>
  <dt> <a name="_pun_3"></a><b><big><tt>_pun[3]</tt></big></b> - Units
of temperature { C; &nbsp;K F reserved }</dt>
  <dd>&nbsp;&nbsp;</dd>
  <dd>Only "C" code (centigrade) can be used in this version of
GEM-Selektor; other codes are reserved for future use.</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
</dl>
<h3> Flags controlling calculation of the equilibrium state </h3>
<dl>
  <p> &nbsp; <br>
  </p>
  <dt> <a name="pm_Mod_0"></a><b><big><tt>pm_Mod[0]</tt></big></b></dt>
  <dd> PE - flag of electroneutrality constraint { 0 1 }</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; &nbsp; </dd>
  <dt> <a name="pm_Mod_1"></a><b><big><tt>pm_Mod[1]</tt></big></b></dt>
  <dd> PD - mode of calling GammaCalc() { 0 1 2 3 4 }</dd>
  <dd> &nbsp; &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pm_Mod_2"></a><b><big><tt>pm_Mod[2]</tt></big></b></dt>
  <dd> PV - flag of additional system volume constraint { 0 1 }</dd>
  <dd> &nbsp; &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pm_Mod_3"></a><b><big><tt>pm_Mod[3]</tt></big></b></dt>
  <dd> PU - flag of non-trivial DC/phase metastability restrictions { 0
1 }</dd>
  <dd> &nbsp; &nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="pmIpar_0"></a><b><big><tt>pmIpar[0]</tt></big></b> -
GammaCalc() return code: 0 (OK) or 1 (error)</dt>
  <dd>&nbsp; &nbsp; &nbsp;</dd>
  <dd>Possible values:&nbsp;</dd>
  <dd>&nbsp; &nbsp; &nbsp;0 &nbsp;Ok&nbsp;</dd>
  <dd>&nbsp; &nbsp; &nbsp;1 &nbsp; Failure</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <p> </p>
  <dt> <a name="pmIpar_1"></a><b><big><tt>pmIpar[1]</tt></big></b></dt>
  <dd> Number of performed Selekt2() loops</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="pmIpar_2"></a><b><big><tt>pmIpar[2]</tt></big></b></dt>
  <dd> Indicator of the same second assignment in Selekt2() procedure</dd>
  <dd>&nbsp;</dd>
  <dd>Value 1 forces IPM to finish.</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="pmIpar_3"></a><b><big><tt>pmIpar[3]</tt></big></b> -
Mode of FIADE procedure operation&nbsp;</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>Possible values: <br>
  </dd>
  <dd>&nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp;SIMPLEX automatic initial
approximation (default);&nbsp;</dd>
  <dd>&nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp;take previous x vector as
initial approximation;&nbsp;</dd>
  <dd>&nbsp; &nbsp; &nbsp; &nbsp;-1 &nbsp;ask the user.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="pmIpar_4"></a><b><big><tt>pmIpar[4]</tt></big></b> -
Flag to expand the currently loaded SysEq record into "Multi" data
structure</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>Possible values: <br>
  </dd>
  <dd>&nbsp; &nbsp; &nbsp; 0 &nbsp; no &nbsp;(default)</dd>
  <dd>&nbsp; &nbsp; &nbsp; 1 &nbsp; yes</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp; &nbsp;</dd>
  <dt> <a name="pmIpar_5"></a><b><big><tt>pmIpar[5]</tt></big></b> -
Flag to control binary data for Phase math script calculations</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd> Possible values:&nbsp;</dd>
  <dd>&nbsp; &nbsp; 0 &nbsp; create new IPM arrays in the Multi data
structure;&nbsp;</dd>
  <dd>&nbsp; &nbsp; 1 &nbsp; IPM arrays are already created;&nbsp;</dd>
  <dd>&nbsp; &nbsp;-1 &nbsp;IPM arrays are outdated - remake them.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="pmIpar_6"></a><b><big><tt>pmIpar[6]</tt></big></b> -
Flag to control re-loading CSD data into Multi</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>Possible values:&nbsp;</dd>
  <dd>&nbsp; &nbsp; 1 &nbsp;reload BAL (bulk composition and additional
constraints) only;&nbsp;</dd>
  <dd>&nbsp; &nbsp; 0 &nbsp;reload the whole CSD including phases and
components lists</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="pmIpar_7"></a><b><big><tt>pmIpar[7]</tt></big></b> -
Flag to control loading of activity coefficients for initial
approximation&nbsp;</dt>
  <dd>&nbsp; &nbsp;<br>
  </dd>
  <dd> Possible values:&nbsp;</dd>
  <dd>&nbsp; &nbsp;0 &nbsp;set all lnGam values to 0 (default);</dd>
  <dd>&nbsp; &nbsp;1 &nbsp;calculate from Mbel (initial ionic strength,
for aqueous species only)&nbsp;</dd>
  <dd>&nbsp; &nbsp;2 &nbsp;take lnGam values from &nbsp;lnGmf
&nbsp;vector;&nbsp;</dd>
  <dd>&nbsp; -1 &nbsp;reserved (for sorption models)</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="pmIpar_8"></a><b><big><tt>pmIpar[8]</tt></big></b> -
Flag to control re-loading thermodynamic data into Multi</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>Possible values:&nbsp;</dd>
  <dd>&nbsp; &nbsp; 0 &nbsp; reload all thermodynamic data;&nbsp;</dd>
  <dd>&nbsp; &nbsp; 1 &nbsp; reload G0 values only;</dd>
  <dd>&nbsp; &nbsp; 2 &nbsp; do not reload.&nbsp;</dd>
  <dd>&nbsp;&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;&nbsp;</dd>
  <dt> <a name="pmIpar_9"></a><b><tt>pmIpar[9]</tt></b></dt>
  <dd> internal &nbsp;</dd>
  <dd> &nbsp; &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmIpar_10"></a><b><tt>pmIpar[10]</tt></b></dt>
  <dd> internal</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmIpar_11"></a><b><tt>pmIpar[11]</tt></b></dt>
  <dd> max. number of surface types (6 in this version of GEMS)</dd>
  <dd> &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="pmIpar_12"></a><b><big><tt>pmIpar[12]</tt></big></b></dt>
  <dd> IPM module return code: 0 - continues; 1 - converged</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmIpar_13"></a><b><tt>pmIpar[13]</tt></b></dt>
  <dd> internal DHH() indicator</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmIpar_14"></a><b><big><tt>pmIpar[14]</tt></big></b></dt>
  <dd> is - index of IC for Phase math script equations ( GammaCalc() )</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmIpar_15"></a><b><big><tt>pmIpar[15]</tt></big></b></dt>
  <dd> js - index of DC for Phase math script equations ( GammaCalc() )</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmIpar_16"></a><b><big><tt>pmIpar[16]</tt></big></b></dt>
  <dd> Next - continue variable for Phase math script equations (
GammaCalc() )</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="denW"></a><b><big><tt>denW</tt></big></b> - Density of
H2O(l) (first cell) and steam (second cell) at T, P of interest</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd>This object is used if aqueous phase is present in the IPM
problem. &nbsp;</dd>
  <dd><br>
  </dd>
  <dd>&nbsp;&nbsp;<br>
  </dd>
  <dt> <a name="epsW"></a><b><big><tt>epsW</tt></big></b> - Dielectric
constant of H2O(l) and steam (second cell) at &nbsp;T, P of interest</dt>
  <dd><br>
  </dd>
  <dd>This object is used if aqueous phase is present in the IPM
problem. &nbsp;</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="_nnr_1"></a><b><tt>_nnr[1]</tt></b>&nbsp;</dt>
  <dd> NR - dimensionality of the R matrix</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Psi_DK_0"></a><b><big><tt>Psi_DK[0] - </tt></big></b>Current
value for the Dikin's criterion of IPM convergence (CD)</dt>
  <dd>&nbsp;<br>
  </dd>
  <dd> The IPM Main Descent algorithm will loop until Dikin's criterion
remains above the convergence threshold, or&nbsp; CD &gt;= T_CD.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="Psi_DK_1"></a><b><big><tt>Psi_DK[1] </tt></big></b><b><big><tt>-</tt></big></b>Threshold
value for the Dikin's criterion of IPM convergence (T_CD)</dt>
  <dd>&nbsp;</dd>
  <dd>Convergence of IPM is achieved when CD &lt; T_CD.&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="lnP"></a><b><tt>lnP</tt></b></dt>
  <dd>Natural logarithm of the total pressure (bar).</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="RT"></a><b><big><tt>RT</tt></big></b></dt>
  <dd> Factor RT = 8.31451* T (J/mol), T is current temperature in
Kelvins.</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="F_RT"></a><b><tt>F_RT</tt></b></dt>
  <dd>Factor F/RT, where F= 96485 C/mol is the Faraday's constant.</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd> &nbsp;</dd>
  <dt> <a name="Xw"></a><b><big><tt>Xw</tt></big></b></dt>
  <dd> Current number of moles of the solvent in the aqueous
phase.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="pmCnst_0"></a><b><tt>pmCnst[0]</tt></b></dt>
  <dd>Contains the molality/mole fraction conversion term &nbsp;
ln(55.50837) = 4.016534&nbsp; (to speed up calculations)</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dt> <a name="pmCnst_1"></a><b><tt>pmCnst[1]</tt></b></dt>
  <dd> Contains current asymmetry correction factor 1- Xw<i> / </i>Xa
&nbsp;for aqueous species (to speed up calculations)</dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="pmCnst_2"></a><b><tt>pmCnst[2]</tt></b></dt>
  <dd> Minimum DC mole quantity to define the Ls set (1e-21 by default)</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmCnst_3"></a><b><tt>pmCnst[3]</tt></b></dt>
  <dd> internal&nbsp;</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmCnst_4"></a><b><tt>pmCnst[4]</tt></b></dt>
  <dd> internal<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmCnst_5"></a><b><tt>pmCnst[5]</tt></b></dt>
  <dd> Current number of moles in a multicomponent phase (in
GammaCalc()
loop)</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pmFitv"></a><b><tt>pmFitv</tt></b></dt>
  <dd> internal smoothing variables (for highly non-ideal systems)</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd> &nbsp;<br>
  </dd>
</dl>
<h3> Vectors</h3>
<dl>
  <dt> <a name="mui"></a><b><big><tt><big>mui</big> -</tt></big></b>
IC
indices in the Project System</dt>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dd>This vector of IC indices connects data for Independent
Components (packed into the "Multi" IPM structure) with the same data
within the expanded <a href="gems_bcc.html">project system data
structure</a>. Indices start from 0.&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>The <tt>mui</tt> vector&nbsp; is automatically created within
the
"Multi" structure because some Independent Components can be excluded
from <a href="glossary.html#DT_CSD">CSD</a> and hence will not be
taken
into the IPM problem. The<tt> mui</tt> vector can be used in<a
 href="gmscript.html"> math scritps</a>.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>Example: the total mole quantity of i-th IC is <tt><a href="#b">b</a>[i]</tt>
in the Multi structure and <tt><a href="gems_bcc.html#B_">B_</a>[mui[i]]</tt>
in the project system structure. <br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;</dd>
  <dt> <a name="muk"></a><big><b><big><tt>muk</tt></big></b></big> <b><big><tt>-</tt></big></b>
Phase indices in the Project System</dt>
  <dd> <br>
  </dd>
  <dd>This vector of Phase indices connects data for phases (packed
into the "Multi" IPM structure) with the same data within the expanded <a
 href="gems_bcc.html">project system data structure</a>.&nbsp;Indices
start from 0.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>The <tt>muk</tt> vector&nbsp; is automatically created within
the
"Multi" structure because some phases can be excluded from <a
 href="glossary.html#DT_CSD">CSD</a> and hence will not be taken into
the IPM problem. The <tt>muk</tt> vector can be used in <a
 href="gmscript.html">math scritps</a>.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>Example: the specific surface area of k-th phase is <tt><a
 href="gems_scm.html#Aalp">Aalp</a>[k]</tt> in the Multi structure and <tt><a
 href="gems_scm.html#Aalp_">Aalp_</a>[muk[k]]</tt> in the project
system
structure. <br>
  </dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="muj"></a><big><b><big><tt>muj</tt></big></b></big><b><big><tt>
-</tt></big></b> DC indices in the Project System</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This vector of DC indices connects data for Dependent Components
(packed into the "Multi" IPM structure) with the same data within the
expanded <a href="gems_bcc.html">project system data structure</a>.&nbsp;Indices
start from 0.</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>The <tt>muj</tt> vector&nbsp; is automatically created within
the
"Multi" structure because some Dependent Components (species) can be
excluded from <a href="glossary.html#DT_CSD">CSD</a> and hence will
not be taken into the IPM problem. The <tt>muj</tt> vector can be used
in <a href="gmscript.html">math scritps</a>.&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd>Example: the upper mole quantity restriction of j-th DC is <tt><a
 href="#dul">dul</a>[j]</tt> in the Multi structure and <tt><a
 href="gems_bcc.html#dul_">dul_</a>[muj[j]]</tt> in the project system
structure. <br>
  </dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Xao"></a><b><tt>Xao</tt></b></dt>
  <dd>Work copy of the <a href="#Xa"><tt>Xa</tt></a> &nbsp;vector from
previous IPM iteration</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Xwao"></a><b><tt>Xwao</tt></b></dt>
  <dd> Work copy of &nbsp;the <a href="#Xwa"><tt>Xwa</tt></a>
&nbsp;vector from previous IPM iteration</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="y"></a><b><tt>y</tt></b></dt>
  <dd> Work copy of &nbsp;the &nbsp;<a href="#x"><tt>x</tt></a>
&nbsp;vector from previous IPM iteration</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="xy"></a><b><tt>xy</tt></b></dt>
  <dd>Work copy of &nbsp;the&nbsp; <a href="#x"><tt>x</tt></a> vector
from previous loop of Selekt2() procedure</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="qp"></a><b><big><tt>qp</tt></big></b></dt>
  <dd> Work cells for execution of built-in functions or math scripts
for non-ideal phases&nbsp;</dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dd>Array of work cells for calculation of the non-ideal solution
models (20 cells per multi-component phase), organized in one row per
phase. Can be used in Phase math scripts. &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="qd"></a><b><big><tt>qd</tt></big></b></dt>
  <dd> Work cells for execution of built-in functions or math scripts
referring to a DC (species) in a non-ideal phase</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;Array of work cells for calculation of DC parameters in
the&nbsp; non-ideal solution models (20 cells). This vector is
zeroed off at entering the next phase in GammaCalc(). Can be used in
math scripts. &nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <p> </p>
  <dt> <a name="mu"></a><b><big><tt>mu</tt></big></b> &nbsp;- IPM
vector
Delta (direction of descent)&nbsp;&nbsp;</dt>
  <dd>&nbsp; <br>
  </dd>
  <dd>This work vector contains values of Delta(x) applied on previous
iteration of IPM for correction of the primal solution (x vector). <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="emu"></a><b><tt>emu</tt></b></dt>
  <dd> Exponent of DC increments to Karpov's phase stability criteria</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="nmu"></a><b><tt>nmu</tt></b></dt>
  <dd> DC increments to&nbsp;to Karpov's phase stability criteria</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="W"></a><b><big><tt>W</tt></big></b></dt>
  <dd> Weight multipliers for DC (incl. metastability restrictions) at
IPM iteration</dd>
  <dd> <br>
  </dd>
  <dd><br>
  </dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="lnGmo"></a><b><tt>lnGmo</tt></b></dt>
  <dd> Copy of the <a href="#lnGam"><tt>lnGam</tt></a> vector from
previous IPM iteration&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Dres"></a><b><tt>Dres</tt></b></dt>
  <dd> Residual deviations between the primal <a href="#y"><tt>y</tt></a>
vector and the DT-restored <a href="#x"><tt>x</tt></a> vector (in
IPM-2
procedures)</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="PHnam_"></a><b><tt>PHnam_</tt></b></dt>
  <dd> List of phases currently present in non-zero quantities at IPM
iteration (likely to be removed in future versions)</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp; <br>
  </dd>
  <dt> <a name="DCnam2"></a><b><tt>DCnam2</tt></b></dt>
  <dd> List of DC names involved in multicomponent phases only</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;<br>
  </dd>
  <dt> <a name="PHnam2"></a><b><tt>PHnam2</tt></b></dt>
  <dd> List of names of multicomponent phases in the system</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;<br>
  </dd>
  <dt> <a name="EQbuf"></a><b><tt>EQbuf</tt></b></dt>
  <dd>Internal</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="XFs"></a><b><tt>XFs</tt></b></dt>
  <dd> Current non-zero quantities of phases Xa at IPM iteration
(likely
to be removed in future versions)</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="Fas"></a><b><tt>Fas</tt></b></dt>
  <dd> Current Karpov criteria of phase stability Fa for phases present
in non-zero quantities&nbsp;(likely to be removed in future versions)</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="DCCW"></a><b><big><tt>DCCW</tt></big></b></dt>
  <dd>Internal classifier of dependent components (for IPM Descent
calculations only)</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="R"></a><big><b><tt>R</tt></b></big></dt>
  <dd> R matrix of IPM linear equations</dd>
  <dd>&nbsp;<br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="R1"></a><b><tt>R1</tt></b></dt>
  <dd>Internal copy of R matrix</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="ICnam_"></a><b><big><tt>ICnam_</tt></big></b></dt>
  <dd> List of IC symbols</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="Gases"></a><b><tt>Gases</tt></b></dt>
  <dd> List of names of gases (to be displayed with &nbsp;<tt><a
 href="#Gfug">Gfug</a>, <a href="#lgFug">lgFug</a></tt> and <a
 href="#lgPpG"><tt>lgPpG</tt></a> vectors)</dd>
  <dd>&nbsp;&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <p> </p>
  <dt> <a name="EqTxt"></a><b><tt>EqTxt</tt></b></dt>
  <dd>Internal (for pre-processing and compilation of Phase math
scripts)</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Fx"></a><b><tt>Fx</tt></b></dt>
  <dd> Total Helmholtz potential of the system F(X), reserved</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="Ux"></a><b><tt>Ux</tt></b></dt>
  <dd>Total internal energy of the system U(X), reserved</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="Hx"></a><b><tt>Hx</tt></b></dt>
  <dd> Total enthalpy of the system H(X), reserved</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="Sx"></a><b><tt>Sx</tt></b></dt>
  <dd> Total negative entropy of the system -S(X), reserved</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Cpx"></a><b><tt>Cpx</tt></b></dt>
  <dd> reserved for future versions</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Cvx"></a><b><tt>Cvx</tt></b></dt>
  <dd> reserved</dd>
  <dd> &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="T0"></a><b><tt>T0</tt></b></dt>
  <dd> reserved</dd>
  <dd> &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Vexpl"></a><b><tt>Vexpl</tt></b></dt>
  <dd> reserved</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="bMol"></a><b><tt>bMol</tt></b></dt>
  <dd> reserved</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd><br>
  </dd>
  <dt> <a name="wMol"></a><b><tt>wMol</tt></b></dt>
  <dd> reserved</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;</dd>
  <dt> <a name="yMet"></a><b><tt>yMet</tt></b></dt>
  <dd> reserved</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="hym"></a><b><tt>hym</tt></b></dt>
  <dd> reserved</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="h0"></a><b><tt>h0</tt></b></dt>
  <dd> DC molar enthalpies, reserved</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;</dd>
  <dt> <a name="f0"></a><b><tt>f0</tt></b></dt>
  <dd> reserved</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="u0"></a><b><tt>u0</tt></b></dt>
  <dd> reserved</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="s0"></a><b><tt>s0</tt></b></dt>
  <dd> DC molar entropies, reserved</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="cp0"></a><b><tt>cp0</tt></b></dt>
  <dd> DC molar Cp, reserved</dd>
  <dd>&nbsp; <br>
  </dd>
  <dd> &nbsp;&nbsp;</dd>
  <dt> <a name="cv0"></a><b><tt>cv0</tt></b></dt>
  <dd> reserved</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="wB"></a><b><tt>wB</tt></b></dt>
  <dd> (HKF, reserved)</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="wAbs"></a><b><tt>wAbs</tt></b></dt>
  <dd> (HKF, reserved)</dd>
  <dd>&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="rIon"></a><b><tt>rIon</tt></b></dt>
  <dd> reserved</dd>
  <dd>&nbsp; &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="pul"></a><b><tt>pul</tt></b></dt>
  <dd> Vector of upper restrictions to Xa (reserved)</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dt> <a name="pll"></a><b><tt>pll</tt></b></dt>
  <dd> Vector of lower restrictions to Xa (reserved)</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="Pparc"></a><b><tt>Pparc</tt></b>&nbsp;</dt>
  <dd> Input DC partial pressures, bar (Pc by default)</dd>
  <dd> &nbsp; &nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="lngmm"></a><b><tt>lngmm</tt></b></dt>
  <dd> ln of DC metastability coefficients (reserved)</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="RFLC"></a><b><tt>RFLC</tt></b></dt>
  <dd> Classifier of restriction types for Xa (reserved)</dd>
  <dd> &nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
  <dt> <a name="RFSC"></a><b><tt>RFSC</tt></b></dt>
  <dd> Classifier of restriction scales for Xa (reserved)</dd>
  <dd>&nbsp;&nbsp;</dd>
  <dd>&nbsp;<br>
  </dd>
</dl>
&nbsp;<br>
<br>
<hr size="2" width="100%">
<h2><a name="EQDEMO_ERRORS"></a>7. Warnings and Error Messages</h2>
<br>
Under construction<br>
<br>
<hr size="2" width="100%"><tt><br>
end of file</tt> <br>
&nbsp; <br>
<br>
&lt;to revise and distribute&gt;<br>
<h2><a name="HOWTOGEM"></a>8. How To Calculate Equilibria in
Geochemical Systems</h2>
<hr size="2" width="100%">
<h3>Contents</h3>
<font face="Helvetica, Arial, sans-serif"><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#EQ_HOWTO_INTRO">1.
Introduction</a></font><tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3200"><br>
<br>
</a>&lt;under construction&gt;<a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3200"><br>
<br>
2. "Computation of Equilibria" Mode</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3210">2.1.
Opening the System Profile</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3220">2.2.
Calculation of Equilibrium State</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3230">2.3.
Examination of Results (+Scroll Lists,Print,Calculator)</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3240">2.4.
Modifying and Re-calculating Existing System
Records</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3250">2.5.
Calculation of New Equilibria within the System Profile</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3260">2.6.
Sequential Reactor Models</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3270">3.
Setting up and Running Process Definitions</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3271">3.1.
Creating or Modifying PROCES records</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3271">3.2.
Modifying IPN Math-Scripts in process definitions</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3273">3.3.
Running the process simulation</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3280">4.
Setting up and Running Graphic-Demo Data Samplers</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3281">4.1.
Creating or Modifying Gtdemo Records</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3282">4.2.
Modifying Math-Scripts&nbsp; in Gtdemo Samplers</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3283">4.3.
Running Gtdemo Samplers</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3290">4.5.
Plotting Data and Customizing Graphs</a></tt> <br>
<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3201">5.
Some Hints, Tips and Tricks</a></tt> <br>
&nbsp; <br>
<hr size="2" width="100%">
<h2><a name="EQ_HOWTO_INTRO"></a>Introduction<br>
</h2>
<p>The setup of chemical modelling problems in GEM approach is
different from that used in the LMA- based codes like PHREEQC2. The Law
of Mass Action (LMA) models differentiate between the "master species",
whose concentrations go directly into the material balance equations,
and the "product species" defined by their LMA expressions and
equilibrium constants of reactions with the master species (see more
about that in&nbsp; <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/g_litref.html#1999PAR/APP">[1999PAR/APP]</a>).
<br>
</p>
<p>In GEM approach, no "master" and "product" species are
distinguished. The stoichiometry of all gaseous, aqueous, liquid, solid
or surface species is written as chemical formulae in terms of&nbsp;
Independent Components (IC). The term "independent component" must be
understood as an independent extensive thermodynamic variable
representing
the total molar quantity in the system (typically number of moles
of chemical element in the total bulk composition). All chemical
species
which can exist in the system are then defined as "Dependent
Components"
(DC) as they are composed of stoichiometrically&nbsp; fixed&nbsp;
quantities of IC.&nbsp; The DC stoichiometries, multiplied by the
number
of moles of DC (or species) <i>x<sub>j</sub></i> , all go directly
into mass balance relative to the total number of moles of&nbsp; IC <i>b<sub>i</sub></i>&nbsp;
in the system (bulk composition). The stability of any species (DC)
at <i>T, P</i>&nbsp;&nbsp; of interest is defined by its standard
molar (or molal in case of aqueous and surface species) Gibbs energy of
formation <i>G<sup>o</sup><sub>j</sub>&nbsp;</i> from IC, these are
usually
chemical elements at selected standard states and charge. The Gibbs
energies, together with the activity terms in the respective phases,
compose chemical potentials, then multiplied by <i>x<sub>j</sub></i>
&nbsp;and summed up into the total Gibbs energy <i>G</i> (<i>x</i>
)&nbsp;
of the whole system. The GEM algorithms seek for values of&nbsp; <i>x<sub>j
&nbsp;</sub></i>such that, for the imposed material balance and
optional metastability constraints, a minimum is provided for <i>G</i>
(<i>x</i> ) (see&nbsp; <b><tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/theorgem.html">theorgem.html</a></tt></b>&nbsp;
manual, or <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/g_litref.html#1997KAR/CHU">[1997KAR/CHU]</a>,
for more
information). <br>
</p>
<p>Thus, to set up a single GEM chemical equilibrium problem, the
following input items must be provided: </p>
<ul>
  <li> a list of independent components;</li>
  <li> a list of phases that may appear at the equilibrium state;</li>
  <li> a list of species within each phase;</li>
  <li> standard molar/molal Gibbs energy function values at <i>T, P</i>&nbsp;
of interest for all species;</li>
  <li> equations for calculation of activity coefficients of species in
the non-ideal multi-component phases;</li>
  <li> optionally, metastability restrictions for some species;</li>
  <li> bulk chemical composition of the whole system.</li>
</ul>
<p>Many irreversible processes (such as titrations, mixing or
weathering) can be simulated in GEM approach (like in the LMA
techniques)
by generating a discrete sequence of equilibrium states at&nbsp;
changing bulk composition, constraints, or state variables of the
chemical system. The computed speciation, activities, dissolved
concentrations, etc. can then be plotted against the varying input
parameters. <br>
</p>
<p><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/gemstart.html#GSM_SET_BCC">Click
here if you want to get back to the "Getting Started" manual.</a>&nbsp;
<br>
<br>
</p>
<hr size="2" width="100%">&lt;Under construction&gt;
<p><br>
</p>
<h3> <a name="P3200"></a><tt>3.2. "Computation of Equilibria" Mode</tt></h3>
This is the usual mode for calculation of geochemical models using GEMS
program package.&nbsp; Such calculations always refer to the <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3300">thermodynamic
database </a>which contains input data about stability of all species
at wide range of temperature, pressure and compositions of the systems.
At present level, such "condensed chemical knowledge" databases are
quite extensive, although most of published databases still&nbsp;
cannot be simply mixed for&nbsp; modeling calculations before special
procedures for matching thermodynamic data have been applied. Moreover,
any meaningful geochemical modeling problem in fact uses only part of
thermodynamic database, restricted either by stoichiometry of the
system (we do not always model systems
with rare earth elements); or by phase types (not all systems require
consideration
of adsorption or multi-component non-ideal solid solutions), or by the
range
of temperature/ pressure conditions (many high-PT minerals are not
considered
in the low-temperature geachemical speciation models). Therefore, it
may
not be convenient always to browse the whole thermodynamic database
having
90% of species or phases awitched off! To avoid this, a new <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3400">System
Profile </a>concept is introduced since this version of GEMS program
package.
<p>In general terms, the system profile is a template which defines a
subset of thermodynamic database and certain default configuration of
chemical systems
used for setting up certain class of geochemical models. This template
is
normally created by the user and stored as a directory of GEMS database
extension
files within the user's home directory <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3350">(more)</a>.&nbsp;
On the next modeling session, the system profile record is also used
for detecting the changes made by the user in thermodynamic database,
and updating already created system definitions, if appropriate. This
makes it easy to do small extensions and fixes without creating a new
system profile and may save a lot of time and effort. Every expert in
geochemical modeling knows that it is hardly possible to compile all
the relevant species in advance, very often it turns to be that&nbsp;
the model interpretation points to inclusion of a few important phases
or complexes overlooked by everybody before. To our knowledge, no other
geochemical modeling program permits to do it so easy
and quickly as this one! </p>
<h4> <a name="P3210"></a><tt>3.2.1. Opening the System Profile</tt></h4>
So, to start modeling calculations in GEMS means to get into a system
profile. For the beginners, one profile ("Default") is automatically
created
on the first start of GEMS. We recommend first to work with this
default
profile for some time (as described in the following sections), before
starting to create your own system profiles.&nbsp; This profile is
built on a major-element core part of GEMS thermodynamic database
(covering 20 elements) and can be
used for solving of a wide range of "usual" geochemical problems in
aqueous systems with gas and many simple mineral phases.
<p>Just press the "<tt>Computation of Equilibria</tt>" button on the
GEMS Main Dialog. A "<tt>Select Profile Record Key</tt>" dialog will
appear. Use
mouse click to select the&nbsp; "<tt>Default: major_files</tt>"&nbsp;
line
on the list and then press&nbsp; <tt>OK</tt>&nbsp; button to open the
profile.
After some seconds,&nbsp; the "<tt>Computation of Equilibria</tt>"
dialog
appears. The wide buttons on this dialog window correspond to main
modes
of geochemical modeling available in GEMS (please, note that some of
these
are still under construction and are not described here!). The simplest
is
calculation of one equilibrium state; to invoke this mode, press "<tt>Thermodynamic
System</tt>" button.&nbsp; The "<tt>Back</tt>" button returns to the
Main Dialog window; the "<tt>Numeric Settings</tt>" button opens the
Profile
Specifications dialog (<a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3201">more</a>).
</p>
<h4> <a name="P3220"></a><tt>3.2.2. Calculation of Equilibrium State</tt></h4>
After you have pressed the<tt> </tt>"<tt>Thermodynamic System</tt>"&nbsp;
button on the "<tt>Computation of Equilibria</tt>" dialog , you will
see a larger "<tt>Thermodynamic System and Equilibrium State</tt>"
dialog window (further abbreviated as <tt>SysEq dialog</tt>).&nbsp;
The buttons on <tt>SysEq dialog </tt>window lead to all main controls
over definition of chemical systems.
<p>Buttons to the left and above the red line correspond to main types
of input data, whereas those to the right and below will open main demo
windows containing results of calculation of an equilibrium state. The
key of the currently active <tt>SysEq</tt>&nbsp; record is shown in
the upper right
corner (you should see&nbsp; "<tt>Default:G:Seawater:0:0:1:25:0:"</tt>&nbsp;
there).&nbsp; Pressing once a big "GEM IPM" button creates an internal
data
structure for this chemical system definition and sends it to Gibbs
energy
minimization using the Interior Points Method. When calculation is
finished,
you can examine the results by pressing the "<tt>Parameters</tt>"
button. </p>
<p>Now, let us run your first calculation by left-mouse-button-click on
the "GEM IPM" button. A small progress dialog window with "<tt>Running
IPM...</tt>" message and a progress bar will appear. This window shows
the current SysEq record key and the number of iterations, total mass
of gas, aqueous solid phases&nbsp; (in grams),&nbsp; pH, pe and ionic
strength of aqueous electrolyte, updated every one or two seconds. A "<tt>Cancel</tt>"
button in the lower right corner breaks the calculation. When the IPM
calculation is converged, i.e. the equilibrium speciation is computed,
the appearance of the progress dialog changes. It displays now "<tt>Converged
at DK=&lt;number&gt;</tt>"&nbsp; with two buttons below - "<tt>Accept</tt>"&nbsp;
and&nbsp; "<tt>Discard</tt>".&nbsp; Both return back to the <tt>SysEq
dialog</tt>,&nbsp; the difference is that&nbsp; the&nbsp; "<tt>Accept</tt>"
button will pack&nbsp; the system definition
plus IPM calculation results and save them to database under the
current
SySeq record key;&nbsp; the "<tt>Discard</tt>" button will not save the
results.&nbsp; The SysEq record is saved also when pressing the&nbsp;
"Save" button on
the the <tt>SysEq dialog. </tt>Now, press "<tt>Accept" </tt>to
continue.
</p>
<h4> <a name="P3230"></a><tt>3.2.3. Examination of Results (+Scroll
Lists, Print, Calculator)</tt></h4>
To see what we have calculated, press the "<tt>Parameters</tt>" button
on<tt> SysEq dialog</tt>.&nbsp; An EqDemo window should appear with
three screenforms which can be seen one at a time upon pressing the <tt>EqIcp,
EqPhp</tt>
and<tt> EqDcp </tt>buttons in the top part of the window. <tt>Close</tt>&nbsp;
button gets back to the&nbsp; <tt>SysEq dialog</tt>.&nbsp; Press the <tt>EqPhp</tt>&nbsp;
button&nbsp; to see which phases appear in just calculated equilibrium
state between the normative&nbsp; seawater and the excess dry
atmospheric air
at ambient conditions.
<p>On the screenform, a list of phase names now appears with several
linked scrolllists containing some general equilibrium parameters for
phases. Put mouse pointer on any of data fields and wait a couple of
seconds - you will see a short (one-line) explanation about this data
object right near the
cursor. If one of the data fields is left-clicked, the same explanation
(plus
the data object label and index of the clicked cell) appears in the
bottom
line of the window.&nbsp; Press right mouse button to see a small
pop-up
menu&nbsp; - usually with "<tt>Help</tt>"&nbsp; and "<tt>Calculator</tt>"
lines. Choosing <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P5300">"<tt>Help</tt>"</a>&nbsp;
will provide
a HTML help page about this data object (under construction!). <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/GEMS-Linux-USREF.html#P6880">Calculator</a>
invokes a convenient calculator widget, you can fill in a cell or a
range of cells within the data object field with certain value (e.g.,
zero) or apply any arithmetic operation
to them (the second operand must be typed in the calculator line). The
pop-up menu&nbsp; on a list of species or phases will contain a "<tt>Show
record</tt>" instead of a "<tt>Calculator</tt>" line. Choosing "<tt>Show
record</tt>"
will display contents of the respective <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P33D1">ICOMP</a>,
<a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P33D3">DCOMP</a>,
<a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P33D4">REACDC</a>
or <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P33D6">PHASE</a>
definition records from the thermodynamic database (you can edit these
records only in "<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3300">Thermodynamic
Database</a></tt>" mode). </p>
<p>The lists of components and phases are usually large, only small
part of
them appears in the window as linked scroll lists. You can quickly scan
the
whole system by putting mouse pointer on a slider on any of the scroll
bars
and dragging it up and down.&nbsp; Within our example (<tt>EqPhp</tt>
screenform)
its possible to see that only aqueous and&nbsp; gas phases are present
plus
single-component mineral phases Fluorapatite,&nbsp; Hematite, and
Braunite.&nbsp;
Other phases from a long list of those included into calculation were
unstable
and hence zeroed off by the IPM algorithm. </p>
<p>Now, press a <tt>EqDcp</tt> button to display the&nbsp; "Species"
screenform.&nbsp; Basically, it is arranged in the same way as "Phase"
screenform: on linked scroll lists, one can see the full speciation
pattern in all phases (species go in the same order as phases, i.e.
first all aqueous species, then gases, solid solutions and
single-component phases).&nbsp; In addition to vector x (primary
solution of the equilibrium calculation problem), some other useful
vectors such as molalities and activity coefficients are displayed.
Data
from all these vectors (also in most other screenforms) can be sampled
in
<a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3280">GTDEMO</a>
or used in <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3270">PROCES</a>
definition <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P4000">Math
Scripts</a> by labels (with indices or names of species from the list
in the leftmost column) visible on top of each vector.&nbsp; Scroll the
lists down to see the speciation (all aqueous and gas species
present in less than 10<sup>-18</sup> moles are zeroed off). </p>
<p>Press a <tt>EqIcp</tt> button to display the "Independent
Components" screenform.&nbsp;
Here, some general information about system definition and properties
of
aqueous phase is displayed.&nbsp; The first linked scroll list shows
the
input bulk composition and the output "dual solution" of the IPM
problem
- the u vector of chemical potentials of independent components. Next
below
is another linked scroll list showing total concentrations of
independent
components dissolved in aqueous electrolyte. If gas phase is present in
the
problem formulation (not necessarily stable) then a third scroll list
will
appear below with partial pressures and fugacities of gases. </p>
<h4> <a name="P3240"></a><tt>3.2.4. Modifying and Re-calculating
Existing System Records</tt></h4>
On the demo screenforms of EqDemo window, one can see quite realistic
model of metastable equilibrium between the normative seawater of 35
g/kg
salinity open to the atmosphere at P=1 bar, T=25 C.&nbsp; There are
still
some minor problems; for instance, braunite appears as a stable
manganese
phase&nbsp; and fluorapatite keeps some phosphorus and fluoride,
although
we know that these phases normally do not precipitate from seawater.
So,
next exercise will be to modify this definition of chemical system such
as to exclude both monerals from the equilibrium state.
<p>To do this, we have to close the <tt>EqDemo</tt> window and get
back to the <tt>SysEq dialog</tt>. Pressing a "<tt>Thermodynamic System</tt>"
button&nbsp; in the upper part of the dialog window will get you into
another collection of four screen forms - a "<tt>System</tt>"
window.&nbsp; The "<tt>Compos</tt>" screenform permits to set up bulk
chemical composition of the system using references to <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P33D2">COMPOS</a>
(GCO) definition records; it also contains two identification lines
where the user can write what is this
system, and optional bibliographic reference fields. The&nbsp; "<tt>Icomp</tt>"&nbsp;
screen form permits to configure a list of independent components to be
taken into the equilibrium calculation (by toggling some <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P33D1">ICOMP</a>s
on/off&nbsp; putting pluses or minuses in the
leftmost column); this screenform also displays the total bulk
composition
vector b and permits to add to it some quantities of independent
components
by typing them into a&nbsp; bi_&nbsp; (rightmost) vector. The "Phase"
screen
form lets you toggle some phases on/off and to set metastability
parameters
and specific surface areas, if necessary. The "<tt>Dcomp</tt>" screen
form
permits to configure the list of species to be taken into calculation
of
equilibria; the formula of any of included (toggled on) species can be
used
for incrementing the total bulk composition of the system via entering
quantity
of this species into xd_ vector.&nbsp; The gEx_&nbsp; vector&nbsp; can
be
used for setting up positive or negative increments of standard Gibbs
energy
value for any species, <i>applicable within this particular system
definition
only,</i> not altering the thermodynamic database. This vector provides
a tool of unmatched flexibility for playing around with thermodynamic
data,
up to installing a prohibitive increment of +100 kJ/mole or more in
order
to eliminate the dependent component from equilibrium <i>without
changing
dimensions of the problem</i>. </p>
<p>This last facility is what we will try in our example
calculation.&nbsp; Press the "<tt>Dcomp</tt>" button and drag down the
scroll list until&nbsp; you find a "<tt>s:CaPO:fluorapatite:rs</tt>"
line in the list of DCOMP/REACDC record keys. Then put cursor into gEx_
column cell against this record key and click on the left mouse button.
A g0 increment of +80 kJ/mol already stays in this cell, and it is
still insufficient to suppress fluorapatite - so highly oversaturated
is seawater to this mineral!&nbsp; Edit this cell to 200000&nbsp; and
press <tt>Tab</tt> or move the cursor&nbsp; elsewhere to take changes
into effect. Then look for&nbsp; "<tt>s:MnSiO:braunite:rs</tt>:" in the
list. Against it, a +90000 J/mole increment has already been done, and
it still tends to precipitate. Change the increment to 200000 and press
<tt>Tab</tt> to leave the cell. Press "<tt>Close</tt>" button to get
back to <tt>SysEq dialog</tt> window.&nbsp; Finally, press "<tt>GEM IPM</tt>"
button to re-calculate the equilibrium state. </p>
<p>Press "<tt>Accept</tt>" to save the results when calculation is
finished. Examine the results by pressing "<tt>Parameters</tt>" button,
as described <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3230">above</a>
. You sould find that the Whitlockite phase appears instead of
Fluorapatite, and Hausmannite - instead of Braunite. The model
metastability can be further tuned exactly in the same way. </p>
<h4> <a name="P3250"></a><tt>3.2.5. Calculation of New Equilibria
within
the System Profile</tt></h4>
A next natural question is - how the equilibrium state may change with
temperature and/or pressure? This is very easy to do in GEMS - it just
requires to create a new SysEq record. Let us try the seawater-air
system at 1 <sup>o</sup>C,&nbsp; 1 bar.&nbsp; From <tt>SysEq dialog</tt>,&nbsp;
press the "<tt>New</tt>"&nbsp; button; this will open a small "<tt>SysEq:
New record key</tt>" dialog&nbsp; with the&nbsp; "<tt>Default:G:Seawater:0:0:1:25:0:"</tt>&nbsp;
disassembled into eight edit lines.&nbsp; First line always contains
the name of the
system profile (Default); second line is always "G" - Gibbs energy is
minimized
(minimization of other thermodynamic potentials is under
construction);&nbsp;
third line is an identifier of chemical system ("Seawater); fourth line
is
variant number of system composition definition (0, can be any integer
up
to 9999); fifth line is total volume constraint of the system (0 means
no
constraint); sixth line is pressure (1 bar); seventh line is
temperature
(25 <sup>o</sup>C); and eigth line is number of variant for
thermodynamic
data constraints (any integer between 0 and 999). Seventh line is what
we
have to change - edit it to 1 (1 <sup>o</sup>C) and press the<tt> OK </tt>button.
<h5> <a name="P3251"></a>Format of SysEq record key (numbers below are
field length in bytes and types):</h5>
<table border="3" cellpadding="3" cellspacing="3">
  <tbody>
    <tr>
      <td>Profile_id</td>
      <td>PotM</td>
      <td>System_id</td>
      <td>VarCSD</td>
      <td>Volume</td>
      <td>Pressure</td>
      <td>Temperature</td>
      <td>VarTD</td>
    </tr>
    <tr>
      <td>str_10</td>
      <td>str_3</td>
      <td>str_12</td>
      <td>int_5</td>
      <td>float_8</td>
      <td>float_8</td>
      <td>float_8</td>
      <td>int_4</td>
    </tr>
  </tbody>
</table>
<p>A small dialog "Reorganization of data fields"&nbsp; appears now,
with a new SysEq record key. Press&nbsp; "<tt>Bypass</tt>" button as we
do not need to re-structurize the system - just to recalculate
thermodynamic data to different temperature (right now done
autonmatically).&nbsp; A "System::"&nbsp; window now appears. You can
edit the first identification line by adding&nbsp; "... at 1 bar 1 C"
or something like that and press the "<tt>Close</tt>" button to come
back to&nbsp; <tt>SysEq dialog. </tt>The list of new values of
thermodynamic data for all species in the system profile can be checked
by pressing the "<tt>T,P &amp; Thermodynamic Data" </tt>button in the
lower left corner; the numbers will remain the same until different
temperature or pressure is specified by picking up an existing&nbsp;
SysEq&nbsp; record or creating a new record, just as we did before.
Now, press the big "<tt>GEM IPM</tt>" button to calculate the new
equilibrium state. Press "<tt>Accept</tt>" to save the results when
calculation is finished. Examine the results by pressing
"<tt>Parameters</tt>" button, as described <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3230">above</a>
. Now
you can see what has changed compared to 25 <sup>o</sup>C; for
instance, concentrations
of dissolved gases such as O2@&nbsp; increased; the total dissolved
carbon
is now&nbsp; 2.3169 millimolal against 2.1032 at 25 <sup>o</sup>C; pH
is
somewhat lower, quartz appears as stable phase, hausmannite disappears
and
so on. </p>
<p>In quite a similar way, by "cloning" already created SysEq records,
the impact of changed bulk composition onto chemical equilibrium states
can
be investigated, either at fixed or variable T,P. Please, try it!
First,
select again the&nbsp; "<tt>Default:G:Seawater:0:0:1:25:0:</tt>" by
pressing
<tt>"Select</tt>" button on SysEq dialog window and pointing to the
record
key in the list. Then press the "New" button, modify the record key to "<tt>Default:G:Seawater:1:0:1:1:0:"
</tt>and press<tt> OK, </tt>then<tt> "Bypass". </tt>A
"System::"&nbsp; window now appears. You can edit the first
identification line changing it to "
Seawater at 1 bar 1 C closed at 1 bar 25 C". Then change the bulk
composition
of the system by removing practically all the atmospheric air. To do
this, find "AtmAirSim" name in the list of Compos record keys, and,
against this name to the right, change the <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/GEMS-Linux-USREF.html#P6104">units
of measurement</a> from "M" (moles) to "g" (grams) in&nbsp; the XAun_
column, and 10 to 0.1 in the xa_ column. This actually means that we
removed 9.9999 kg of air from the bulk composition of the system and
thus made 1 kg of seawater
nearly "closed" with respect to the atmosphere. Please, note that you
can
also enter <i>negative</i> quantities into xa_, xd_, and&nbsp;
bi_&nbsp; vectors; the program checks only that the numbers in the b_
vector are non-negative and will issue a warning if you have made a
mistake. All right, after you have changed the composition, press "<tt>Close</tt>"
button and then the
"<tt>GEM IPM</tt>" button to calculate the new equilibrium state. Press
"<tt>Accept</tt>" to save the results. Examine the results by pressing "<tt>Parameters</tt>"
button, as described <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3230">above</a>
. Now you can see what has changed compared to the open seawater at 25 <sup>o</sup>C.&nbsp;
For instance, we have calculated a terrific pH = 8.5, f(CO<sub>2</sub>)
= 13.2 Pa and
f(O<sub>2</sub>) = 0.08 bar (normal values are pH about 8.2, f(CO<sub>2</sub>)
= 35 Pa and f(O<sub>2</sub>)=0.21 bar). This is just a consequence of
"cooling
down" a closed parcel of normative seawater equilibrated to the
atmosphere
at 25 <sup>o</sup>C. Now, you are prepared to an infinite play with
the seawater
model - for instance, you can create a next system immediately, by
adding
1 millimole of carbon or "Redfield organic matter" Compos (CorgRedf) to
see
a profound difference in speciation and partial pressures of gases in
reduced
seawater. This. however, goes far beyond the scope of this manual. You
should
have now a feeling that it is really easy to check various geochemical
ideas
while performing calculations with GEMS! </p>
<h4> <a name="P3260"></a><tt>3.2.6. Sequential Reactor Models</tt></h4>
Sequential reactors modeling is often used to reproduce changes in
stable mineral assemblage and equilibrated (mobile) aqueous or gas
phases in irreversible processes like infiltration metasomatosis,
weathering, evaporation, or evolution of aqueous fluid and wall-rock
minerals in convective hydrothermal systems (Karpov, 1981; Borisov and
Shvarov,1992). The idea is to divide a big "megasystem" into several
local-equilibrium "reactors". Aqueous solution of some initial bulk
composition enters (in some predefined quantity <tt>qAqu</tt>) into
the first reactor containing also the bulk composition of some rock in
quantity <tt>qRock</tt>. Then the fluid reaches equilibrium with the
rock, possibly dissolving some minerals and precipitating others.
Afterwards, certain quantities of phases (e.g., aqueous fluid) are
displaced to the next reactor, with
the same or different rock composition, or with another fluid
composition
to mix and equilibrate, possibly at different temperature and pressure.
The
process is repeated until all the desired sequence of irreversible
changes
is modelled.
<p>To run such a model in GEMS, one first has to create and calculate a
start SysEq record, e.g., representing&nbsp; equilibrium in the initial
fluid
only. Next, perform the following algorithm. </p>
<ol>
  <li> <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3250">Create
new</a> SysEq record key (we recommend changing only last field at
constant T,P) and then select "<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3440">Rebuild</a></tt>"
option to get into a "<tt><a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3450">SysEq:
Remake Parameters</a></tt>" configuration window with many switches and
flags.</li>
  <li> Look at help line for every switch doing a mouse click on it.
Find a switch "<tt>xp_&nbsp; via quantities of phases ...</tt>" and
check it
on (with asterisk *), then press<tt> OK </tt>to proceed. This switch
activates the mode of using bulk compositions of phases from a
previously calculated equilibrium state to calculate bulk composition
of the new system.</li>
  <li> On appearing database file selection dialog, entitled "mark one
SysEq record for getting phase bulk compositions", select key of the
initial
(or previous) SysEq record. This record key should then appear in&nbsp;
"SyPhEQ" line on&nbsp; <tt>System::Compos</tt>&nbsp; screen form.</li>
  <li> Switch to the <tt>System::Compos</tt> screen form and find a
new xp_&nbsp; vector column (with all zeros in grams by default).
Specify quantity (and units) of aqueous (gas or other) phase from
previous SysEq record that you wish to be moved into your new "reactor"
in xp_ column.</li>
  <li> Check that only remaining part of the system bulk composition
has been specified in other vectors like xa_,&nbsp; xd_, and bi_
(usually quantities of water and air given there must be zeroed off).</li>
  <li> Proceed with <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3220">calculation
of equilibrium state</a> as usual and save it to database. If a
"Warning: Charge imbalance in calculated bulk composition! Zero it
off?" message appears, press "Yes" button.</li>
  <li> If more "reactors" have to be calculated, repeat this algorithm
selecting just-calculated SysEq as previous "SyPhEQ" record. Otherwise,
sequential reactor model is finished.</li>
</ol>
&nbsp;In this simple way, very sophisticated irreversible processes can
be simulated using GEMS. Automatic calculation of sequential reactors
using <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3270">PROCES</a>
simulators is also possible (for experienced users).
Sampling and plotting of the results with <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3280">GTDEMO</a>
is
strongly recommended. <br>
&nbsp;
<h4> <a name="P3270"></a><tt>3.2.7. Setting up and Running Process
Definitions</tt></h4>
Most geochemical modeling problems require calculation of a series of
equilibrium states to simulate processes such as mixing, dissolution,
titration
etc. Doing this in manual mode can be boring and time-consuming,
especially
when the process is controlled by a certain regular change of bulk
composition of the system. To facilitate this, a Process simulator
record type has been implemented in GEMS code .In calculation mode,
this simulator generates
a sequence of SysEq records which are then calculated and stored, to be
sampled finally into one or several Gtdemo records.
<p>Two types of process simulations are possible. The "S" (sequential)
type implies that the next step of the process does not depend on the
calculated parameters of equilibrium from the previous step. This is
true for temperature-pressure changes, simple titrations, and simple
reaction extent models like dissolution of a fixed rock composition.
The "U" (reciprocal) type of the process means that the next step
depends on some parameters of the current equilibrium state, for
example, on pH, pe, bulk composition of equilibrium phases, activity of
some species etc. Typical examples are sequential reactors; inverse
titrations (to given values of pH or pe); or kinetically dependent
processes. In case of inverse titration modeling, certain amount of
titrant (acid, base, oxidant or reductant) should be found which brings
the aquatic system to certain, pre-defined value of equilibrium pH (or
pe, or both). To do this, a "gold section" optimization procedure is
invoked which compares the calculated
value to the prescribed one, and makes a correction to the amount of
titrant,
until a convergence with necessary precision is achieved. </p>
<p>In general, it may be difficult to predict all meaningful process
formulations which may be of interest to (geo)chemists because a
process formulation depends
on the system definition and modeling objectives, and an unlimited
variety
of these&nbsp; is possible. Therefore, in GEMS code, the simulated
irreversible
processes are usually defined using the <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P4000">Math
Scripts</a>
where the user can write&nbsp; what exactly and where should be changed
in
the SysEq record for the next step of the simulated sequence. This
provides
you with an unmatched freedom and flexibility because nearly all
numeric
input and output data objects in GEMS are accessible to Math Scripts
via
their labels and indices.&nbsp; The Math Script text is translated into
the
internal code at the beginning of process simulation, then run
automatically in a stack-based interpreter at each simulation step.
Some examples of PROCES math scripts are provided <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P4600">below</a>.
</p>
<p>A Process definition record always refers to an (ordinary) SysEq
record which must exist in the database before the process definition
is created and executed. This "parent" SysEq record is used as a
template which is modified
and "cloned" into a sequence of SysEq record generated by the process
simulator.
For this reason, the first eight&nbsp; fields of the PROCES record key
are
the same as in its parent <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3251">SysEq
record key</a>, followed
by the process identifier and type fields.&nbsp; The parent SysEq
record
is never changed by the process simulator; it is just used as a
template to generate new, modified SysEq records on the simulation
steps. </p>
<h5> <a name="P3271"></a>3.2.7.1. Creating or Modifying PROCES records</h5>
To create/modify PROCES record, press "Definitions of Processes" button
in "Calculation of Equilibria" dialog. In the "Process" window, select <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P333R3">"Record"
"Create"</a> or <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P333R2">"Record"
"Remake"</a> menu commands and then type in or select a PROCES record
key. In the appearing "Reorganization of Data Fields" dialog, press "<tt>Clear
all</tt>" button if you wish to create the Process simulator from
scratch, "<tt>Remake</tt>" for changing some fields with
re-configuration of the record, or "<tt>Bypass</tt>" if you will only
edit some numbers or math script lines.&nbsp; In the first two cases,
a&nbsp; "Process: Remake Parameters" window appears with switches and
counters. Read meaning of the switches and counters by pointing mouse
to them, and modify wherever necessary. The most important input at
this step is a Ntxi&nbsp; field where you should type a number of
"points", i.e. SysEq records to be produced by the process simulator.
Often it is advisable to order an optional "<tt>modC</tt>" table
(visible on Page 2 of "Process:" window) where some input data can be
conveniently typed in and then used
in the process math script. Press<tt> OK </tt>when configuration is
finished.
<p>Now, Page 1 of the <tt>Process:</tt> window appears. If there is
nothing to modify then <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3273">proceed
with calculations</a>.&nbsp; Variants of the process simulation can be
set up using one or more of three-number vectors&nbsp; <tt>"iTm",
"iNv", "iP", "iTC", "iV", "iTau", "ipXi", "iNu", "ipH", "ipe"</tt>.
Scan them with mouse pointer and read help lines. Each of these vectors
has the following structure: </p>
<p><tt>first cell&nbsp; [0]&nbsp; start value</tt> <br>
<tt>second cell [1]&nbsp; limiting value</tt> <br>
<tt>third cell&nbsp; [2]&nbsp; increment (0 - not changed)</tt> </p>
<p>The first five vectors are automatically used by the program to
generate the last five fields of SysEq record keys. Please, make sure
that the respective values will not exceed length limits of <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3251">SysEq
record key format</a>. In the&nbsp; <tt>"iTm"</tt> specification, it
is wise to put increment larger than 1 (at best, 5 or 10) if the
process simulation will change bulk composition of the system. This may
let you a possibility of producing
more points in the most interesting parts of the sequence (e.g., near
redox
barrier) later on. </p>
<h5> <a name="P3272"></a>3.2.7.2. Modifying Math-Scripts&nbsp; in
Process Definitions</h5>
Most of the three-cell interval vectors discussed under previous
heading have counterparts - the work objects <tt>"J", "cTm", "cNv",
"cP", "cT", "cTC",
"cV", "cTau", "cpXi", "cXi", "cNu", "cpH", "cpe", "cEh"</tt> , visible
on&nbsp;
<tt>Page 3</tt>&nbsp; of the "Process" window.&nbsp; When calculation
of
the process begins, these work cells are loaded with the respective
start values. The process simulator uses current contents of <tt>"cTm",
"cV",
"cP", "cTC", and "cNv"</tt> objects to construct SysEq record keys. The
<tt>"Next"</tt> object contains 1 if the next process point is to be
simulated,
or 0 if the sequence is finished; the value will be switched
automatically
when the pre-defined limit is achieved in any of the work cells or
specified
in math script. All these&nbsp; work cells and corresponding interval
vectors
can be used as variables in the process <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P4000">Math
Script expressions</a>
aimed at describing any changes in the system along the process path.
The
script can be typed into <tt>"P_expr"</tt> text field on <tt>Page 1</tt>
of the "Process :"&nbsp; window.&nbsp; The most frequent form of the
process
script looks like this:
<p><tt>$ Change in Ca/Si bulk ratio in the system</tt> <br>
<tt>cNu =: iNu[0] + J*iNu[2];</tt> <br>
<tt>xd_[\J{quartz}] =: cNu;</tt> <br>
<tt>xd_{portlandite} =: 1-cNu;</tt> <br>
<tt>$ end</tt> </p>
<p>This little program is run automatically to change bulk composition
in SysEq records when each next point is generated (indexed with <tt>J</tt>)
in the process simulation. The first and the last are comment lines.
The second line calculates the current number of moles of added quartz
stoichiometry by incrementing within <tt>"iNu"</tt> counter (supposed
to be set up by the
user). Third line copies it into an element of <tt>"xd_"</tt> vector
in <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3250">system
definition</a> which corresponds to quartz. Fourth line calculates
number of moles of portlandite stoichiometry and assigns
it to the respective element of <tt>"xd_"</tt> vector.&nbsp; There are
many
ways to specify the same process using Math Script expressions; some
examples
are provided <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P4600">below</a>.
</p>
<h5> <a name="P3273"></a>3.2.7.3. Running the Process Simulation</h5>
After editing of the process definition fields is finished, press <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P333R4">"Calculate"</a>
button or menu command to start calculations. If the Math script
contains syntax errors, you may be asked to fix them
before the program can proceed. During calculations, the "IPM
Progress"&nbsp;
dialog is normally visible with the current SysEq record key.
Calculations
may take time if the system is large or the process generates many
points
(depending on the processor performance). When all equilibria are
computed,
you will see "Process calculation finished OK" in the status line of
the
"Process: " window. Press "<tt>Accept</tt>" button and proceed with
analyzing
the results. <br>
&nbsp;
<h4> <a name="P3280"></a><tt>3.2.8. Setting up and Running
Graphic-Demo Data Samplers</tt></h4>
When many equilibrium states are calculated using the Process
definition to simulate titrations, process extent models, evaporation
or temperature/ pressure changes, it is problematic to print out all
the results, pick up and plot them by hand. To facilitate this
operation - a crucial step in
the performance of&nbsp; modeling results interpretation - a special
facility is included into GEMS code.&nbsp; This is a Gtdemo data
sampler and plotter which works according to specifications provided in
the Gtdemo records stored in&nbsp; the users database extension
files.&nbsp; Gtdemo can sample virtually any numerical data by reading
records of any type according to a selected sequence of record keys.
Which data to extract and how to recalculate them - the user can
specify in a <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P4000">Math
Script</a> text in a special Gtdemo record field.&nbsp; As in case of
the <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3270">Process
simulator</a>, the Gtdemo math script is automatically translated and
run every time when the Gtdemo record is recalculated. When a next data
record is extracted
from the database, the Math Script is run to pick up the necessary
data,
re-scale them or calculate some derived parameters, and store into a
Gtdemo
table (up to 10 columns). When scanning of database records is
finished,
this table can also be displayed on a screen form, <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P333R9">printed</a>
into a text file for subsequent import to worksheets or sophisticated
scientific graphing software for high-quality presentations, or <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P333R8">plotted</a>
in a graphic window. Graphs can be <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3290">customized</a>,
zoomed and printed. A sequence of (user-defined) experimental points
can be displayed on the graph together with the sampled (or calculated)
numbers - this is very useful when the thermodynamic model has to be
fitted to the experimental data. Any number of Gtdemo records can be
created for sampling the same set of GEMS database records.
<h5> <a name="P3281"></a>3.2.8.1. Creating or Modifying Gtdemo Records</h5>
To create/modify a Gtdemo record, press a "Data Sampler and Graph Demo"
button in "Calculation of Equilibria" dialog. In the "GtDemo" window,
select <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P333R3">"Record"
"Create"</a> or <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P333R2">"Record"
"Remake"</a> menu commands and then type in or select a Gtdemo record
key of the following format: <br>
&nbsp;
<table border="3" cellpadding="3" cellspacing="3">
  <tbody>
    <tr>
      <td>Profile_id</td>
      <td>Top_chain</td>
      <td>GD_code</td>
      <td>Variant_#</td>
      <td>GD_name</td>
    </tr>
    <tr>
      <td>str_10</td>
      <td>str_8</td>
      <td>str_4</td>
      <td>int_4</td>
      <td>str_16</td>
    </tr>
  </tbody>
</table>
<p>Top_chain field shows the highest-level record type to be sampled
(e.g., PROCES which implies that SysEq records created by the Process
Simulator will be sampled together with the data in IPM work structure
(Multi) and thermodynamic
data from the Profile structure). GD_code is usually "GT". Variant_#
should
be different if another Gtdemo sampler is created for the same output
dataset.
When a new Gtdemo record key is assembled, press OK to proceed. Select
the
top record chain to be sampled from the appearing list and press OK (if
Proces
is selected, you will have to select one Proces record after that).
Now,
in "Reorganization of Data Fields" dialog, press "<tt>Clear all</tt>"
button
if you wish to create the Gtdemo sampler from scratch, "<tt>Remake</tt>"
for changing some fields with re-configuration of the record, or "<tt>Bypass</tt>"
if you will only edit some names or math script lines.&nbsp; In the
first
two cases, a&nbsp; "GtDemo: Remake Parameters" window appears with
switches
and counters. Read meaning of the switches and counters by pointing
mouse
to them, and modify wherever necessary. The most important input at
this
step is a gDimXY[1] field where you should type a number of columns for
the
Gtdemo table to be produced. Do not enter anything into gDimXY[0] cell
(number
of lines in Gtdemo sampler table) as it will be automatically set later
upon
selection of records to be sampled. If you wish also to plot
experimental
data on the graph for comparison with calculated results then turn on
the
first switch ("Use empirical data") and enter number of lines to
gDimEf[0]
and columns(ordinates) to gDimEf[1] cells for allocating object fields
where
you can type in the experimental data later. Press<tt> OK </tt>when
configuration
is finished. You will be asked to set template for the database record
list
(just press OK for the first time). The list of record keys will
appear,
select needed ones by lef-mouse-clicks and press OK. </p>
<p>Now, <tt>Page 1 </tt>of the<tt> GtDemo::</tt> window appears. Fill
out the "GDname" and "GDcom" lines and also type in the names for
abscissa and ordinate (for the plot legend), as well as the column
(line) identifiers in "gLnam" fields. If you have ordered arrays for
experimental data, fill in the identifier(s) in&nbsp; "gLnamE" fields,
go to<tt> Page 3 </tt>of<tt> GtDemo </tt>window and type the data
into "xE" vector (abscissa) and "yE" columns (ordinates). Now, what
remains is to write a Math Script which will pick the numbers from GEMS
data objects and put them into "x0" vector (abscissa) and "y0" columns
(ordinates) of the Gtdemo sampler table. </p>
<h5> <a name="P3282"></a>3.2.8.2. Modifying Math-Scripts&nbsp; in
Gtdemo
Samplers</h5>
On<tt> Page 2 </tt>of<tt> GtDemo </tt>window, you can see two special
Gtdemo data objects: <tt>"next"</tt>&nbsp; contains 1 if the next data
record
is to be sampled, or 0 if the sequence is finished; and "<tt>jR</tt>" -
index of the (currently processed) data record from the "GD_rkl" list.
These
two objects together with&nbsp; the "x0", "y0" arrays can be used as
variables in the Gtdemo <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P4000">Math
Script expressions</a> aimed at describing which data to sample and
assign to x0[jR]&nbsp; and y0[jR][0], y0[jR][1], .... cells (the jR
index is incremented automatically when Gtdemo sampler is calculated).
The script can be typed into <tt>"gExpr"</tt> text field
on <tt>Page 1</tt> of "<tt>GtDemo::</tt>"&nbsp; window.&nbsp; The
typical
Gtdemo script looks like this:
<p><tt>$ Abscissa - Ca/Si bulk ratio in the system</tt> <br>
<tt>x0[jR] =: b[\i{Ca}] / b{Si};</tt> <br>
<tt>$ Ordinates - total dissolved Ca and Si, millimolal</tt> <br>
<tt>y0[jR][0] =: m_t{Ca} * 1000;</tt> <br>
<tt>y0[jR][1] =: m_t{Si} * 1000;</tt> <br>
<tt>$ Free Ca+2 ion, millimolal</tt> <br>
<tt>y0[jR][2] =: my[\j{Ca}] * 1000;</tt> <br>
<tt>$ end</tt> </p>
<p>This little program is run automatically to pick up data from&nbsp;
SysEq records (indexed <tt>jR</tt>) read one-by-one&nbsp; by the
Gtdemo sampler. Comment lines begin from "$" and explain what is done
by the following math script operators.&nbsp; There are many ways to
specify various data samplers using Math Script expressions; some
examples are provided <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P4600">below</a>.
</p>
<h5> <a name="P3283"></a>3.2.8.3. Running Gtdemo Samplers</h5>
After editing of the Gtdemo definition fields is finished, press <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P333R4">"Calculate"</a>
button or menu command to start calculations. If the Math script
contains syntax errors, you may be asked to fix them
before the program can proceed. Calculations may take time, especially
if
many large SysEq records are sampled because each such record is
expanded
into both Multi and System Definition data structures and thermodynamic
data
are calculated if temeprature or pressure differs (depending on the
processor
performance). When all database records are sampled, you will see
"GtDemo
calculation finished OK" in the status line of the "GtDemo::" window.
Press
"<tt>Page 3</tt>"&nbsp; button and proceed with analyzing, plotting and
printing&nbsp; the results. <br>
&nbsp;
<h4> <a name="P3290"></a><tt>3.2.9. Plotting Data and Customizing
Graphs</tt></h4>
To plot Gtdemo arrays, select a "Record" "Plot" menu command of
"GtDemo::" window. You will be prompted to save Gtdemo record to
database (it is wise to do it). A graph window entitled as the "GDname"
line appears. You can see what each line means after pressing on the
"Legend" button. "Fragment" button will display an enlarged fragment of
the graph. "Print" button function is still under construction.
<p>To customise the graph, press the "Legend" button to open "Legend"
dialog. On this simple form, you can set up scales for abscissa and
ordinates, select axis type (the number of grid lines), define size and
position of zoomed
fragment, and set symbol shape, size and color, as well as line
thickness
and color, for each ordinate. The "Background" button lets you to
specify
background color for the graph (not saved in this version!). </p>
<p>If you have entered some experimental data into xE and yE arrays,
their symbols and colors can be customized separately on the "Legend"
dialog. We
recommend to use a <tt>ksnapshot</tt> utility program (a KDE
application) for capturing Gtdemo graphs and legends into <tt>*.png</tt>
files. <br>
&nbsp; </p>
<h4> <a name="P3201"></a><tt>3.2.10. Some Hints, Tips and Tricks</tt></h4>
On<tt> EqStat dialog </tt>window, there is a "FIA Simplex" checkbox
below the "GEM IPM" button. This checkbox (checked on by default)
defines which initial approximation will be used for entering a
feasible domain of the IPM minimzation problem. "FIA Simplex" on means
that a linearized problem is solved first using the simplex method
linear programming subroutine, then a special procedure for entering
the feasible domain is performed which
involves all phases and species included into the problem (see more in
Karpov,
Chudnenko and Kulik, 1997). This scheme guarantees correct selection of
stable phases and calculation of redox state parameters, and should
always
be used when an equilibrium is calculated for the first time for a
given
system configuration. In aqueous systems, the full sequence usually
requires
40 to 120 iterations. However, if only a small change in composition or
T,P is specified for the next calculation then the equilibrium
speciation
from the previously-calculated SysEq record can be directly used as a
feasible-domain
initial approximation&nbsp; for the IPM algorithm. In this case, only a
few iterations of IPM are needed, which can save a lot of computing
time.
Try this mode by unchecking the "FIA Simplex" box and pressing the "GEM
IPM" button. Even if nothing has been changed in the system definition,
doing
this usually results in much better precision od mass balance. Beware,
however,
that the direct entering into IPM retains only phases and species which
have
been selected in non-zero quantities during the preceding, "FIA
Simplex"
calculation, and may (theoretically) give wrong results if the bulk
composition
or stability of some phases have changed significantly. So, if in
doubt,
it is always better to check with the "FIA Simplex" on.
<p>Some bulk compositions, inconsistent thermodynamic data or highly
non-ideal solution phases may sometimes cause difficult convergence or
error messages of the IPM module. In many cases, the problem can be
successfully solved after some adjustment of the numeric control
parameters of the IPM minimization algorithm. These parameters are
saved inside of the Profile records and can
hence be kept different in separate user-created system profiles. To
adjust
the parameters, go in "Computation of Equilibria" mode of GEMS, select
the
system profile and press&nbsp; the "Numeric Settings..."&nbsp; button
on
the "Computation of Equilibria" dialog to get in a&nbsp; "Profile"
window. <br>
<a name="P3211"></a> <br>
If IPM algorithm did not converge or did it after more than 200
iterations, increase Pa_DK threshold value three times and try again.
Sometimes the FIA
Simplex procedure cannot enter the fesible domain and an error message
about
that is dispayed. In this case, increase the Pa_DHB threshold 10 times
and
try to calculate again (this will also increase the mass balance
deviations in the calculated equilibrium state).&nbsp; Other important
controls are&nbsp; Pa_DB (minimum number of moles in the bulk
composition) and&nbsp; Pa_DS
(cutoff number of moles for phase elimination). Bad convergence of IPM
in
highly non-ideal system can often be avoided by changing the&nbsp;
Pa_AG
factor to 0.4 - 0.5 and&nbsp; Pa_DGC to 0.3. Setting Pa_DGC to a
negative
value &gt; -1 reverts to the old method of IPM tinkle suppression for
highly
non-ideal systems&nbsp; (Karpov et al., 1997). If you want to make
these
changes effective during next work sessions, save them by
pressing&nbsp;
"Save"&nbsp; pictogram or selecting&nbsp; "Record" - "Save" pop-up menu
line.
In general, adjustments of this kind require a considerable experience
in
thermodynamic modeling with GEM/Selektor codes. </p>
<p>GEMS is capable to calculate equilibria when several highly
non-ideal phases
are included into the system (Karpov et al., 1997). This, however,
poses
specific problems of uniqueness of the result and of attaining
convergence of IPM algorithm. The first problem is important when some
phases have positive excess Gibbs energy and exsolution (or liquation)
may occur. This is a matter of correct problem statement and usage of
special "activity coefficients" for the initial Simplex approximation.
The second problem is solved in GEMS by introducing a global smoothing
parameter which controls increments to
chemical potentials of species due to the non-ideality or electrostatic
corrections. This "Pa_AG" parameter can be reset in the <a
 href="file:///W:/Shared/SYNCHRO/ToDoInGEMS/GEMS3HTML/doc/html/ge_howto.html#P3211">"Numeric
Settings"</a> screenform. It takes initial value at first 50 IPM
iterations, then decreases in about 10 times next 30 iterations
(depending on Pa_DGC), 10 times more - at next 20 iterations and so on.
In most cases, good convergence is achieved in 70 to 130 iterations
even in very non-ideal systems. <br>
&nbsp; <br>
&nbsp; </p>
<p><tt>end of file</tt> <br>
&nbsp; </p>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</body>
</html>
