<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <meta name="GENERATOR"
 content="Mozilla/4.72 [en] (Win98; I) [Netscape]">
  <title>GEMS3 Tutorial (Getting Started)</title>
  <meta name="description" content="Version 2.0.0-PSI">
  <meta name="author" content="GEMS-PSI Development and Support Team">
</head>
<body>
<h1><img src="gems1.png" height="48" width="48"> <b><font
 color="#000099"><font size="+2"> </font></font></b><font
 color="#000066">GEM-Selektor version 3</font><b><font color="#000099"><font
 size="+2"> <br>
</font></font></b></h1>
<h2><font face="Helvetica, Arial, sans-serif">Tutorial - Getting Started<br>
</font></h2>
<font face="Helvetica, Arial, sans-serif">Those who prefer a modern
style<big><small> of learning software "by doing" may switch to a
Screenshot Gallery Tutorial on GEMS-PSI home page (<font color="#6600cc">http://les.web.psi.ch/Software/GEMS-PSI/screenshots/</font>).
<br>
<br>
A more detailed introduction in setting up modelling projects and
calculating equilibria can be found in <a href="#GSM_CALC_EQSTAT">Section
2 below</a>.</small>&nbsp; </big></font><br>
<p><b><small><font face="Helvetica, Arial, sans-serif"><big><a
 href="#GSM_CALC_EQSTAT"><font color="#993300">Kick-Off Start (make
your first system)</font></a></big></font></small></b> </p>
<hr size="2" width="100%">
<h3><font face="Helvetica, Arial, sans-serif">Contents</font> &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </h3>
<p><big> </big></p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a href="#GSM-INTRO">1.
Introduction</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_WORKSESSION"> 1.1.&nbsp; Starting and Quitting the Work
Session</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_HELP_BIBLIO"> 1.2.&nbsp; Runtime Help and Bibliography
System</a></font></li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_SCRIPT_LIBS">1.2.1.&nbsp; Script Libraries</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_BIBLIO_REF"> 1.2.2.&nbsp; Bibliographic References and your
Comments</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a href="#GSM_TOOLTIPS">1.2.3.&nbsp;
Tool Tips and Status Line Help Messages</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_HELP_RUNTIME"> 1.2.4. Access to HTML Runtime and Online
Documentation</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a href="#GSM_GEMS_GUI">1.3.
Graphical User's Interface (GUI)</a></font></li>
  <li>
    <p><a href="#GSM_CALC_EQSTAT"><font
 face="Helvetica, Arial, sans-serif">2.&nbsp; Calculating Equilibria
with GEM-Selektor</font></a>&nbsp;</p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_MOD_PROJECTS">2.1. &nbsp;Modelling Projects and GEMS
Database</a></font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_OPEN_PROJECT">2.1.1. Opening Existing Projects&nbsp;</a></font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_CREATE_PROJECT">2.1.2. Creating a New Project</a></font></p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_CREATE_SYSTEM_1">2.1.3. Creating your First Chemical System
Definition (CSD)</a> </font><br>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_SINGLE_EQSTAT">3.&nbsp; Calculating a Single Equilibrium
State</a></font></p>
  </li>
</ul>
<p> </p>
<p> </p>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a href="#GSM_SET_BCC">3.1.
Setting up the Bulk Composition of Chemical System</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_RUN_GEMIPM"> 3.2.&nbsp; Running GEM IPM to Calculate an
Equilibrium State</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_VIEW_RESULTS"> 3.3.&nbsp; Examining Results: Equilibrium
Speciation</a></font></p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_VIEW_IPM_INPUT">3.4. Examining Results: Input System
Definition and Thermodynamic Data</a></font> <br>
  </li>
</ul>
<p> </p>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_PRINT_RESULTS">3.5. Printing GEM Results and Chemical
System Definition</a></font></li>
</ul>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_CLONE_SYSEQ">3.6. Modifying </a></font><a
 href="#GSM_CLONE_SYSEQ"><font face="Helvetica, Arial, sans-serif">and
"Cloning"</font></a><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_CLONE_SYSEQ"> Chemical System Definitions</a>&nbsp;</font></li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="file:///C:/GEMS2test/program/doc/html/gemstart.html#GSM_MOD_SYSTEM_STOI">3.6.1.&nbsp;
Modifying System Stoichiometry</a></font>&nbsp;</p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_CLONE_SYSEQ_REC">3.6.2. "Cloning" SysEq Records in Project
Database (Also for Other P, T)</a></font> </p>
  </li>
</ul>
<p> </p>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_SELECT_PHASES_SPECIES">3.6.3. &nbsp;(De)Selecting Phases
and Species</a><br>
    </font> </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_SET_META_CONSTR">3.6.4. Setting Additional Metastability
Constraints</a><br>
    </font> </p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_SET_CORR_G0">3.6.5. Setting Corrections to Input
Thermodynamic Data </a><br>
    </font> </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_SYSTEM_FROM_SCRATCH"> 3.7. Creating a New System Definition
(as an Alternative)</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_MORE_EQUILIBRIA">3.8.
More About Calculations of Single Equilibria</a></font><br>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_IRREVER_PROCESS"> 4.&nbsp; Simulation of
Irreversible Processes</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_PARENT_SYSEQ">4.1. Creating Parent System
Definition</a><br>
    </font> </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_SET_PROCESS_SIM"> 4.2.&nbsp; Setting up a
Process Simulator</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_PROSIM_MATH_SCRIPT">4.3. Writing Process
Simulation Math Script </a><br>
    </font> </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_SET_PROSIM_SAMPLING">4.4. Setting a Process
with Data Sampling</a> <br>
    </font> </p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_PROSAMPLE_MATH_SCRIPT">4.4.1. Writing a
Process
Data Sampling Math Script</a><br>
    </font> </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_RUN_PROSAMPLE">4.4.2. Running Process
Simulation with Data Sampling</a><br>
    </font> </p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_PLOT_PROSAMPLE">4.4.3. Examining, Plotting and
Printing Sampled Results</a><br>
    </font> </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_PROFIT_RUN">4.4.4. Running Process Simulation
in Graphic Fitting Mode</a><br>
    </font> </p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_PROSIM_RESULTS">4.5. Examining Process
Simulation Results</a><br>
    </font> </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_INVERSE_TITR">4.6. Process Simulator to
Perform an Inverse Titration Sequence</a><br>
    </font> </p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_PROCESS_MORE">4.7. More About Process
Simulators </a></font><br>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_GTDEMO_SAMPLER"> 5. Using Graphic/Tabulation
Data Samplers (GtDemo)</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_CREATE_GTDEMO">5.1. Creating a GtDemo Sampler </a><br>
    </font> </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_GTDEMO_MATH_SCRIPT">5.2. Writing a GtDemo Math
Script</a><br>
    </font> </p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_RUN_GTDEMO"> 5.3. Sampling Process Results and
Plotting Graphs</a></font></p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_ADD_EMPIRICAL">5.4. Adding and Plotting
Empirical Data</a><br>
    </font> </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html#GSM_GTDEMO_PRINT"> 5.5. Printing Sampled Results
using Print Scripts</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_EXTEND_PROJECT"> 6. Extending Modelling
Project
Database</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_DATA_OVERRIDE"> 6.1. Overriding Database
Records for Species and Phases</a></font></p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_SPECIES"> 6.2. Adding New Dependent
Components (Species)</a></font></p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_DCOMP">6.2.1. Adding DComp Records</a></font></li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_SET_BIBLIOREF">6.2.2. Setting Up a
Bibliography
Reference</a><br>
    </font> </p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_REACDC">6.2.3. Adding ReacDC Records&nbsp;</a></font></p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_RUN_RTPARM">6.2.4. Tabulating T,P Corrections
for Thermodynamic Data (RTParm Records)</a>&nbsp;</font></li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_RTPARM_PRINT_SCRIPT">6.2.5. Modifying a RTParm
Print Script</a><br>
    </font> </p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_PHASE">6.3. Adding New Phase Definitions</a></font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_SINGLE">6.3.1. Creating a Single-Component
Phase Record</a></font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_IDEAL">6.3.2. Creating an Ideal Solution
Phase Record</a></font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_NONIDEAL">6.3.3. Creating a Non-Ideal
Solution Phase Record</a></font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_PHASE_MATH_SCRIPT">6.3.4. Writing Math Script
for a Non-Ideal Mixing Model</a></font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_SORPTION">6.3.5. Creating a Sorption Phase
Record</a><br>
    </font> </p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ADD_COMPOS">6.4. Adding New PCO (Compos)
Records</a></font></p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_GEMS_DB_MORE">6.5. More About Management of
GEMS Databases</a><br>
    </font> </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_PROJECT_EXTEND">7. &nbsp;Extending the
Modelling Project</a></font></p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_ELEMENTS_DIALOG">7.1. ElementsDialog Options</a></font></li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_PROJECT_COPY">7.2. Copying Records from GEMS
Kernel Database</a><br>
    </font> </p>
  </li>
</ul>
<p> </p>
<ul>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_EQSTAT_RERUN"> 7.3. Re-running already
calculated equilibria</a><br>
    </font> </p>
  </li>
  <li><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_PROJECTS_MORE">7.4. More About Modelling
Projects</a></font></li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="gemstdbm.html#GSM_MOD_SORPTION">8. Modelling Systems with
Sorption Phases</a></font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif">8.1.&nbsp;</font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif">8.2. <br>
    </font> </p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif"><a
 href="#GSM_HOWTO_PROCEED">9. </a><a
 href="gemstdbm.html#GSM_HOWTO_PROCEED">How to Proceed&nbsp;</a></font></p>
  </li>
</ul>
<p> </p>
<p> </p>
<h2> &nbsp;</h2>
<hr size="2" width="100%">
<h2> <a name="GSM-INTRO"></a><font face="Helvetica, Arial, sans-serif">1.
Introduction</font></h2>
<p><font face="Helvetica, Arial, sans-serif">If you are new to <a
 href="glossary.html#DT_thermo_modelling">thermodynamic modeling</a>
and have just installed the GEM-Selektor code on your PC then, within
several hours,&nbsp; this chapter will lead you step by step through a
typical modeling session, without going too much into terminology or
technical details (but providing necessary links). <br>
&nbsp;<br>
You'll learn how to make a <a href="glossary.html#DT_project">modelling
project</a>, define and "clone" <a href="glossary.html#DT_system">chemical
systems</a>, calculate <a href="glossary.html#DT_equilibrium">equilibrium
states</a>,&nbsp; explore and print the results, set up a <a
 href="glossary.html#DT_process_sim">process simulator</a>, sample and
plot results of calculation of a series of (local/partial) equilibria.
Next, you will learn how to add new <a href="glossary.html#DT_species">chemical
species</a> and <a href="glossary.html#DT_phase_thermodynamic">phases</a>
to your modelling project database and then extend the project lists
while updating
the already calculated systems. We hope that, eventually, you'll get
a feeling of easiness and efficiency of GEM thermodynamic modelling,
and decide to use it and learn more. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif"> If you already know how
to operate the GEM-Selektor <a href="glossary.html#DT_GUI">GUI</a>,
then skip the introductory sections below and proceed right away to <a
 href="#GSM_CALC_EQSTAT">Chapter 2 - how to calculate chemical
equilibria</a>. </font><br>
&nbsp; <br>
&nbsp; </p>
<h3> <a name="GSM_WORKSESSION"></a><font
 face="Helvetica, Arial, sans-serif">1.1. Starting and Quitting the
Work Session</font></h3>
<p><font face="Helvetica, Arial, sans-serif">It is assumed here that
you have
installed GEM-Selektor properly on your Win32 or Linux PC (if not
yet done, please consult <a href="gemsetup.html">Installation and Setup</a>).
Start the program by clicking on its icon (or execute&nbsp; </font><big><tt>Rungems.bat</tt></big><font
 face="Helvetica, Arial, sans-serif"> &nbsp;from the command line, if
appropriate). <br>
&nbsp;<br>
Upon the normal startup, you should see a GEM-Selektor Main Dialog,
with the "Get Started" and&nbsp; "About"&nbsp; buttons in the bottom
right corner. A left mouse click on the "Get Started" button will show
the beginning of this Manual in the Helpviewer browser; by clicking on
the "About" button and following hyperlinks there, you can also learn
more about the program and its developers. The normal way of quitting
GEMS work session is to go back to the Main Dialog and press the
"Exit"&nbsp; button (this will also save the current program
configuration). </font><br>
</p>
<p> &nbsp; </p>
<h3> <a name="GSM_HELP_BIBLIO"></a><font
 face="Helvetica, Arial, sans-serif">1.2. Runtime Help and Bibliography
System</font></h3>
<p><font face="Helvetica, Arial, sans-serif">In GEM-Selektor, you
always have
a direct access to the script- and bibliography database (<a
 href="gm_sdref.html">SDref module</a>), which contains default <a
 href="#GSM_SCRIPT_LIBS">libraries</a> of print/export, import, and
template math scripts, and also helps in keeping track of the source of
any input data or comments to your own modelling work. Moreover,
GEM-Selektor dialogs and module window pages show <a
 href="#GSM_TOOLTIPS">tooltips</a> and provide full <a
 href="#GSM_HELP_RUNTIME">runtime access</a> to HTML documentation.<br>
</font> <br>
</p>
<p> </p>
<h4><a name="GSM_SCRIPT_LIBS"></a><font
 face="Helvetica, Arial, sans-serif">1.2.1.&nbsp; Script Libraries</font></h4>
<p><font face="Helvetica, Arial, sans-serif">GEM-Selektor comes with a
collection of <a href="gm_sdref.html">SDref </a>records containing <a
 href="pe_script.html">print/export, import</a>, and template <a
 href="gmscript.html">math scripts</a> - the <a
 href="gm_sdref.html#DEF_SCRIPT_LIB">default script library</a> - that
should &nbsp;help you in performing data import/export and writing math
scripts. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">A&nbsp;print script can be
selected when the "Print" icon is clicked or the "Record" "Print..."
menu command activated on any module window. In a similar way, export
and import scripts can be executed using "Record List" "Export..." or
"Record List" "Import..." menu commands. Template math scripts cannot
be executed immediately; but they can help in writing your own <a
 href="gmscript.html">math scripts</a>.</font><br>
<br>
</p>
<p> </p>
<h4><a name="GSM_BIBLIO_REF"></a><font
 face="Helvetica, Arial, sans-serif">1.2.2.&nbsp; Bibliographic
References and your Comments</font></h4>
<p><font face="Helvetica, Arial, sans-serif"> It is important for
scientific applications to keep track of bibliographic sources of input
data. The GEM-Selektor code can provide access to one or more records
with bibliographic references and comments to them (stored in&nbsp; <a
 href="gm_sdref.html">SDref database</a> module) from <a
 href="gm_dcomp.html">DComp</a>, <a href="gm_reacdc.html">ReacDC</a>, <a
 href="gm_rtparm.html">RTParm</a>, <a href="gm_compos.html">Compos</a>,
<a href="gm_phase.html">Phase</a>, <a href="gems_bcc.html">SysEq</a>, <a
 href="gm_proces.html">Process</a> and <a href="gm_gtdemo.html">GtDemo</a>
module windows. References to bibliography (<a
 href="gdb_rkey.html#dbm_SDref">SDref record keys</a>) are stored in
the
respective database records together with numerical input data.</font></p>
<p><font face="Helvetica, Arial, sans-serif">On those module windows,
you can find an</font>&nbsp; <big><tt>xSDref</tt></big>&nbsp; ( <tt><font
 size="+1">x</font></tt>&nbsp; <font
 face="Helvetica, Arial, sans-serif">stands for any letter like</font> <big><tt>d,
r, p</tt> ...</big>)&nbsp; <font face="Helvetica, Arial, sans-serif">list
with lines referring to
record(s) in the SDref database. Lines in the</font> <tt><big>xSDval</big>
</tt><font face="Helvetica, Arial, sans-serif">list, located to the
right, usually contain comments on what has been taken from the
referenced data source.<br>
&nbsp;<br>
</font> </p>
<p> </p>
<h4><a name="GSM_TOOLTIPS"></a><font face="Helvetica, Arial, sans-serif">1.2.3.&nbsp;
Tool Tips and Status Line Help Messages</font></h4>
<p><font face="Helvetica, Arial, sans-serif">Tooltips are very short
messages (on yellow background) explaining in brief the meaning of a
button or a data field that you see. Just keep the mouse pointer 1-2
sec on a data field
or button to get the tooltip. In GEM-Selektor module window pages, the
content of tooltips will also be shown in the lowermost left
corner (status line) if the data object field is left-mouse
clicked.&nbsp;</font></p>
<p><br>
</p>
<p> </p>
<h4><a name="GSM_HELP_RUNTIME"></a><font
 face="Helvetica, Arial, sans-serif">1.2.4. Access to HTML Runtime and
Online Documentation</font></h4>
<p><font face="Helvetica, Arial, sans-serif">If tool tips are not
sufficient, or if you wish to learn more systematically about the
program, then HTML documentation files can be opened in a
context-sensitive way in the built-in "Helpviewer" browser window of
GEM-Selektor. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">You can read more about
using the GEMS Helpviewer in the <a href="gems_gui.html#HELP_RUNTIME">gems_gui.html</a>
manual. <br>
</font> <br>
</p>
<p> </p>
<h3><a name="GSM_GEMS_GUI"></a> <font
 face="Helvetica, Arial, sans-serif">1.3. Graphical User's Interface
(GUI)</font></h3>
<p><font face="Helvetica, Arial, sans-serif">The GEM-Selektor GUI
consists of dialogs, (sub)module windows, and the Helpviewer browser.</font>
<font face="Helvetica, Arial, sans-serif">Dialogs control the program
operation (together with toolbars and menus) and display some results
in graphical form (e.g. Graph Dialog, System Dialog).&nbsp;</font> <br>
<font face="Helvetica, Arial, sans-serif">Module windows provide access
for the user to view and edit input and output data.</font><font
 face="Helvetica, Arial, sans-serif"> Data Object Descriptors (DOD)
form a backbone of data manipulation in the GEM-Selektor GUI and
database. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">You can read more about
the GEMS
user's interface operation in the <a
 href="gems_gui.html#GEMS_GUI_INTRO">gems_gui.html</a>
manual. The database functionality is described in <a
 href="gems_gdb.html">gems_gdb.html</a>, and formats of record
keys - in <a href="gdb_rkey.html">gdb_rkey.html</a> manuals. </font><br>
</p>
<p><br>
</p>
<p> </p>
<hr size="2" width="100%">
<p> </p>
<h2> <a name="GSM_CALC_EQSTAT"></a><font
 face="Helvetica, Arial, sans-serif">2. Calculating Equilibria using
GEM-Selektor</font></h2>
<p><br>
<font face="Helvetica, Arial, sans-serif"> GEMS program has two main
modes of operation:&nbsp; "<a href="#GSM_MOD_PROJECTS">Computation of
Equilibria</a>"&nbsp; and&nbsp; "<a href="#GSM_EXTEND_PROJECT">Thermodynamic
Database</a>", &nbsp; accessible through the respective buttons on the
Main Dialog that appears
after the program starts. Computing chemical equilibria is actually
the main job of GEM-Selektor, organized in form of the <a
 href="#GSM_MOD_PROJECTS">modelling projects</a> (or simply projects),
i.e. user-controlled parts of GEMS database that accumulate all the
input- and calculated data related to a certain modelling application. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">The GEMS database can be
viewed as consisting of two parts: a&nbsp; <u>thermodynamic database</u>
&nbsp;where the input data for the <a
 href="glossary.html#DT_independent_component">independent components</a>,
<a href="glossary.html#DT_dependent_component">dependent components</a>,
<a href="glossary.html#DT_phase_thermodynamic">phases</a>, and
<a href="glossary.html#DT_PCO">compositions</a> are stored and
maintained,
and a&nbsp; <u>systems databas</u><u>e</u> &nbsp;where definitions of <a
 href="glossary.html#DT_system">chemical systems</a> and processes with
the results of model calculations are accumulated.&nbsp;</font></p>
<p><font face="Helvetica, Arial, sans-serif">Part of the thermodynamic
database is supplied together with the GEM-Selektor code. It is called
a "Default" database and consists of three parts: "Kernel",
"Complementary" and "Specific". <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">The kernel database part
contains a consistent collection of species stoichiometries and
standard molar thermodynamic properties imported from Nagra-PSI
chemical thermodynamic database [<a href="g_litref.html#2002HUMBER">2002HUM/BER</a>]
as </font><font face="Helvetica, Arial, sans-serif">described in [<a
 href="g_litref.html#2003THO/KUL">2003THO/KUL</a>]</font><font
 face="Helvetica, Arial, sans-serif">. The complementary database part
has been imported from the Slop98.dat file [<a
 href="g_litref.html#1997SHOSAS">1997SHO/SAS</a>]. The specific part of
the database (at present under construction) will contain extensions
relevant for e.g. waste disposal applications. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">The Default database also
contains a minimal set of <a href="gm_phase.html">Phase</a> definition
records (to assemble modeling projects), and <a href="gm_sdref.html">SDref</a>
records with bibliographic data and template
script libraries. For details, consult the <a href="kernel_db.html">GEMS
default database manual</a>. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">The user can add new
database records of any type and thus extend the thermodynamic database
or "override" some default thermodynamic values with her/his own data.
This is normally possible only within the modelling project database
files because default database files are write-protected to ensure
compatibility between different modelling applications. Thus, the files
located in a user's project directory comprise a user's extension part
of the GEMS database.&nbsp; <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">When a new project is
created, a directory (having the same name as the project) with empty
database files of all types will be created first. Then, a subset of
default database records covering a selected list of independent
components will be copied into these project files, after that the
kernel database files will be disconnected from the project. Further
on, the user can add records with thermodynamic data, compositions,
references, scripts, phase definitions, develop and accumulate records
with equilibria, process simulators etc., but nothing will be changed
in the kernel database.&nbsp; &nbsp; <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif"> Thermodynamic database
records (of <a href="gm_icomp.html">IComp</a>, <a href="gm_dcomp.html">DComp</a>,
<a href="gm_reacdc.html">ReacDC</a>, <a href="gm_compos.html">Compos</a>,
<a href="gm_phase.html">Phase</a> types) cannot be modified, created or
deleted even in the user's project files during the program operation
in the "Computation of Equilibria" mode. To modify these records, you
should first go back to Main Dialog and then to "Thermodynamic
Database" mode where all <a href="gems_gdb.html">database management
functionality</a> for all record types and database files is
provided.&nbsp; </font></p>
<p><font face="Helvetica, Arial, sans-serif">In the following steps, we
will consider as an example some equilibria between aqueous solution
(with- or without the atmosphere), oxide and carbonate mineral phases
in the heterogeneous multiphase Ca-Mn-Fe-C-Na-Cl-N-O-H aquatic system.
This numerical example stems (in a very simplified form) from a paper [<a
 href="g_litref.html#2000KULKER">2000KUL/KER</a>] and demonstrates a
typical process of creating a new modelling project, setting up system
definitions and process simulators, calculating and examining
equilibrium states, and plotting some simple but useful diagrams.
<br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">We will &nbsp;proceed with
extending the project database (by adding some new species and phases),
updating the project and calculating some SSAS (solid solution -
aqueous solution) equilibria at different redox conditions to show some
powerful features of the GEM modelling approach [<a
 href="g_litref.html#1997KARCHU">1997KAR/CHU</a>, <a href="2001KARCHU">2001KAR/CHU</a>]
on which the GEM-Selektor code is based. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">After completing these
exercises, you should be able to create easily your own projects and
calculate chemical equilibria, as well as present the results and
extend the project thermodynamic database. Then you may proceed with
reading detailed&nbsp; <a href="gems_toc.html">manuals</a>&nbsp; on
how the GEM-Selektor works, how
consistency of thermodynamic data is maintained, and, in parallel, work
through more tests and modelling examples that will be provided in the <a
 href="g_tests.html">test problem suite</a> and <a href="g_tutor.html">tutorial</a>
files. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">Some examples follow those
from the PHREEQC2 User's Guide <a href="g_litref.html#1999PARAPP">[1999PAR/APP]</a>
which should help you to compare the results obtained by using the
alternative Law-of-Mass Action (LMA) and Gibbs Energy Minimization
(GEM) techniques and to better understand their common features
and differences.<br>
</font> <br>
<br>
</p>
<p> </p>
<h3><a name="GSM_MOD_PROJECTS"></a><font
 face="Helvetica, Arial, sans-serif">2.1. &nbsp;Modelling Projects and
&nbsp;GEMS Database</font></h3>
<p><font face="Helvetica, Arial, sans-serif">A modelling project is
actually a directory containing a set of GEMS database files that
&nbsp;keep a "template" definition of the chemical system, all the
necessary input thermodynamic and composition data records, as well as
(input and calculated) data for many particular equilibrium systems
with optional Process Simulator and Graphic/tabulated Data Sampler
records. GEM calculations of thermodynamic equilibria can only be
performed in the context of a modelling project. To access projects,
press the "Computation of Equilibria" button on the Main Dialog. <br>
<br>
</font> </p>
<h4><font face="Helvetica, Arial, sans-serif"><a name="GSM_OPEN_PROJECT"></a>2.1.1.
Opening an Existing Project </font></h4>
<p><font face="Helvetica, Arial, sans-serif">After selecting the
"Computation of Equilibria" button on the Main Dialog, you will see a
"Modelling projects" dialog. All existing projects are listed in the
upper part of the dialog window; below, some important switches and
buttons are located (see the &nbsp;<a href="gp_howto.html">gp_howto.html</a>
&nbsp;file for details).&nbsp;<br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">To open an existing
project, just select its <a href="gdb_rkey.html#dbm_Project">record key</a>
in the list (for example, </font><big><tt>"TryNPTDB:TestNagraPsiGEMS:"</tt></big><font
 face="Helvetica, Arial, sans-serif">) and double-click on it or press
the "Open Project" button. This (after a few seconds) will get you in a
Project &lt;name&gt; "Gibbs Energy Minimization Modelling
Project" dialog, where &lt;name&gt; of the project (in this case,
</font><big><tt>"TryNPTDB"</tt></big><font
 face="Helvetica, Arial, sans-serif">) is taken from the first field of
the Project record key. The same name is given to the project directory
</font><big><tt>.../projects/TryNPTDB</tt></big> &nbsp;<font
 face="Helvetica, Arial, sans-serif">and is part of any file name in
that directory. From this dialog, you can proceed to GEM modelling in a
single chemical system or to simulation of irreversible chemical
transfer processes as sequences of local/partial equilibrium states. <br>
<br>
</font> </p>
<h4><font face="Helvetica, Arial, sans-serif"><a
 name="GSM_CREATE_PROJECT"></a>2.1.2. Creating a New Project</font></h4>
<p><font face="Helvetica, Arial, sans-serif">When you begin a new
modelling application, you have to create a new project first. From the
Main Dialog, press the "Computation of Equilibria" button to open the
"Modelling projects" dialog. There, click the "New Project" button; it
will bring you into a small dialog shown below. </font><br>
</p>
<p><img src="SetProjectKey.png" alt="EnterProjectKey image" height="237"
 width="339"> <br>
</p>
<p><font face="Helvetica, Arial, sans-serif">For now, you could just
leave the default project name "MyWork" and press "Ok". This is not a
very good idea, however, because if you will try to create another
project later on and do the same again, the program will produce an
error message because it cannot handle two projects with the identical
names. So, let us change the project name immediately, for instance, to
"Carbonat" (you can put any other name, of course), also to refer to
this name in the following text. Holding the mouse pointer on a field
will produce a tooltip that tells its meaning. &nbsp;Click on the
"Help" button to see a help page about this record key format and
length of the key fields (do not forget to close the Helpviewer browser
to get back to the
Enter Key dialog). Press "Ok" to proceed. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">This will bring you to a
large Elements Dialog that looks like the Periodic (Mendeleev) Table of
chemical elements. Each element (<a
 href="glossary.html#DT_independent_component">Independent Component</a>
in GEM terminology) is represented by a button, clickable if data for
this
element and its compounds are present in the available part of default
thermodynamic database. Clicked buttons (with lighter background) mean
that
the respective elements (with species and phases involved) will
be selected into this modelling project to form stoichiometry basis for
your chemical systems. Another click de-selects the element
("toggle" buttons). Make sure that the following elements are be
selected:
Ca,Mn,Fe,C,Na,Cl,O,H and e(Zz) - charge. Select also "Nit" (in the
upper right corner) to use the decoupled nitrogen to form the model
atmosphere. &nbsp;The dialog should now look like this: <br>
<br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif"><img
 src="selectElements.png" alt="ElementsDialog" height="575" width="676">
</font></p>
<p><font face="Helvetica, Arial, sans-serif"><br>
Press "Ok" when finished. If GEMS will ask you about the</font>&nbsp; <big><tt>DiscardedRecords.txt</tt></big>
&nbsp;<font face="Helvetica, Arial, sans-serif">file, reply with
"Overwrite" - this diagnostic file is not important now. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">Next, a dialog shown below
will appear: </font><br>
</p>
<p><img src="WhichAqModel.png" alt="WhichAqModel image" height="435"
 width="702"> <br>
</p>
<p><font face="Helvetica, Arial, sans-serif">As seen from this
self-explanatory
dialog, GEMS is about to let you define the aqueous and gaseous models
to be included into chemical systems in the newly-created project.
After
the aqueous electrolyte model (on the first tab) and the gas mixture
model
(the second tab) have been selected, the program will assemble the
aqueous
and the gas phase definitions automatically, by collecting all aqueous
(gaseous) species from the default database that conform with the
project system stoichiometry basis (in our case Ca, Mn, Fe, C, Na, Cl,
Nit, O, H, e ). <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">Differences between the
alternative
aqueous models may be of importance for experienced modellers, as there
is
no perfect way of computing activity coefficients of aqueous ions and
complexes,
and each model has its pros and cons and covers a certain range of
total
dissolved salt concentration. For now, it is sufficient to take the
default
choice (Ion association model with Davies equation). Likewise, for
ambient
conditions, it is sufficient to take the default gas mixture model (see
below).
<br>
</font></p>
<br>
<p><img src="WhichGasModel.png" alt="WhichGasPhase image" height="435"
 width="702"> <br>
</p>
<p><font face="Helvetica, Arial, sans-serif"><br>
Press the "Ok" button to assemble the aqueous and gas phase
definitions.
After a few seconds, you should see the "Gibbs Energy Minimization
Modelling Project" dialog, the same as if you would just open an
existing project. This means that our new project "Carbonat" has been
succesfully created; it can be closed and opened as any other existing
project.
<br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">To close, press the "Back"
button to get back to the GEM-Selektor Main Dialog. Now you can simpy
open the project "Carbonat", <a href="#GSM_OPEN_PROJECT">as it has
already been described</a>. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">If you are
curious&nbsp;what the program has actually done while creating the new
project, read a <a href="gp_howto.html#NEW_PROJECT_SIDEBAR">sidebar in
the "GEMS Project HowTo Manual"</a>; otherwise, proceed to <a
 href="#GSM_CREATE_SYSTEM_1">creating your first CSD</a> (Chemical
System Definition) in the new modelling&nbsp; project.</font>&nbsp; <br>
</p>
<blockquote> </blockquote>
<blockquote><font face="Helvetica, Arial, sans-serif"><br>
  </font></blockquote>
<h4><font face="Helvetica, Arial, sans-serif"><a
 name="GSM_CREATE_SYSTEM_1"></a>2.1.3. Creating your First Chemical
System Definition (CSD) </font></h4>
<p><font face="Helvetica, Arial, sans-serif">Now, after you have
created a
new project "Carbonat", it is time to create your first CSD, that is,
set bulk composition of the system, temperature and pressure for
calculation of the equilibrium state. Go into the "Gibbs Energy
Minimization Modelling Project" dialog and press the button
"Single-System Equilibria (SysEq)". The program will show
the&nbsp;"Single Thermodynamic System" dialog (you can read a sidebar
below); if it detects that there are no <a href="gm_syseq.html">SysEq</a>
records in the project directory, it will automatically start creating
a new record and you will see an <a href="#GSM_ENKEY_DIALOG">"Enter
new key" dialog</a>.<br>
</font> </p>
<font face="Helvetica, Arial, sans-serif"> You will
see a "Single Thermodynamic System" dialog. This is, in fact, a
fully-featured GUI window (with menus, toolbar icons, two pages and the
status line) that you will see most of the time when calculating
chemical equilibria. The status (lowermost) line of the window
shows&nbsp; the key of currently loaded SysEq record and some general
parameters
of equilibrium state (T, P, V, pH, pe and IS - ionic strength). Now,
the status line indicates </font><big><tt>"Carbonat:*:*:*:*:*:*:*:"</tt></big>
<font face="Helvetica, Arial, sans-serif">and zero temperature,
pressure
and volume, which means that no system definition is loaded. There are
three possibilities to continue: &nbsp;</font><br>
<blockquote> </blockquote>
<ol>
  <li>
    <p><font face="Helvetica, Arial, sans-serif">To create a new SysEq
record (by executing the "Record"-&gt;"Create" menu command and
entering a new record key); </font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif">To load an existing
SysEq record (by pressing the "Display" &nbsp;<img src="fileopen.png"
 alt="LoadRecord button" height="20" width="20"> &nbsp; toolbar button
and selecting one record key from the appearing list);&nbsp;</font></p>
  </li>
  <li>
    <p><font face="Helvetica, Arial, sans-serif">To "clone" the
currently active record (by executing the "Record"-&gt;"New(Clone)"
menu command, entering a new SysEq record key, and modifying some input
parameters).&nbsp;</font></p>
  </li>
</ol>
<font face="Helvetica, Arial, sans-serif"> Note that in all three
cases, the changes will be recorded in the project database only
after the eqilibrium state is computed (<a href="#GSM_RUN_GEMIPM">see
below</a>). As there is no system definition (SysEq record) in this
project yet, we must proceed with creating one. Select the "Record"
"Create" menu command and
examine the appearing dialog.</font><br>
<p> </p>
<h4><font face="Helvetica, Arial, sans-serif"><a name="GSM_ENKEY_DIALOG"></a>
Enter New Key dialog:</font></h4>
<p> <img src="SetSystemKey.png" alt="Set System Key image" height="242"
 width="328"> <br>
</p>
<p><font face="Helvetica, Arial, sans-serif">This dialog shows tooltips
that explain the meaning of eight fields of (disassembled) <a
 href="gdb_rkey.html#dbm_SysEq">SysEq record key</a>.<br>
The first and second fields should be left just as they are. The third
field contains the name of chemical system (default - "MySystem", we
recommend changing it to a more reasonable name).
The fourth field is usually changed when the bulk composition (CSD)
of the system will be changed; put there "1" for now - this is your
first bulk composition. The fifth field should normally be left
"0", except some rare special cases of "indefinite" equilibrium. The
sixth field contains pressure (in bar) under which the equilibrium has
to be calculated (1 bar by default); the seventh field must contain
temperature (in centigrade) for the equulibrium (25 <sup>o</sup>C
by default). The last field should be changed if some metastability
constraints or corrections to thermodynamic data will be imposed. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif"> Now, it is time to think
&nbsp;what system and at which conditions we want to model. Let us
begin with a simple hypothetical system at 1 bar 25 <sup>o</sup>C
consisting of 0.3 kg H<sub>2</sub>O and large excess of (dry)
atmosphere (say, 300 kg). To this "open pot with water", we will add
0.03 moles NaCl, 1 g CaCO<sub>3</sub>, 1 g MnCO<sub>3</sub> and 1 g FeCO<sub>3</sub>
and wait until this system equilibrates completely, to follow what will
be the final composition and speciation of the aqueous phase, and which
mineral phases will precipitate. Let us call this system "CaFeMnOpen"
(put this name in the third field of the appearing dialog), and call
the above "recipe" variant 1 (put 1 in the fourth field). Press "Ok" to
proceed. &nbsp;</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">A "SysEq: Remake
parameters" dialog appears; it is possible to do various
re-configurations of the data structure of the system definition there.
Now, simply press "Ok". This will bring you in the "System" submodule
window, "Compos" page, where the bulk composition of the system can be
specified. Two comment lines in the upper part help to identify the CSD
when this SysEq record will be printed or displayed later. Enter there
something like </font><br>
</p>
<p><big><tt>"Open system water with added Ca,Fe,Mn carbonate"<br>
"Exercise 1 from Getting Started Manual"&nbsp; <br>
</tt></big></p>
<p><br>
</p>
<hr size="2" width="100%">
<h2> <a name="GSM_SINGLE_EQSTAT"></a><font
 face="Helvetica, Arial, sans-serif">3. Calculating a Single
Equilibrium State</font></h2>
<p><font face="Helvetica, Arial, sans-serif">Now, you are about to put
the ingredients together into the "pot" in order to calculate
equilibrium in the aquatic system open to the atmosphere. If you are
interested to learn about philosophy of defining chemical systems for
GEM calculation of equilibria,&nbsp; then <a
 href="ge_howto.html#EQ_HOWTO_INTRO">click
here to read a sidebar</a>.</font><br>
&nbsp; <br>
</p>
<blockquote> </blockquote>
<p><br>
</p>
<h3><a name="GSM_SET_BCC"></a><font face="Helvetica, Arial, sans-serif">3.1.
Setting up the Bulk Composition of Chemical System<br>
</font> </h3>
<p><font face="Helvetica, Arial, sans-serif">On the "Compos" page of
"System" window, you will see a </font><tt>&nbsp;<big><a
 href="gems_bcc.html#CCvp">CCvp</a></big></tt> <font
 face="Helvetica, Arial, sans-serif">&nbsp;list of <a
 href="glossary.html#DT_PCO">PCO</a> names from <a
 href="gm_compos.html">Compos</a> records connected to the project.
These PCO can be viewed as the ingredients that we put in the pot at
certain quantities according to the recipe of what has to be cooked.
GEM-Selektor offers a lot of flexibility in representing quantities of
stoichiometries to be combined in the <a
 href="glossary.html#DT_bulk_compos">bulk chemical composition (BCC) of
the system</a>.&nbsp;</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif"> To the right of the</font>
<big><tt>CCvp</tt></big> <font face="Helvetica, Arial, sans-serif">list,
a column (</font><big><a href="gems_bcc.html#XAun_"><tt>XAun_</tt></a></big>)
<font face="Helvetica, Arial, sans-serif">of single </font><big><tt>"g"</tt></big>
<font face="Helvetica, Arial, sans-serif">letters is seen; next, a</font>
&nbsp;<big><a href="gems_bcc.html#xa_"><tt>xa_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector (filled with zeros)
is visible, where you can enter the necessary (positive or negative)
PCO quantities to be added to BCC.In the respective cells (to the left)
in the</font> <big><a href="gems_bcc.html#XAun_"><tt>XAun_</tt></a></big>
<font face="Helvetica, Arial, sans-serif">column, you can define
<a href="g_useref.html#QUANCONCUNITS">units of measurement of
quantities/concentrations</a> in which the PCO quantity is given,
separately for each PCO. The
default unit is grams&nbsp; </font><big><tt>"g"</tt></big>.&nbsp; <br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Now put in the</font> <big><a
 href="gems_bcc.html#xa_"><tt>xa_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector 300 against </font><big><tt>"Aqua"</tt></big>,
<font face="Helvetica, Arial, sans-serif">300000 against</font> <big><tt>"AtmAirNit"</tt></big>,
<font face="Helvetica, Arial, sans-serif">1 against </font><big><tt>"CaCO3"</tt>,
<tt>"MnCO3"</tt>,</big> <font face="Helvetica, Arial, sans-serif">and</font>
<big><tt>"FeCO3"</tt></big><font face="Helvetica, Arial, sans-serif">,
and 0.03 against</font> <big><tt>"NaCl"</tt></big>. <font
 face="Helvetica, Arial, sans-serif">For the last entry, do not forget
to change</font> <big><tt> "g"</tt></big> <font
 face="Helvetica, Arial, sans-serif">(grams) to </font><big><tt>"M"</tt></big>
<font face="Helvetica, Arial, sans-serif">(moles) in the</font> <big><a
 href="gems_bcc.html#XAun_"><tt>XAun_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">cell to the left. If you are
curious what is taken, for instance, under the</font> <big><tt>"AtmAirNit"</tt></big><font
 face="Helvetica, Arial, sans-serif"> PCO, then mark this name in the
list and press </font><big><tt>F7</tt></big>. <font
 face="Helvetica, Arial, sans-serif">You will see the "Compos" window
where you can view contents of this Compos record. Note that editing or
deleting records in this viewing mode is not allowed (this can be done
in "Thermodynamic Database" management mode only). Close the "Compos"
window to continue.&nbsp; <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">The actual calculation of
the system bulk composition occurs when you switch back to the "Single
Thermodynamic System" dialog and click on a "Calculate BCC" &nbsp;<img
 src="RunBCC.png" alt="Calculate BCC button" height="20" width="20">
&nbsp; button (alternatively, "Calc"&nbsp; "BCC" menu command). If you
entered everything correctly, no messages will appear
and you can immediately proceed to <a href="#GSM_RUN_GEMIPM">GEM IPM
calculation</a> of the equilibrium state (next section). <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">If you are curious first
to
see the input bulk composition of the system, then click on the
"Bulk Composition"&nbsp;<img src="SetCompos.png"
 alt="Bulk Compos button" height="25" width="24"> &nbsp;toolbar button
(or "Data" "Bulk Composition" menu command) to get back to the "System"
window, and select there an
"IComp" page. There you will see an</font>&nbsp; <big><a
 href="gems_bcc.html#ICvp"><tt>ICvp</tt></a></big>&nbsp; <font
 face="Helvetica, Arial, sans-serif">list of IComp record keys for
Independent Components (stoichiometry basis of the project system) and
to the
right, a</font> <big><tt><a href="gems_bcc.html#B_">B_</a></tt></big> <font
 face="Helvetica, Arial, sans-serif">vector. Numbers now visible in
this vector are total moles of Independent Components, just calculated
from PCO quantities entered in the "Compos" window. As an alternative,
these mole quantities could have been directly entered in a</font><big>
<a href="gems_bcc.html#bi_"><tt>b<u>i_</u></tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector to the right (they would be
just copied during the BCC calculation). But then you would have to
perform all necessary conversions and multiplications yourself.</font> <br>
</p>
<p><br>
</p>
<h3><a name="GSM_RUN_GEMIPM"></a><font
 face="Helvetica, Arial, sans-serif">3.2.&nbsp; Running GEM IPM to
Calculate an Equilibrium State</font></h3>
<p><font face="Helvetica, Arial, sans-serif">Having the bulk
composition
of the system specified, it is quite easy to run the GEM IPM
calculation.
Just close the "System" window and press the "Calculate IPM"&nbsp;<img
 src="RunIPM.png" alt="Run IPM button" height="20" width="20"> button
on the toolbar (or execute the "Calc" "IPM" menu command). An "IPM
Minimization Progress" dialog will pop up with some basic properties of
the system, updated ca. once per 1 or 2 seconds. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">The calculation is
finished when &nbsp;a word "Converged" appears on the title of the
Progress Dialog. To save the input data and results into a <a
 href="gm_syseq.html">SysEq</a> record (with a key appearing to the
right
of toolbar buttons in the&nbsp; "Single Thermodynamic System" dialog),
press the "Accept" button.&nbsp; The Progress Dialog disappears, and
you will see the large&nbsp;"Single Thermodynamic System" dialog again,
this time - its second page, &nbsp;entitled "Results: Equilibrium
State".&nbsp; </font><br>
</p>
<p><br>
</p>
<h3><a name="GSM_VIEW_RESULTS"></a><font
 face="Helvetica, Arial, sans-serif">3.3.&nbsp; Examining the Results:
Equilibrium Speciation</font></h3>
<p><font face="Helvetica, Arial, sans-serif">The "Results: Equilibrium
State" page of the "Single Thermodynamic System" dialog displays the
most important parameters for the whole system, phases, and their
species in a hierarchical list view form. What you see (in the first
column)
is a list of phases included in the GEM IPM problem. The second column
"L" shows how many species have been included into each phase; the next
column "Type" shows the <a href="g_useref.html#PHASESTATECODES">phase
aggregate state code</a>. The next column "x (moles)" displays mole
quantities of phases at equilibrium; unstable phases are zeroed off.
You should
see now five phases present in non-zero quantities:</font> <big><tt>"aq_gen",
"gas_gen", "Calcite", "Hematite" </tt></big><font
 face="Helvetica, Arial, sans-serif">and</font><tt> <big>"Pyrolusite"</big></tt>.&nbsp;
<br>
</p>
<p><font face="Helvetica, Arial, sans-serif">A mouse click on the small
"+" to the left of a phase name will expand it and display data for
all species of this phase; another click on the same place will "close"
the species list. Expand the </font><big><tt>"aq_gen"</tt></big><font
 face="Helvetica, Arial, sans-serif"> phase to view the calculated
aqueous speciation in a list below the </font><big><tt>"aq_gen"</tt></big>
<font face="Helvetica, Arial, sans-serif">phase row. You can drag
separators between the column names to shrink or expand each column
(for instance, to see full names of aqueous species). The "Type" column
how contains the</font> <font face="Helvetica, Arial, sans-serif"><a
 href="g_useref.html#DCCLASSCODES">species class code</a>; the "x
(moles)" column displays mole quantities of species at equilibrium or
zeros
for the dependent component eliminated in the IPM-2 calculation. The
next "log(activity)" column contains decimal logarithms of activity for
all species, including eliminated ones, expressed in the respective
standard concentration scale (molal for aqueous and surface species,
mole fraction for gaseous, liquid or solid condensed species). The
"Concentration" column shows concentrations (in the respective scale
for each phase, i.e. molal for aqueous species). The last, "ln(gamma)"
column, shows natural
logarithms of species activity coefficients (again in the respective
concentration scale for each phase).</font>&nbsp;<br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Some general parameters of
the aqueous solution are shown in the status line of the "Single
Thermodynamic System" dialog. In this example, pH =&nbsp; 8.321; pe =
12.288; and effective ionic strength IS = 0.1024 (all in molal scale).
More detailed information can be viewed in the "EqDemo" submodule
window pages. This window can be opened by pressing the "Dual Solution"
&nbsp;<img src="ordertool.png" alt="Dual Solution icon" height="21"
 width="21"> &nbsp;toolbar button or selecting the "View" "Dual
Solution etc..." menu command. The "EqDemo" submodule window has five
pages: "EqIC" with data objects containing equilibrium properties of
Independent Components; "EqPh" with data for phases; "EqDC" with
results for Dependent Components (species);&nbsp; "EqSurf" with results
for sorption phases and surface patches on them; and "EqGen" page that
shows the state variables and some generic output parameters for the
whole equilibrium state. On the last page you can see, for instance,
the calculated values of pH, pe, Eh, ionic strength, and fugacities of
gases. In this example,&nbsp; the latter correspond to atmospheric
values because of an excess of
the gas phase, set by a large addition (300 kg) of the "dry atmospheric
air" PCO to the bulk system composition. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Now, switch back to the
"Results: Equilibrium State" page of the "Single Thermodynamic System"
dialog and open the</font> <big><tt>"gas_gen"</tt></big> <font
 face="Helvetica, Arial, sans-serif">phase. Indeed, there is almost
10400 moles of gas at this equilibrium state, including ca. 3.76 moles
CO<sub>2</sub>. Numbers in the "log(activity)" column correspond now to
fugacities of gases at the actual pressure (1 bar). Concentrations are
mole fractions - now equal to partial pressures because the mixture is
ideal (all activity coefficients equal 1). Note extremely low
fugacities of CH<sub>4</sub> and H<sub>2</sub> gases at these oxidizing
conditions
dictated by 0.21 bar partial pressure of oxygen gas O<sub>2</sub>.</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Close the </font><big><tt>"gas_gen"</tt></big>
<font face="Helvetica, Arial, sans-serif">phase and open the </font><big><tt>"Calcite"</tt></big>
<font face="Helvetica, Arial, sans-serif">phase.As expected for a
single-component mineral, its mole fraction is 1 and log(activity) is
very close
to 0 (in fact, it is a small number due to limited numerical
precision);&nbsp; calcite is stable in this equilibrium, present in
0.009747 moles quantity. Now, close the </font><big><tt>"Calcite"</tt></big><font
 face="Helvetica, Arial, sans-serif"> and open the </font><big><tt>"Portlandite"</tt></big><font
 face="Helvetica, Arial, sans-serif"> phase. This time, the phase is
unstable (zero moles), and log(activity) is ca. -9.69 indicating that
the aqueous phase is 9.7 orders of magnitude undersaturated with
portlandite. Thus, in case of single-component condensed phases in the
aquatic system, the&nbsp;log(activity) column shows, in fact, the
logarithm of saturation index. Note that positive values may appear in
this place only if
the mole quantity of the solid is constrained from above by the&nbsp;</font><big>
<a href="gems_sys.html#dul"><tt>dul</tt></a> </big><font
 face="Helvetica, Arial, sans-serif">&nbsp;metastability limit.
Otherwise, positive numbers for a single-component mineral (especially
in zero mole quantity) may point to a serious inconsistency in the
input thermodynamic data, error in stoichiometry of this mineral, or
incorrect formulation of the problem (e.g. inadequate bulk chemical
composition). Now, open the</font><big><tt> </tt><tt>"Graphite"</tt></big><font
 face="Helvetica, Arial, sans-serif"> phase to see a large number
(-71.86) in the "log(activity)" column - it shows how unstable are
reducing minerals
at oxidizing conditions.&nbsp;</font></p>
<p><font face="Helvetica, Arial, sans-serif">A very important part of
GEM IPM equilibrium calculation results cannot be displayed as
hierarchical list view. It can be seen only in the "EqIC" page of
the&nbsp;"EqDemo" submodule window (click the&nbsp;"Dual Solution"
&nbsp;<img src="ordertool.png" alt="Dual Solution icon" height="21"
 width="21"> &nbsp;toolbar button). This part of GEM IPM-2 results
consists of the so-called dual solution vector</font><a
 href="gems_sys.html#u"><tt> <big>u</big> </tt></a><font
 face="Helvetica, Arial, sans-serif">of chemical potentials of
independent components at equilibrium state, - and the mass balance
residuals
vector</font> <big><a href="gems_sys.html#Cb"><tt>Cb</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">that shows the quality of the
numerical solution.</font> <br>
</p>
<p><font face="Helvetica, Arial, sans-serif">If the aqueous phase is
present in the system then vectors</font> <big><a
 href="gems_sys.html#lgm_t"><tt>lgm_t</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">and/or</font> <big><a
 href="gems_sys.html#m_t"><tt>m_t</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">display total molality
concentrations of dissolved elements (excluding H<sub>2</sub>O solvent)
(</font><big><tt>lgm_t</tt></big> <font
 face="Helvetica, Arial, sans-serif">in decimal logarithms). For
convenience, the &nbsp;input bulk composition of the system - vector</font>
<big><a href="gems_sys.html#b"><tt>b</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">- is also displayed next to the
list
of IC symbols (</font><big><tt>ICnam</tt></big><font
 face="Helvetica, Arial, sans-serif">). In the present example,
absolute values of mass balance residuals should all be less than 1e-11
moles. Check that chemical potential of Ca, u(Ca) = -287.7013 mol/mol
and log
m(Ca) = -3.0896. Note that chemical potential of electrical charge
u(Zz)
has a quite large positive value 28.2942 or 70.141 kJ/mol - reflecting
a strongly oxidizing redox state of the system. The total molalities of
Fe and Mn are extremely low - log m(Fe) = -13.45 and log m(Mn) =
-15.856
because the most stable oxide phases of these metals - goethite FeOOH
and
pyrolusite MnO<sub>2</sub> - are present at the equilibrium state.</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">The next page "EqPh" of
the "EqDemo"
window shows the list of included phases and their main equilibrium
state parameters. The</font> <big><tt><a href="gems_sys.html#Xa">Xa</a></tt></big>
<font face="Helvetica, Arial, sans-serif">vector shows total number of
moles of all species in each phase;</font> <big><tt><a
 href="gems_sys.html#phVol">phVol</a></tt></big> &nbsp;<font
 face="Helvetica, Arial, sans-serif">displays volumes and</font>&nbsp; <big><tt><a
 href="gems_sys.html#phM">phM</a></tt></big> <font
 face="Helvetica, Arial, sans-serif">vector - masses of phases. The</font>
<big><tt><a href="gems_sys.html#Fa">Fa</a></tt></big> &nbsp;<font
 face="Helvetica, Arial, sans-serif">vector shows values of Karpov
phase stability
criterion for phases present at the equilibrium state; if absolute
value of this criterion is close to zero (less than 0.01) then the
phase can be considered stable.&nbsp;</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">The "EqDc" page of
"EqDemo" window
displays calculated parameters of Dependent Components. The</font> <big><a
 href="gems_sys.html#x"><tt>x</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector (mole quantities of DC)
represents the prime solution of the GEM problem; the</font> <big><a
 href="gems_sys.html#lga"><tt>lga</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector contains log(activity)
values (in the case of single component phase DC, log(saturation
index)). The</font> <big><a href="gems_sys.html#gamma"><tt>gamma</tt></a></big>
<font face="Helvetica, Arial, sans-serif">vector contains activity
coefficients; and the</font> <big><a href="gems_sys.html#my"><tt>my</tt></a></big>
<font face="Helvetica, Arial, sans-serif">vector - molality
concentrations (for aqueous, surface species, and solids). More data
become visible if this window page is scrolled down (by dragging the
scroller at the right window border), for instance, the</font> <big><a
 href="gems_sys.html#Wxx"><tt>Wxx</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector containing mole fractions
for all Dependent Components.</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">On the left side, a list
of species
is located (scrollable together with numerical data vectors). You
may want to see an input data record from thermodynamic database for
a given species, e.g.</font> <big><tt>Ca(OH)+</tt></big> <font
 face="Helvetica, Arial, sans-serif">aqueous complex. Just mouse-click
the species name in the</font>&nbsp; <big><a href="gems_sys.html#DCnam"><tt>DCnam</tt></a></big>
<font face="Helvetica, Arial, sans-serif">list and press</font> <big><tt>F7</tt></big>
<font face="Helvetica, Arial, sans-serif">to view (but not edit) a
DComp record behind it.&nbsp;&nbsp; In the same way, you can view data
for independent components or phases and phases on the respective
pages. As usual,</font><tt> <big>F1</big></tt> <font
 face="Helvetica, Arial, sans-serif">key on any (clicked) data entry
will bring you a HTML help page in the Helpviewer browser window. The
"Close"&nbsp; button will get you back to the "Single Thermodynamic
System" dialog.</font> <br>
&nbsp;&nbsp;</p>
<h3><a name="GSM_VIEW_IPM_INPUT"></a><font
 face="Helvetica, Arial, sans-serif">3.4. Examining Results: Input
System Definition and Thermodynamic Data </font></h3>
<p><font face="Helvetica, Arial, sans-serif">You just have seen how
extensive output information can be viewed after a single GEM IPM
calculation. Of course, you may want to view the input data and setup
of this chemical system definition (CSD). There are several ways to see
this input information from the "Single Thermodynamic System" dialog.
The easiest way is
to switch to the "Input System Definition" page by clicking on the
respective tab. You can switch between the two "list view" pages of the
dialog
by a mouse click whenewer you need. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">On the "Input System
Definition" page, you will also see a list of phase names, numbers of
included species in each phase, and the aggregate state code in the
"Type" column, similar to the "Results: Equilibrium State" page. But
the rest of columns are different - they can be used for switching some
phases (or species) in and out of the CSD, install metastability
constraints, corrections to input thermodynamic data etc. In other
words, some data in this page can be edited, <a
 href="#GSM_SELECT_PHASES_SPECIES">as described below</a>.&nbsp;</font></p>
<p><font face="Helvetica, Arial, sans-serif">Clicking on the "+" near
the phase name will expand the list to give access to all species in
this phase. The most important is the "On/Off" column: a given chemical
species will be taken in calculation of equilibrium state if it is
marked with "+".&nbsp; If marked with "-", the species will be excluded
from the GEM problem (and will not appear in the EqDemo window lists or
in&nbsp; the "Results: Equilibrium State" page). Use right-mouse click
to edit these selector switches. The same on-off switches apply to
phases (if a
phase is switched off, all its species will also be turned off). <a
 href="#GSM_SET_META_CONSTR">See below</a> for more information about
CSD setup with help of the&nbsp; "Input System Definition" page. </font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Alternatively, the input
data can be accessed from the "Data" menu of the "Single Thermodynamic
System" dialog. To see the input thermodynamic data for species,
execute the "Data" "Thermodynamic Data" menu command. This will open a
"MTparm" submodule window with two pages. On "Page 1"&nbsp; you should
see the</font> <big><a href="gems_bcc.html#DCvp"><tt>DCvp</tt></a></big>
<font face="Helvetica, Arial, sans-serif">list of all <a
 href="gm_dcomp.html">DComp</a> and <a href="gm_reacdc.html">ReacDC</a>
record keys linked to the project system; click on a species name and
press</font> <big><tt>F7</tt></big> <font
 face="Helvetica, Arial, sans-serif">to view record contents. The</font>
<big><a href="gems_bcc.html#DCSvp"><tt>DCSvp</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">column to the right shows whether
the
data for a species will be taken from a DComp ("d") or ReacDC ("r")
record.
Next, the</font> <big><a href="gems_bcc.html#DC_on"><tt>DC_on</tt></a></big>
<font face="Helvetica, Arial, sans-serif">column (with pluses and
minuses) shows which species will be included or not into the GEM
calculation of this CSD. The</font> <big><a href="gems_bcc.html#gTP"><tt>gTP</tt></a></big>
<font face="Helvetica, Arial, sans-serif">column contains the input
standard molar/molal Gibbs energies of species, corrected to <i>P</i>
&nbsp;and <i>T</i> &nbsp;of interest (shown in two fields</font> <big><tt><a
 href="gems_bcc.html#P">P</a></tt></big> <font
 face="Helvetica, Arial, sans-serif">and</font> <big><a
 href="gems_bcc.html#T"><tt>T</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">above). In the next,</font> <big><a
 href="gems_bcc.html#gEx_"><tt>gEx_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">column, you can enter a positive
or negative correction to any respective value in the</font> <font
 face="Helvetica, Arial, sans-serif"><a href="gems_bcc.html#gTP">gTP</a></font>
<font face="Helvetica, Arial, sans-serif">column; this correction
applies only in this CSD for calculation of equilibrium state. Note
that for any species switched off, the correction does not apply
either. The</font> <big><a href="gems_bcc.html#vTP"><tt>vTP</tt></a></big>
<font face="Helvetica, Arial, sans-serif">column shows (partial) molar
volumes of species (in J/bar), to be used in computing volumes of
phases and the whole system at the equilibrium state.</font>&nbsp;
&nbsp; <br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Now, close the "MTparm"
window and click on the "Bulk Composition" toolbar button (or execute
the "Data" "Bulk Composition" menu command).&nbsp; This will open the
(already familiar) "System" window, "Compos" page where you have
specified the system bulk composition in the </font><big><a
 href="gems_bcc.html#xa"><tt>xa_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">column. Click the "DComp" button
on top of the window to view the "DComp" page. There you should see the</font>
<big><a href="gems_bcc.html#DCvp"><tt>DCvp</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">list of record keys and to
the left of it, the</font> <big><a href="gems_bcc.html#DC_on"><tt>DC_on</tt></a></big>
<font face="Helvetica, Arial, sans-serif">switches (the same as in the
"MTparm" window) that can be used to re-configure the CSD (<a
 href="#GSM_SELECT_PHASES_SPECIES">see below</a>). To the right of</font>
<big><tt>DCvp</tt></big> <font face="Helvetica, Arial, sans-serif">list,
a column (filled with "M") allows to set units of quantities/
concentrations for the respective element of the</font> <big><tt>xd_</tt></big>
<font face="Helvetica, Arial, sans-serif">vector. A non-zero number in
the</font> <big><a href="gems_bcc.html#xd_"><tt>xd_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">column will add a certain quantity
of this species elemental stoichiometry to the bulk system composition
- as an alternative to the</font> <big><a href="gems_bcc.html#xa_"><tt>xa_</tt></a></big>
<font face="Helvetica, Arial, sans-serif">vector on the "Compos" page.</font>&nbsp;</p>
<p><font face="Helvetica, Arial, sans-serif">Switch to the "Phase" page
now. There you will see a</font> <big><tt>PHvp</tt></big><font
 face="Helvetica, Arial, sans-serif"> list of Phase record keys linked
to the project system, with switches on the left side that let you to
turn some phases on ("+") and off ("-"). The</font> <big><tt>Yof_,
Aalp_</tt></big> <font face="Helvetica, Arial, sans-serif">and</font> <big><tt>Sigm_</tt></big>
<font face="Helvetica, Arial, sans-serif">columns to the right (now all
zeros) may serve for specifying surface properties of phases (see <a
 href="gems_scm.html">gems_scm.html</a> manual).&nbsp;</font></p>
<p><font face="Helvetica, Arial, sans-serif">The next, "IComp" page,
displays the</font> <big><a href="gems_bcc.html#ICvp"><tt>ICvp</tt></a></big>
l<font face="Helvetica, Arial, sans-serif">ist of Independent
Components forming the stoichiometry basis of the project system, with
switches (to the left) defining which of IC must be taken into this CSD
and calculation of equilibrium state. To the right, you should see the</font>
<big><a href="gems_bcc.html#B_"><tt>B_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector containing the total bulk
composition of the present system (in moles). Next to the right, two
columns for (optional) modification of the</font> <big><tt>B_</tt></big>
<font face="Helvetica, Arial, sans-serif">vector are seen:</font> <big><a
 href="gems_bcc.html#BCun_"><tt>BCun_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">column (filled with "M") allows to
set units of quantities/concentrations for the respective element of the</font>
<big><tt>bi_</tt></big> <font face="Helvetica, Arial, sans-serif">vector,
and the</font> <big><tt>bi_</tt></big> <font
 face="Helvetica, Arial, sans-serif">column itself. A non-zero number
in the</font> <big><a href="gems_bcc.html#bi_"><tt>bi_</tt></a></big>
<font face="Helvetica, Arial, sans-serif">column will add certain
quantity of Independent Component to the bulk system composition - as
an alternative (or in extension) to the</font> <big><a
 href="gems_bcc.html#xa_"><tt>xa_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector on the "Compos" page.&nbsp;</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">You may ask - why there
are several
places for entering data to calculate the system bulk chemical
composition
(</font><big><tt><a href="gems_bcc.html#xa_">xa_</a>, <a
 href="gems_bcc.html#xd_">xd_</a>, <a href="gems_bcc.html#xp_">xp_</a>
</tt></big><font face="Helvetica, Arial, sans-serif">and</font> <tt><big><a
 href="gems_bcc.html#bi">bi_</a></big> </tt><font
 face="Helvetica, Arial, sans-serif">vectors)? Doesn't it seem too
complicated? &nbsp;Wouldn't it be simpler to enter just moles of
Independent Components, as in other modelling codes? &nbsp;The answer
is: the GEMS code gives you an unmatched flexibility &nbsp;and power in
formulating bulk compositions of chemical systems. We hope that you
will appreciate it in the following numerical examples. You can close
now the "EqDemo", "System" and "MTparm" windows, if not yet done, to
come back to the "Single Thermodynamic System" dialog. </font><br>
<br>
</p>
<h3><a name="GSM_PRINT_RESULTS"></a><font
 face="Helvetica, Arial, sans-serif">3.5. Printing GEM Results and
Chemical System Definition</font></h3>
<p> </p>
<p> </p>
<p> </p>
<p><font face="Helvetica, Arial, sans-serif">Sometimes, you may want to
have a tabulated printout of GEM calculation results and input CSD.
There are several possibilities. The sandard way of printing the
equilibrium speciation, prime/dual IPM solutions, and phase assemblage
is to click on the "Print" &nbsp;<img src="fileprint.png"
 alt="Print icon" height="20" width="20"> &nbsp; toolbar button (or
execute the "Print" "GEM results" menu command). This will open first a
dialog "SDref: Please, select a print script" with suitable script
records from the <a href="pe_script.html">print script library</a>.
Select there a </font><big><tt>"pscript-eqst-aquat:0000:multi:"</tt></big>
<font face="Helvetica, Arial, sans-serif">item and press "Ok" to
proceed. Now, a standard "Save As" dialog appears, where you have to
select a directory and type in a (new) text file name where the results
will be printed. Enter, for instance, </font><big><tt>"Carbonat1eq.txt"</tt></big>
<font face="Helvetica, Arial, sans-serif">and press "Save". That's it -
you should see now again the "Single Thermodynamic System" dialog. Use
your file manager to find the</font> <big><tt>Carbonat1eq.txt</tt></big>
<font face="Helvetica, Arial, sans-serif">file and open it in the
simple ASCII text editor. You can edit the output, print it or import
into a spreadsheet program. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">If you are not satisfied
with the printout or want to print different output data, you can use
the</font> <big><tt>"pscript-eqst-aquat:0000:multi:"</tt></big> <font
 face="Helvetica, Arial, sans-serif">SDref record as a template for
creating and editing your own print script (call it</font> <big><tt>"pscript-my-best:1000:multi:"</tt></big>
<font face="Helvetica, Arial, sans-serif">and save in your project
sdref database file), as described in detail in the <a
 href="pe_script.html">Print/Export Scripts Manual</a>. </font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">In a similar way, you can
obtain a simpler (less official) printout only of data shown in the
"Results: Equilibrium State" list view page. Just select the "Print"
"Results: Equilibrium State Tree..." menu command and enter the file
name. The&nbsp;"Print" "Input: System Definition Tree..." menu command
will print into a text file the contents of the "Input System
Definition" list view page. </font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">A more elegant way to
print out
the input the CSD data consists in using print scripts and the
"Print"&nbsp;
"System Definition" menu command. Again, you will have to select a
suitable
printing script first and then select a directory and enter a file
name.
Take first a</font> <big><tt>"pscript-full:0002:system:"</tt></big><font
 face="Helvetica, Arial, sans-serif"> script record and enter </font><big><tt>"Carbonat1csd.txt"</tt></big>
<font face="Helvetica, Arial, sans-serif">file name. In this file, you
will see full lists of Dependent Components and Phases, with nothing
really changed against default values. This printout can be made much
more compact if you will select a</font> <big><tt>"pscript-normal:0000:system:"</tt></big>
<font face="Helvetica, Arial, sans-serif">script record next time. In
the produced ASCII file, you will see a reasonably condensed list
of Compos (PCO) - only those that have been used for specifying the
bulk composition of the system. The lists of&nbsp; Dependent Components
and Phases will not appear at all because nothing has been specified
there. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Finally, the input
thermodynamic data for <i>P,T</i> &nbsp;of interest can be printed by
selecting the "Print" "Thermodynamic Data..." menu command. In the
appearing list, take a</font> <big><tt>"pscript-g-gx-v:0000:mtparm:"</tt></big>
<font face="Helvetica, Arial, sans-serif">script record and enter a</font>
<big><tt>"Carbonat1-25.txt"</tt></big> <font
 face="Helvetica, Arial, sans-serif">file name. In this file, you will
see a nice table with all the data that you have seen in the "MTparm"
window. If you wish to have a printout in kJ/mol &nbsp;or in kcal/mol,
or molar volumes in cm3/mol, then you will have to create and use your
own (modified) print script. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif"><i>A practical remark:</i>
&nbsp;Full printouts of CSD and GEM results described above are good
when you create and check a few "initial" systems in your modelling
project. However, if you then will generate a series of equilibria,
consider creating
and using data samplers (in <a href="gm_gtdemo.html">GtDemo</a> or <a
 href="gm_proces.html">Process</a></font> <font
 face="Helvetica, Arial, sans-serif">records) which will save you a lot
of time in collecting m plotting and printing only relevant input and
output data.</font><br>
<br>
</p>
<hr size="2" width="100%">
<h3><a name="GSM_CLONE_SYSEQ"></a> <font
 face="Helvetica, Arial, sans-serif">3.6. Modifying and "Cloning"
Chemical System Definitions </font></h3>
<p><font face="Helvetica, Arial, sans-serif">So far, you have composed
your first CSD, calculated equilibrium, viewed and printed results.
Now, it is time to think what these results mean, then, if necessary,
modify the CSD to make the model more adequate to reality. GEM-Selektor
makes this task easy and convenient. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">It would be a good
exercise to
close all windows and shut down the GEM-Selektor program first, then
start it again, go to "Calculations of Equilibria" mode, and from the
"Single Thermodynamic System" dialog, find and open your previously
calculated
equilibrium</font> <big><tt>"Carbonat:G:CaFeMnOpen:1:0:1:25:0:"</tt></big>.
<font face="Helvetica, Arial, sans-serif">If you get stuck somewhere on
the way, this means that you have to read some parts of Section 3.1
again. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Now, you have two options:
(1) to modify CSD, re-calculate equilibrium, and save results under the
same record key (good for tuning); and (2) to "clone" this CSD by
saving it under a different SysEq record key, then modify CSD and
re-calculate the equilibrium state.&nbsp; <br>
</font> <br>
</p>
<h4><a name="GSM_MOD_SYSTEM_STOI"></a><font
 face="Helvetica, Arial, sans-serif">3.6.1.&nbsp; Modifying the System
Stoichiometry</font></h4>
<p><font face="Helvetica, Arial, sans-serif">The simplest (and most
frequent) CSD modification is a change in the system bulk composition.
In the previously calculated equilibrium, we obtained ionic strength
about 0.1 (set by an addition of NaCl) and pH about 8.3 (set by
alkalinity created by dissolution of calcite at atmospheric CO<sub>2</sub>
partial pressure). Let us learn how to control the effect of these two
factors onto aqueous equilibria in our system.&nbsp;</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Press the&nbsp; "Bulk
Composition" <img src="SetCompos.png" alt="Bulk Composition icon"
 height="22" width="21"> &nbsp; toolbar button and find a</font> <big><tt>"NaCl"</tt></big>
<font face="Helvetica, Arial, sans-serif">entry in the PCO list on the
"Compos" page (extend the window, if necessary). 0.03 moles NaCl should
have been set there that produced the 0.1 m ionic strength at
equilibrium. Let us increase this amount 6-7 times (approximately, to
get the ionic strength of seawater). Type in 0.2 instead of 0.03, press
Enter, close the "System" window, and press the "Calculate IPM" <img
 src="RunIPM.png" alt="Calculate IPM icon" height="20" width="20">
&nbsp; toolbar button. Press "Accept" on the Progress Dialog, when IPM
calculation is finished. In the status line of the "Single
Thermodynamic System" dialog, you should see pH = 8.316 and IS = 0.67. </font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Now you can compare the
calculated aqueous speciation and total dissolved concentrations to the
previous run (at 0.1 m ionic strength) that you should have printed
into the</font> <big><tt>"Carbonat1eq.txt"</tt></big> <font
 face="Helvetica, Arial, sans-serif">file. pH has slightly decreased
(by 0.005 units). At the same time, total dissolved calcium molality
increased from log m(Ca) = -3.093 to -2.987 (hint: open the "EqDemo"
window to see this number). Examination of aqueous speciation of Ca
(e.g. in "EqDC" page of "EqDemo" window) in comparison to your previous
printout shows that molalities of all calcium aqueous species have
increased in spite of the fact that their activities decreased. The
reason lies in sensibly lower values of activity coefficients for
charged aqueous species due to elevated ionic strength. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Let us proceed with
checking the pH of aqueous solution. There is no way to set pH as input
variable in GEM calculations; the only way to control it is to add acid
or base to the system bulk composition. Let us revert to the "System"
window "Compos" page and add some acid there (0.01 moles) in the form
of HCl. Compute the equilibrium and view the results. Calculated pH =
7.7 is now significantly lower, and ionic strength higher (0.717
molal). <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">A look at the "Results:
Equilibrium State" page tells us that almost a half of the previously
present calcite phase has dissolved. Indeed, a look into the "EqDemo"
window shows log m(Ca) = -1.77 , or 1.2 orders of magnitude (20 times)
greater than in the previous run without addition of HCl. If you have
got different pH and
log m(Ca) numbers than listed here, then you most probably forgot to
change the quantity/concentration units from grams ("g") to moles ("M")
for HCl in the "Compos" page of "System" window. Ok, that seems to be
sufficient to give you a feeling how to modify CSD and check what
happens
at equilibrium; remove now the HCl addition and change the NaCl
addition
back to 0.03 moles, then recalculate and save the equilibrium to
restore
the original system. </font><br>
<br>
</p>
<h4><a name="GSM_CLONE_SYSEQ_REC"></a><font
 face="Helvetica, Arial, sans-serif">3.6.2. "Cloning" SysEq Records in
Project Database (Also for Other P, T)</font></h4>
<p><font face="Helvetica, Arial, sans-serif"> The just performed
exercise has a drawback that, once we have changed something in CSD and
calculated equilibrium, the previously calculated results are lost (at
least if they were not printed out). This can easily be avoided by
"cloning" SysEq records, i.e. creating new records using previously
active one as
a template. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Let us investigate first
the impact of temperature and pressure onto our system. In the "Single
Thermodynamic System" dialog, select the "Record" "New(Clone)" menu
command.
In the appearing "SysEq: Please, enter a new key" dialog, change
temperature
(7-th field) to 5 instead of 25 C and press "Ok". You will see the
"System"
window; just close it and calculate the equilibrium state (press
"Accept"
when finished). In the field next to the toolbar, you should see now a
new
record key</font> <big><tt>"Carbonat:G:CaFeMnOpen:1:0:1:5:0:"</tt> </big><font
 face="Helvetica, Arial, sans-serif"> and in the status bar - the new
temperature
T = 278.15 K. To compare with the first equilibrium, you can simply use
the "Previous" &nbsp;<img src="arrow_left1.png" alt="Previous icon"
 height="11" width="11"> &nbsp;and "Next" &nbsp;<img
 src="arrow_right1.png" alt="Next icon" height="11" width="11">
&nbsp;toolbar buttons (watch the SysEq record keys!), or
select necessary records from the list using the "Display" <img
 src="fileopen.png" alt="Display icon" height="20" width="20"> &nbsp;
button. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">We notice now that pH and
IS (ionic strength) have slightly increased. Open the "EqDemo" window,
drag it to the opposite corner of your desktop, and (by toggling
"Previous" and "Next" toolbar buttons) watch how the total dissolved
molalities of carbon, oxygen and nitrogen change. As expected, they all
get larger at 5 C because of a well known fact that solubility of
atmospheric gases in water increases with decreasing temperature. You
can also see how the input thermodynamic data change with temperature
after you close the "EqDemo" window and open the "MTparm" window
(through "Data" menu). In the same
way you can study the effect of pressure (put zero in place of pressure
in SysEq record key if temperature is set greater or equal to 100 C -
this will define a "saturated vapor pressure" <i>P</i><sub>sat</sub>
&nbsp;as a function of temperature).&nbsp; <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Now, let us produce a new
system &nbsp;by changing seriously its bulk composition.So far, we
considered aqueous solution with some minerals (added as metal
carbonates) as "open" to the atmosphere, simulated with a very large
addition of "Dry atmospheric air". Let us see what will be the effect
of "closing" the aqueous part + initial "carbonates", i.e. removing
almost all atmosphere. We will also learn how to calculate aqueous
speciation in molarities because experimental data are often reported
in moles per litre of aqueous solution. </font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Open the&nbsp;</font> <big><tt>"Carbonat:G:CaFeMnOpen:1:0:1:25:0:"</tt></big>
<font face="Helvetica, Arial, sans-serif">system and "clone" it under a
new record key</font>&nbsp;<big><tt>"Carbonat:G:CaFeMnClos:1:0:1:25:0:"</tt></big>.
<font face="Helvetica, Arial, sans-serif">Then, open the "System"
"Compos" page. Change there the addition of water</font> <big><tt>"Aqua"</tt></big>
<font face="Helvetica, Arial, sans-serif">to 1000 g, NaCl to 0.1 mole,
and the addition of air</font> <big><tt>"AtmAirNit"</tt></big> <font
 face="Helvetica, Arial, sans-serif">- to 0.1 g. Close the "System"
window, calculate and accept the new equilibrium state. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">Already a first glance to
the status line is enough to see that the new recipe has fundametally
changed the equilibrium.</font> <font
 face="Helvetica, Arial, sans-serif">pe = -4.396 is now negative
(mildly reducing conditions), pH dropped to 7.288 (without any addition
of HCl), and the stable phase assemblage has totally changed. Instead
of Pyrolusite (Mn(IV) oxide), Rhodochrosite (MnCO<sub>3</sub>) appears;
two more iron phases - Siderite and Goethite - appear in addition to
hematite; Calcite is still there but about 2/3 of initial addition has
dissolved; and only 2 mmol of gas phase is present. Examination of the
gas phase (if you open it in the "Results: Equilibrium State" page)
shows that this gas is now mainly nitrogen with some 150 times higher
partial pressure of CO<sub>2</sub> than atmospheric, plus traces of
hydrogen. Fugacity of oxygen (log(activity)= -71.55 for O<sub>2</sub>)
is now extremely low.</font> <br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Furthermore, the aqueous
speciation has drastically changed too. You can see it in the expanded</font>
<big><tt>"aq_gen"</tt></big> <font face="Helvetica, Arial, sans-serif">phase:
dissolved iron is now dominated by Fe<sup>+2</sup> and its complexes,
and concentrations of Mn<sup>+2</sup> ion and its complexes are almost
10 orders of magnitude higher. A look at total dissolved molalities (in
the "EqDemo" window) shows that log m(Fe) = -4.9 is almost 9 orders and
log m(Mn) = - 5.09 is 10.8 orders of magnitude greater than that in the
"open" system. Chemical potential of charge, u(Zz) = -10.12, is now
also negative (it was +28 in the open system).&nbsp;&nbsp;</font></p>
<p><font face="Helvetica, Arial, sans-serif">What about molarities of
aqueous species? Change to the "EqPh" page and check there the
calculated volume of aqueous phase (1004.6 cm<sup>3</sup>). One can
expect that if one takes about 4.6 g less water addition in the bulk
composition of the
system, the volume will be almost 1 L and then moles of aqueous species
in the&nbsp;</font> <big><tt>x</tt></big> &nbsp;<font
 face="Helvetica, Arial, sans-serif">vector (primal solution) will be
numerically equal to molarities. Let us try it: close the "EqDemo"
window, open the "System" window and in the "EqDC" page, find water</font>
<big><tt>"H2O@"</tt></big> <font face="Helvetica, Arial, sans-serif">in
the species list. To the right of this record key, change "M" (moles)
to "g" (grams) and in the respective</font> <big><a
 href="gems_bcc.html#xd_"><tt>xd_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">column cell, enter -4.6 (negative
additions are allowed as long as they do not produce negative values in
the bulk composition of the system). Alternatively, instead of using</font>
<big><tt>xd_</tt></big> <font face="Helvetica, Arial, sans-serif">vector,
you could change the water addition on the "Compos" page (</font><big><a
 href="gems_bcc.html#xa_"><tt>xa_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">vector) to 995.4 grams. Close the
"System" window and re-calculate equilibrium. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">The numbers seen in the
status line have changed slightly, of course. But inspection of the
aqueous phase volume (999.99 cm<sup>3</sup>) tells us that the aqueous
speciation seen in the</font> <big><a href="gems_sys.html#x"><tt>x</tt></a></big>
<font face="Helvetica, Arial, sans-serif">vector on "EqDC" page (or in
the expanded aqueous phase on "Results: Equilibrium State" page) can be
taken now safely as molarities (you still see molalities in the
"Concentration" column). A conversion factor from the molal (in which
log(activity), pH and pe are given) to the molar concentration scale
for this system can be
found simply by dividing any molarity by molality. For example, take
the
Ca<sup>+2</sup> ion: Factor = 0.0025544 / 0.0025664 = 0.995324,
log(Factor) = -0.002035, or only 0.002 pH, pe or log(activity) units,
which can, in principle, be neglected. &nbsp;Please, note that such a
calculation of molarities is only as good as the partial molal volumes
of aqueous species and water available in the thermodynamic
database.&nbsp;</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Interestingly, what will
happen if even less "air" will be added to the system bulk composition?
To explore this, let us "clone" a new SysEq record&nbsp;</font><big><tt>"Carbonat:G:CaFeMnClos:2:0:1:25:0:"</tt></big>
&nbsp;<font face="Helvetica, Arial, sans-serif">by changing to 2 the
fourth field (CSD variant) of the record key. In the appearing "Compos"
page, change addition of</font> <big><tt>"AtmAirNit"</tt></big> <font
 face="Helvetica, Arial, sans-serif">from 0.1 g to 0.0001 g, close the
window and perform the GEM IPM calculation.</font><font
 face="Helvetica, Arial, sans-serif"> The equilibrium state has changed
again! The "Graphite" phase appears now, the gas phase has disappeared.
Inspection of &nbsp;gas fugacities (log(activity) in</font> <big><tt>"gas_gen"</tt></big>
<font face="Helvetica, Arial, sans-serif">phase) shows that (except
nitrogen), the dominating gas would be CO<sub>2</sub>, followed by
methane CH<sub>4</sub>, and then H<sub>2</sub>. Fugacity of oxygen is
astronomically small ( -70.77 in log scale).&nbsp;</font></p>
<p><font face="Helvetica, Arial, sans-serif">Let us try how the program
will react if we totally remove addition of </font><big><tt>"AtmAirNit"</tt></big>
<font face="Helvetica, Arial, sans-serif">from the bulk system
composition. "Clone" a new SysEq record</font>&nbsp; <big><tt>"Carbonat:G:CaFeMnTest:2:0:1:25:0:"</tt></big>
<font face="Helvetica, Arial, sans-serif">(you can delete it later). In
the "Compos" page, zero off the air addition and press the "Calculate
BCC" button. Now you get something new - a "Missing IC Warning" dialog,
showing that no moles are going to be specified for the</font> <big><tt>"Nit"</tt></big>
<font face="Helvetica, Arial, sans-serif">Independent Component. The
program does not know whether this is a mistake or the user did it
deliberately (as we did), so it gives the user an opportunity to think
again. If
checkbox(es) for the missing elements will be checked than the fill-out
value(s) will be inserted into the</font> <big><tt>bi_</tt></big> <font
 face="Helvetica, Arial, sans-serif">vector and bulk composition
recalculated. Otherwise, the program will switch this(these) element(s)
off together with all their species and &nbsp;single-component phases.
Let us press the
"Check/Ok" button and then investigate the "IComp" page. Indeed, the</font>
<big><tt>"Nit"</tt></big><font face="Helvetica, Arial, sans-serif">
independent component is now turned off. On the "Input System
Definition" page of the "Single Thermodynamic System" dialog, expand
the </font><big><tt>"gas_gen"</tt></big> <font
 face="Helvetica, Arial, sans-serif">phase to see that</font> <big><tt>"N2-atm"</tt></big>
<font face="Helvetica, Arial, sans-serif">gas is turned off, as well as
(in the</font> <big><tt>"aq_gen"</tt></big> <font
 face="Helvetica, Arial, sans-serif">phase) the</font> <big><tt>"Nit2@"</tt></big>
<font face="Helvetica, Arial, sans-serif">dissolved gas. All right,
press now the "Calculate BCC" and then "Calculate IPM" buttons to
compute equilibrium</font>. <font face="Helvetica, Arial, sans-serif">The
results should be pretty similar to the "almost closed" variant (with
0.0001 g addition of air), except that the gas phase is absent from
stable phase assemblage, and you will not see the </font><big><tt>Nit</tt></big>
<font face="Helvetica, Arial, sans-serif">species at all in the output
lists.&nbsp;</font><br>
&nbsp;</p>
<h4><a name="GSM_SELECT_PHASES_SPECIES"></a><font
 face="Helvetica, Arial, sans-serif">3.6.3. &nbsp;(De)Selecting Phases
and Species</font></h4>
<p><font face="Helvetica, Arial, sans-serif"> In the previous section,
we
have learned that GEM-Selektor is capable to exclude automatically all
species
of Independent Component(s) assigned zero quantity(ies) in the system
bulk
composition. This functionality is frequently used when a new system
definition
has to be created "from scratch" (i.e. without "cloning" from the
previous
CSD) and the bulk composition covers &nbsp;only part of IC forming
stoichiometry
basis of the project system. However, in many cases you will need
turning
some components and phases on or off to refine your CSD or to switch
back
an Independent Component with its species and phases. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Let us first check how to
turn off some phases and what impact it will have on the equilibrium
state. In the&nbsp; "Single Thermodynamic System" dialog, press the
"Display" <img src="fileopen.png" alt="Display icon" height="20"
 width="20"> &nbsp; toolbar button (alternatively, press </font><big><tt>F6</tt></big><font
 face="Helvetica, Arial, sans-serif"> or select the "Record" "Display"
menu command). In the appearing "SysEq: Existing CSD and equilibria
records in project database" list, select the&nbsp; record </font><big><tt>"Carbonat:G:CaFeMnOpen:1:0:1:25:0:"</tt></big>.
<font face="Helvetica, Arial, sans-serif">This calculation results were
discussed in detail (<a href="#GSM_VIEW_RESULTS">see above</a>),
although that model is not realistic for the low-temperature aquatic
systems because neither hematite nor pyrolusite control dissolved Fe
and Mn in Earth
surface- and groundwater at low temperatures. Indeed, the calculated
total dissolved Fe (ca. 1e-14 molal) and Mn ( less than 1e-15 molal)
are far below the values typically reported for surface ocean waters
(ca. 1e-9 and 1e-10 molal, respectively).Therefore, we can try to
switch off Goethite and Pyrolusite (the most stable oxides) and see
what happens.</font> <br>
</p>
<p><font face="Helvetica, Arial, sans-serif">As our GEM problem is
going to
become smaller (two phases and two species are to be excluded), it has
to be "cloned" under a different CSD name (third field of SysEq record
key). Execute the "Record" "Clone" menu command and change</font> <big><tt>"CaFeMnOpen"</tt></big>
<font face="Helvetica, Arial, sans-serif">to</font> <big><tt>"CaFeMnHypO"</tt></big><font
 face="Helvetica, Arial, sans-serif">; in the appearing "System"
"Compos" page, modify the first comment line by adding</font> <tt>"(metastable)"</tt>.&nbsp;
<font face="Helvetica, Arial, sans-serif">The easiest way to switch off
two phases is to close the "System" window and click on the "Input
System Definition" tab. There, with double right-mouse clicks, change
in the "On/Off" column "+" to "-" for &nbsp;</font><big><tt>"Goethite","Hematite"</tt></big>
<font face="Helvetica, Arial, sans-serif">and</font> <big><tt>"Pyrolusite"</tt></big>.
<font face="Helvetica, Arial, sans-serif">You can expand entries for
these phases to see that the the respecitve Dependent Components were
also turned off. To update the CSD, click now the "Calculate BCC"&nbsp;<img
 src="RunBCC.png" alt="Calculate BCC icon" height="20" width="20">
toolbar button, then calculate and accept the new equilibrium state. </font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">As seen on the "Results:
Equilibrium State" page, new phases appear at this (metastable)
equilibrium -&nbsp; "Ferrihydrite-mc" and "Manganite". Check total
dissolved Fe and Mn (hint: use the "Detailed Results" <img
 src="ordertool.png" alt="Dual Solution icon" height="21" width="21">
&nbsp;toolbar button); now, log m(Fe) = -9.45 and log m(Mn) = -11.29.
It is known (Gramm-Osipov, 1996) that instead of manganite MnOOH,
hausmannite Mn<sub>3</sub>O<sub>4</sub> appears to be controlling
dissolved Mn in the oxic seawater. Let us see how does it work -
"clone" another test SysEq (with name</font> <big><tt>"CaFeMnTes2"</tt></big>).
<font face="Helvetica, Arial, sans-serif">Try an alternative way to
switch
off a phase: go to the "Phase" page of "System" window, find</font> <big><tt>"Manganite"</tt></big><font
 face="Helvetica, Arial, sans-serif">, change "+" to "-" to the left,
and change to "DComp" page. There you can check what happened to
"manganite" species: as pyrolusite, it is now also switched off. Close
the "System" window, press&nbsp; "Calculate BCC"&nbsp;<img
 src="RunBCC.png" alt="Calculate BCC icon" height="20" width="20">
toolbar button, then calculate and accept the equilibrium state.</font><font
 face="Helvetica, Arial, sans-serif"> Indeed, now 0.0029 mol</font> <big><tt>"Hausmannite"</tt></big><font
 face="Helvetica, Arial, sans-serif"> appear at this (even more
metastable) equilibrium state. Total dissolved Mn is now log m(Mn) =
-9.415 - a quite realistic value for sea- or stream water. </font><br>
</p>
<p> <font face="Helvetica, Arial, sans-serif">In a similar way, you
can switch some components and phases back into the GEM problem. Note,
however, that unlike turning off, this process is not fully automated
in GEM-Selektor. The correct order is: first, turn on Independent
Component (if any) in the "System" "IComp" page and &nbsp;change the
system bulk composition to cover this IC; second, switch on some phases
(in the "Input System definition" page); &nbsp;expand phases and check
the species to be turned on (especially aqueous phase). Finally, press
the "Calculate BCC"&nbsp;<img src="RunBCC.png" alt="Calculate BCC icon"
 height="20" width="20"> toolbar button and then check again phases and
species that you have switched on, as well as the bulk composition of
the system
(vector</font> <big><tt>B_</tt></big><font
 face="Helvetica, Arial, sans-serif">). Now, you can calculate and save
your new equilibrium. Exercise this sequence to restore the</font> <big><tt>"Nit"</tt></big><font
 face="Helvetica, Arial, sans-serif"> independent component and its
species in the</font>&nbsp; <big><tt>"CaFeMntTest"</tt></big> <font
 face="Helvetica, Arial, sans-serif">SysEq record.</font><br>
<br>
</p>
<h4><a name="GSM_SET_META_CONSTR"></a><font
 face="Helvetica, Arial, sans-serif">3.6.4. Setting Additional
Metastability Constraints</font></h4>
<p><font face="Helvetica, Arial, sans-serif">Metastability is quite
common in low-temperature geochemical systems. For instance, river
waters are often and normative seawater is always oversaturated to
dolomite, calcite and aragonite, nevertheless, these minerals
(especially dolomite) do not precipitate or do it very slowly, except
at some special conditions (evaporation, bilolgical growth). This kind
of kinetic controls can be
simulated in GEM-Selektor using one- or two-sided metastability
constraints on the sought-for molar quantities of species in the prime
GEM solution (more in <a href="theorgem.html">theorgem.html</a>
manual). </font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">Display the </font><big><tt>"Carbonat:G:CaFeMnHypO:1:0:1:25:0:"</tt></big>
<font face="Helvetica, Arial, sans-serif">SysEq record created in our <a
 href="#GSM_SELECT_PHASES_SPECIES">previous exercise</a>. Concentration
of total dissolved calcium in seawater is about 10.65 millimol/kg, and
in the calculated equilibrium it is less than 1 millimol/kg due to
presence of 9.75 millimoles of stable calcite phase (CaCO<sub>3</sub>)
at the atmospheric fugacity of CO<sub>2</sub> gas. Assuming that
precipitation of calcite is strongly inhibited, let us restrict the
amount of calcite formed in the partial equilibrium to 0.1 millimol. </font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">To do so, first "clone" a
new system </font><big><tt>"Carbonat:G:CaFeMnHypO:1:0:1:25:1:"</tt></big><font
 face="Helvetica, Arial, sans-serif">, &nbsp;i.e. change the last field
of SysEq record key; edit the comment lines by writing there something
about partial equilibrium to calcite, and&nbsp; change the total
addition of CaCO<sub>3</sub> to the system bulk composition from 1 g to
0.3 g. In the "Input System Definition" page, expand the "Calcite"
phase and find the "Lower_KC", "Upper_KC" and "KC_type" columns (extend
the window, if necessary). For all species in the usual, "complete
equilibrium" systems, these columns contain trivial codes and values.</font>
<big><big><tt>"B"</tt></big></big> &nbsp;<font
 face="Helvetica, Arial, sans-serif">in "KC_type" means "both-side
constraints", from 0 moles ( lower) to 1e6 moles (upper) restriction
values. Right-click on&nbsp; "1e+06" &nbsp;in the "Upper_KC", edit it
to 0.0001 and press </font><big><tt>Enter</tt></big><font
 face="Helvetica, Arial, sans-serif">. Suppress also the Aragonite
phase by
expanding it and entering 111111 (J/mol) in the "G0_corr." column, to
prevent
that Aragonite precipitates instead of Calcite. Now, calculate BCC and
then
compute the equilibrium state.</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif"> Our metastability
constraint for calcite caused a quite vivid effect: calculated pH =
9.15 is 0.8 units greater than before, and ionic strength is 1.2 times
greater. Calcite phase is present, but in the prescribed quantity
0.0001 mol; expand
this phase to see log(activity) = 2.58 - pointing to a large
oversaturation of aqueous phase with respect to calcite. Check total
dissolved calcium: log m(Ca) = -2.015, or m(Ca) = 9.67 millimolal -
close to calcium concentration in seawater. Switch to the "PhEq" page
and find there the value of Karpov criterion (Fa) for calcite: 380. As
this criterion for all stable phases must be almost zero, we can
conclude that the kinetic constraint to calcite indeed greatly
increases "metastability" of the model system and turns it, in fact,
into a "partial equilibrium" because the rest of species were not
constrained and have equilibrated at higher total alkalinity created by
extra dissolved calcium. Obviously, if precipitation kinetics of
calcite is known, one could model the whole process as function of time
- until the complete equilibrium will be achieved. <br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">In the same way, the
dissolution kinetics can be modeled. The only difference is that
instead of the upper, the non-trivial <b>lower</b> constraint to the
amount of species has to be specified, to prevent disappearance of the
unstable solid phase. Alternatively to the&nbsp;"Input System
Definition" page, metastability constraints can be set in the "System"
"DComp" page (scroll the whole page
down to see the</font> <big><a href="gems_bcc.html#dll_"><tt>dll_</tt></a></big>
<font face="Helvetica, Arial, sans-serif">and</font>&nbsp; <big><a
 href="gems_bcc.html#dul_"><tt>dul_</tt></a></big> <font
 face="Helvetica, Arial, sans-serif">columns).</font> &nbsp; &nbsp;
&nbsp; &nbsp; <br>
<br>
</p>
<h4> <a name="GSM_SET_CORR_G0"></a><font
 face="Helvetica, Arial, sans-serif">3.6.5. Setting Corrections to
Input Thermodynamic Data</font>&nbsp;</h4>
<p><font face="Helvetica, Arial, sans-serif">After we created a CSD
where "Hematite" and "Goethite" phases were excluded, we found that the
solubility of inorganic Fe in the open system calculated in presence of
microcrystalline "Ferrihydrite-mc" phase became ca. 2-3 times below
that usually reported (about 1 nM). We can suspect that the input <i>G<sup>o</sup></i>
value of microcrystalline ferrihydrite is a bit too negative. Whatever
could be the reason, the question is: how this input value should be
corrected in order to obtain the expected dissolved iron concentration?
<br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Display the earlier </font><big><tt>"Carbonat:G:CaFeMnHypO:1:0:1:25:0:"</tt></big>
<font face="Helvetica, Arial, sans-serif">system and expand the</font> <big><tt>"Ferrihydrite-mc"</tt></big>
<font face="Helvetica, Arial, sans-serif">phase to see that it refers
to a</font> <big><tt>"Fe(OH)3(mic)"</tt></big> <font
 face="Helvetica, Arial, sans-serif">Dependent Component. Using the
"Data" menu, open the "MTparm" (input thermodynamic data) window, find
there a DC</font> <big><tt>"Fe(OH)3(mic)"</tt></big> <font
 face="Helvetica, Arial, sans-serif">in the list, click on it and
(using </font><big><tt>F7</tt></big>
<font face="Helvetica, Arial, sans-serif">key) open the source ReacDC
record.<br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">We can now correct the G<sup>o</sup>
value of the </font><big><tt>"Fe(OH)3(mic)"</tt> </big><font
 face="Helvetica, Arial, sans-serif">species only for this calculation
of equilibrium state, without changing its ReacDC database record.
"Clone" the presently displayed system under a</font> <big><tt>"Carbonat:G:CaFeMnHypO:1:0:1:25:2:"</tt></big>
<font face="Helvetica, Arial, sans-serif">SysEq record key (change
only the last field).&nbsp; Mark in the comment lines something like</font>
<tt>"corr. G0 HFO"</tt> <font face="Helvetica, Arial, sans-serif">and
switch back to the "MTparm" window, and find there a cell in the </font><big><tt>gEx_</tt></big>
column against &nbsp;the <big><tt>"Fe(OH)3(mic)"</tt><font
 face="Helvetica, Arial, sans-serif"><small> species. </small></font></big><font
 face="Helvetica, Arial, sans-serif">Which value to put there instead
of zero?
We expect to increase total dissolved Fe molality in ca. 3 times (0.5
orders of magnitude). For a reaction involving one Fe(OH)3,solid this
will
be 0.5 * 2.303RT &nbsp;= 0.5*5708 = 2854 J/mol. So, type this positive
correction to G<sup>o</sup> value of </font><big><tt>"Fe(OH)3(mic)"</tt></big><font
 face="Helvetica, Arial, sans-serif"> into the respective</font> <a
 href="gems_bcc.html#gEx_"><big><tt>gEx_</tt></big></a> <font
 face="Helvetica, Arial, sans-serif">vector cell; press "Enter" and
calculate the equilibrium state. Alternatively, the same correction
could have been done directly in the "Single Thermodynamic System"
dialog in the </font><font face="Helvetica, Arial, sans-serif"> in the
"G0_corr." column</font><font face="Helvetica, Arial, sans-serif">
(after expanding the phase)</font>.<font
 face="Helvetica, Arial, sans-serif"> Check now the total dissolved Fe:
log m(Fe) =&nbsp; -8.95 - a quite realistic value. The </font><big><tt>gEx_</tt></big>
<font face="Helvetica, Arial, sans-serif">corrections can also be used
for "kicking off" a species from equilibrium by inserting a large
positive addition to G<sup>o</sup>, as done with Aragonite in the
previous section.</font><br>
</p>
<p><font face="Helvetica, Arial, sans-serif">To finalize "fine tuning"
of thermodynamic data in our aquatic system, recall that at more
reducing conditions in absence of sulfur, dissolved iron in groundwater
or sediment porewater may be controlled by "hydromagnetite" - a
colloidal phase that has composition close to magnetite but it has
large specific surface area and is 2 to 3 orders of magnitude more
soluble. We can also put now a positive G<sup>o</sup> correction (+5708
J/mol, as one mole of Fe<sub>3</sub>O<sub>4</sub> releases 3 moles Fe
into aqueous solution) to "magnetite" species in the "Magnetite" phase
in order to simulate hydromagnetite. <br>
</font></p>
<p><font face="Helvetica, Arial, sans-serif">You can check how this
correction works by "cloning" the system (under </font><big><tt>"Carbonat:G:CaFeMnHypC:1:0:1:25:2:"</tt></big><font
 face="Helvetica, Arial, sans-serif">) and making it "almost closed" as
described <a href="#GSM_CLONE_SYSEQ_REC">above</a>.; check also taht
the "Goethite" phase is disabled.&nbsp; Use the following recipe: 1000
g H<sub>2</sub>O, 0.1 g air, 0.1 mole NaCl, 1 g CaCO<sub>3</sub>, 1 g
&nbsp;MnCO<sub>3</sub> and 1 g FeCO<sub>3</sub>. After calculation of
equilibrium, you should get the following stable phase assemblage:</font>
<big><tt>"aq_gen" + "gas_gen" + "Calcite" + "Siderite" + "Magnetite" +
"Rhodochrosite"</tt></big> <font face="Helvetica, Arial, sans-serif">&nbsp;at
pH = 7.08, pe = -1.77, log f(CO<sub>2</sub>)
= -1.56, log f(O<sub>2</sub>) = -61.9, log m(Ca) = -2.47, log m(Mn) =
-4.98
and log m(Fe) = -4.78.&nbsp;</font></p>
<p> <br>
</p>
<h3><a name="GSM_SYSTEM_FROM_SCRATCH"></a><font
 face="Helvetica, Arial, sans-serif">3.7. Creating a New System
Definition (as an Alternative)</font></h3>
<p><font face="Helvetica, Arial, sans-serif">Any time when working
within your modelling project, you can start a new line of model
calculations by creating a new SysEq record "from scratch", instead of
"cloning" a previously displayed one. In this case, it is wise to
invent a completely new CSD name (third field of <a
 href="gdb_rkey.html#dbm_SysEq">SysEq record key</a>). Let us create
now a &nbsp;"parent" system for plotting calcite and ferrihydrite
solubility diagrams described in the <a href="#GSM_INVERSE_TITR">next
chapter</a>.&nbsp;<br>
</font> </p>
<p><font face="Helvetica, Arial, sans-serif">Re-start GEMS, open the
"Carbonat" project, go into the "Single Thermodynamic System" dialog,
select "Record" "Create" menu command and enter a new record key</font>
<big><tt>"Carbonat:G:CaFeSpecO:1:0:1:25:2:"</tt></big><font
 face="Helvetica, Arial, sans-serif">. In the appearing "SysEq: Remake
parameters" dialog, find the</font>&nbsp; <big><tt>tname</tt></big>
&nbsp;<font face="Helvetica, Arial, sans-serif">and</font> &nbsp;<tt><big>tnote</big>
</tt><font face="Helvetica, Arial, sans-serif">comment lines, type there</font>
<br>
</p>
<blockquote><tt><big> "Parent system for Ca and Fe speciation diagrams"<br>
"Example 2 for GEMS getting-started tutorial"</big><br>
  </tt></blockquote>
<p><font face="Helvetica, Arial, sans-serif">and press "Ok" to proceed.
Now, set the bulk composition according to the following recipe: 1000g
of</font> <big><tt>"Aqua"</tt></big><font
 face="Helvetica, Arial, sans-serif">, 300 kg of</font> <big><tt>"AtmAirNit"</tt></big><font
 face="Helvetica, Arial, sans-serif">, 0.2 mol of CaCO<sub>3</sub>, 0.2
mol of FeOOH, 0.1 mol of NaCl, 1e-6 mol HCl and 1e-6 mol of NaOH. Also
turn off the</font> <big><tt>"Goethite"</tt></big> <font
 face="Helvetica, Arial, sans-serif">and</font> <big><tt>"Hematite"</tt></big>
<font face="Helvetica, Arial, sans-serif">phases and set a&nbsp; 2.854
kJ/mol correction to G0 of </font>"<big><tt>Fe(OH)3(mic)"</tt></big> <font
 face="Helvetica, Arial, sans-serif">species in the </font><big><tt>"Ferrihydrite-mc"</tt></big>
<font face="Helvetica, Arial, sans-serif">phase. When ready, press the
"Calculate BCC" button. You should see a "Missing IC warning" dialog;
as we indeed do not want to consider Mn in this modelling series,
simply press "Check/Ok" and then again &nbsp;calculate BCC. This time,
nothing should happen; &nbsp;all solid phases of Mn appear turned off
(as well as the aqueous Mn species). Now, calculate the equilibrium
state and check total dissolved Ca and Fe.&nbsp; You should get log
m(Ca) = -3.09, log m(Fe) = -9.15 at pH = 8.322 and 0.103 molal
effective ionic strength.</font> </p>
<p><br>
</p>
<p> </p>
<p> </p>
<h3><a name="GSM_MORE_EQUILIBRIA"></a> <font
 face="Helvetica, Arial, sans-serif">3.8. More About Calculations of
Single Equilibria</font></h3>
<p><font face="Helvetica, Arial, sans-serif">There are some special
cases of GEM equilibria calculations, such as <a
 href="glossary.html#DT_sequential_reactors">sequential reactors</a>,
or
sorption systems. You can learn more about that in the <a
 href="ge_howto.html">ge_howto.html</a> and <a href="gems_scm.html">gems_scm.html</a>
specialized manuals. More detailed description of the GEM IPM-2 module,
its numerical controls, error messages, and troubleshooting (in
"stepwise"
calculation mode) is available in the <a href="gems_ipm.html">gems_ipm.html</a>
manual.</font><br>
<br>
</p>
<hr size="2" width="100%">
<p> </p>
<p><a name="END_GEMSTART"></a><font face="Helvetica, Arial, sans-serif"><a
 href="gemstar2.html">CONTINUE to the next part (gemstar2.html)</a></font>
</p>
<p><font face="Helvetica, Arial, sans-serif"><a href="gemstart.html">Table
of Contents</a></font> </p>
<p><tt>end of file</tt> <br>
&nbsp; </p>
&lt;from g_tutor.html&gt;<br>
<h2><font size="+2">Tutorial Guide &lt;merge with index from gems2
screenshot tutorial, move contents to gems_tutorial.html, and delete
the rest of this file&gt;<br>
</font></h2>
<hr size="2" width="100%">
<h3>Contents </h3>
<p>&nbsp; <br>
&nbsp;Under Construction<br>
</p>
<p>To be provided in Version 2.2<br>
</p>
<hr size="2" width="100%">
<p> &nbsp; </p>
<p>Tutorial </p>
<p>Index <br>
&nbsp;<br>
<br>
</p>
<p>Example 10 from the PHREEQC2 User's Guide <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#1999PARAPP">[1999PAR/APP]</a>
which should help you to compare the results obtained by using the
alternative Law-of-Mass Action (LMA) and Gibbs Energy Minimization
(GEM) techniques and to better understand their common features and
differences. <br>
</p>
<p><br>
</p>
<p><br>
</p>
<p> &nbsp; </p>
<h4> <a name="3_1_1_open_profile"></a>3.1.1 Opening a System Profile</h4>
<p><br>
To start chemical modeling calculations in GEMS means to open a system
profile. Just press the&nbsp; <tt><font size="+1">"</font>Computation
of Equilibria<font size="+1">"</font></tt>&nbsp; button on the Main
Dialog. A <font size="+1">"</font>System Profile<font size="+1">"</font>
dialog will appear with a list of available <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_profil.html">profile
definitions</a>. <br>
&nbsp; </p>
<p>One of the listed profiles is named "Default", it contains lists of
all the phases and components necessary for our worked example. Select
it with a left mouse click and then press <tt><font size="+1">"</font>Go!<font
 size="+1">"</font></tt> button to open the profile. In a few seconds,
you will see a&nbsp; <tt><font size="+1">"</font></tt>Computation of
Geochemical Equilibrium Models<tt><font size="+1">"</font></tt> dialog.
<br>
&nbsp; </p>
<p>Three wide buttons on this dialog (<tt><font color="#000000">SysEq,Process</font></tt>
and <tt>GtDemo</tt>) correspond to three main modes of geochemical
modeling available in this version of GEMS. Any modeling exercise
starts with construction of at least one single chemical system
definition (CSD), which can then be used as a template for creating
other similar definitions, or as a startpoint for the process
simulation. <br>
&nbsp; </p>
<p>So, we have to create a new system definition to model solubility of
(Ca,Sr)CO<sub>3</sub> solid solution in water under CO<sub>2</sub>
atmosphere. To do this,
press the <tt>"Single - System Equilibria (SysEq)"</tt>&nbsp; button
on the&nbsp; "Computation..." dialog. <br>
&nbsp; <br>
&nbsp; </p>
<h4> 3.1.2 Setting up bulk composition of the chemical system</h4>
<p><br>
&nbsp;Now, you are in the "Single Thermodynamic System" dialog
that provides easy access to various input data screen forms related
to chemical system definitions, as well as to the equilibrium
calculation
results. Both kinds of data for a single chemical system are stored in
the database as one record of&nbsp; <tt><a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_syseq.html">SysEq</a></tt>&nbsp;
type under a unique <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gdb_rkey.html#dbm_SysEq">record
key</a>. <br>
&nbsp; </p>
<p>A top left button group called&nbsp; "Records"&nbsp; helps you to
manage SysEq records. To set up a new chemical system definition means
to insert a new record in the database, and this process always begins
with creation of a new SysEq record key. So, proceed by doing a left
mouse click on the <tt>"Create..."</tt> button in the "Records" button
group. <br>
&nbsp; </p>
<p>A small but important dialog "SysEq: Please, enter a new record key"
appears now. It has eight text editor lines, each corresponding to a
field in SysEq record key format. You will see tool tips which tell you
the maximum length and the meaning of each field, if you keep the mouse
cursor on
a field for more than 2 seconds. Clicking on the <tt>"Help"</tt>
button
will open HTML page with more information, if necessary (don't forget
to
step back to the present page in Helpviewer window). <br>
&nbsp; </p>
<p>The first (top) field always contains the System Profile name and
must not be edited - any chemical system definition (CSD) is meaningful
only within the profile context where it was created. <br>
&nbsp; </p>
<p>The second field shows which potential function will be minimized
(this version of GEMS can minimize Gibbs energy only), type <tt>'G'</tt>
in. <br>
&nbsp; </p>
<p>The third field should keeps an identification name of the chemical
system (up to 12 characters long); enter <tt>'CaCO3_AQ'</tt> there
(assume
you've just invented this name for a new system). <br>
&nbsp; </p>
<p>The fourth field is necessary to keep track of changing bulk
composition of otherwise the same chemical system. It must contain a
non-negative integer made of one to five digits - the bulk composition
and configuration (BCC) variant number. Enter&nbsp; <tt>'1'</tt>&nbsp;
there - it is your first system! <br>
&nbsp; </p>
<p>The fifth field may contain volume constraint for the system (for
some special systems), but now put '0' to tell the program that the
volume is unconstrained. <br>
&nbsp; </p>
<p>The sixth field must contain pressure <i>P</i>&nbsp; (in bars) or 0
(then pressure <i>P<sub>sat</sub></i>&nbsp; will be computed from
temperature along the saturated vapor curve SVC); enter <tt>'1'</tt>
to set the ambient pressure 1 bar. <br>
&nbsp; </p>
<p>The seventh field must contain non-negative temperature <i>TC</i>&nbsp;
(in Centigrade); enter <tt>'25'</tt> to set the ambient temperature. <br>
&nbsp; </p>
<p>The eight and last field must contain a variant number of kinetic or
other CSD constraints of otherwise the same chemical system. Now, enter
<tt>'0'</tt> into this field. <br>
&nbsp; </p>
<p>So far, the "SysEq: Please, enter a new record key" dialog should
look like this: <br>
&nbsp; </p>
<p><img
 src="../../../../../../../../C:/GEMS2test/program/doc/html/syseqkey.png"
 nosave="" align="left" height="242" width="328"> <br>
&nbsp; </p>
<p>The packed key of this SysEq record will look like this:&nbsp; <tt>"Default:G:CaCO3_AQ:1:0:1:25:0:"<font
 size="+1">. </font></tt>Now, press the <tt>"Ok"</tt> button. In a
small
"Reallocation of data arrays" dialog, you will see the above packed key
of
the record about to be created. Press the <tt>"Clear all"</tt> button
because
the first definition of the chemical system has to be created "from
scratch". Activation of the <tt>"Clear all"</tt> button forces the
program to fill
out all fields of SysEq records with default values and delete all
dynamic-memory data fields (if there were any). In contrast, the <tt>"Remake"</tt>
button retains all the information present in the SysEq data structures
and lets you re-organize it. The <tt>"Bypass" </tt>button (pressed in
most cases)
retains previous data and skips the whole remake process. <br>
&nbsp; </p>
<p>Pressing <tt>"Clear all" </tt>will pop up a configuration dialog
called "SysEq: Remake parameters", with many switches and counters
(don't change anything in them for this example calculation). Above the
<tt>"Ok"</tt> button, there are three string fields. The upper one is
called <tt>"tname"</tt> and it is advisable to enter there a few words
for identification of this chemical system definition. For
instance,&nbsp; type <tt>"My first aragonite- water-atmosphere system"<font
 size="+1"> </font></tt>(don't forget first to remove the "Empty"
placeholder <tt><font size="+1">`</font></tt>). The line below - <tt>"tnote"</tt>
- may contain some comments to the first line, for instance, your name.
Or, better, type <tt>"Following Example 10 from PHREEQC2"</tt>.&nbsp;
Leave third line (<tt>"tPhEQ"</tt>) blank and press the <tt>"Ok"</tt>&nbsp;
button. <br>
&nbsp; </p>
<p>After a few seconds (when the GEMS code configures memory and
collects thermodynamic data from the database files), you will see a
"Compos" page of the "System::" screen form. Except of two lines of
text you just typed in before, this page shows a list of <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_compos.html">predefined
composition objects</a> (Compos record keys) which you can, optionally,
use for constructing the bulk composition of your system. <br>
&nbsp; </p>
<p>Left mouse clicking on any of the page selector buttons in the
window top
left corner will show you other pages with lists of accessible record
keys
and (input) data for the species (<tt>"DComp"</tt> button), phases (<tt>"Phase"</tt>
button ), and stoichiometry units (<tt>"IComp"</tt> button). <br>
&nbsp; </p>
<p>Contents of any input data record accessible to this system profile
will be shown in a separate window if you click on the respective list
item and then press&nbsp; <tt>F7</tt>&nbsp; key (close such windows
after
looking into them). Pressing <tt>F1</tt> key after clicking on
any&nbsp;
data field will show you the appropriate HTML documentation page. All
the data fields show tool tips, also visible (after a mouse click) with
data object label and cell indices in the bottom (status) line of the
window. <br>
&nbsp; </p>
<p>Now, let's get back to our <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/KSExamp/casrco3.html">modeling
example</a>. The initial composition of aqueous phase is defined as
calcium bicarbonate solution at equilibrium with pure aragonite at
nearly
1 bar partial pressure of CO<sub>2</sub> gas. The easiest way to set
such a composition is to take 1 kg of water, 1 mole of CO<sub>2</sub>,
and 1 mole of CaCO<sub>3</sub>, and let it equilibrate (in absence of
other solid phases except aragonite) at 1 bar and 25 C. <br>
&nbsp; </p>
<p>Go to "DComp" page of "System" window and scroll down the "DCvp"
list until
you find the water solvent (<tt>"a&nbsp;&nbsp;
Zw_&nbsp;&nbsp;&nbsp;&nbsp; H2O@&nbsp;&nbsp;&nbsp; "</tt> record key).
In a cell to the right, change "M" to "g" to set gram units, and in the
next cell to the right ( in <tt>"xd_"</tt> column), enter "1000". This
will add 1 kg of H<sub>2</sub>O stoichiometry to the bulk composition
of the system. <br>
&nbsp; </p>
<p>Down in the "DCvp" list, find the record key of CO<sub>2</sub>&nbsp;
gas (<tt>"g&nbsp;&nbsp; C+4&nbsp;&nbsp;&nbsp;&nbsp;
CO2&nbsp;&nbsp;&nbsp; "</tt>), and put "1" in the corresponding cell of
the&nbsp; <tt>"xd_"</tt> vector. The (unchanged) <tt>'M'</tt> code to
the left tells you that
you are adding one mole of CO<sub>2</sub> stoichiometry to the bulk
composition; other useful <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_useref.html#QUANCONCUNITS">"quantity-concentration"
codes</a> are <tt>'g'</tt> (grams), <tt>'m'</tt> (molality), <tt>'i'
</tt>(millimolality) and <tt>'%'</tt> (mass percent).&nbsp; In the
same way, put 1e-4 moles of O<sub>2</sub> stoichiometry to set up redox
state of the system (assumed to be slightly oxidizing). <br>
&nbsp; </p>
<p>Finally, go up the "DCvp" list, find&nbsp; <tt>"a&nbsp;&nbsp;
Ca&nbsp;&nbsp;&nbsp; Ca(CO3)@&nbsp;&nbsp; "</tt>&nbsp; entry and put <tt>'1'</tt>
into the respective cell of the&nbsp; <tt>"xd_"</tt> vector to the
right, to add 1 mole of CaCO<sub>3</sub>&nbsp; to the bulk composition
of the system. Please, note that we add here 1 mole of stoichiometry of
the neutral CaCO<sub>3</sub> aqueous species; we could also use the
dependent component aragonite to do this. In any case, non-zero numbers
in <tt>"xd_"</tt> vector do not prescribe that the respective DCs must
appear at equilibrium; this can be decided only upon completion of the
GEM calculation. <br>
&nbsp; </p>
<p>Now, select the "IComp" page of "System" window. You will see a
scroll list <tt>"ICvp"</tt> of accessible independent components and a
<tt>"B_"</tt> vector-column tied to <tt>"ICvp"</tt> on the right side.
The <tt>"B_"</tt> vector still contains only zeros, which means that
the input bulk composition of the system has not yet been calculated.
To do it, find the GEMS&nbsp; "Single Thermodynamic System" dialog on
your desktop and press a large "BCC" button, located in "Calculations"
button group at the bottom right corner of the dialog window. <br>
&nbsp; </p>
<p>After one or two seconds, you should see the "IComp" page of
"System" window
and in the middle of it - a lengthy but important dialog shown below: <br>
&nbsp; </p>
<p><img
 src="../../../../../../../../C:/GEMS2test/program/doc/html/bcccheck.png"
 nosave="" height="291" width="494"> <br>
&nbsp; </p>
<p>Put mouse pointer on the title of this dialog (where you see the
record key of SysEq record to be created) and drag it away to see
contents of the <tt>"B_"</tt> vector-column. The program calculated 2
moles of carbon, 1 mole of calcium, 111.01687 moles of hydrogen, and
60.508434 moles of
oxygen; the remaining cells (for other chemical elements) contain
zeros. <br>
&nbsp; </p>
<p>Since zero or negative quantities of independent components cannot
be considered
in calculation of equilibria, the above dialog reports you about this
situation
and suggests that it will automatically switch off all such IC, all
species
containing them, and all (single component) phases referring to those
species.&nbsp;
Look at the leftmost column on the "IComp" page: the independent
components
prepared to be switched off are now marked with asterisks <tt><font
 size="+1">'*'</font></tt>, and those about to be retained - with
pluses
<tt><font size="+1">'+'</font></tt>. <br>
&nbsp; </p>
<p>The program cannot decide for you - you might have forgotten to add
some ingredients to the system composition (in principle, you can find
it
out by examining the <tt>"B_"</tt> vector or its switch list). An
alternative is to fill zero elements of the <tt>"B_"</tt> vector with
"trace" values, and then re-examine how your bulk composition is
specified. Do not try to calculate the equilibrium if the above
diagnostic message appears after pressing the <tt>"BCC"</tt> button! <br>
&nbsp; </p>
<p>In case of our example, obviously, the rest of independent
components can
be safely switched off, so press <tt>Enter</tt> or click on the <tt>"EXCLUDE"</tt>
button. You will see minuses against all the discarded ICs, which means
that they will not be taken into the chemical system definition to
calculate the equilibrium state. <br>
&nbsp; </p>
<p>Now, Select the "Phase" page. You will see a (more or less) long
list of
phases (Phase record keys) linked to the system profile, and also a
switch list to the left, with all phases that do not conform to the
bulk composition already switched off. In the list, aqueous phase is
always the first
one, followed by the gas phase. Next to the gas phase, other
multi-component phases are listed (solid solution, sorption etc.),
followed by single
component phases. This order is required by the GEM IPM numerical
kernel
of Selektor codes. <br>
&nbsp; </p>
<p>Some of the phases, e.g. <tt>"Ca-stronti-sub"</tt> (Ca-strontianite
solid solution) are still switched on; obviously, in the present
example,
you have to switch them off by hand (just typing in minuses instead of
pluses in the selection column). By doing so, make sure that the
following
phases remain switched on: </p>
<ul>
  <li> <tt><font size="+1">aq_gen</font></tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(generic aqueous electrolyte phase)</li>
  <li> <tt><font size="+1">gas_gen</font></tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(generic ideal gas mixture)</li>
  <li> <tt><font size="+1">Graphite</font></tt></li>
  <li> <tt><font size="+1">Aragonite</font></tt></li>
  <li> <tt><font size="+1">Portlandite</font></tt></li>
</ul>
<p><br>
Select now the "DComp" page. You will also see a list of all species
available to the system profile, arranged according to the order of
phases in the list on "Phase" page. Number of species in each phase is
provided in the <tt>"L1vp"</tt> column on the "Config" page; you can
use this information to locate species of a given phase in the <tt>"DCvp"</tt>
list. Hydrogen ion and water solvent always stay at the end of species
list in the aqueous phase. For such examples like the present one, it
is advisable to switch off&nbsp; H<sub>2</sub>O gas from the gas phase
- then the amount of aqueous phase at equilibrium will not depend on
mass
ratio of gas to aqueous phase. Just scroll the <tt>"DCvp"</tt> list
until
you find the <tt>"g:O-2:H2O: "</tt> species and put <tt><font
 size="+1">'-'</font></tt>&nbsp; instead of <tt><font size="+1">'+'</font></tt>
against it. <br>
&nbsp; </p>
<p>Now, go back to the "IComp" page, then to the "Single Thermodynamic
System" dialog on your desktop, and press the <tt>"BCC"</tt> button
again. If, after 1-2 seconds, the "Switch off" warning dialog does not
appear, then your system definition is internally consistent and ready
for calculation of equilibrium state. Otherwise, check what's wrong in
the System window pages, make corrections and press the <tt>"BCC"</tt>
button again. Close the "System" window by pressing the "Close" button,
when finished. <br>
&nbsp; <br>
&nbsp; </p>
<h4> 3.1.3 Running GEM IPM to obtain equilibrium speciation</h4>
<p><br>
Go into the "Single Thermodynamic System" dialog. Make sure that the <tt>"Simplex"</tt>
check box is ticked, and left-click the large
<tt>"IPM</tt>" button. This will create an IPM internal data structure
and submit it into the GEM IPM numerical module for calculation of
equilibrium
state in the "Automatic Initial Approximation" mode. When the IPM
starts,
you will see an "IPM Minimization Progress" dialog. It shows some
(periodically updated) vital information, such as the key of currently
loaded SysEq
record where the results will be stored&nbsp; (in this case, <tt>"Default:G:CaCO3_AQ:1:0:1:25:0:"</tt>);
the number of performed IPM iterations; basic information about the
chemical system (total masses of gas, liquid and solid phases in grams;
pH, pe and IS of the aqueous electrolyte phase). <br>
&nbsp; </p>
<p>When calculation of equilibrium is finished (usually in less than 1
sec), the "Single Thermodynamic System" dialog will show a word
"Converged..." in the title and two buttons <tt>"Accept"</tt> and <tt>"Discard"</tt>
at the bottom. Pressing the first (<tt>"Accept"</tt>) button will pack
the
definition of chemical system and results of calculation into SysEq
record
and save it into the database under the currently selected record key
(just
do it now). The <tt>"Discard"</tt> button will get you back to the
"Single
Thermodynamic System" dialog without saving the results (for instance,
when such SysEq record exists and something goes wrong with the last
calculation).
The SysEq record is saved also when you press the&nbsp; <tt>"Save"</tt>
button on the "Single Thermodynamic System" dialog. <br>
&nbsp; </p>
<p>You can (if you like) immediately check how good is the equilibrium
speciation that just has been&nbsp; calculated. Uncheck the "Simplex"
check box
below the "IPM" button and press this button again. This will run the
GEM IPM module using the previously calculated speciation as initial
approximation. If you see on the "Single Thermodynamic System" dialog
that the program has converged in 0 or 1 iterations and other numbers
(e.g. pH) are the
same, than the previously calculated result was OK. Press the "Accept"
button to save the results. <br>
&nbsp; <br>
&nbsp; </p>
<h4> 3.1.4 Examining the results</h4>
<p><br>
</p>
&nbsp;
<p>There is a&nbsp; <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/GEMS-Linux-USREF.html#P6880">Calculator</a>&nbsp;
widget which lets you do calculations "on the fly" (make sure that IPM
calculation results are saved before doing this). For instance, go back
to the <tt>EqIC</tt> page and click on the first cell of <tt>lgm_t</tt>
column, then press <tt>F8</tt>. A "Data Object Cell Calculator" widget
will appear on your desktop. Click on <tt>"Select all cells"</tt>
button, then on <tt>"10^x"</tt> button, and finally - on <tt>"Ok-Do
It!"</tt>. The "Calculator" disappears, and you will see total
molalities instead of their logarithms in the&nbsp; <tt>lgm_t</tt>
column. Repeat the operation (selecting <tt>"log x"</tt> on the
Calculator widget) to restore the initial numbers in the<tt> lgm_t</tt>
column. The <tt>F1, F7</tt> and <tt>F8</tt> hot key functionality can
also be selected from a small pop-up menu when you do a right mouse
click on any data field cell. <br>
&nbsp; </p>
After you have finished examination of results, press <tt>"Close"</tt>
button to return to the "Single Thermodynamic System" dialog. From
there you may want to print the system definition and results of
calculation of equilibrium state into a text ASCII file. In this case,
click on any of the buttons in the "Print/Export" group (bottom right
corner) and select the file name and directory where to print the file
in the appearing dialog. <br>
&nbsp; <br>
<br>
<h4> 3.1.5 Modifying chemical system definition</h4>
<p><br>
Compare pH=6.11 and total dissolved Ca=12.34 mmolal, calculated
in the previous example, to that taken in the PHREEQC2 manual example
(pH=5.93, total Ca = 3.932 mmolal). We see that our pH is about 0.2
units
higher and total dissolved Ca&nbsp; - 3 times greater than in the
original
example. Could this difference be related to different data in
thermodynamic
database? <br>
&nbsp; </p>
<p>Let us examine input thermodynamic data. On the "Single
Thermodynamic
System" dialog, click a <tt>"Thermodynamic data at T, P"</tt> button
in the
"Input..." group. A "MTparm" window appears with a large&nbsp; <tt>DCvp</tt>&nbsp;
list of Dependent Component record keys available to the system
profile.
Drag the scroll bar near this list down until you see a record key <tt>"s:CaCO:aragonite:&nbsp;&nbsp;
"</tt> and&nbsp; <tt>"s:CaCO:calcite:&nbsp;&nbsp; "</tt> immediately
next to it. Click&nbsp; on the corresponding cell in a&nbsp; <tt>gTP</tt>
column to the right of <tt>"s:CaCO:aragonite:&nbsp;&nbsp; "</tt> list
line. This cell contains -1127400 (J/mol) - the standard state Gibbs
energy of aragonite, taken into our equilibrium calculations. By
clicking
on the record key and pressing <tt>F7</tt> you will see that the data
for
aragonite comes from the [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1995ROB/HEM%5D">1995ROB/HEM</a>]
database. <br>
&nbsp; </p>
<p>Close this DComp window and, by scrolling <tt>DCvp</tt> list up,
find
also <i>G</i><sup>o</sup> data for Ca<sup>+2</sup> (-552790) and CO<sub>3</sub><sup>-2</sup>
(-527983 J/mol) aqueous ions. From these data one obtains that the
actual thermodynamic solubility product of aragonite (log<i>K&nbsp; </i>=
-8.169) is greater than that in the PHREEQC2 example (log<i>K&nbsp; </i>=
-8.336) by 0.167 logK units. Therefore, to obtain the same solubility
of aragonite as in the PHREEQC2 example, the standard state Gibbs
energy of aragonite at 25 <sup>o</sup>C must be decreased by
0.167*5708 = 955 J/mol (from
-1127400 to -1128355 J/mol).. <br>
&nbsp; </p>
<p>Luckily, such trial corrections can be made in GEMS chemical system
definitions, without actual modification of thermodynamic database.
Just get back to the <tt>"s:CaCO:aragonite:&nbsp;&nbsp; " </tt>line
which is located before&nbsp; <tt>"s:CaCO:calcite:&nbsp;&nbsp; "</tt>
in the <tt>DCvp</tt> list and, in the corresponding cell of a <tt>gEx_</tt>
column to the right, type&nbsp; -955. Now, the&nbsp; <i>G<sup>0</sup></i>&nbsp;&nbsp;
value of aragonite, actually taken into the IPM calculation, will be
-1127400 + (-955) =
-1128355 J/mol, which corresponds to solubility product log<i>K&nbsp;</i>
= -8.336, as required. <br>
&nbsp; </p>
<p>What remains to do in order to see how this correction affects the
equilibrium speciation and pH? Just close the MTparm window and press
the large
"IPM" button on the "Single Thermodynamic System" dialog - to calculate
the equilibrium again. Press "Accept" button on the IPM progress dialog
and then examine the results ("Dual Solution" button). <br>
&nbsp; </p>
<p>In the EqIC page of EqDemo window, the following total solubilities
should appear now: <br>
&nbsp; <br>
&nbsp;
<table border="3" cellpadding="3" cellspacing="3">
  <tbody>
    <tr>
      <td><tt><font size="+1">ICnam</font></tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <tt><font size="+1">lgm_t</font></tt></td>
    </tr>
    <tr>
      <td>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-1.26083</td>
    </tr>
    <tr>
      <td>Ca&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-1.97559</td>
    </tr>
    <tr>
      <td>H&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-1.67493</td>
    </tr>
    <tr>
      <td>O&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-0.88324</td>
    </tr>
    <tr>
      <td>Zz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0</td>
    </tr>
  </tbody>
</table>
</p>
<p>The total dissolved calcium is now 10.58 mmolal, about 2 mmolal less
than that obtained with the uncorrected <i>G<sup>o</sup></i>&nbsp; of
aragonite. Let us check the solubility product that actually has been
used in the last GEM calculation. Pick up the <tt>EqDC </tt>page and,
in the <tt>lga</tt> column, find log activity of Ca<sup>+2</sup> (
-2.285) and that of CO<sub>3</sub><sup>-2</sup>&nbsp; ( -6.051). Their
sum is quite close to&nbsp; -8.336 - the implied log<i>K</i>&nbsp;&nbsp;
for aragonite.&nbsp; Go to the <tt>EqGen</tt> page and check the
calculated pH there (6.047). This pH is slightly lower than in the
previous example run (6.11), but quite close to that listed in the
original experiments of Plummer and Busenberg [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>],
Table 4 (6.07 - 6.08) at PCO<sub>2</sub> around 0.96 (atm?). Our
calculated total dissolved calcium - ca. 10.6 mmolal - is also in good
agreement to solubility data (ca. 11 mmol/kg soln of Ca+Sr) from this
table at the lowermost mole fraction of aragonite (0.83%). From this we
can conclude that the GEM model is now good enough to proceed, even
though we cannot explain the difference with the initial values of pH,
total dissolved
Ca and C&nbsp; given in the PHREEQC2 example. <br>
&nbsp; </p>
<p>Next, we can&nbsp; test what happens if we include water vapor into
the gaseous phase (you may remember that H<sub>2</sub>O&nbsp; gas has
been excluded when we constructed the first system definition). Open
the "System" window, <tt>DComp</tt> page, and scroll down the <tt>DCvp</tt>
list until you find the <tt>"g:O-2:H2O:&nbsp; "</tt> record key. Just
to the left of it, change '-' to '+' to switch the species on, then
select <tt>"Phase"</tt> page, and press once or twice the <tt>"BCC"</tt>
button on the "Single Thermodynamic System" dialog. If nothing happens
and the plus against water vapor does not disappear, close the System
window and calculate the new equilibrium state (surprisingly, by
pressing the <tt>"IPM"</tt> button). Accept the
results and go into the "EqDemo" window (<tt>EqGen</tt> page) to check
them. The pH now is 6.054 and fCO<sub>2</sub> is 0.974 bar (0.9615 atm)
- even closer to the experimental data in [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>]
Table 4 than before. Clearly, the partial pressure of CO<sub>2</sub>
is lowered by the water vapor partial pressure (0.026 bar) at fixed
total
pressure of 1 bar at 25 <sup>o</sup>C. <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; </p>
<h4> 3.1.6 Creating a new chemical system definition</h4>
<p><br>
Next, you may wish to explore how the equilibrium state may change with
temperature and/or pressure. This is very easy to do in GEM-Selektor -
it just requires to create a new SysEq record using the old one as a
template. Following the aragonite-water example, let us try the last
definition of our chemical system at 1 bar, 76 <sup>o</sup>C. If you
closed the GEMS work session since the last exercise (Section 3.1.5)
then start the program again, open the "Default" profile, go to the
"Single Thermodynamic System" dialog, press the <tt>"Load..." </tt>button&nbsp;
of the "Records" button group, select (mouse click) the system <tt>"Default:G:CaCO3_AQ:1:0:1:25:0:"</tt>
from the appearing list, and press <tt>"Ok"</tt>. Using one of the
available chemical system definitions as a template is always the
easiest way to
create a new, similar one. <br>
&nbsp; </p>
<p>Now, press the <tt>"Create"</tt> button. In the "SysEq: Please,
enter
a new key" dialog, you will see the above record key in a disassembled
form, each part in a separate text line editor fields. In the
temperature field (second from the bottom), change 25 to 76 (to set
temperature in 76 <sup>o</sup>C) and press <tt>"Ok"</tt>. The
following dialog will appear: <br>
&nbsp; </p>
<p><img
 src="../../../../../../../../C:/GEMS2test/program/doc/html/syseqrem.png"
 nosave="" align="left" height="131" width="318"> <br>
&nbsp; </p>
<p>As we want to change only temperature and leave the rest intact,
don't press "Clear all" or "Remake" buttons, but carefully click on the
"Bypass" button. This will retain everything unchanged in the program
memory,
except thermodynamic data for species (automatically recalculated to
76 C 1 bar) and the SysEq record key. In a second delay, you will see
the "System" window; add <tt>"run at 76 C"</tt> to the <tt>tnote</tt>
field,
if you like. Close the "System" window and press the "IPM" button to
compute
a new equilibrium state. Accept results (pH = 6.14, IS =&nbsp; 0.01)
and examine pages of the EqDemo window. <br>
&nbsp; </p>
The calculated total dissolved calcium - 3.6 mmolal - is in good
agreement with data from&nbsp; [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>]
Table 4 at lowermost strontianite mole fractions (3.5-3.7 mol/kg soln).
log<i>K </i><sub>sp</sub> = -8.829, calculated from log activities of
Ca<sup>+2</sup> and CO<sub>3</sub><sup>-2</sup> ions (as described
above),
is only 0.003 units different from that listed in their table (-8.826).
Calculated P(CO<sub>2</sub>) = 0.67 bar is higher than reported (around
0.6 atm), most probably because of neglection of the non-ideal mixing
of H<sub>2</sub>O and CO<sub>2 </sub>in gaseous phase (see [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1994NOR/MUN%5D">1994NOR/MUN</a>]);
pH = 6.14 is, accordingly, somewhat lower (pH around 6.2 is given&nbsp;
in Table 4 of&nbsp; [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>]).
<br>
<br>
<br>
<br>
<p>Let us come back to our numerical example - the <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/KSExamp/casrco3.html">aragonite-strontianite
SSAS equilibrium system</a>. Now, we will define a parent record to
this system in order to investigate later on, how aqueous and
solid-solution speciation changes upon addition of SrCO<sub>3</sub>&nbsp;
to the bulk chemical composition. The parent system will be constructed
from the aqueous solution, previously equilibrated with aragonite and CO<sub>2</sub>
atmosphere (fCO<sub>2</sub> = 0.97 bar) at 25 <sup>o</sup>C
temperature and 1 bar total
pressure. Since, unlike fixed composition phases, solubility of solid
solutions
depends on the solid/water (S/W) ratio, this ratio must be also known.
We could not figure it out from the PHREEQC2 Example 10 and hence will
take S/W the same as in the original experiments&nbsp; [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>]
- about 20 g/L. The advantage is that the direct comparison of
calculated and measured concentrations should then be possible. <br>
&nbsp; </p>
<p>From Main Dialog of GEMS, go into "Calculation of Equilibria" mode
and open the "Default" system profile. Go into the "Single
thermodynamic
system" dialog and load the previously developed SysEq record <tt>"Default:G:CaCO3_AQ:1:0:1:25:0:"
</tt>(with H<sub>2</sub>O vapor switched off and corrected solubility
product of aragonite)<font size="+1">. </font>Press the <tt>"IPM"</tt>
button to re-calculate it, accept the results and open the "EqDemo"
window,
<tt>EqIC</tt> page. In the whole <tt>lgm_t</tt> vector, convert
numbers
from logarithmic to molal scale (using the <tt>F8</tt> key, calculator
widget),
and write down the initial composition of aqueous solution - we will
need
it soon: <br>
&nbsp; <br>
&nbsp;
<table border="3" cellpadding="3" cellspacing="3">
  <tbody>
    <tr>
      <td><tt><font size="+1">ICnam</font></tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <tt><font size="+1">molal</font></tt></td>
    </tr>
    <tr>
      <td>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0.05376</td>
    </tr>
    <tr>
      <td>Ca&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0.01047</td>
    </tr>
    <tr>
      <td>H&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0.02092</td>
    </tr>
    <tr>
      <td>O&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0.12845</td>
    </tr>
  </tbody>
</table>
</p>
<p>Now, close the "EqDemo" window and press <tt>"Create"</tt> button,
then enter a new record key <tt>"Default:G:CaSrCO3SS:0:0:1:25:0:"<font
 size="+1">,</font></tt>press <font size="-1">"Ok"</font> and then <tt>"Clear
all"</tt>. In the appearing "SysEq: Remake parameters" dialog, type in <tt>"Parent
aragonite- strontianite SSAS system"</tt> as a name of the system and <tt>"Following
PHREEQC2 Example at 25 C"</tt> as a comment. Press
<tt>"Ok"</tt> when ready; the "System" window, <tt>Compos</tt> page
appears.
Find a pre-defined composition "Aqua" in the <tt>CCvp</tt> list and,
to
the right of it, type 993 to set 993 grams of H<sub>2</sub>O in the
bulk
composition. Also, find the Mwat (<tt>Masses[0,1]</tt>) cell in the
first
row below the title (hint: click on different cells and watch the
bottom
status line of the window) and put 0.993 (kg) in there as a base for
molality-into-moles
conversion. This is necessary for specifying parts of the system bulk
composition
in molality units (i.e. moles per 1 kg H<sub>2</sub>O), and, in
principle,
is used only at the stage of system formulation; the Mwat quantity in
not
necessarily the quantity of water-solvent <i>after</i>&nbsp;
calculation
of equilibrium state. <br>
&nbsp; </p>
<p>Why did we add 993 grams of H<sub>2</sub>O to the system
composition?
This is because we wanted to have 20 g/L S/W ratio (volume refers to
the
suspension, i.e. water + aragonite). The density of aragonite is about
3
g/cm<sup>3</sup>, so the volume of 20 g of aragonite is about 7 cm<sup>3</sup>.
The remaining 993 cm<sup>3</sup> of water would then have a mass of
about
993 g (neglecting the fact that density of water is slightly below 1 at
25
<sup>o</sup>C). More precise calculation, of course, is possible. <br>
&nbsp; </p>
<p>Now, go to the "<tt>IComp"</tt> page. Find the&nbsp; <tt>bi_</tt>
column and, to the left of it, change <tt>'M'</tt> characters to <tt>'m'</tt>&nbsp;
for&nbsp; C, Ca, H, O, and Sr, to set molality units for the respective
cells of the <tt>bi_</tt> column. Then enter in these cells (<tt>bi_</tt>
column) the numbers from the table above and the arbitrary trace amount
0.5e-7 molal for strontium. This will add salt composition of water
previously equilibrated with aragonite, as well as some trace
strontium, to total
bulk composition of the system. <br>
&nbsp; </p>
<p>Next, switch to the <tt>"DComp"</tt> page and set 0.97 mol of CO<sub>2</sub>
gas, 0.03 mol H<sub>2</sub>O gas, and 0.0001 mol of oxygen gas in the <tt>xd_</tt>
vector there. Scroll a little bit down the <tt>DCvp</tt>
list to find aragonite and (below it) strontianite lines. To the left
of aragonite entry, change <tt>'M'</tt> code (moles) to <tt>'g'</tt>
(grams)
and put 20 in the respective cell of the <tt>xd_</tt> vector, to add
20
g of CaCO<sub>3</sub> to the system. In a similar way, add 7.5e-6 g of
strontianite
stoichiometry (approximately 0.5e-7 mol). Then close the "System"
window.
<br>
&nbsp; </p>
<p>Go to the&nbsp; "Single thermodynamic system" dialog and press the <tt>"BCC"</tt>
button. On the appearing warning message, press <tt>"Switch off"</tt>
and then examine the <tt>IComp</tt> page on the "System" dialog
window. The <tt>B_</tt> column (total bulk chemical composition of the
system
in moles) should contain all zeros except C (1.223205 mol), Ca
(0.210218
mol), H (110.32052 mol), O (57.81709 mol), and Sr (1.0045e-7 mol). If
something goes wrong, check setup of the bulk composition as described
above. <br>
&nbsp; </p>
<p>What remains is to configure a set of phases to be taken into
equilibria calculations. To do it, go to <tt>"Phase"</tt> page and
make sure that only the phases from the following list are selected
(switched on with
pluses in the first column): </p>
<ul>
  <li> <tt><font size="+1">aq_gen</font></tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(generic aqueous electrolyte phase)</li>
  <li> <tt><font size="+1">gas_gen</font></tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(generic ideal gas mixture)</li>
  <li> <tt><font size="+1">Ca-stronti-sub</font></tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(solid solution of Ca-strontianite)</li>
  <li> <tt><font size="+1">Sr-aragonit-sub</font></tt>&nbsp;&nbsp;&nbsp;&nbsp;
(solid solution of Sr-aragonite)</li>
  <li> <tt><font size="+1">Graphite</font></tt></li>
  <li> <tt><font size="+1">Portlandite</font></tt></li>
</ul>
Make sure that single component phases Calcite, Strontianite and
Sr-oxide are switched off. Two (Ca,Sr)CO<sub>3</sub> solid solution
phases are included because of possible phase separation (miscibility
gap). These phase definitions are identical, except that in the first
one,&nbsp; the strontianite end member is declared "Major", and the
aragonite
end member "Junior" (you can see it by clicking on phase name and
pressing
<tt>F7</tt>, the <tt>'M'</tt> and <tt>'J'</tt> characters in a <tt>PhDCC</tt>
classifier in "Phase" window). In the second solid solution, the
aragonite
end member is declared "Major" and the strontianite - "Junior". The
difference
between "Major" and "Junior" is that, only at automatic (simplex)
initial
approximation, GEM-Selektor takes the "Junior" phase component with an
activity coefficient artificially set to 1000. Thus, two (otherwise the
same) phases get initially different compositions. If total bulk
composition
of the system falls into the miscibility gap, the compositions of two
solid solution phases will become more and more different on the IPM
iterations
and will converge at the solvus edges. Otherwise (outside miscibility
gap),
both phases either will converge to the same mole fractions of end
members,
or one of them will be eliminated from the mass balance. See textbooks
(e.g.
[<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1994NOR/MUN%5D">1994NOR/MUN</a>],
p.141) to learn more about immiscibility in non-ideal solid solutions. <br>
&nbsp;
<p>You probably remember that thermodynamic data used in GEM-Selektor
kernel database produce slightly different solubility products of
aragonite
than that given by Plummer and Busenberg [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>].
Previously, for the aragonite-water system, we made a -955 J/mol
correction to <i>G <sup>0</sup></i><sub>298</sub> value of aragonite
to get log<i>K</i><sub>sp</sub> = -8.336 at 25 C, as required. Now, we
have to go to "MTparm" window (<tt>"Thermodynamic Data at T, P"</tt>
button on the&nbsp; "Single thermodynamic system" dialog) and apply
this correction again (in <tt>gEx_</tt> column), this time to&nbsp;
aragonite end members in both solid solution phases. With strontianite,
however, the required correction is much stronger. Click on its record
key and press <tt>F7</tt> to examine the DComp database record of
strontianite. Robie and Hemingway [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1995ROB/HEM%5D">1995ROB/HEM</a>]
provide <i>G <sup>0</sup></i> = -1137600 J/mol with uncertainty 1500
J/mol. Taking data for Sr<sup>+2</sup> and CO<sub>3</sub><sup>-2</sup>
ions from SUPCRT92 (see "MTparm" window), one obtains log<i>K</i><sub>sp</sub>
= -8.02&nbsp; by far too high from -9.271 from [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>].
The difference is -1.25 p<i>K</i> units, or&nbsp; -7137 J/mol! There
might be a problem with the number from [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1995ROB/HEM%5D">1995ROB/HEM</a>];
anyway, we have to make a correction (-7137 to <tt>gEx_</tt> cells for
both strontianite end members) in order to stay consistent with the
solid solution model of Plummer and Busenberg. Do it and close the
"MTparm" window. <br>
&nbsp; </p>
<p>Finally, press the <tt>"BCC"</tt> button one or two times to make
sure that you have no more warnings, and press the <tt>"IPM" </tt>button
to calculate equilibrium state. Accept it and go to the "EqDemo" window
to examine results. Let's begin with the <tt>"EqGen"</tt> page. What
you
see is that pH = 6.054 and f(CO<sub>2</sub>) = 0.974 bar are the same
as
in the Sr-free aragonite-water system - which is expected because we
added
only trace amount of total strontium (1e-7 moles) to the system. Check
the
total dissolved molalities (<tt>lgm_t</tt>) on the <tt>EqIC</tt> page:
Ca
10.467 mmolal (again the same as in the Sr-free system) and Sr is
5.6e-8
molal, e.g. about a half of it is retained in the solid solution phase
(aragonite). <br>
&nbsp; </p>
<p>Let us check the phases we have at equilibrium (<tt>EqPh</tt> page).
From the numbers in <tt>Fa</tt> column we conclude that all three
phases present are stable;&nbsp; <tt>Ca-stronti-sub</tt> phase
(strontianite with some calcium) has been eliminated. There are 20.0002
grams of the <tt>Sr-aragonit-sub</tt> phase - which means that the
system was formulated correctly and can
indeed be used as a parent to simulate the process of changing Sr/Ca
ratios in solid phase composition. <br>
&nbsp; </p>
<p>Now, let us examine the speciation (<tt>EqDC</tt> page). In the <tt>x</tt>
vector, we see that aqueous Sr is present mainly as Sr<sup>+2</sup>
ion and Sr bicarbonate complex - pretty similar to calcium. Scroll down
to see the carbonate solid solution end members. Strontianite end
member
is present only in trace mole fraction 2.3e-7 (you can see it in the <tt>Wxx</tt>
column if you scroll down the whole EqDemo window). Activity
coefficient of aragonite (<tt>gamma</tt> column) is 1, but the activity
coefficient of strontianite end member is 189.46. Clearly, this is a
non-ideal solid solution model. Let us see how it is defined. <br>
&nbsp; </p>
<p>Go to the EqPh page, click on <tt>Sr-aragonit-sub</tt> phase name
and
press <tt>F7;</tt> the "Phase" window will appear, it has three pages.
<tt>Page 1</tt> just shows that the solid solution contains two end
members,
aragonite and strontianite, and the latter is declared "Junior". Select
<tt>Page 2</tt>. You will see there a DcEq text field with the
following
<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gmscript.html">math
script</a>: </p>
<blockquote><tt>$ Asymmetric model of aragonite-strontianite solution</tt>
  <br>
  <tt>$ for 25 C: A0 = 8490 J/mol A1 = -4510 J/mol</tt> <br>
  <tt>$ for 75 C: A0 = 7710 J/mol A1 = -3360 J/mol</tt> <br>
  <tt>ln_gam[0] =: ( Wx[1]^2 *(8490-4510*(4*Wx[1]-3)))/RT_; \@</tt> <br>
  <tt>ln_gam[1] =: ( Wx[0]^2 *(8490-4510*(4*Wx[1]-1)))/RT_; \@</tt> <br>
  <tt>$ end</tt></blockquote>
This math script calculates activity coefficients of the Guggenheim
asymmetric model for both end members at each iteration of the IPM
minimization algorithm (<tt>Wx</tt> is mole fraction, <tt>ln_gam</tt>
is natural logarithm of activity coefficient, <tt>RT_</tt> = 2479 for
25 C; all three variables are defined by the IPM algorithm before this
script is automatically
executed in each iteration; <tt>\@</tt> marks end of the group of
equations
for one component). That's it! In a similar way, you can create your
own
non-ideal phase model and keep it in the database together with other
<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_phase.html">phase
definitions</a>. <br>
&nbsp;
<p><a name="SIDEBAR_1"></a>A little sidebar: before proceeding with
setting up a process simulator, let's check what happens if we take 10
g of
CaCO<sub>3</sub> and 10 g of SrCO<sub>3</sub> in the bulk composition
of the system. According to [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>],
this would bring us inside&nbsp; the miscibility gap. Close the EqDemo
window and create a new system, with SysEq record key <tt>"Default:G:CaSrCO3SS:1:0:1:25:0:"<font
 size="+1">,</font></tt>press <tt>"Ok"</tt> and then <tt>"Bypass"</tt>.
In the&nbsp; the "System" window, go to <tt>DComp</tt> page, and in
the <tt>xd_</tt> column, change the previous numbers of grams of
aragonite and calcite
to 10 and 10. Add words <tt>"(miscibility gap)"</tt> to <tt>tnote</tt>
comment, close "System" window and press <tt>"IPM"</tt> button to
calculate the
new equilibrium state. Accept the results and open "EqDemo" window to
examine them. <br>
&nbsp; </p>
<p>On the <tt>EqPh</tt> page, you will see that four phases are now
stable; <tt>Ca-stronti-sub</tt> phase (strontianite with some calcium)
now appears in the amount of 10.888 g (there is also 9.022 g of <tt>Sr-aragonit-sub</tt>
phase). However, as seen on the <tt>EqDC</tt> page, the composition of
two carbonate solid solutions is now completely different: <br>
&nbsp; <br>
&nbsp;
<table border="3" cellpadding="3" cellspacing="3" width="68%">
  <tbody>
    <tr>
      <td>Phase</td>
      <td>End-member&nbsp;</td>
      <td>Type</td>
      <td>Mole <br>
fraction</td>
      <td>Activity&nbsp; <br>
coefficient</td>
    </tr>
    <tr>
      <td><tt>Ca-stronti-sub</tt></td>
      <td><tt>aragonite&nbsp;</tt></td>
      <td><tt>J</tt></td>
      <td><tt>0.1426</tt></td>
      <td><tt>6.9807</tt></td>
    </tr>
    <tr>
      <td><tt>&nbsp;</tt></td>
      <td><tt>strontianite&nbsp;</tt></td>
      <td><tt>M</tt></td>
      <td><tt>0.8574</tt></td>
      <td><tt>0.9800</tt></td>
    </tr>
    <tr>
      <td><tt>Sr-aragonit-sub</tt></td>
      <td><tt>aragonite&nbsp;</tt></td>
      <td><tt>M</tt></td>
      <td><tt>0.9952</tt></td>
      <td><tt>1.0002</tt></td>
    </tr>
    <tr>
      <td><tt>&nbsp;</tt></td>
      <td><tt>strontianite&nbsp;</tt></td>
      <td><tt>J</tt></td>
      <td><tt>0.0048</tt></td>
      <td><tt>173.96</tt></td>
    </tr>
  </tbody>
</table>
<br>
&nbsp; </p>
<p>As expected, we have now a mixture of two phases with the "most
stable" compositions on the edges of the miscibility gap, with quite
small fraction of SrCO<sub>3</sub> in Sr-aragonite phase. Plummer and
Busenberg [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>]
report that at 25 <sup>o</sup>C, the most stable aragonites should
contain 0.58 mol% of SrCO<sub>3</sub> (0.48% in our calculation) and
the most stable
strontianites - 82.8% SrCO<sub>3</sub> (85.7% in our calculation). We
will now proceed to the process simulation with this realistic SSAS
model.
Just close the "Single thermodynamic system" dialog to go back to the
"Computation of Equilibrium Models" dialog. <br>
<br>
</p>
<p> &nbsp; </p>
<h4>3.2.1 Setting up a Process Simulator</h4>
<p><br>
If you closed GEMS work session, start the program again, go into the
"Calculation of Equilibria" mode and open the "Default" system profile.
<br>
&nbsp; </p>
<p>From the "Computation of Equilibrium Models" dialog, click on a <tt>"Process
Simulation (Process)"</tt> button. This will bring you a (still empty)
"Process" module window. Select <tt>"Create"</tt> from the <tt>"Record"</tt>
menu to create your first <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_proces.html">Process
definition</a> record.&nbsp; You will see a dialog window entitled
"SysEq: Please, select a parent system for a new Process" with a list
of <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_syseq.html">SysEq
records</a> available in the "Default" profile.&nbsp; Click on the <tt>"Default:G:CaSrCO3SS:0:0:1:25:0:"</tt>&nbsp;
record key (to mark/select it) and press <font size="-1">"Ok"</font>
to proceed. Now, a small "Process: Please, enter a new key" dialog
appears with the last two lines containing asterisks <tt>'*'</tt> in
two fields added
to the above-mentioned record key. Replace <tt>'*' </tt>with&nbsp; <tt>'S'</tt>
in the last field, to indicate that the process will change bulk
composition independently of calculated equilibrium parameters. In a
field above (previous-to-last one), type <tt>"CaSr_r20gL"</tt> as a
process simulator identifier (because several processes can be defined
using the same parent SysEq record). Press <tt>"Ok"</tt> whe finished,
then <tt>"Clear all"</tt> on the appearing
"Reorganization of data fields" dialog. <br>
&nbsp; </p>
<p>This brings you into a "Process: Remake parameters" configuration
dialog - quite important in case of the Process definition. The first
two lines, as usual, should contain the full name of the record and
optional comments to it; type in something like that: <br>
&nbsp; </p>
<blockquote><tt>"Solubility of (Ca,Sr)CO3 as f(X_Sr) at 20 g/L"</tt> <br>
  <tt>"Expanding Example 10 from PHREEQC2 users guide"</tt></blockquote>
<p><br>
Below, there is a line of switches which control operation and data
structure of the Process module; click on each to read tool tips. It's
the right moment to think again what the process simulator must do. <br>
&nbsp; </p>
<p>To see the effect of bulk solid composition on equilibrium
solubility
of Ca and Sr and mole fraction of (Ca,Sr)CO<sub>3</sub> phase(s) at ca.
20
g/L S/W ratio, we need to "mix"&nbsp; <i>nu</i>&nbsp;&nbsp; grams of
CaCO<sub>3</sub> with (20 - <i>nu </i>) grams of SrCO<sub>3</sub>,
incrementing <i>nu</i>&nbsp; from, say, 0 to 20 with a 1 g step which
gives 21 points in total. The rest of the system definitions can be
left the same as in the parent system, because solubility of mixed
carbonate will not exceed a few millimolal, e.g. significant change of
S/W ratio is not likely to occur. The Process module generates new
SysEq records by duplicating ("cloning") the parent system, and then
applies necessary changes to these new records. <br>
&nbsp; </p>
<p>In our (pretty simple) case, it is sufficient to switch off (i.e.,
put minus instead of plus) <tt>PePsts[0,1]</tt> because temperature
and
pressure will be kept fixed, but make sure that <tt>PePsts[0,2]</tt>
is on since bulk composition will be changed, and <tt>PePsts[0,4] </tt>is
on - to save the newly created SysEq records to database. <tt>PePsts[0,10]</tt>&nbsp;
must be on because we will provide a math script for modifying bulk
compositions. Put also a minus in <tt>PePvv[0,10]</tt> to always use
the automatic
Simplex initial approximation in <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gems_ipm.html">GEM
IPM</a> calculations. Then proceed to the leftmost counter <tt>Ntxi</tt>
and set there 21 (points to be generated). You may also put&nbsp; 1
into <tt>PePdim[0,4]</tt> to set one bibliographic reference. Check
the switches once more and press <tt>"Ok"</tt>. <br>
&nbsp; </p>
<p>Now, you see <tt>Page 1</tt> of the "Process" window with the
record key and the name of the process simulator, but with several
empty fields, including a multi-line text editor field <tt>P_expr</tt>.&nbsp;
Many variants of the process simulation can be set up using one or more
of three-number column "iterators"&nbsp; <tt>iTm, iNv, iP, iTC, iV,
iTau, ipXi, iNu, ipH, ipe</tt>. Each of those has the following
structure: <br>
&nbsp; </p>
<dl>
  <dd> <tt>&lt;iterator_name&gt;[0]&nbsp; start (initial) value</tt></dd>
  <dd> <tt>&lt;iterator_name&gt;[1]&nbsp; limiting value</tt></dd>
  <dd> <tt>&lt;iterator_name&gt;[2]&nbsp; increment (0 - keep at start
value)</tt></dd>
</dl>
<p><br>
The Process module has also one work cell for each iterator, named <tt>cTm</tt>
(for <tt>iTm</tt> iterator), <tt>cNv</tt> (for <tt>iNv</tt>) and so
on; you can see all these work cells on <tt>Page 2</tt> of the
"Process" window. Contents of the work cells can be changed on every
iteration of the Process Simulator, either automatically using the
start and increment values from the respective iterator, or by the
user-defined math script (see
below). The first five iterators&nbsp; <tt>iTm, iNv, iP, iTC, </tt>and<tt>
iV </tt>are used&nbsp; by the program automatically to increment
respectively the <tt>cTm, cNv, cP, cTC, </tt>and<tt> cV </tt>work
cells and from these generate the last five fields of
newly-created&nbsp; <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gdb_rkey.html#dbm_SysEq">SysEq
record keys</a>.&nbsp; Other iterators are not incremented
automatically and may be used only in the Process math scripts
expressions to set work variables, such as <tt>cNu</tt>. The full list
of iterators, work cells and other data objects related to the Process
Simulators, which can be used
in math scripts, is available in the <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_useref.html">user's
reference</a> and in the <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_proces.html">Process
module documentation</a> files. <br>
&nbsp; </p>
<p>In the&nbsp; <tt>iTm</tt>&nbsp; iterator, it makes sense to put an
increment larger than 1 (at best, 5 or 10) if the process simulation
will change the total bulk composition of the system. The SysEq records
generated
by the Process Simulator will then be numbered like 1000, 1010, 1020,
...
- this leaves you a possibility of producing more points in the most
interesting parts of the batch sequence later on (e.g., obtain better
resolution near the redox barrier). Please, keep in mind that the
process step counter <tt>Ntxi</tt> has a priority over iterators - the
simulation is finished when <tt>Ntxi</tt> points are computed,
regardless of which limiting values in the iterators are not yet
reached. <br>
&nbsp; </p>
<p>Now, let us come back to setting the iterator values. First of all,
we need to set constant pressure (1 bar) and temperature (25 <sup>o</sup>C).
To do it, select the&nbsp; <tt>iP</tt>&nbsp; column and put 1 into the
first cell (start value), 1 into second one (end value), and 0 into
third one (increment). Likewise, set the <tt>iTC</tt> column for fixed
25 <sup>o</sup>C. In the <tt>iTm</tt> column, set 1000 in the first,
1200 in second, and 10 in the third cell; this will generate SysEq
records with 1000, 1010, 1020, ..., 1190, 1200 CSD (<u>c</u>hemical <u>s</u>ystem
<u>d</u>efinition) variant numbers in the fourth field of the <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gdb_rkey.html#dbm_SysEq">SysEq
record key</a>. Finally, set 0 in the first, 20 in&nbsp; second, and
1 in third cells of the<tt> iNu</tt> column, to be used as an iterator
for a master variable&nbsp; <tt>cNu</tt>&nbsp; in the <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_proces.html#P_expr">Process
math script</a>. <br>
&nbsp; </p>
<p>This knowledge must be sufficient for us to write a necessary <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gmscript.html">math
script</a>. It has to assign current <tt>cNu</tt> value to number of
grams of strontianite ( <tt>xd_[{strontianite}]</tt> ) and <tt>20 -
cNu</tt> to number of grams of aragonite ( <tt>xd_[{aragonite}]</tt>)
- see how we specified 10 grams of each in our <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gemstart.html#SIDEBAR_1">previous</a>
<br>
<tt>"Default:G:CaSrCO3SS:1:0:1:25:0:"</tt> system definition! The math
script must look like this: <br>
&nbsp; </p>
<blockquote><tt>$ Changing Sr/Ca ratio in solid on iteration</tt> <br>
  <tt>cNu =: iNu[0] + J * iNu[2];</tt> <br>
  <tt>xd_[\J{aragonite}] =: 20 - cNu;</tt> <br>
  <tt>xd_[{strontianite}] =: cNu;</tt> <br>
  <tt>$ End</tt></blockquote>
<p><br>
Enter it into the <tt>P_expr </tt>field on <tt>Page 1</tt> of the
"Process" window (you can also drag mouse to select the text in the
Help browser window, then press <tt>Ctrl-c</tt>, click on the <tt>P_expr
</tt>field and press <tt>Ctrl-v</tt>). In this script: <br>
&nbsp; </p>
<blockquote><tt>'$'</tt>&nbsp; character starts a comment line; <br>
  <tt>J</tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is an internally changed
Process iteration index; <br>
Expression&nbsp; <tt>cNu =: iNu[0] + J * iNu[2];</tt> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
increments<tt> cNu</tt> from 0 to 20 by 1; <br>
Expression&nbsp; <tt>xd_[\J{aragonite}] =: 20 - cNu;</tt> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
assigns 20, 19, ..., 1, 0 grams to the <tt>xd_</tt> vector cell <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
for the first occurrence of <tt>aragonite</tt> in the species list.</blockquote>
<p><br>
The <tt>"\J"</tt> switch tells the program to look for the index
of&nbsp; <tt>aragonite</tt> in the Profile species name list (such
switches will be obsolete in the next version of GEMS). Before
simulations, the DC index is determined and substituted against the
species name (e.g., <tt>xd_[238]</tt>). As some species can be added
or removed to/from the profile later on, writing indices directly into <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gmscript.html">math
scripts</a> would create incompatibility problems; that is why name
preprocessing
has been implemented in GEM-Selektor.&nbsp; Now the Process Simulator
is ready to run. <br>
&nbsp; <br>
&nbsp; </p>
<h4> <a name="3_2_2_run_process"></a>3.2.2 Running the Process batch
IPM calculations</h4>
After editing of the process definition fields is finished, press
the&nbsp;<tt> "Calculate"</tt> button or <tt>"Record" "Calculate"</tt>
menu commands to start simulation. You will be asked to save the
Process record to database (to be able to recover it if something goes
wrong with calculations).&nbsp; If the Process math script contains
syntax errors, you may be asked to fix them before the program can
proceed. In our numerical example, you will get warnings that the
program finds more than one "aragonite" and "strontianite" - a
consequence of having two mixed carbonate phases with the same end
member names (two copies of solid solution phase definition are needed
to simulate phase separation). Just take the first ones and
proceed with calculations. <br>
&nbsp;
<p>During calculations, the "IPM Minimization Progress"&nbsp; dialog is
normally visible, showing the currently processed SysEq record key.
Calculations may take some time if the system is large or the process
simulator generates hundreds of points (depending on computer
performance). When all equilibria are computed, you will see a message
"Process calculation finished OK" in the status line of the "Process: "
window. Press "<tt>Accept</tt>"
button, then close the "Process" window (with save), and proceed with
analyzing the results. <br>
&nbsp; </p>
<p>The simplest (but less convenient)&nbsp; way is to examine each
generated equilibrium state (stored in a SysEq record) separately, as a
single
system, as described in <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gemstart.html#3_1_4_exam_results">Section
3.1.4</a>. Go into the&nbsp; "Single thermodynamic system" dialog and
press
the "Load..." button. In the appearing list, you should see many
entries
for the "<tt>CaSrCO3SS</tt>" system, numbered 1000, 1010, 1020 and so
on - generated by our process simulator. Click on (select) any of them
- for instance, 1050 - and press "Ok", then open the "EqDemo"
window.&nbsp; There you will see that two carbonate solid solutions of
different compositions are present, with mole fractions of end members
just on the solvus edges, so the system looks pretty much the same
as&nbsp; <tt>"Default:G:CaSrCO3SS:1:0:1:25:0:" </tt>(<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gemstart.html#SIDEBAR_1">end
of Section 3.2</a>). <br>
&nbsp; </p>
<p>Within the miscibility gap, all equilibria (numbered 1010 to 1080)
will have the same pH and solubility values, only masses of two mixed
phases will differ. Clearly, 4-6 points in this composition region
would be enough; there are only 1 and 2 points left for the one-phase
regions, - quite
insufficient to produce complete diagrams. Luckily, in GEM-Selektor
it's easy enough to improve the math script in the Process simulator
definition.
Let us try - close the "EqDemo" window and the "Single Thermodynamic
System"
dialog, and go back to the "Process" window. Load there our previously
created Process definition record <tt>"Default:G:CaSrCO3SS:0:0:1:25:0:CaSr_r20gL:S:<font
 size="+1">"</font></tt><font size="+1">.</font> <br>
&nbsp; </p>
<p>There are many ways of modifying the math script for "non-linear"
change of <tt>cNu</tt> variable - you can try yourself. Now, let us
simply
provide positions of 21 simulation points, defined in terms of mole
fraction of strontianite end-member. The math script must, accordingly,
convert mole fractions into grams (keeping total 20 g of the solid) and
then assign them to <tt>xd_</tt> vector cells as before. <br>
&nbsp; </p>
<p>To implement these changes,&nbsp; select <tt>"Record" "Remake"</tt>
menu item on the "Process" module window, and press <tt>"Remake"</tt>
button on the "Reorganization of Data Fields" dialog. This will open
the "Process: Remake Parameters" dialog; find the<tt> PePvv[0,9]</tt>
flag and switch it on (put <tt>'+'</tt>) to allocate a&nbsp; <tt>modC&nbsp;</tt>
work
array. Then find the&nbsp; <tt>PeDim1[0,1]</tt> count cell and enter 1
there - to tell the program that the&nbsp; <tt>modC</tt>&nbsp; array
will
have one column (and 21 lines, as indicated in the&nbsp; <tt>Ntxi</tt>
cell).&nbsp; Press <tt>"Ok"</tt> when ready and <tt>"Cancel"</tt> on
the
next "GtDemo: Set template" dialog. We are now back to the "Process"
window;
the newly-created <tt>modC</tt>&nbsp; vector can be seen to the right
of the math script field <tt>P_expr</tt>. Now, you can simply enter
mole
fractions of strontianite in solid composition into <tt>modC</tt>&nbsp;
like this (in mol %): 0; 0.1; 0.2; 0.3; 0.4; 0.5; 3; 10; 20; 40; 60;
80;
84; 85; 87; 90; 93; 97; 98; 99.9; 100.&nbsp; Then modify math script in
the&nbsp; <tt>P_expr</tt>&nbsp; field as follows (check for molar
masses
of aragonite and strontianite in their DComp records, <tt>M0d</tt>
field).
<br>
&nbsp; </p>
<blockquote><tt>$ Changing Sr/Ca ratio in solid on iteration</tt> <br>
  <tt>cNu =: modC[J]/100; cXi =: 1 - cNu;</tt> <br>
  <tt>$ Mole fraction/mass factor, normalized to 20 g</tt> <br>
  <tt>cpXi =: 20 / ( 147.629 * cNu + 100.089 * cXi );</tt> <br>
  <tt>xd_[\J{aragonite}] =: cpXi * cXi * 100.089;</tt> <br>
  <tt>xd_[{strontianite}] =: cpXi * cNu * 147.629;</tt> <br>
  <tt>$ End</tt></blockquote>
<p><br>
This math script is more complex because of a conversions between mole
fractions and moles of CaCO<sub>3</sub> and SrCO<sub>3</sub>, and a
need to maintain 20 grams of total solid per liter of aqueous
suspension. <br>
&nbsp; </p>
Calculate the process simulation again. What remains to
do is to plot some relevant results. Don't do it by hand - the GtDemo
module is at your disposal. <br>
&nbsp; <br>
<p>In the appearing "GtDemo: Remake parameters" dialog, first type in <tt>GDname</tt>
and <tt>GDcom</tt> fields as follows: <br>
&nbsp; </p>
<p><tt>Solubility of Ca and Sr at equilibrium with (Ca,Sr)CO3 SS</tt> <br>
<tt>as function of bulk solid X(Sr) at S/W = 20 g/L</tt> <br>
&nbsp; </p>
<p>The idea is to plot total dissolved calcium and strontium (molal) as
function of total mole fraction of Sr in solid phases (i.e. in binary
system). As experimental data in [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>]
does not discriminate between Ca and Sr, we will also plot a Ca+Sr line
and will compare it with some experimental points. So, in total we have
3 plots and need 3 columns in the <tt>y0</tt> table and, say, 7
experimental points and 1 column in the <tt>yE</tt> table. To set this
up, find the <tt>gDimXY[0,1]</tt> cell and enter 3 there, then enter 7
and 1 into <tt>gDimEf[0,0]</tt>
and <tt>gDimEf[0,1]</tt>, respectively, and turn on (<tt>'+'</tt>) the
<tt>GDps[0,0]</tt> flag. Press <tt>"Ok"</tt> when finished. <br>
&nbsp; </p>
<p>A small "Set template" dialog will appear, just press <tt>"Ok"</tt>
for now. You will see a list of SysEq record keys with a title "
Marking record keys for data extraction". With left mouse clicks,
select all <tt>CaSrCO3SS</tt>&nbsp; record keys numbered from <tt>1000</tt>
to <tt>1200</tt> (as they were set up in the Process definition).
Selected lines in the list are indicated by dark background color.
Press <tt>"Ok"</tt> when ready. You will see the "GtDemo" window (<tt>Page
1</tt>) with empty single- and multi-line editor fields. The largest
one is called <tt>gExpr</tt>, it must contain a <tt>GtDemo</tt> <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gmscript.html">math
script</a>, written, in principle, in a similar way as that in the <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/gm_proces.html">Process
simulator</a> definition. <tt>gX_Nam</tt> and <tt>gY_Nam</tt> fields
may contain names of abscissa and ordinate axis, respectively (in our
case <tt>"X_Sr"</tt>&nbsp; and <tt>"log_m"</tt>). The <tt>gLnam</tt>
list contains identifiers for the plot lines (columns in the <tt>y0</tt>
array), in case of our example, enter <tt>"Ca_aq", "Sr_aq"</tt> and <tt>"Ca+Sr"</tt>;
likewise, the <tt>gLnamE</tt> object identifies (plots of) the
empirical data that the user has entered into columns of the optional <tt>yE</tt>
array (<tt>"Ca+Sr_E"</tt>). <br>
&nbsp; </p>
<p>Now, it's time to write the math script; in GtDemo definition, it
must contain assignments such as <tt>x0[jR] =: ...... ;&nbsp;
y0[jR][0] =: ....; y0[jR][1] =: ...;&nbsp; ......</tt>&nbsp; Such
operators will put sampled data into lines of the <tt>x0</tt> and <tt>y0</tt>
arrays. In
most cases, it is sufficient to describe only how one record should be
sampled using the <tt>jR</tt> index variable which is automatically
changed
from 0 to <tt>gDimXY[0,0] </tt>(total number of sampled records) upon
GtDemo module execution. On the right side of assignment operators, you
can use
any (indexed) <a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_useref.html">data
object labels</a>
which refer to meaningful numerical data existing at present in
GEM-Selektor
program memory. These labels are seen on any module page screen forms
(e.g.,
"EqDemo") or window status lines. <br>
&nbsp; </p>
<p>For our example (Ca-Sr carbonate SSAS system), the following script
will do the job: <br>
&nbsp; </p>
<blockquote><tt>$ Determine Sr mole fraction in solid</tt> <br>
  <tt>x0[jR] =: ( b[\i{Sr}] - bXa[0][{Sr}] ) /</tt> <br>
  <tt>&nbsp; ( b[{Sr}] - bXa[0][{Sr}] + b[{Ca}] - bXa[0][{Ca}] );</tt> <br>
  <tt>$ Collect total dissolved Ca and Sr in log molal</tt> <br>
  <tt>y0[jR][0] =: lgm_t[{Ca}];</tt> <br>
  <tt>y0[jR][1] =: lgm_t[{Sr}];</tt> <br>
  <tt>$ Calculate log of sum of dissolved Ca and Sr</tt> <br>
  <tt>y0[jR][2] =: lg( 10^lgm_t[{Ca}] + 10^lgm_t[{Sr}] );</tt> <br>
  <tt>$ End</tt></blockquote>
<p><br>
You can see the contents of data objects&nbsp; <tt>b&nbsp;</tt>
and&nbsp; <tt>lgm_t</tt> in the "EqDemo" window, page <tt>EqIC</tt>
and
the bXa&nbsp; data object - in the "Multi" window, page <tt>Phas D</tt>.
Both are accessible from the "Single Thermodynamic System" dialog,
buttons
<tt>"Dual solution..."</tt> and <tt>"Details for experts"</tt>,
respectively.
Every time when a new SysEq record is loaded by the GtDemo module, the
script will be executed, the <tt>jR</tt> index automatically
incremented,
and the next record loaded from the database. Enter the script (or copy
it using clipboard) into <tt>gExpr</tt> editor field on <tt>Page 1</tt>
of the "GtDemo" window and press the <tt>"Calculate"</tt> icon or <tt>"Record"
"Calculate"</tt> menu commands (save the GtDemo record to database upon
warning). <br>
&nbsp; </p>
<p>If there were no syntax errors in the math script, the program will
silently spend some seconds for loading SysEq records one-by-one and
calculating the data. Finally, the "GtDemo" window title will show a
message "Calculation finished OK". Now, we can examine and plot the
results; to do it, select <tt>Page 2</tt> of rhe "GtDemo" window.
There you will see <tt>x0</tt> and <tt>y0</tt> arrays filled with
sampled numbers, as well as <tt>xE
</tt>and <tt>yE</tt> columns still containing zeros. From the <tt>"Record"</tt>
menu, the <tt>"Print"</tt> item exports data to ASCII print files, and
the <tt>"Plot"</tt> item opens the Graph Dialog window where <tt>y0</tt>
and <tt>yE</tt> columns are plotted as lines (or scattered symbols, or
both) against the <tt>x0 (xE)</tt> abscissa. <br>
&nbsp; </p>
<p>Select the <tt>"Record" "Plot"</tt> menu commands. You will be
prompted to save the GtDemo record to database (it is always wise to do
it).&nbsp; A graph window entitled as the "GDname" line appears. You
can see what each line means in the "Legend" on the right side. A The <tt>"Fragment"
</tt>button will display an enlarged fragment of the graph. A <tt>"Print..."</tt>
button sends the plot window contents to standard printing device (in
this version, may still be under construction). Line thickness, color
and symbols can be customized in the Legend Dialog which appears on
pressing
the <tt>"Customize..."</tt> button on the graph. There you can set up
scales for abscissa and ordinates, select axis type (the number of grid
lines), define size and position of zoomed fragment, and set symbol
shape,
size and color, as well as line thickness and color, for each ordinate.
The <tt>"Background"</tt> button lets you specify a background color
for
the graph (not saved with other contents of GtDemo record in this
version).
<br>
&nbsp; </p>
<p>If you have entered some experimental data into <tt>xE</tt> and <tt>yE</tt>
arrays, their symbols and colors can be customized separately on the
Legend dialog. For capturing a ready GtDemo graph window into <tt>*.jpg</tt>,
<tt>*.png</tt> or other graphic file formats, we recommend using a <tt>ksnapshot</tt>
utility program (a Linux KDE application) or Win32 <tt>Alt-PrtSc</tt>
key combination to send the picture to clipboard, from where it can be
inserted into an image editor (e.g., Microsoft(R) Photo Editor). <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; </p>
<h4> <a name="3_2_5_export_results"></a>3.2.5 Exporting sampled results</h4>
<p><br>
To export data sampled by a GtDemo definition, open the "GtDemo"
window, load a record of interest, and select <tt>"Record" "Print"</tt>
commands from the menu. You will have to answer questions such as which
format (tabular or plain text) to use, and whether to print math script
together with the data. Then a standard "File selection" dialog appears
where you can enter the file name and choose the directory path to save
the file. This ASCII file can then be edited using any standard text
editor and imported into Microsoft(R) Excel or other commercial
presentation programs. We are going to provide output filters for
exporting data into some important formats in the future versions of
GEM-Selektor. <br>
&nbsp; </p>
<p>Let us return to our numerical example - (Ca,Sr)CO<sub>3</sub> SSAS
system, - and examine the plot of aqueous solubility data in more
details. Please, open the "GtDemo" window, load the previously created
record keyed "<tt>Default:SysEq:GT:0:CaSrCO3SS_aq:"</tt>, and plot it (<tt>"Record"
"Plot"</tt> menu commands). We see on the plot that Sr_aq steeply
increases from less than 1e-7 to about 1e-3 molal at 1e-6 &lt; <i>X</i>
(Sr) &lt; 0.005 and then Sr_aq and Ca_aq remain constant along the
miscibility gap where compositions of both solid solution phases are
fixed at the spinodal mole fractions up to <i>X</i> (Sr) = 0.86. At
higher mole fractions of Sr in the solid, Sr_aq increases up to the
solubility of pure strontianite (4.5 mmolal) while Ca_aq goes below
1e-6 molal. <br>
&nbsp; </p>
<p>Let us see how the calculated total dissolved Ca+Sr fit with the
experimental data of Plummer and Busenberg [<a
 href="../../../../../../../../C:/GEMS2test/program/doc/html/g_litref.html#%5B1987PLU/BUS%5D">1987PLU/BUS</a>].
To save time, enter into <tt>xE</tt> and <tt>yE</tt> columns on <tt>Page
2</tt> of the "GtDemo" window only seven points from their Table 4 for
25 <sup>o</sup>C at nearly one bar p(CO<sub>2</sub>): <br>
&nbsp; <br>
&nbsp;
<table border="3" cellpadding="3" cellspacing="3">
  <tbody>
    <tr>
      <td><tt>X(Sr),xE</tt></td>
      <td><tt>0.0083</tt></td>
      <td><tt>0.114</tt></td>
      <td><tt>0.411</tt></td>
      <td><tt>0.565</tt></td>
      <td><tt>0.859</tt></td>
      <td><tt>0.925</tt></td>
      <td><tt>0.998</tt></td>
    </tr>
    <tr>
      <td><tt>Solubility</tt></td>
      <td><tt>10.81</tt></td>
      <td><tt>11.58</tt></td>
      <td><tt>10.57</tt></td>
      <td><tt>8.72</tt></td>
      <td><tt>5.56</tt></td>
      <td><tt>5.13</tt></td>
      <td><tt>4.72</tt></td>
    </tr>
    <tr>
      <td><tt>log(solub.),yE</tt></td>
      <td><tt>-1.966</tt></td>
      <td><tt>-1.936</tt></td>
      <td><tt>-1.976</tt></td>
      <td><tt>-2.059</tt></td>
      <td><tt>-2.255</tt></td>
      <td><tt>-2.290</tt></td>
      <td><tt>-2.326</tt></td>
    </tr>
  </tbody>
</table>
</p>
<p>When ready, save the record to database and plot the data again (<tt>"Record"
"Plot"</tt>). Customize the graph (make scattered symbols of size 5,
line type 0 for the experimental points). The experimentally determined
total solubilities are significantly less than our model predictions at
total 0.6 &lt; <i>X</i> (Sr) &lt; 0.9, implying either inhibition of
phase
separation in this region or insufficient equilibration time in the
experiments.
<br>
&nbsp; </p>
<p>It is now interesting to see how compositions of both solid solution
phases change with total <i>X</i> (Sr) in solid. It is easy - we just
have to "clone"&nbsp; the previously created GtDemo record and change
some parts in the sampler definition. In the "Record" menu, select <tt>"Save
as"</tt> , change the record key to "<tt>Default:SysEq:GT:1:CaSrCO3SS_sx:"</tt>,
press <tt>"Ok"</tt> and then select <tt>"Record" "Remake"</tt> menu
item. Select "SysEq" in the appearing list, press <tt>"Ok"</tt> and
again <tt>"Remake"</tt> button. Now we need four lines for mole
fractions of two end members in two phases, and we will not plot any
experimental points. So, find the <tt>gDimXY[0,1]</tt> cell and enter
6 there, then enter zeros into <tt>gDimEf[0,0]</tt> and <tt>gDimEf[0,1]
</tt>fields, and turn off (to <tt>'-'</tt>) the <tt>GDps[0,0]</tt>
flag. Press <tt>"Ok"</tt> when finished. The record key template and
list of SysEq record keys appear again, all the keys are already
selected, simply press <tt>"Ok"</tt>. In the "GtDemo" window, change
GDname field to:
<br>
&nbsp; </p>
<blockquote><tt>Mole fractions of Ca and Sr end members in SS phases</tt></blockquote>
<p><br>
Put <tt>"Mol fr."</tt> to <tt>gY_Nam</tt> field. Six entries in
<tt>gLnam</tt> list can be changed to <tt>"X1Ca", "X1Sr", "X2Ca",
"X2Sr",
"mX1,g", "mX2,g". </tt>There are many ways to write a math script for
picking up mole fractions of solid solution end members; here is just
one of them, in tune with the previous script: <br>
&nbsp; </p>
<blockquote><tt>$ Determine total Sr mole fraction % in solid</tt> <br>
  <tt>x0[jR] =: ( b[\i{Sr}] - bXa[0][{Sr}] ) *100 /</tt> <br>
  <tt>&nbsp; ( b[{Sr}] - bXa[0][{Sr}] + b[{Ca}] - bXa[0][{Ca}] );</tt> <br>
  <tt>$ Collect % mole fractions of Ca and Sr in SS phases</tt> <br>
  <tt>y0[jR][0] =: Wxx[\j{oxygen}+1]*100;</tt> <br>
  <tt>y0[jR][1] =: Wxx[{oxygen}+2]*100;</tt> <br>
  <tt>y0[jR][2] =: Wxx[{oxygen}+3]*100;</tt> <br>
  <tt>y0[jR][3] =: Wxx[{oxygen}+4]*100;</tt> <br>
  <tt>$ Masses of SS phases in grams</tt> <br>
  <tt>y0[jR][4] =: phM[2];</tt> <br>
  <tt>y0[jR][5] =: phM[3];</tt> <br>
  <tt>$ End</tt></blockquote>
<p><br>
<tt>Wxx</tt> is the data vector containing calculated mole fractions
for species in multi-component phases. The <tt>oxygen</tt> gas stays
in the DC list just before aragonite end member of the first solid
solution phase, and this name is used in the script to avoid warnings
that there are two species named "<tt>aragonite</tt>". <tt>phM</tt> is
a vector containing masses of phases (see <tt>EqPh</tt> page of
"EqDemo" window). Put this script into <tt>gExpr</tt> field (remove
old contents before) and run the data
sampler by clicking on the <tt>"Calculate"</tt> icon. When finished,
plot
the data and customize the graph (assign different colors to lines,
adjust
the grid and so on). <br>
&nbsp; </p>
Take a look first at the <tt>"mX1,g" </tt>and<tt> "mX2,g"</tt> lines
showing amounts of Ca-strontianite and Sr-aragonite phases,
respectively. Both phases co-exist in a wide region of total <i>X</i>
(Sr)&nbsp; values from 0.5 to 86 %, where the quantity of the first one
increases and that of the second one decreases, while mole fractions of
end-member remain fixed
(i.e. fill out a miscibility gap at very low Sr content in aragonite
and
ca. 14% CaCO<sub>3</sub> in strontianite). At&nbsp; <i>X</i> (Sr) =
86%,
the Sr-aragonite phase disappears and mole fractions of end-members in
Ca-strontianite change linearly towards composition of pure
strontianite; quantity of this phase now practically remains constant. <br>
<br>
<p>&nbsp; <br>
&nbsp; <br>
&nbsp; </p>
<h4> <a name="3_2_1_set_process"></a></h4>
<br>
<br>
<br>
<br>
<p><br>
</p>
<p><br>
</p>
<p><br>
</p>
<p><br>
</p>
<p> Then we will add sulfur to the system (and extend the thermodynamic
database accordingly) to explore how the solid solution - aqueous
solution (SSAS) equilibria involving (Ca,Sr)CO<sub>3</sub> solid
solutions would change due to precipitation of SrSO<sub>4</sub> phase
(celestite). <br>
</p>
<p><br>
<br>
</p>
<p><tt>end of file</tt> <br>
&nbsp; </p>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</body>
</html>
